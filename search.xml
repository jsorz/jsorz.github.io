<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[å‰ç«¯ä¸ºä»€ä¹ˆè¦ä¼šæ­£åˆ™è¡¨è¾¾å¼]]></title>
    <url>%2Fblog%2F2019%2F02%2Fregexp-in-frontend.html</url>
    <content type="text"><![CDATA[åœ¨ç¬”è€…å­¦ç”Ÿæ—¶ä»£ï¼Œä¸€ç›´å•çº¯åœ°è®¤ä¸ºæ­£åˆ™éƒ½æ˜¯åç«¯è€å“¥çš„äº‹å„¿ï¼Œå‰ç«¯åªè¦ split ä¸€æŠŠæ¢­å°±å¤Ÿäº†ã€‚ä¸‡ä¸å¾—å·²çš„æ—¶å€™å°±ç½‘ä¸Šæœå‡ æ®µæ­£åˆ™ä»£ç ï¼Œcopy ä¸€ä¸‹ä¹Ÿèƒ½ç”¨ã€‚ è¿™æ˜¯ç»´åŸºç™¾ç§‘ä¸Šæ­£åˆ™è¡¨è¾¾å¼çš„è¯æ¡ï¼Œæˆªå›¾åªæˆªäº†ä¸€å±ï¼Œäº‹å®ä¸Šè¿™å¼ æ­£åˆ™è¡¨è¾¾å¼çš„è¡¨æ ¼ä¸¤ä¸ªå±å¹•éƒ½è£…ä¸ä¸‹ã€‚ã€‚ã€‚æˆ‘ç¬¬ä¸€æ¬¡æŸ¥çš„æ—¶å€™ç«‹é©¬å°±å¼ƒäº†ï¼Œäºæ˜¯å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œéƒ½åœ¨åŸåœ°è¸æ­¥ï¼Œåªä¼šç”¨ç”¨ ^ $ . * æœ€åˆè§åˆ°æ­£åˆ™è¡¨è¾¾å¼æ˜¯åœ¨è¡¨å•éªŒè¯é‡Œï¼Œå¤šå°‘ä¼šç”¨äº› validate çš„åº“ï¼ŒåŸºæœ¬çš„ç”µè¯ / é‚®ç®±ä¹‹ç±»çš„æ ¡éªŒéƒ½æœ‰ç°æˆçš„ï¼ŒçœŸæ­£è‡ªå·±å†™æ­£åˆ™å»æ ¡éªŒè¾“å…¥æ ¼å¼çš„æœºä¼šå¹¶ä¸å¤šã€‚åæ¥æ¸æ¸å‘è§‰æ­£åˆ™è¡¨è¾¾å¼çš„é­”åŠ›ï¼Œå®ƒå¯ä»¥æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆçš„ä¸€æŠŠåˆ©å™¨ã€‚ æ—¥å¸¸çäº‹1ã€è€é¡¹ç›®è¿ç§»ï¼Œæ‰€æœ‰çš„ T.dom.getElementById(&#39;abc&#39;) ä»£ç éƒ½è¦æ”¹æˆæ–°çš„å†™æ³• $(&#39;#abc&#39;) 2ã€ç»„ä»¶åº“å‡çº§ï¼Œæ‰€æœ‰çš„ &lt;el-dialog v-model=&quot;a&quot; å¿…é¡»æ”¹æˆ &lt;el-dialog :visible.sync=&quot;a&quot; éƒ½æ˜¯çœŸå®å·¥ä½œä¸­çš„è„æ´»ç´¯æ´»ï¼Œæ•…äº‹ 1 ä¸­çš„é¡¹ç›®æœ‰è¿‘ 100 ä¸ªé¡µé¢ï¼Œç”±äº T åº“å¼ƒç”¨äº†ï¼Œä¸ä»… T.dom.getElementById è¿˜æœ‰ getElementByClass ç­‰ç­‰è°ƒç”¨éƒ½è¦æ”¹æˆ jquery çš„å†™æ³•ã€‚å¦‚æœå®Œå…¨é äººè‚‰ï¼Œé‚£æ˜¯å¤šä¹ˆçš„è‹¦åŠ›ã€‚ æ•…äº‹ 2 ä¸­çš„ç»„ä»¶åº“å…¶å®å°±æ˜¯æˆ‘ä»¬çš„ Elementï¼Œæˆ‘ä»¬åŸå…ˆå¾ˆå¤šé¡¹ç›®éƒ½æ˜¯ Element 1.xï¼Œè¦å‡çº§åˆ° 2.xï¼Œè¿™ä¸ªå¯¹è¯æ¡†çš„ breaking change å½±å“è¿˜æŒºå¤§çš„ï¼Œåœ¨ 2.x ä¸­é€šè¿‡ v-model æ˜¯æ— æ³•å”¤èµ·å¯¹è¯æ¡†çš„ã€‚å› æ­¤è¦ç¡®ä¿æ¯ä¸ª el-dialog éƒ½æ£€æŸ¥ä¸€éï¼Œè€Œæ¨¡æ¿ä»£ç é‡Œ el-dialog çš„ v-model å¯èƒ½ä¸åœ¨ç¬¬ä¸€ä¸ªï¼Œå±æ€§å¤šçš„æ—¶å€™è¿˜ä¼šæ¢è¡Œï¼Œéƒ½éœ€è¦ç«çœ¼é‡‘ç›ã€‚ èªæ˜çš„è¯»è€…è‚¯å®šçŸ¥é“ï¼Œé äººè‚‰æ˜¯ä¸ªæ²¡æœ‰åŠæ³•çš„åŠæ³•ï¼Œè€Œä¸”çœ‹å¤šäº†ä¹Ÿä¼šçœ¼èŠ±ï¼Œæœ€å¥½è¿˜è¦ double checkã€‚è™½ç„¶å†™æ­£åˆ™è¡¨è¾¾å¼å»æ‰¾ï¼Œä¹Ÿä¸èƒ½ä¿è¯ 100% éƒ½è¦†ç›–ï¼Œæ¯•ç«Ÿè€é¡¹ç›®é‡Œå„ç§è¿·ä¹‹ä»£ç éƒ½æœ‰ï¼Œä½†æ­£åˆ™èƒ½å¸®æˆ‘ä»¬æ‰¾å‡ºå¤§éƒ¨åˆ†ï¼Œå¹¶ä¸” replace çš„æ—¶å€™ä¹Ÿèƒ½é¿å…è¾“å…¥é”™è¯¯ï¼Œè¿™æ ·å¯ä»¥æŠŠç²¾åŠ›æ”¾åœ¨ double check ä¸Šã€‚ æ­£åˆ™èµ·æºæ­£åˆ™è¡¨è¾¾å¼æºäºå½¢å¼è¯­è¨€ä¸è‡ªåŠ¨æœºç†è®ºï¼Œå…³äºå½¢å¼åŒ–çš„å†…å®¹ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å» wiki ä¸ŠæŸ¥ã€‚ æ­£åˆ™å¼•æ“çš„åŸºç¡€å°±æ˜¯çŠ¶æ€æœºï¼Œåœ¨ç¼–è¯‘åŸç†ä¸­ä½ ä¸€å®šä¼šå¬è¯´ NFA (éç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœº) ä¸ DFA (ç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœº)ï¼Œå…³äº NFA / DFA é€šä¿—çš„è§£é‡Šå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚ æ­£åˆ™è¡¨è¾¾å¼æœ€æ—©åœ¨ Unix ä¸­çš„ sed å’Œ grep å‘½ä»¤ä¸­å¼€å§‹æ™®åŠã€‚å¦‚æœä½ ç”¨è¿‡ sed &quot;s/aaa/bbb/&quot; çš„è¯ï¼Œå…¶å®å¯ä»¥å†™æ­£åˆ™è¡¨è¾¾å¼æ¥åšæ›´å¤æ‚çš„æ–‡æœ¬å¤„ç†ã€‚ è€Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼ŒPerl æ˜¯ç¬¬ä¸€ä¸ªå®ç°æ­£åˆ™è¡¨è¾¾å¼å¼•æ“çš„è¯­è¨€ã€‚ç›®å‰å¤§éƒ¨åˆ†è¯­è¨€éƒ½ä½¿ç”¨åŸºäº NFA çš„æ­£åˆ™å¼•æ“ã€‚ æ€ä¹ˆå­¦æ­£åˆ™ç¬”è€…èµ°äº†ä¸€äº›å¼¯è·¯ï¼Œå…ˆåœ¨å®æˆ˜ä¸­å†™æ­£åˆ™ï¼Œä¸ä¼šå†™å°±æŸ¥æ­£åˆ™çš„è¯­æ³•è¡¨ï¼Œæ¸æ¸åœ°å¤§éƒ¨åˆ†è¯­æ³•ä¹Ÿå°±éƒ½è®°ä½äº†ï¼Œéœ€è¦æŸ¥è¡¨çš„ä¹Ÿè¶Šæ¥è¶Šå°‘äº†ã€‚å…¶å®æˆ‘è§‰å¾—æ­£ç¡®çš„å­¦ä¹ æ–¹å¼åº”è¯¥å…ˆå®Œæ•´åœ°çœ‹ä¸€æœ¬å…¥é—¨ä¹¦ç±ï¼Œå¯¹æ•´ä½“æœ‰å®è§‚æŠŠæ§åï¼Œå†åœ¨å®æˆ˜ä¸­åå¤ç»ƒä¹ å’ŒæŸ¥è¡¨ï¼Œå›å¤´å†é‡çœ‹ä¹¦ï¼Œè¿™æ ·çš„è®°å¿†åº”è¯¥æœ€æ·±ã€‚ å¦‚æœä½ è¿˜åœ¨ä¸ºæ­£åˆ™è¡¨è¾¾å¼çš„è¯­æ³•è€Œå¥å¿˜çš„è¯ï¼Œæ¨èä¸€æœ¬ã€Šæ­£åˆ™è¡¨è¾¾å¼å¿…çŸ¥å¿…ä¼šã€‹ï¼Œè¿™æœ¬ä¹¦åªæœ‰ 100 é¡µï¼Œä¸€ä¸ªå‘¨æœ«å°±èƒ½çœ‹å®Œã€‚ä»¥åå†æŸ¥è¯­æ³•è¡¨çš„æ—¶å€™ï¼Œå°±ä¼šè¶Šæ¥è¶Šæœ‰è§„å¾‹å¯å¾ªã€‚ æ­£åˆ™è¡¨è¾¾å¼çš„è¯­æ³•å¯åˆ†ä¸ºè¿™å‡ å¤§ç±» åŒ¹é…å­—ç¬¦ åŒ¹é…ä½ç½® é‡å¤ä¸è´ªå©ª åˆ†ç»„ä¸æ•è· å‰åæ–­è¨€ æœ¬æ–‡å¹¶ä¸ä»‹ç»æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ï¼Œåªé€šè¿‡å®é™…å·¥ä½œçš„ä¾‹å­æ¥è¯´æ˜æ­£åˆ™çš„ç”¨é€”ã€‚å¯ä»¥å…ˆæ ¹æ®ä»¥ä¸Šå‡ ä¸ªåˆ†ç±»ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼çš„è¯­æ³•è¡¨é‡Œå†è¿‡ä¸€éã€‚ 1ã€URLé‡Œçš„æš—å·åœ¨å…¬å¸çš„å¼€å‘ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šæœ‰ä¸¤å¥—ä»¥ä¸Šçš„æµ‹è¯•ç¯å¢ƒï¼Œå¦‚ alpha å’Œ beta ç¯å¢ƒã€‚è€Œåœ¨å‰ç«¯é¡µé¢ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸åŒçš„ URL æ¥åŒºåˆ†ï¼Œä¾‹å¦‚ jack.alpha.domain.com ä¸ jack.beta.domain.com åˆ†åˆ«å¯¹åº” alpha å’Œ beta ç¯å¢ƒï¼Œè€Œ jack.domain.com åˆ™æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚é—®é¢˜æ¥äº†ï¼Œå‰ç«¯ä»£ç æ˜¯åŒä¸€ä»½ï¼Œå®ƒéœ€è¦æ ¹æ®å½“å‰ hostname æ‰€å±çš„ç¯å¢ƒæ¥è°ƒç”¨ä¸åŒç¯å¢ƒçš„æ¥å£ã€‚ å½“ç„¶è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯ split ä¸€æŠŠæ¢­å°±èƒ½è§£å†³çš„ï¼Œä½†è¿™å¹¶ä¸ä¼˜é›…ã€‚å›åˆ°æ­£åˆ™è¡¨è¾¾å¼ä¸Šï¼Œæˆ‘ä»¬å…ˆåˆ†æéœ€æ±‚ï¼Œå‡è®¾å…¬å¸ä¸€çº§åŸŸååªæœ‰ domain.com çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜å°±æ˜¯æå– appid (ä¾‹å­ä¸­çš„ jack) ä¸ .domain.com ä¸­é—´çš„éƒ¨åˆ†ã€‚ 123var reg = /\w+\.(\w+\.)?domain.com/;var match = 'jack.alpha.domain.com'.match(reg);console.log(match[1]); // alpha. å¦‚ä¸Šä»£ç çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå…³é”®æ˜¯ (\w+\.)? è¿™æ®µï¼Œå®ƒè¡¨ç¤ºåŒ¹é…é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œå¹¶ä¸”å°æ‹¬å·æ˜¯åˆ†ç»„ï¼Œå¯åœ¨ match çš„ç»“æœä¸­ç›´æ¥æ•è·åˆ°åˆ†ç»„é‡Œçš„å€¼ã€‚ è¡¥å……1ï¼šåˆ†ç»„é‡Œæ‹¿åˆ°çš„ç»“æœæ˜¯ alpha.ï¼Œå¤šäº†ä¸ª . ä¸èµ°å¿ƒï¼Œæ€ä¹ˆæŠŠå®ƒå»æ‰å‘¢ï¼Ÿå¯ä»¥æ”¹æˆ ((\w+)\.)? è¿™æ · alpha å°±è¦åœ¨ç¬¬ 2 ç»„æ•è·é‡Œæ‹¿åˆ°äº†ï¼Œå› ä¸ºç¬¬ 1 ç»„ä»æ˜¯ alpha. è¡¥å……2ï¼šè¯•è¯• (?:(\w+)\.)? è¿™é‡Œ (?:) è¡¨ç¤ºä¸äº§ç”Ÿåˆ†ç»„å·ï¼Œäºæ˜¯ä»å¯åœ¨ç¬¬ 1 ç»„æ•è·ä¸­æ‹¿åˆ° alpha è¡¥å……3ï¼š\w åŒ¹é…å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œå¦‚æœä½ çš„ hostname ä¸­åŒ…å«å…¶ä»–å­—ç¬¦ï¼Œæ¯”å¦‚æ‰©å……æˆ [\w-] å°±å¯ä»¥åŒ…å«ä¸­åˆ’çº¿ - è¡¥å……4ï¼šåŠ å…¥å…¬å¸çš„ä¸€çº§åŸŸåæœ‰å¤šä¸ªï¼Œé‚£ä¹Ÿå¯ä»¥å¯¹ domain.com å†è¿›è¡Œæ‰©å……ã€‚ 12345var reg = /\w+\.(?:(\w+)\.)?(domain|abc|xyz).com/;var match = 'jack.alpha.domain.com'.match(reg);console.log(match[1]); // alphamatch = 'jack.domain.com'.match(reg)console.log(match[1]); // undefined (åˆ†ç»„æ•è·ä¸åˆ°åˆ™è¡¨ç¤ºç”Ÿäº§ç¯å¢ƒ) æ­£åˆ™è¡¨è¾¾å¼çš„ä¹¦å†™æ˜¯é€æ­¥ç»†åŒ–çš„ï¼Œè¿˜æ˜¯è¦å…ˆåˆ†æå¥½éœ€æ±‚ï¼Œå†™çš„ä¸å¤šä½™ã€‚ 2ã€å¼•å·æ›¿æ¢åœ¨ä¸€äº›è€é¡¹ç›®é‡Œ JavaScript ä»£ç ç»å¸¸å­˜åœ¨å•å¼•å·åŒå¼•å·æ··ç”¨ï¼Œå¾ˆä¸è§„èŒƒï¼Œè®©ä»¥åçš„ç»´æŠ¤è€…çœ‹ç€å¾ˆç´¯ã€‚è™½ç„¶ç°åœ¨æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨ ESLint æ¥è‡ªåŠ¨ä¿®å¤ï¼Œè¿˜æ˜¯æƒ³ä¸¾è¿™ä¸ªä¾‹å­æ¥ä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ª case 123456789&#123; "a": &#123; "a1": "a1", "a2": &#123; "b1": 'b1' &#125; &#125;, 'b': "b"&#125; ç°åœ¨å¸Œæœ›æŠŠè¿™æ®µ JSON å¯¹è±¡æ”¹æˆ key ä¸å¸¦å¼•å·ï¼Œvalue éƒ½ä¸ºå•å¼•å·ã€‚è§‚å¯Ÿä¸‹è¿™ä»½æ•°æ®ï¼Œkey å’Œ value éƒ½æœ‰å•å¼•å·å’ŒåŒå¼•å·ï¼Œäºæ˜¯æˆ‘çš„æƒ³æ³•æ˜¯å…ˆæŠŠæ‰€æœ‰åŒå¼•å·æ”¹æˆå•å¼•å·ï¼Œç„¶åå†æŠŠ key çš„å•å¼•å·å»æ‰ã€‚ åŒå¼•å· â†’ å•å¼•å·ï¼Œæˆ‘ç¬¬ä¸€æ¬¡å†™å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼š 1replace(/"(.*)"/g, '$1') å¤§éƒ¨åˆ† IDE çš„ find-replace åŠŸèƒ½éƒ½æ”¯æŒå†™æ­£åˆ™ï¼Œä¸å¦¨å¯ä»¥è¯•è¯•çœ‹ï¼Œä¸Šé¢è¿™æ®µæ­£åˆ™æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ .* ä¹ŸåŒ¹é…äº†åŒå¼•å·ï¼Œä¸Šé¢ &quot;a1&quot;:&quot;a1&quot; è¢« &quot;.*&quot; åŒ¹é…äº†ï¼Œè¿™æ˜¯å…¸å‹çš„è¿‡åº¦åŒ¹é…ã€‚è§£å†³åŠæ³•æ˜¯ä½¿ç”¨ [^&quot;]* æˆ–è€…ä½¿ç”¨ .*? ä»¥è¡¨ç¤ºå°½å¯èƒ½å°‘çš„é‡å¤ã€‚è¿™å°±è¯´åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„è´ªå©ªä¸æƒ°æ€§ã€‚ è´ªå©ªä¸æƒ°æ€§ å›¾ç‰‡ç¤ºä¾‹æ¥è‡ªã€ŠJavaScript æ­£åˆ™è¡¨è¾¾å¼è¿·ä½ ä¹¦ã€‹ ä¸Šé¢è¿™å¼ å›¾è§£é‡Šäº†æ­£åˆ™å¼•æ“çš„åŒ¹é…è¿‡ç¨‹ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯ &quot;.*&quot;ï¼Œå¾…åŒ¹é…çš„å­—ç¬¦ä¸²æ˜¯ &quot;abc&quot;de ç¬¬ 1 æ­¥ï¼Œåˆå§‹åŒ–ï¼Œå½“å‰çŠ¶æ€æŒ‡å‘æ­£åˆ™ä¸­çš„ç¬¬1ä¸ª &quot;ï¼Œå¹¶ä¸”å¼€å§‹è¯»å–å¾…åŒ¹é…å­—ç¬¦ä¸²ã€‚ ç¬¬ 2 æ­¥ï¼Œå‘ç°æ­£åˆ™ä¸­çš„ç¬¬1ä¸ª &quot; æ­£å¥½èƒ½åŒ¹é…å­—ç¬¦ä¸²ã€‚ ç¬¬ 3 æ­¥ï¼Œå½“å‰çŠ¶æ€æŒ‡å‘æ­£åˆ™ä¸­çš„ .*ï¼Œå¹¶ä¸”è¯»å–å­—ç¬¦ä¸²çš„æŒ‡é’ˆä¹Ÿå‘å‰ç§»åŠ¨ï¼Œå·§äº†ï¼Œa ä¹Ÿè¢«åŒ¹é…ä¸Šäº†ã€‚ ç¬¬ 4 ~ 8 æ­¥ï¼ŒçœŸé¦™çœŸé¦™ï¼Œ.* ä¸€ç›´åŒ¹é…åˆ°å­—ç¬¦ä¸²æœ«å°¾äº†ï¼å‘äº†ï¼Œæˆ‘è¿™æ­£åˆ™ .* åé¢è¿˜æœ‰ä¸ª &quot; è¦æ€ä¹ˆåŠï¼Ÿ ç¬¬ 9 æ­¥ï¼Œè¯»å–å­—ç¬¦ä¸²çš„æŒ‡é’ˆå›é€€ä¸€æ ¼ã€‚è¿™å°±æ˜¯æ­£åˆ™åŒ¹é…ä¸­çš„å›æº¯ã€‚ ç¬¬ 10 æ­¥ï¼Œå›é€€å®Œå‘ç°æ­£åˆ™æœ€åçš„ &quot; è¿˜æ˜¯æ²¡æ³•åŒ¹é… eï¼Œäºæ˜¯ç»§ç»­å›é€€ã€‚ ç¬¬ 11 æ­¥ï¼Œå›é€€å®Œè¿˜æ˜¯ä¸èƒ½åŒ¹é…ï¼Œå†å›é€€ã€‚ ç¬¬ 12 æ­¥ï¼Œç°åœ¨è¯»å–å­—ç¬¦ä¸²çš„æŒ‡é’ˆåœ¨ &quot; ä¸Šï¼Œä¸å®¹æ˜“ï¼Œç»ˆäºåŒ¹é…ä¸Šäº†ï¼ ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œ.* æ˜¯è´ªå©ªçš„ï¼Œä¸€å¼€å§‹ä¼šæŠŠå­—ç¬¦ä¸²é‡Œçš„ abc&quot;de éƒ½åŒ¹é…è¿›å»ï¼Œç„¶åæ­£åˆ™å‘ç°è¿™æ˜¯æ¡æ­»è·¯ï¼Œå†ä¸€æ­¥æ­¥å›é€€ï¼Œç›´åˆ°æ­£åˆ™èƒ½å¤Ÿç»§ç»­åŒ¹é…ä¸‹å»ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ NFA ä¸­çš„å›æº¯æ³•ã€‚ è€Œå½“ä½¿ç”¨äº†æƒ°æ€§æ¨¡å¼åï¼Œå¦‚å°† .* æ”¹æˆ .*?ï¼Œå®ƒä¼šå°½å¯èƒ½å°‘åœ°åŒ¹é…ã€‚ä¸å¦¨è¯•ä¸‹ä»¥ä¸‹ä¸¤ä¸ªä¾‹å­ï¼Œè§‚å¯Ÿä¸¤ä¸ªåˆ†ç»„é‡Œæ•è·åˆ°çš„å†…å®¹ã€‚ 12'12345'.match(/(\d&#123;1,3&#125;)(\d&#123;2&#125;)/)'12345'.match(/(\d&#123;1,3&#125;?)(\d&#123;2&#125;)/) å›æº¯çš„æ·±æ¸Šç„¶è€Œæ­£åˆ™ä¸­çš„è´ªå©ªå’Œå›æº¯ä¹Ÿæœ‰ä¸ªå¤©å‘ï¼Œé‚£å°±æ˜¯ ReDosï¼Œå³æ­£åˆ™è¡¨è¾¾å¼é‡Œçš„ Deny of Serviceã€‚å¯ä»¥è¯•è¯•å¦‚ä¸‹ä»£ç ï¼š 12'aaaaaaaaaaaaaaaaaaaaaaaaaaaab'.match(/^(a+)+$/)'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaab'.match(/^(a+)+$/) å½“æ­£åˆ™è¡¨è¾¾å¼ä¸­å‡ºç°æœ‰æ­§ä¹‰çš„ç‰‡æ®µæ—¶ï¼Œå¦‚ /(a+)+/ï¼Œå­—ç¬¦ä¸²é‡Œçš„ a æ—¢å¯ä»¥è¢« a+ åŒ¹é…ï¼Œåˆå¯ä»¥è¢« (a+)+ åŒ¹é…ï¼Œè¿™å°±å®¹æ˜“äº§ç”Ÿé—®é¢˜ã€‚æŒ‰ç…§ä¸Šé¢å›æº¯æ³•çš„åŸç†ï¼Œa+ ä¼šå…ˆä¸€è·¯æŠŠ a éƒ½åŒ¹é…å®Œï¼Œç„¶åå‘ç°ç³Ÿäº†ï¼Œæ­£åˆ™è¡¨è¾¾å¼æœ€åè¿˜æœ‰ä¸ª +ï¼Œäºæ˜¯ä¸€ä¸ªä¸ªå­—ç¬¦å›é€€ï¼Œç›´åˆ°å‘ç° (a+)+ èƒ½åŒ¹é…æ—¶åˆä¼šä¸€è·¯æŠŠ a éƒ½åŒ¹é…å®Œï¼Œç„¶åå‘ç°è¡Œå°¾ç¬¦åŒ¹é…ä¸äº†ï¼Œä¼šå†æ¬¡å›æº¯å°è¯•ã€‚éšç€å­—ç¬¦ä¸²é•¿åº¦çš„å¢åŠ ï¼Œå›æº¯æ¬¡æ•°ä¼šå‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œç»ˆå°†å¯¼è‡´ Deny of Serviceã€‚ ReDos çš„å†…å®¹æ›´å¤šåœ¨å®‰å…¨é¢†åŸŸï¼Œç¬”è€…åªç²—ç•¥äº†è§£ä¸‹ã€‚å¹³æ—¶ä¹¦å†™æ­£åˆ™è¡¨è¾¾å¼çš„æ—¶å€™å°¤å…¶è¦ç•™æ„åµŒå¥—çš„ * å’Œ +ã€‚ 3ã€å­—ç¬¦ä¸²å»é‡ä½ å¯èƒ½åœ¨ç®—æ³•é¢˜é‡Œä¹Ÿè§è¿‡å­—ç¬¦ä¸²å»é‡ï¼Œå»æ‰å­—ç¬¦ä¸²ä¸­é‡å¤çš„å­—ç¬¦ã€‚æœ¬æ–‡è¿™é‡Œä¸è®¨è®ºç®—æ³•ï¼Œæƒ³è¯´æ˜é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿèƒ½åˆ¤æ–­ç”¨æˆ·çš„è¾“å…¥é‡Œæœ‰æ— é‡å¤å­—ç¬¦ã€‚è¿™é‡Œéœ€è¦å…ˆå­¦ä¹ æ­£åˆ™é‡Œçš„å‡ ä¸ªæ­¦å™¨ã€‚ åå‘å¼•ç”¨ (back reference)ç®€å•è¯´å°±æ˜¯åœ¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­å¼•ç”¨ä¸€ä¸ªåˆ†ç»„çš„å­è¡¨è¾¾å¼ã€‚ä¸¾ä¸ª HTML æ ‡ç­¾çš„ä¾‹å­ï¼Œå¦‚æœè¦åŒ¹é… &lt;h1&gt;&lt;/h1&gt; æ ‡ç­¾ï¼Œå¯ä»¥è¿™ä¹ˆå†™ /&lt;(h[1-6])&gt;[\s\S]*&lt;\/\1&gt;/ è¿™ä¸ªæ­£åˆ™å¯ä»¥åŒ¹é…ä»»æ„åˆæ³•çš„ h æ ‡ç­¾ï¼Œå…¶ä¸­ \1 å°±ä»£è¡¨ç¬¬ 1 ä¸ªåˆ†ç»„çš„åå‘å¼•ç”¨ï¼Œå¦åˆ™å°±å¾—ä¸º h1 ~ h6 å„å†™ä¸€ä¸ªè¡¨è¾¾å¼å°±å¾ˆç´¯èµ˜ã€‚åå‘å¼•ç”¨çš„å…³é”®åœ¨äºå‰é¢è¦å…ˆæœ‰åˆ†ç»„ï¼Œå¦åˆ™ \1 æ˜¯æ— æ•ˆçš„ã€‚ å…ˆè¡Œæ–­è¨€ (look ahead) / åè¡Œæ–­è¨€ (look behind)å…ˆè¡Œæ–­è¨€çš„è¯­æ³•å½¢å¼ä¸º /c(?=a)/ï¼Œè¡¨ç¤ºåŒ¹é… a å·¦è¾¹çš„ cã€‚ä¸ºäº†é¿å…ä¸æ–­è¨€ä¸­çš„ã€Œå‰ã€å’Œ ã€Œåã€æ··æ·†ï¼Œè¿™é‡Œå°±ç”¨ã€Œa å·¦è¾¹çš„ cã€æ¥è¡¨è¾¾ã€‚ å…ˆè¡Œæ–­è¨€æœ‰äº›åœ°æ–¹ä¹Ÿå«ã€Œå‰ç»æ–­è¨€ã€æˆ–ã€Œå‰å‘æŸ¥æ‰¾ã€ï¼Œæƒ³è±¡ä½ è‡ªå·±å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰«æå­—ç¬¦ä¸²çš„è¿‡ç¨‹å°±åƒæŒ‡é’ˆåœ¨å‘å‰ç§»åŠ¨ã€‚ å…ˆè¡Œæ–­è¨€ä¹Ÿæœ‰å…¶å¦å®šå½¢å¼ï¼Œå«åšå…ˆè¡Œå¦å®šæ–­è¨€ï¼Œå¦‚ /c(?!a)/ï¼Œå³åŒ¹é…ã€Œéaã€å·¦è¾¹çš„ cï¼Œå…¶å®è¿™ä¸ /c(?=[^a])/ æ•ˆæœç›¸åŒï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±è¯•è¯•ã€‚ æ‰€æœ‰çš„æ­£åˆ™å¼•æ“éƒ½æ”¯æŒå…ˆè¡Œæ–­è¨€å’Œå…ˆè¡Œå¦å®šæ–­è¨€ã€‚åˆ°äº† ES2018 æ‰æ”¯æŒåè¡Œæ–­è¨€ï¼Œç»†èŠ‚å¯å‚è€ƒ ECMAScript 6 å…¥é—¨çš„æ­£åˆ™ç« èŠ‚ã€‚ å°¤å…¶éœ€è¦æä¸€ç‚¹çš„æ˜¯ï¼Œæ–­è¨€ä¸­çš„æ–‡æœ¬ä¸ä¼šåŒ…å«åœ¨æœ€ç»ˆçš„åŒ¹é…ç»“æœé‡Œï¼Œæ€ä¹ˆç†è§£å‘¢ï¼Ÿ/c(?=a)/ åªä¼šåŒ¹é… cï¼Œ(?=a) æ—¢ä¸ä¼šäº§ç”Ÿåˆ†ç»„ï¼Œä¹Ÿä¸ä¼šå‡ºç°åœ¨ match å‡½æ•°çš„ç»“æœä¸­ï¼Œå¯ä»¥è¯•ä¸‹ &#39;cat&#39;.match(/c(?=a)/)ã€‚å®¹æ˜“çŠ¯çš„é”™è¯¯æ˜¯ä¸å°å¿ƒå†™æˆäº† /c(?=a)t/ é‚£å°± GG äº†ï¼Œè¿™æ˜¯ä¸ªæ°¸è¿œä¸å¯èƒ½åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ ç°åœ¨æˆ‘ä»¬å›åˆ°å­—ç¬¦ä¸²å»é‡çš„é—®é¢˜ä¸Šï¼Œç”¨ä¸Šé¢çš„æ­¦å™¨å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œç”¨å…ˆè¡Œæ–­è¨€é…åˆåå‘å¼•ç”¨ã€‚ç›´è§‚ä¸Šçš„ç†è§£å°±æ˜¯è‡ªå·±ä½œä¸ºä¸€ä¸ªæ‰«ææŒ‡é’ˆï¼Œå…ˆå¾€å‰é¢çœ‹ï¼Œåœ¨è¿œå¤„èƒ½ä¸èƒ½æ‰¾åˆ°å’Œå½“å‰è„šä¸‹ç›¸åŒçš„å­—ç¬¦ã€‚ 1'abcdaccd'.replace(/(.)(?=.*?\1)/g, '') // bacd ä¸Šé¢çš„å­—ç¬¦ä¸²ç”¨æ­£åˆ™æ›¿æ¢åä¸ºä»€ä¹ˆæ˜¯ bacdï¼Œä¸åº”è¯¥æ˜¯ abcd ä¹ˆï¼Ÿå› ä¸º /(.)(?=.*?\1)/ åŒ¹é…çš„æ˜¯ç¬¬1ä¸ª .ï¼Œæ–­è¨€å¹¶ä¸ä¼šå‡ºç°åœ¨åŒ¹é…ç»“æœé‡Œï¼Œæ‰€ä»¥ç†è§£èµ·æ¥å°±æ˜¯æ‰«ææŒ‡é’ˆåœ¨å½“å‰ä½ç½®æ—¶ï¼Œå…ˆå¾€å‰é¢çœ‹ï¼Œå¦‚æœæœ‰çœ‹åˆ°ç›¸åŒçš„å­—ç¬¦ï¼Œå°±æŠŠå½“å‰è„šä¸‹çš„å­—ç¬¦æ›¿æ¢æˆç©ºã€‚ å¦‚æœæƒ³è®©æ›¿æ¢åçš„ç»“æœæ˜¯ abcd è¯¥æ€ä¹ˆå†™æ­£åˆ™å‘¢ï¼Ÿæ˜¾ç„¶è¦ç”¨åè¡Œæ–­è¨€ï¼Œå°±æ˜¯æ‰«ææŒ‡é’ˆåœ¨å½“å‰ä½ç½®æ—¶ï¼Œå¾€èº«åçœ‹ï¼Œå¦‚æœæœ‰çœ‹åˆ°ç›¸åŒçš„å­—ç¬¦ï¼Œå°±æŠŠå½“å‰è„šä¸‹çš„å­—ç¬¦æ›¿æ¢æˆç©ºã€‚ 1'abcdaccd'.replace(/(.)(?&lt;=\1.*?\1)/g, '') // abcd çœ‹åˆ°è¿™ä¸ªæ­£åˆ™å¯èƒ½åˆå›°æƒ‘äº†ï¼Œåè¡Œæ–­è¨€éš¾é“ä¸éƒ½æ˜¯ /(?&lt;=y)x/ è¿™ä¹ˆå†™çš„ä¹ˆï¼Ÿè¿™å°±æ˜¯é»‘ç§‘æŠ€äº†ï¼Œå› ä¸ºç”¨åˆ°åå‘å¼•ç”¨ï¼Œå°±å¾—ä¿è¯æ­£åˆ™è¡¨è¾¾å¼ä¸­è¦å…ˆå‡ºç°åˆ†ç»„ï¼Œæ‰€ä»¥ /(?&lt;=\1.*?\1)(.)/ è¿™ç§è¡¨è¾¾å¼é‡Œçš„ \1 æ˜¯æ— æ•ˆçš„ã€‚ æ³¨ï¼šæ­¤æ³•æ¥è‡ªæ­£åˆ™å®ç°æ•°ç»„æ»¤é‡ 4ã€å®šåˆ¶ .vue å•æ–‡ä»¶æ¨¡æ¿æœ€è¿‘åœ¨åšå¾®ä¿¡å°ç¨‹åºï¼Œæ¯ä¸ªé¡µé¢éƒ½å¿…é¡»å†™ wxml / wxss / js / json è¿™ 4 ä¸ªæ–‡ä»¶ï¼Œå½“é¡¹ç›®é‡Œé¡µé¢å¤šçš„æ—¶å€™æ–‡ä»¶å°±å·¨å¤šæ— æ¯”ã€‚å‡å¦‚æ²¡æœ‰ç”¨ä»»ä½•å¼€å‘æ¡†æ¶ï¼Œå¯ä»¥è‡ªå·±å®šåˆ¶ä¸€ä¸ªå•æ–‡ä»¶æ¨¡æ¿ï¼Œæœ‰ç‚¹ç±»ä¼¼ .vue æ–‡ä»¶ã€‚ 1234567891011121314151617181920&lt;template&gt; &lt;view&gt;&lt;/view&gt;&lt;/template&gt;&lt;script type="json"&gt;&#123; usingComponents: &#123; &#125;&#125;&lt;/script&gt;&lt;script&gt;Page(&#123; // ...&#125;);&lt;/script&gt;&lt;style lang="stylus"&gt;&lt;/style&gt; ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŠŠè¿™ä¸ªæ–‡ä»¶æ‹†æˆæ¨¡æ¿ã€æ ·å¼ã€js å’Œ json é…ç½®å¯¹åº”çš„ 4 ä¸ªæ–‡ä»¶ï¼ŒæŠ›å¼ƒåŸæ¥çš„ split å¤§æ³•æˆ–è€…é€è¡Œè¯»æ–‡ä»¶ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥å¸®æˆ‘ä»¬ä¼˜é›…åœ°è§£å†³é—®é¢˜ã€‚ ä¿®é¥°ç¬¦åœ¨å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­è§åˆ°äº† /.*/gï¼Œå…¶ä¸­çš„æœ€åé‚£ä¸ª g å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚ å¸¸ç”¨çš„ä¿®é¥°ç¬¦æœ‰ i ï¼šignore case m ï¼šmultiline g ï¼šglobal å¾ˆå¥½è®°ï¼Œåˆèµ·æ¥ imgï¼ŒES6 ä¸­åˆæ–°å¢äº†å‡ ç§ä¿®é¥°ç¬¦ï¼Œç»†èŠ‚å¯å‚è€ƒ ECMAScript 6 å…¥é—¨çš„æ­£åˆ™ç« èŠ‚ã€‚ å¤šè¡Œæ¨¡å¼ (multiline)ä¸Šé¢è¿™ä¸ªé—®é¢˜éœ€è¦ç”¨åˆ°æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„å¤šè¡Œæ¨¡å¼ï¼Œå› ä¸ºè¦åœ¨ä»£ç æ–‡ä»¶ä¸­åšåŒ¹é…ï¼Œè‚¯å®šæ¶‰åŠåˆ°æ¢è¡Œã€‚ å½“ä½¿ç”¨äº† m ä¿®é¥°ç¬¦åï¼Œå¤šè¡Œæ¨¡å¼ä¸‹ä¼šæ›´æ”¹ ^ å’Œ $ çš„å«ä¹‰ï¼Œä½¿å®ƒä»¬åˆ†åˆ«åœ¨ä»»æ„ä¸€è¡Œçš„è¡Œé¦–å’Œè¡Œå°¾åŒ¹é…ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚ å›åˆ°åˆšæ‰çš„é—®é¢˜ï¼Œå¦‚ä½•æå– &lt;template&gt;&lt;/template&gt; æ ‡ç­¾ä¹‹é—´çš„å†…å®¹ï¼Œé¦–å…ˆä¼šæƒ³åˆ° /&lt;template&gt;(.*)&lt;\/template&gt;/mï¼Œç„¶è€Œå¯ä»¥è¯•è¯•å‘ç°ä¸è¡Œã€‚è¿™æ˜¯å› ä¸º . åŒ¹é…çš„æ˜¯é™¤ \r \n ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ä»»æ„å­—ç¬¦ã€‚æ‰€ä»¥æ­£åˆ™è¡¨è¾¾å¼éœ€è¦æ”¹æˆ /&lt;template&gt;([\s\S]*)&lt;\/template&gt;/mï¼Œåˆ†ç»„ä¸­æ•è·çš„å°±æ˜¯æ ‡ç­¾ä¹‹é—´çš„å†…å®¹ã€‚ åŒç†ï¼ŒåŒ¹é… &lt;style&gt; æ ‡ç­¾é‡Œçš„æ ·å¼ï¼Œå¯ä»¥å†™å‡º /&lt;style(?:\s+lang=&quot;(\w+)&quot;)?&gt;([\s\S]*?)&lt;\/style&gt;/mg å…¶ä¸­ &lt;style(?:\s+lang=&quot;(\w+)&quot;)?&gt; å¯ä»¥åŒæ—¶åŒ¹é… &lt;style&gt; ä¸ &lt;style lang=&quot;stylus&quot;&gt;ï¼Œå¹¶ä¸”å¯ä»¥ä»åˆ†ç»„æ•è·ä¸­æ‹¿åˆ° lang å±æ€§çš„å€¼ã€‚å¦å¤–è¦æçš„æ˜¯ï¼Œ.vue æ–‡ä»¶é‡Œå¯èƒ½ä¼šå†™å¤šä¸ª &lt;style&gt;ï¼Œæ‰€ä»¥è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­è¦ä½¿ç”¨ m å’Œ g ä¸¤ä¸ªä¿®é¥°ç¬¦ï¼Œå¹¶ä¸”åœ¨æ ‡ç­¾å†…å®¹çš„é‡Œè¦ä½¿ç”¨ [\s\S]*? ä»¥è¡¨ç¤ºæƒ°æ€§ï¼ˆå°½å¯èƒ½å°‘çš„åŒ¹é…ï¼‰ã€‚ æœ€åå°±æ˜¯åŒºåˆ† &lt;script&gt; æ ‡ç­¾äº†ï¼Œåœ¨æˆ‘ä»¬å®šåˆ¶çš„æ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ç€ &lt;script type=&quot;json&quot;&gt; è¿™æ˜¯æˆ‘ä»¬è‡ªå·±çº¦å®šçš„å†™ JSON é…ç½®çš„åœ°æ–¹ï¼Œè€Œæ™®é€šçš„ &lt;script&gt; æˆ– &lt;script type=&quot;text/javascript&quot;&gt; åˆ™æ˜¯å†™ JavaScript ä»£ç ã€‚ç”¨å…ˆè¡Œå¦å®šæ–­è¨€ï¼Œå¯ä»¥å†™å‡º /&lt;script(?!\s+type=&quot;json&quot;).*?&gt;([\s\S]*?)&lt;\/script&gt;/m æ¥æå– JavaScript ä»£ç ã€‚è¿™é‡Œå¯ä»¥ä½“ä¼šä¸‹ï¼Œå¦‚æœå‰é¢åŠæ®µå†™æˆ /&lt;script(?!\s+type=&quot;json&quot;)&gt;/ çš„è¯ï¼Œå°±æ— æ³•åŒ¹é…åˆ° &lt;script type=&quot;text/javascript&quot;&gt; äº†ã€‚ JavaScript ä¸­çš„æ­£åˆ™å¦‚æœè¯»è€…çœ‹åˆ°è¿™å„¿ï¼Œè¯´æ˜å¯¹æ­£åˆ™æ²¡æœ‰å¤±å»ä¿¡å¿ƒã€‚ğŸŒ JavaScript ä¸­æ­£åˆ™ç›¸å…³çš„å‡½æ•°æœ‰ replace / test / match / execï¼Œä¸Šæ–‡ç¤ºä¾‹ä»£ç ä¸­ä¹Ÿç”¨è¿‡ä¸€äº›äº†ã€‚è¿™é‡Œå¼ºçƒˆæ¨èä¸‹ exec å‡½æ•°ï¼Œå½“ä½¿ç”¨äº† g ä¿®é¥°ç¬¦æ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰å¤šå¤„åŒ¹é…ï¼Œmatch å‡½æ•°æ— æ³•æ‹¿åˆ°æ¯å¤„åŒ¹é…ä¸­çš„åˆ†ç»„ä¿¡æ¯ï¼Œè¿™å°±éœ€è¦ç”¨ exec æ¥å¤„ç†äº†ã€‚ 12345678var reg = /ï¿¥(\d+)/g;console.log('ï¿¥1 ï¿¥23 ï¿¥33'.match(reg)); // æ— æ³•æ‹¿åˆ°åˆ†ç»„æ•è·var res;while (res = reg.exec('ï¿¥1 ï¿¥23 ï¿¥33')) &#123; console.log(res, res &amp;&amp; res[1]); // å¯ä»¥æ‹¿åˆ°ç¬¬1ä¸ªåˆ†ç»„ console.log('reg lastIndex', reg.lastIndex);&#125; RegExp å¯¹è±¡é‡Œçš„ exec å‡½æ•°å¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨ï¼Œæ¯æ¬¡åªè¿”å›ä¸€å¤„åŒ¹é…çš„è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬åˆ†ç»„æ•è·ï¼‰ï¼Œå¹¶ä¸”æŠŠå½“å‰å¤„ç†åˆ°çš„å­—ç¬¦ä¸²ä¸‹æ ‡å­˜åœ¨ RegExp çš„ lastIndex ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ g å…¨å±€æ¨¡å¼ä¸‹å¾—åˆ°æ¯å¤„åŒ¹é…çš„åˆ†ç»„ä¿¡æ¯ã€‚ ES6 åçš„æ–°å¢ç‰¹æ€§ES6 ä¹‹åå¯¹æ­£åˆ™è¡¨è¾¾å¼çš„æ–°å¢äº†ä¸å°‘ç‰¹æ€§ï¼Œä¸»è¦åœ¨å¯¹ Unicode çš„æ”¯æŒä¸Šã€‚å¦‚æœä½ å»ç½‘ä¸Šæœé‚£äº›æ­£åˆ™è¡¨è¾¾å¼å¤§å…¨ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šæœåˆ°ç”¨ /[\u4e00-\u9fa5]/ æ¥è¯†åˆ«æ±‰å­—ï¼Œè¿™æ˜¯å¾ˆä¹…ä»¥å‰çš„åšæ³•ã€‚ç°åœ¨çš„å­—ç¬¦é›†æ›´å¤šäº†ï¼Œä¸å¦¨è¯•è¯• ğ ®· ã® æˆ–è€… ğŸ˜‚ å‘¢ï¼Ÿå…ˆæ¥çœ‹ä¸ªä¾‹å­ï¼š 12console.log('ğŸ˜‚'.length); // 2console.log('\uD83D\uDE02'); å¯ä»¥çœ‹åˆ° ğŸ˜‚ ç”± 2 ä¸ªåŒå­—èŠ‚ç ç»„æˆ (UTF-16)ï¼Œå¯ä»¥åœ¨ codepoints ä¸ŠæŸ¥åˆ°å®ƒçš„æ‰€æœ‰ç¼–ç æ ¼å¼ï¼Œæ˜¾ç„¶å®ƒå·²ç»è¶…å‡ºäº† /[\u4e00-\u9fa5]/ çš„èŒƒå›´ã€‚ä½ å¯èƒ½ä¼šè¯´ï¼Œå®ƒåˆä¸æ˜¯æ±‰å­—ï¼Œå½“ç„¶ä¸èƒ½ç”¨ä¸Šé¢é‚£ä¸ªæ­£åˆ™ï¼Œé‚£ä¸å¦¨å†æŸ¥ä¸‹ ğ ®· çš„ç¼–ç ã€‚ ES6 å¯¹æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸ª u ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤º Unicode æ¨¡å¼ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œæ­£åˆ™ä¸­çš„ . å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬ Unicode å­—ç¬¦ï¼‰ã€‚ 12345678/./.test('ğŸ˜‚'); // true å› ä¸º ğŸ˜‚ è¢«è®¤ä¸ºæ˜¯2ä¸ªå­—ç¬¦ï¼Œç›¸å½“äº '\uD83D\uDE02'/.&#123;2&#125;/.test('ğŸ˜‚'); // true åŸå› åŒä¸Š/\S&#123;2&#125;/.test('ğŸ˜‚'); // true åŸå› åŒä¸Š/^.$/.test('ğŸ˜‚'); // false æ­£åˆ™é™åˆ¶äº†å¼€å¤´å’Œç»“å°¾ï¼Œ2ä¸ªå­—ç¬¦å½“ç„¶åŒ¹é…ä¸ä¸Šå’¯/^.$/u.test('ğŸ˜‚'); // true Unicode æ¨¡å¼ä¸‹ï¼Œè®¤ä¸º ğŸ˜‚ æ˜¯1ä¸ªå­—ç¬¦/.&#123;2&#125;/u.test('ğŸ˜‚'); // false åŸå› åŒä¸Š/\S&#123;2&#125;/u.test('ğŸ˜‚'); // false åŸå› åŒä¸Š/\u&#123;1F602&#125;/u.test('ğŸ˜‚');// true Unicode æ¨¡å¼ä¸‹è¿˜å¯ä»¥ç”¨ \u{unicodeå€¼} æ¥è¡¨ç¤ºç ç‚¹å¤§äº 0xFFFF çš„ Unicode å­—ç¬¦ã€‚ æ­¤å¤–ï¼ŒES2018 è¿˜å¼•å…¥äº† Unicode å±æ€§è½¬ä¹‰ï¼Œæ¯”å¦‚å¯ä»¥ç”¨ /\p{Unified_Ideograph}/u æ¥åŒ¹é…æ‰€æœ‰æ±‰å­—ã€‚å…¶ä¸­ Unified_Ideograph æ˜¯ä¸€ä¸ª Unicode property è¡¨ç¤ºæ±‰å­—å­—ç¬¦é›†ï¼Œå¯åœ¨ tc39 ä¸­æŸ¥åˆ°æ‰€æœ‰å±æ€§è½¬ä¹‰ã€‚ å½“ç„¶ï¼ŒES6 å’Œ ES2018 è¿˜å¢åŠ äº†å¦å¤–2ä¸ªä¿®é¥°ç¬¦ï¼Œä»¥åŠåè¡Œæ–­è¨€å’Œå…·ååˆ†ç»„ï¼Œå‡ºäºç¯‡å¹…åŸå› è¿™é‡Œå°±ä¸å¤šä»‹ç»äº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒ ECMAScript 6 å…¥é—¨çš„æ­£åˆ™ç« èŠ‚ã€‚ æ€»ç»“æ­£åˆ™è¡¨è¾¾å¼æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆçš„ä¸€æŠŠåˆ©å™¨ï¼Œä¹Ÿæ˜¯å€¼å¾—æ¯ä¸ªç¨‹åºå‘˜æŒæ¡çš„ã€‚æœ¬æ–‡æŠ›ç –å¼•ç‰ï¼Œä¸»è¦æƒ³è¯´æ˜æ­£åˆ™è¡¨è¾¾å¼åœ¨å‰ç«¯ä¸­æœ‰ç€å¾ˆå¤šåº”ç”¨åœºæ™¯ï¼Œè€Œä¸ä»…ä»…æ˜¯çº¯ç²¹çš„è¡¨å•éªŒè¯ã€‚ æ­£åˆ™è¡¨è¾¾å¼çš„è¯­æ³•çœ‹ç€å¤šè€Œå¤æ‚ï¼Œä½†åªè¦ä»è¯­æ³•çš„åŠŸèƒ½åˆ†ç±»å…¥æ‰‹ï¼Œå¹³æ—¶å¤šå†™å¤šè¿ç”¨ï¼Œå°±èƒ½å¾ˆå¿«å…‹æœè¯­æ³•çš„è®°å¿†è´Ÿæ‹…ã€‚ä¹¦å†™æ­£åˆ™è¡¨è¾¾å¼çš„è¿‡ç¨‹ä¹Ÿä½“ç°ç€æ€è€ƒçš„è¿‡ç¨‹ï¼Œæ­£åˆ™çš„ç»†åŒ–ä¹Ÿå°±æ˜¯éœ€æ±‚çš„ç»†åŒ–ã€‚ æœ€åå†æ¬¡æ¨èå…¥é—¨ä¹¦ç±ã€Šæ­£åˆ™è¡¨è¾¾å¼å¿…çŸ¥å¿…ä¼šã€‹ï¼Œä»¥åŠæ­£åˆ™è¡¨è¾¾å¼çš„å¯è§†åŒ–å·¥å…· regulexã€‚ å‚è€ƒèµ„æ–™ ã€ŠJavaScript æ­£åˆ™è¡¨è¾¾å¼è¿·ä½ ä¹¦ã€‹ ECMAScript 6 å…¥é—¨çš„æ­£åˆ™ç« èŠ‚ æ­£åˆ™å®ç°æ•°ç»„æ»¤é‡ æµ…æReDoSçš„åŸç†ä¸å®è·µ ä¸€ä¸ªç”±æ­£åˆ™è¡¨è¾¾å¼å¼•å‘çš„è¡€æ¡ˆï¼ˆè§£å†³ç‰ˆï¼‰ ä¸€æ¬¡æ€§ææ‡‚JavaScriptæ­£åˆ™è¡¨è¾¾å¼ä¹‹å¼•æ“]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>æ­£åˆ™</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â€œæ»‘ç¨½â€çš„äº‹ä»¶å¾ªç¯]]></title>
    <url>%2Fblog%2F2018%2F12%2Finteresting-event-loop.html</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨å†™ Vue æ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå¤§ä½“åœºæ™¯æ˜¯ï¼šæœ‰ä¸€ä¸ªç»„ä»¶ A ç”¨äºå¯¹è¯æ¡†ä¸­ï¼Œä¹Ÿå¯ç”¨åœ¨å¯¹è¯æ¡†ä¹‹å¤–ã€‚A åˆå§‹åŒ–åä¼šè¯·æ±‚æ•°æ®ï¼Œå½“å®ƒç”¨äºå¯¹è¯æ¡†ä¸­æ—¶ï¼Œå¯èƒ½ä¼šæ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å‚æ•°ï¼Œéœ€è¦æ ¹æ®è¿™äº›å‚æ•°å»è¯·æ±‚æ•°æ®ã€‚ æˆ‘ä»¬çŸ¥é“å¤§éƒ¨åˆ† Dialog ç»„ä»¶åœ¨å®ç°æ—¶ï¼Œåªæœ‰å½“å¯¹è¯æ¡†é¦–æ¬¡è¢«æ‰“å¼€æ—¶æ‰ä¼šå»æ¸²æŸ“å…¶å†…éƒ¨çš„ content éƒ¨åˆ†ã€‚äºæ˜¯é—®é¢˜æ˜¯ï¼šå½“ç»„ä»¶ A å¤„äºå¯¹è¯æ¡†ä¸­ï¼Œå¹¶ä¸”é¦–æ¬¡æ‰“å¼€å¯¹è¯æ¡†æ—¶ï¼ŒA å…ˆè¢«åˆå§‹åŒ–ï¼Œç„¶åå¯¹è¯æ¡†å‘ A é€ä¼ å¤–éƒ¨ä¼ å…¥çš„å‚æ•°ï¼Œç”± A å‘èµ·æ•°æ®è¯·æ±‚ã€‚ äº‹æ•…ç°åœº123456789101112131415export const A = &#123; methods: &#123; reload() &#123; // çœç•¥...è¯·æ±‚æ•°æ® &#125;, receiveContext(&#123; params, data &#125; = &#123;&#125;) &#123; // çœç•¥... this.reload(); &#125;, &#125;, mounted() &#123; // this.reload(); nextTick(() =&gt; this.reload(), 0); &#125;&#125;; A çš„ mounted å…ˆè¢«è§¦å‘ï¼Œè°ƒç”¨ reload å‡½æ•°ï¼›æ¥ç€å¤–éƒ¨å¼€å§‹è°ƒç”¨ receiveContextï¼Œå†æ¬¡è°ƒç”¨ reloadï¼Œä¹Ÿå°±å‡ºç°äº†åœ¨å¯¹è¯æ¡†é¦–æ¬¡æ‰“å¼€æ—¶ä¼šé‡å¤è¯·æ±‚ã€‚ P.S. åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆä¸ç”¨ props é€ä¼ ï¼Œå› ä¸ºæˆ‘ç”¨ dispatch action è§¦å‘ receiveContextã€‚ æ— è®ºæˆ‘åœ¨å“ªå„¿æ€ä¹ˆåŠ  nextTickï¼Œéƒ½é¿å…ä¸äº†åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶é‡å¤è¯·æ±‚çš„é—®é¢˜ã€‚äºæ˜¯å‘ç°è‡ªå·±å¯¹ nextTick çš„æœ¬è´¨è¿˜æ²¡æé€ã€‚ ä¿®å¤åå…ˆç›´æ¥ç»™å‡ºä¿®å¤åçš„ä»£ç ï¼Œå†æ…¢æ…¢æ¢ç©¶åŸå› ã€‚ 1234567891011121314151617181920export const A = &#123; methods: &#123; reload() &#123; // NOTE: é˜²æ­¢åˆæ¬¡æ¸²æŸ“ receiveContext åè§¦å‘ 2æ¬¡ reload if (this._macroTimer) &#123; clearTimeout(this._macroTimer); this._macroTimer = null; &#125; // çœç•¥...è¯·æ±‚æ•°æ® &#125;, receiveContext(&#123; params, data &#125; = &#123;&#125;) &#123; // çœç•¥... this.reload(); &#125;, &#125;, mounted() &#123; // NOTE: setTimeout ä¸º macrotask, å¯ä»¥ä¿è¯åœ¨ nextTick (microtask) ä¹‹åæ‰§è¡Œ this._macroTimer = setTimeout(() =&gt; this.reload(), 0); &#125;&#125;; Event Loopéƒ½çŸ¥é“ js æ˜¯å•çº¿ç¨‹çš„ï¼Œä¸ºä»€ä¹ˆè¦è®¾è®¡æˆå•çº¿ç¨‹ï¼Œè¯»è€…ä¸å¦¨å¯ä»¥æ€è€ƒä¸€ä¸‹ğŸ¤” åŒæ—¶ js åˆæ˜¯éé˜»å¡çš„ï¼Œè¿™å°±æ˜¯ Event Loop çš„åŠŸåŠ³äº†ã€‚ ä¸»çº¿ç¨‹è¿è¡Œçš„æ—¶å€™ä¼šç”Ÿæˆå †ï¼ˆheapï¼‰å’Œæ ˆï¼ˆstackï¼‰ï¼› js ä»ä¸Šåˆ°ä¸‹è§£ææ–¹æ³•ï¼Œå°†å…¶ä¸­çš„åŒæ­¥ä»»åŠ¡æŒ‰ç…§æ‰§è¡Œé¡ºåºæ’åˆ—åˆ°æ‰§è¡Œæ ˆä¸­ï¼› å½“ç¨‹åºè°ƒç”¨å¤–éƒ¨çš„APIæ—¶ï¼Œæ¯”å¦‚ ajaxã€setTimeout ç­‰ï¼Œä¼šå°†æ­¤ç±»å¼‚æ­¥ä»»åŠ¡æŒ‚èµ·ï¼Œç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„ä»»åŠ¡ï¼Œç­‰å¼‚æ­¥ä»»åŠ¡è¿”å›ç»“æœåï¼Œå†æŒ‰ç…§æ‰§è¡Œé¡ºåºæ’åˆ—åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼› ä¸»çº¿ç¨‹å…ˆå°†æ‰§è¡Œæ ˆä¸­çš„åŒæ­¥ä»»åŠ¡æ¸…ç©ºï¼Œç„¶åæ£€æŸ¥äº‹ä»¶é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå°±å°†ç¬¬ä¸€ä¸ªäº‹ä»¶å¯¹åº”çš„å›è°ƒæ¨åˆ°æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œè‹¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°å¼‚æ­¥ä»»åŠ¡ï¼Œåˆ™ç»§ç»­å°†è¿™ä¸ªå¼‚æ­¥ä»»åŠ¡æ’åˆ—åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚ ä¸»çº¿ç¨‹æ¯æ¬¡å°†æ‰§è¡Œæ ˆæ¸…ç©ºåï¼Œå°±å»äº‹ä»¶é˜Ÿåˆ—ä¸­æ£€æŸ¥æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå°±æ¯æ¬¡å–å‡ºä¸€ä¸ªæ¨åˆ°æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ªç¯å¾€å¤çš„ï¼Œå°±å«åš Event Loop äº‹ä»¶å¾ªç¯ã€‚ macro task + micro taskåœ¨ Event Loop ä¸ºäº†åŒºåˆ†å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œä¼˜å…ˆçº§ï¼Œjs è®¾è®¡å‡ºäº† macro task (å®ä»»åŠ¡) ä¸ micro task (å¾®ä»»åŠ¡) è¿™ä¸¤ä¸ªæ¦‚å¿µã€‚ å¸¸è§çš„ task æœ‰ macro task: setTimeoutï¼ŒsetIntervalï¼ŒsetImmediateï¼ŒI/O (ç£ç›˜è¯»å†™æˆ–ç½‘ç»œé€šä¿¡)ï¼ŒUI äº¤äº’äº‹ä»¶ micro task: process.nextTickï¼ŒPromise.then äº‹ä»¶å¾ªç¯ä¼šå°†é‡åˆ°çš„å¼‚æ­¥ä»»åŠ¡æ’åˆ—åˆ°å¯¹åº”çš„ macro task åŠ micro task é˜Ÿåˆ—ä¸­ï¼š å½“æ‰§è¡Œæ ˆä¸­çš„ä»»åŠ¡æ¸…ç©ºï¼Œä¸»çº¿ç¨‹ä¼šå…ˆæ£€æŸ¥ micro task é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå°±å°† micro task é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºï¼› ç„¶åå†æ£€æŸ¥ macro task é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œåˆ™æ¯æ¬¡å–å‡ºã€ç¬¬ä¸€ä¸ªã€‘macro task åŠ å…¥åˆ°æ‰§è¡Œæ ˆä¸­ï¼› å†æ¬¡æ¸…ç©ºæ‰§è¡Œæ ˆï¼Œé‡æ–°æ£€æŸ¥å¾®ä»»åŠ¡ï¼ˆé‡å¤ç¬¬ä¸€æ­¥ï¼‰ æµ‹è¯•ä»£ç test 1 12345678910111213141516console.log(1);setTimeout(() =&gt; &#123; console.log(6);&#125;, 0);new Promise(resolve =&gt; &#123; console.log(2); resolve();&#125;).then(() =&gt; &#123; console.log(4);&#125;).then(() =&gt; &#123; console.log(5);&#125;);console.log(3); test 2 12345678910111213141516console.log(1);setTimeout(() =&gt; &#123; console.log(5);&#125;, 0);new Promise(resolve =&gt; &#123; console.log(2); resolve();&#125;).then(() =&gt; &#123; setTimeout(() =&gt; console.log(6), 0);&#125;).then(() =&gt; &#123; console.log(4);&#125;);console.log(3); test 3 12345678910111213141516console.log(1);setTimeout(() =&gt; &#123; Promise.resolve().then(() =&gt; console.log(5));&#125;, 0);new Promise(resolve =&gt; &#123; console.log(2); resolve();&#125;).then(() =&gt; &#123; setTimeout(() =&gt; console.log(6), 0);&#125;).then(() =&gt; &#123; console.log(4);&#125;);console.log(3); test 4 12345678910111213141516console.log(1);setTimeout(() =&gt; &#123; Promise.resolve().then(() =&gt; console.log(6));&#125;, 0);new Promise(resolve =&gt; &#123; console.log(2); resolve();&#125;).then(() =&gt; &#123; Promise.resolve().then(() =&gt; console.log(4), 0);&#125;).then(() =&gt; &#123; console.log(5);&#125;);console.log(3); ä»¥ä¸Šæ‰€æœ‰ç¤ºä¾‹éƒ½æŒ‰ 1 2 3 4 5 6 çš„é¡ºåºè¾“å‡ºã€‚ æœ€åä¸€ä¾‹ä¸­ï¼Œå…³äº 4 å’Œ 5 çš„è¾“å‡ºé¡ºåºï¼Œè¿˜æ˜¯æœ‰ç‚¹â€œæ»‘ç¨½â€ã€‚ Vue nextTickv2.4.412345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485/** * Defer a task to execute it asynchronously. */export const nextTick = (function () &#123; const callbacks = [] let pending = false let timerFunc function nextTickHandler () &#123; pending = false const copies = callbacks.slice(0) callbacks.length = 0 for (let i = 0; i &lt; copies.length; i++) &#123; copies[i]() &#125; &#125; // the nextTick behavior leverages the microtask queue, which can be accessed // via either native Promise.then or MutationObserver. // MutationObserver has wider support, however it is seriously bugged in // UIWebView in iOS &gt;= 9.3.3 when triggered in touch event handlers. It // completely stops working after triggering a few times... so, if native // Promise is available, we will use it: /* istanbul ignore if */ if (typeof Promise !== 'undefined' &amp;&amp; isNative(Promise)) &#123; var p = Promise.resolve() var logError = err =&gt; &#123; console.error(err) &#125; timerFunc = () =&gt; &#123; p.then(nextTickHandler).catch(logError) // in problematic UIWebViews, Promise.then doesn't completely break, but // it can get stuck in a weird state where callbacks are pushed into the // microtask queue but the queue isn't being flushed, until the browser // needs to do some other work, e.g. handle a timer. Therefore we can // "force" the microtask queue to be flushed by adding an empty timer. if (isIOS) setTimeout(noop) &#125; &#125; else if (!isIE &amp;&amp; typeof MutationObserver !== 'undefined' &amp;&amp; ( isNative(MutationObserver) || // PhantomJS and iOS 7.x MutationObserver.toString() === '[object MutationObserverConstructor]' )) &#123; // use MutationObserver where native Promise is not available, // e.g. PhantomJS, iOS7, Android 4.4 var counter = 1 var observer = new MutationObserver(nextTickHandler) var textNode = document.createTextNode(String(counter)) observer.observe(textNode, &#123; characterData: true &#125;) timerFunc = () =&gt; &#123; counter = (counter + 1) % 2 textNode.data = String(counter) &#125; &#125; else &#123; // fallback to setTimeout /* istanbul ignore next */ timerFunc = () =&gt; &#123; setTimeout(nextTickHandler, 0) &#125; &#125; return function queueNextTick (cb?: Function, ctx?: Object) &#123; let _resolve callbacks.push(() =&gt; &#123; if (cb) &#123; try &#123; cb.call(ctx) &#125; catch (e) &#123; handleError(e, ctx, 'nextTick') &#125; &#125; else if (_resolve) &#123; _resolve(ctx) &#125; &#125;) if (!pending) &#123; pending = true timerFunc() &#125; if (!cb &amp;&amp; typeof Promise !== 'undefined') &#123; return new Promise((resolve, reject) =&gt; &#123; _resolve = resolve &#125;) &#125; &#125;&#125;)() å¯ä»¥çœ‹åˆ°ï¼ŒVue ä¼˜å…ˆä½¿ç”¨ Promise.resolve() æ¥å®ç° nextTickï¼Œå¯¹äºä¸æ”¯æŒ Promise çš„è®¾å¤‡åˆ™ä½¿ç”¨ MutationObserverï¼Œå†æ¬¡ä¹‹åˆ™é™çº§ä¸º setTimeoutã€‚ v2.5.17123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110const callbacks = []let pending = falsefunction flushCallbacks () &#123; pending = false const copies = callbacks.slice(0) callbacks.length = 0 for (let i = 0; i &lt; copies.length; i++) &#123; copies[i]() &#125;&#125;// Here we have async deferring wrappers using both microtasks and (macro) tasks.// In &lt; 2.4 we used microtasks everywhere, but there are some scenarios where// microtasks have too high a priority and fire in between supposedly// sequential events (e.g. #4521, #6690) or even between bubbling of the same// event (#6566). However, using (macro) tasks everywhere also has subtle problems// when state is changed right before repaint (e.g. #6813, out-in transitions).// Here we use microtask by default, but expose a way to force (macro) task when// needed (e.g. in event handlers attached by v-on).let microTimerFunclet macroTimerFunclet useMacroTask = false// Determine (macro) task defer implementation.// Technically setImmediate should be the ideal choice, but it's only available// in IE. The only polyfill that consistently queues the callback after all DOM// events triggered in the same loop is by using MessageChannel./* istanbul ignore if */if (typeof setImmediate !== 'undefined' &amp;&amp; isNative(setImmediate)) &#123; macroTimerFunc = () =&gt; &#123; setImmediate(flushCallbacks) &#125;&#125; else if (typeof MessageChannel !== 'undefined' &amp;&amp; ( isNative(MessageChannel) || // PhantomJS MessageChannel.toString() === '[object MessageChannelConstructor]')) &#123; const channel = new MessageChannel() const port = channel.port2 channel.port1.onmessage = flushCallbacks macroTimerFunc = () =&gt; &#123; port.postMessage(1) &#125;&#125; else &#123; /* istanbul ignore next */ macroTimerFunc = () =&gt; &#123; setTimeout(flushCallbacks, 0) &#125;&#125;// Determine microtask defer implementation./* istanbul ignore next, $flow-disable-line */if (typeof Promise !== 'undefined' &amp;&amp; isNative(Promise)) &#123; const p = Promise.resolve() microTimerFunc = () =&gt; &#123; p.then(flushCallbacks) // in problematic UIWebViews, Promise.then doesn't completely break, but // it can get stuck in a weird state where callbacks are pushed into the // microtask queue but the queue isn't being flushed, until the browser // needs to do some other work, e.g. handle a timer. Therefore we can // "force" the microtask queue to be flushed by adding an empty timer. if (isIOS) setTimeout(noop) &#125;&#125; else &#123; // fallback to macro microTimerFunc = macroTimerFunc&#125;/** * Wrap a function so that if any code inside triggers state change, * the changes are queued using a (macro) task instead of a microtask. */export function withMacroTask (fn: Function): Function &#123; return fn._withTask || (fn._withTask = function () &#123; useMacroTask = true const res = fn.apply(null, arguments) useMacroTask = false return res &#125;)&#125;export function nextTick (cb?: Function, ctx?: Object) &#123; let _resolve callbacks.push(() =&gt; &#123; if (cb) &#123; try &#123; cb.call(ctx) &#125; catch (e) &#123; handleError(e, ctx, 'nextTick') &#125; &#125; else if (_resolve) &#123; _resolve(ctx) &#125; &#125;) if (!pending) &#123; pending = true if (useMacroTask) &#123; macroTimerFunc() &#125; else &#123; microTimerFunc() &#125; &#125; // $flow-disable-line if (!cb &amp;&amp; typeof Promise !== 'undefined') &#123; return new Promise(resolve =&gt; &#123; _resolve = resolve &#125;) &#125;&#125; ã€å‚è€ƒèµ„æ–™ã€‘ http://hcysun.me/vue-design/art/8vue-reactive-dep-watch.html#nexttick-çš„å®ç° https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†ä¹Ÿä¸æƒ³å†™è¡¨å•äº†]]></title>
    <url>%2Fblog%2F2018%2F10%2Fno-form-any-more.html</url>
    <content type="text"><![CDATA[ä¸€ äº§å“ï¼šå°å“¥å“¥åœ¨ä¹ˆï¼Ÿæˆ‘æƒ³ä¸´æ—¶åŠ ä¸ªå°å°å°å°çš„éœ€æ±‚~~ å°æ˜ï¼šä¸åœ¨ã€‚ äº§å“ï¼šå¾ˆç®€å•çš„å“ˆï¼Œå°±åœ¨åŸæ¥çš„é¡µé¢ä¸ŠåŠ ä¸ªå°åŠŸèƒ½â€¦â€¦ äº§å“ï¼šå¸®å¸®å¿™ï¼Œæ±‚ä½ äº†å“¥å“¥ï¼Œæˆ‘è¯·ä½ åƒæ˜Ÿçˆ¸çˆ¸~ å°æ˜ï¼šå…ˆè¯´å§ã€‚ã€‚è¦æ˜¯æ”¹åŠ¨å¤§çš„è¯ï¼Œè¯·æµ·åº•æéƒ½æ²¡ç”¨ã€‚ã€‚ äº§å“ï¼šä¸ä¼šçš„ï¼å°±æ˜¯åœ¨æˆ‘ä»¬çš„æ´»åŠ¨åå°é¡µé¢ä¸Šï¼Œæƒ³åŠ ä¸ªæ´»åŠ¨é¢„å‘Šçš„åŠŸèƒ½ï¼Œå¤§æ¦‚è¿™ä¸ªæ ·å­â€¦â€¦ äº§å“ï¼šæ˜¯ä¸æ˜¯å¾ˆç®€å•å“ˆ~ å°æ˜ï¼šå“¦ã€‚è¿˜è¡Œå§ äºæ˜¯å°æ˜æ‰“å¼€äº†é¡¹ç›®ï¼Œæ‰¾åˆ°äº†ç›¸åº”çš„é¡µé¢ï¼ŒOh shitï¼ ä»¥å‰çš„ä»£ç è°å†™çš„ï¼Œå†™å®Œå°±è·‘è·¯äº†ä¹ˆï¼è¿˜å¥½ç°åœ¨åŠ çš„â€œæ´»åŠ¨é¢„å‘Šâ€åŠŸèƒ½è·Ÿå…¶ä»–éƒ¨åˆ†ä¸ç›¸å¹²ï¼Œå¯ä»¥å•ç‹¬æŠ½ç¦»å‡ºå»ã€‚å°æ˜æ„Ÿè§‰æœºæ™ºå¦‚æˆ‘ï¼Œå¾ˆå¿«å°±å†™å¥½äº†ï¼Œç®€ç›´æ˜¯ç©ºæ‰‹è–…ç¾Šæ¯›ã€‚ å°æ˜ï¼šåŠ å¥½äº†ï¼ˆæ¥æ¯æŠ¹èŒ¶æ‹¿é“ï¼‰ äºŒ äº§å“ï¼šå°å“¥å“¥åœ¨ä¹ˆï¼Ÿæ˜¨å¤©åŠ çš„å°éœ€æ±‚åæ¥ä¸šåŠ¡è¯´éœ€è¦æœ‰ä¸ªâ€œç«‹å³ç”Ÿæ•ˆâ€çš„æŒ‰é’®ã€‚ã€‚ã€‚ äº§å“ï¼šå®åœ¨å¯¹å¯¹å¯¹å¯¹å¯¹ä¸èµ· &gt;_&lt; æˆ‘åœ¨åŸæ¥çš„å›¾ä¸Šç¨å¾®åŠ äº†ç‚¹ï¼Œæ±‚å“¥å“¥å¸®å¿™æ”¹ä¸€ä¸‹ä¸‹ äº§å“ï¼šæ˜¯è¿™æ ·çš„ï¼Œâ€œç«‹å³ç”Ÿæ•ˆâ€é€‰â€œæ˜¯â€æ—¶ï¼Œé€‰æ—¥æœŸçš„å°±ä¸è¦äº†ï¼Œé€‰â€œå¦â€æ—¶æ‰æœ‰â€œç”Ÿæ•ˆæ—¥æœŸâ€ â€¦â€¦ äº§å“ï¼šå“¥ ä½ çœ‹åˆ°äº†å—ï¼Ÿ å°æ˜ï¼šä½ è¯´å®Œäº†å—ï¼Ÿå…¨éƒ½è¯´å®Œæˆ‘å†ä¸€èµ·æ”¹ äº§å“ï¼šè¯´å®Œäº†ï¼è°¢è°¢ O(âˆ©_âˆ©)O ç”±äºå°æ˜å…ˆè§ä¹‹æ˜ï¼Œä¸€å¼€å§‹å°±æŠŠâ€œæ´»åŠ¨é¢„å‘Šâ€éƒ¨åˆ†æŠ½ç¦»å‡ºå»äº†ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸ç”¨ care å…¶ä»–ä»£ç ï¼Œä¹Ÿå¾ˆå¿«å°±æ”¹å¥½äº†ã€‚ ä¸‰ äº§å“ï¼šå°å“¥å“¥â€¦â€¦æˆ‘å·²ç»è·ªä¸‹äº† äº§å“ï¼šåˆè·Ÿä¸šåŠ¡èŠäº†ï¼Œä»–ä»¬è‡ªå·±ä¸€å¼€å§‹éƒ½æ²¡ç†æ¸…ï¼Œç°åœ¨æ‹æ¸…æ¥šäº† äº§å“ï¼š1. ç±»å‹ä¸ºâ€æ‹‰æ–°â€œä¸â€å†²å•â€œæ—¶ï¼Œæ´»åŠ¨è¿˜æ”¯æŒæŒ‰æ¡ä»¶çš„ç”Ÿæ•ˆæ–¹å¼ï¼Œæ¡ä»¶æ”¯æŒâ€æ´»åŠ¨äººæ•°â€œã€â€æ´»åŠ¨å¤©æ•°â€œã€â€å³°å€¼â€œï¼ˆä¸‰è€…ä¸ºä¸”çš„å…³ç³»ï¼‰ äº§å“ï¼š2. ç±»å‹ä¸ºâ€å›é¦ˆâ€œæ—¶ï¼Œæ´»åŠ¨åªæ”¯æŒç«‹å³ç”Ÿæ•ˆå’ŒæŒ‰æ—¶é—´ç”Ÿæ•ˆä¸¤ç§æ–¹å¼ äº§å“ï¼šä¸ä¼šå†æ”¹äº†ï¼ä¸ç„¶æˆ‘å°±è¯·åƒæµ·åº•æ å°æ˜ï¼šå†è§ã€‚ æ—¥å¸¸åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç»å¸¸å‡ºç°ä¸Šé¢æ•…äº‹ä¸­çš„å½±å­ï¼Œå…¬å¸çš„ä¸šåŠ¡ä¸ä¼šåœä¸‹ï¼Œéœ€æ±‚å¿…ç„¶è¦è·Ÿç€ä¸šåŠ¡è€Œä¸æ–­æ¼”åŒ–ï¼Œä¸€ä¸ªçœ‹ä¼¼ç®€å•çš„é¡µé¢è¡¨å•ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿ã€‚ é¡¹ç›®äº¤æ¥äº†Næ‰‹ï¼Œå„äººéƒ½æŒ‰å„è‡ªçš„é£æ ¼å†™ä»£ç ï¼›äº§å“ä¹Ÿäº¤æ¥äº†å¥½å‡ æ‰‹ï¼Œå„æŒ‰å„çš„å¥—è·¯æéœ€æ±‚ã€‚æ ¹æœ¬åŸå› æ˜¯ä»£ç çš„ç»´æŠ¤æˆæœ¬ä¸ä¸šåŠ¡ä¸æ–­å˜åŒ–ä¹‹é—´çš„çŸ›ç›¾ã€‚ æ­£å¦‚ä¸Šé¢æ•…äº‹ä¸­çš„ä¾‹å­ï¼Œå†å¾€åå‘å±•ï¼Œæœ‰å¯èƒ½â€œæ´»è·ƒäººæ•°â€çš„æ¡ä»¶éœ€è¦æ”¯æŒå¤šä¸ªåŒºé—´ï¼Œç”šè‡³å‡ºç°â€œç”Ÿæ•ˆæ¡ä»¶â€ä¸è¡¨å•ä¸­çš„å…¶ä»–é¡¹å‘ç”Ÿè€¦åˆï¼Œéœ€æ±‚åƒå˜ä¸‡åŒ–ï¼Œæ€ä¹ˆé¢„çŸ¥å¾—äº†ã€‚ ç©¶å…¶åŸå› ï¼Œå°±æ˜¯å½“è¡¨å•ä¸­å‡ºç°è”åŠ¨çš„éœ€æ±‚ï¼Œæˆ–è€…è·¨è¡Œä¹‹é—´å‘ç”Ÿåˆ¶çº¦å…³ç³»æ—¶ï¼Œè¡¨å•ä»£ç çš„å¤æ‚åº¦å°±ä¼šä¸Šå‡ï¼Œéšç€ä¸šåŠ¡éœ€æ±‚çš„æ¼”å˜ï¼Œå¦‚æœä»£ç å¤„ç†çš„ä¸å¥½ï¼Œä¼šå˜å¾—è¶Šæ¥è¶Šéš¾ç»´æŠ¤ã€‚ é…ç½®å‹è¡¨å•è¡¨å•æœ¬è´¨ä¸Šæ˜¯ä»€ä¹ˆï¼Ÿè¡¨å•ç”¨æ¥æ‰¿è½½ä¸šåŠ¡éœ€æ±‚çš„äº¤äº’é€»è¾‘ï¼Œè¡¨å•çš„æœ€ç»ˆç›®çš„æ˜¯æäº¤ä¸€äº›ç‰¹å®šæ ¼å¼çš„æ•°æ®ã€‚é‚£ä¹ˆä»å…¶ç›®çš„å‡ºå‘ï¼Œä»æ•°æ®çš„è§’åº¦ï¼Œè¡¨å•å°±æ˜¯ä¸€å † key ä¸ value çš„æ˜ å°„ï¼Œkey å°±æ˜¯æ¥å£è°ƒç”¨æ—¶çš„å‚æ•°ï¼Œvalue å°±æ˜¯ key æ‰€å¯¹åº”çš„è¡¨å•æ§ä»¶çš„ç”¨æˆ·è¾“å…¥å€¼ã€‚ ç†æƒ³çŠ¶æ€ä¸‹ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹çš„ JSON ç»“æ„æ¥å®šä¹‰ä¸€ä¸ªè¡¨å•ã€‚ æ•°ç»„ä¸­çš„æ¯é¡¹éƒ½å¯¹åº”è¡¨å•ä¸­çš„ä¸€é¡¹ï¼Œtype å³è¡¨å•æ§ä»¶çš„ç±»å‹ï¼Œkey å³è¡¨å•æäº¤æ—¶çš„æ•°æ®å‚æ•°ã€‚å¦‚ä¸Šå›¾ï¼Œè¡¨å•æäº¤æ—¶ä¼šå‘é€ä»¥ä¸‹æ•°æ® 12345&#123; act_type: '', instant: '', range: []&#125; ä¸€ä¸ª key åˆ°åº•ä¼šè¾“å‡ºä»€ä¹ˆç±»å‹çš„æ•°æ®ï¼Œå–å†³äºå®ƒå¯¹åº”çš„è¡¨å•æ§ä»¶æ˜¯ä»€ä¹ˆã€‚ åº”å¯¹è”åŠ¨éœ€æ±‚ä¸Šé¢è¯´åˆ°è¡¨å•ä¸­çš„è”åŠ¨æ˜¯ç½ªæ¶çš„æ ¹æºï¼Œåœ¨ JSON é…ç½®ä¸­èƒ½å¦å¤„ç†å¥½è¿™ä¸ªå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬å…ˆç¿»ä¸‹ä¸šåŠ¡é¡¹ç›®ä¸­çš„ä»£ç ï¼Œæ˜¯å¦ç»å¸¸å‡ºç°è¿™æ ·éšæ„çš„ä»£ç ã€‚ ä»¥ Vue ä¸ºä¾‹ï¼Œv-if æ¡ä»¶æ¸²æŸ“ç¡®å®æ˜¯å¤„ç†è”åŠ¨çš„åŠæ³•ï¼Œä½†æ»¡å±çš„ v-if ä»¥åŠæšä¸¾å€¼çš„ magic numberï¼ŒåŠ¨ä¸åŠ¨å°±å‡ ç™¾è¡Œçš„è¡¨å•ï¼Œæ¨¡æ¿ä¸­åˆè€¦åˆç€é€»è¾‘ï¼Œç»´æŠ¤èµ·æ¥çœŸæ˜¯ä¸ªåˆè„åˆç´¯çš„æ´»å„¿ã€‚ æ ¹æ®å®é™…éœ€æ±‚ï¼Œæ•´ç†äº†ä¸‹å¸¸è§è”åŠ¨çš„å¥—è·¯ ç¬¬1ç±»ï¼šA ä¸ºç‰¹å®šå€¼æ—¶ï¼ŒB ä¸æ˜¾ç¤ºï¼›æˆ– A ä¸ºç‰¹å®šå€¼æ—¶ï¼ŒB æ‰æ˜¾ç¤º ç¬¬2ç±»ï¼šA ä¸ºç‰¹å®šå€¼æ—¶ï¼ŒB åªèƒ½ä¸ºç‰¹å®šèŒƒå›´å†…çš„å€¼ï¼ˆæˆ–ä¸èƒ½ä¸ºæŸäº›å€¼ï¼‰ ç¬¬3ç±»ï¼šA ä¸ºç‰¹å®šå€¼æ—¶ï¼ŒB ä¹Ÿåªèƒ½ä¸ºç‰¹å®šå€¼ å€Ÿé‰´ v-if çš„æ€æƒ³ï¼Œåœ¨é…ç½®å‹è¡¨å•çš„ JSON ä¸­ä¹Ÿå¯ä»¥å°è¯•æ¡ä»¶æ¸²æŸ“ã€‚ 1234567891011121314151617181920[ &#123; title: 'æ´»åŠ¨ç±»å‹', key: 'act_type', type: 'radio' &#125;, &#123; title: 'ç«‹å³ç”Ÿæ•ˆ', key: 'instant', type: 'radio' &#125;, &#123; title: 'ç”Ÿæ•ˆæ—¥æœŸ', key: 'range', type: 'dates', ifRender(form) &#123; return form.instant == false; &#125; &#125;] é…ç½®ä¸­çš„ ifRender æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¥å‚å³å½“å‰è¡¨å•çš„æ•°æ®çŠ¶æ€ï¼Œå¯ä»¥åœ¨å‡½æ•°ä¸­åˆ¤æ–­æ¸²æŸ“çš„æ¡ä»¶ï¼Œä»¥è¾¾åˆ°ä¸ v-if ç­‰ä»·çš„æ•ˆæœã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±å¯ä»¥å®ç°ç¬¬1ç±»è”åŠ¨ã€‚ åº”å¯¹åŠ¨æ€å–å€¼èŒƒå›´åœ¨ä¸Šé¢çš„ JSON é…ç½®ä¸­ï¼Œå…¶å®çœç•¥äº†ä¸€ç‚¹ï¼Œå°±æ˜¯å•é€‰æ§ä»¶çš„é€‰é¡¹ï¼Œå®ƒå±äºæ§ä»¶å†…éƒ¨çš„å±æ€§ï¼Œå› æ­¤å¯ä»¥ç»Ÿä¸€å®šä¹‰ä¸€ä¸ª props å­—æ®µæ¥è¡¨ç¤ºç»„ä»¶å†…éƒ¨çš„å±æ€§ã€‚ä¸‹é¢å®Œæ•´å®šä¹‰äº†äº§å“æœ€åˆéœ€æ±‚ä¸­çš„â€œæ´»åŠ¨ç±»å‹â€è¿™ä¸€è¡Œã€‚ 12345678910[ &#123; title: 'æ´»åŠ¨ç±»å‹', key: 'act_type', type: 'radio', props: &#123; options: &#123; 1: 'æ‹‰æ–°', 2: 'å†²å•', 3: 'å›é¦ˆ' &#125; &#125; &#125;,] æœ‰äº†è¿™ä¸ªåŸºç¡€åï¼Œå¯¹äºç¬¬2ç±»è”åŠ¨ï¼ŒA ä¸ºç‰¹å®šå€¼æ—¶ï¼ŒB åªèƒ½ä¸ºç‰¹å®šèŒƒå›´å†…çš„å€¼ï¼ˆæˆ–ä¸èƒ½ä¸ºæŸäº›å€¼ï¼‰ï¼Œå°±è¿åˆƒè€Œè§£äº†ã€‚å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œè®© props æ”¯æŒå‡½æ•°ï¼Œå…¥å‚åŒæ ·æ˜¯å½“å‰è¡¨å•çš„æ•°æ®çŠ¶æ€ã€‚ å¯¹äºéœ€æ±‚3ä¸­ï¼Œç±»å‹ä¸ºâ€å›é¦ˆâ€œæ—¶ï¼Œæ´»åŠ¨åªæ”¯æŒç«‹å³ç”Ÿæ•ˆå’ŒæŒ‰æ—¶é—´ç”Ÿæ•ˆä¸¤ç§æ–¹å¼ï¼Œå°±å¯ä»¥é€šè¿‡ä»¥ä¸‹ JSON é…ç½®æ¥å®šä¹‰æ¸…æ¥šã€‚ 123456789101112131415161718192021[ &#123; title: 'æ´»åŠ¨ç±»å‹', key: 'act_type', type: 'radio', props: &#123; options: &#123; 1: 'æ‹‰æ–°', 2: 'å†²å•', 3: 'å›é¦ˆ' &#125; &#125;, &#123; title: 'ç”Ÿæ•ˆæ–¹å¼', key: 'effect_type', type: 'radio', props(form) &#123; const map = &#123; 1: 'ç«‹å³', 2: 'æŒ‰æ—¶é—´', 3: 'æŒ‰æ¡ä»¶' &#125;; if (form.act_type === 3) &#123; delete map[3]; &#125; return &#123; options: map &#125;; &#125; &#125;] å½“ç„¶ä½ å¯èƒ½ä¼šå«Œå¼ƒ magic numberï¼Œé‚£å°±å®šä¹‰ä¸ªæšä¸¾å¸¸é‡å¥½äº†ã€‚æ€»çš„æ¥è¯´è¿™æ ·å®šä¹‰çš„è¡¨å•è”åŠ¨é€»è¾‘ï¼Œé›†ä¸­åˆæ¸…æ™°ã€‚ åº”å¯¹é™åˆ¶ç‰¹å®šå€¼ç»†å¿ƒçš„ä½ å¯ä»¥ä¼šæ³¨æ„åˆ°ï¼Œç¬¬3ç±»è”åŠ¨è¿˜æ²¡æ³•å®ç°ï¼ŒA ä¸ºç‰¹å®šå€¼æ—¶ï¼ŒB ä¹Ÿåªèƒ½ä¸ºç‰¹å®šå€¼ã€‚ è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹åŸå…ˆä¸šåŠ¡ä»£ç ä¸­ä¼šæ€ä¹ˆå†™ã€‚ä¸€èˆ¬ä¸¤ç§å¥—è·¯ï¼š1æ˜¯ watch è¡¨å•çŠ¶æ€ä¸­çš„ A å­—æ®µï¼Œå½“å®ƒä¸ºç‰¹å®šå€¼æ—¶ï¼Œå°† B å­—æ®µä¹Ÿèµ‹æˆç‰¹å®šå€¼ï¼›2æ˜¯ç›‘å¬ A å­—æ®µæ‰€å¯¹åº”è¡¨å•æ§ä»¶çš„ change äº‹ä»¶ï¼Œå½“å®ƒ change æˆç‰¹å®šå€¼æ—¶ï¼Œå°† B å­—æ®µä¹Ÿèµ‹æˆç‰¹å®šå€¼ã€‚å¯ä»¥æƒ³è±¡ï¼Œè¿™ä¸¤ç§ä»£ç ç»™ B èµ‹å€¼æ—¶ä¸ B çš„å£°æ˜å¤„éƒ½éš”çš„æ¯”è¾ƒè¿œï¼Œè€Œä¸”æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„ä¹ æƒ¯ï¼Œæœ‰çš„äººå–œæ¬¢å†™åœ¨æ¨¡æ¿é‡Œï¼Œæœ‰çš„äººå–œæ¬¢å†™åœ¨é€»è¾‘é‡Œï¼Œæœ‰çš„äººå¯èƒ½å–œæ¬¢å•ç‹¬æŠ½ä¸ªå‡½æ•°ã€‚ åœ¨ä¸Šé¢çš„é…ç½®å‹è¡¨å•ä¸­ï¼ŒåŒæ ·å¯ä»¥åšè¿™ä¸ªäº‹æƒ…ï¼Œå¯ä»¥é€šè¿‡ç»™ props å¢åŠ ä¸ª value å­—æ®µç”¨æ¥ç‰¹æŒ‡è¯¥è¡¨å•æ§ä»¶çš„æ•°æ®ã€‚ 1234567891011121314151617181920212223242526[ &#123; title: 'æ´»åŠ¨ç±»å‹', key: 'act_type', type: 'radio', props: &#123; options: &#123; 1: 'æ‹‰æ–°', 2: 'å†²å•', 3: 'å›é¦ˆ' &#125; &#125; &#125;, &#123; title: 'ç”Ÿæ•ˆæ–¹å¼', key: 'effect_type', type: 'radio', props(form) &#123; const value; const map = &#123; 1: 'ç«‹å³', 2: 'æŒ‰æ—¶é—´', 3: 'æŒ‰æ¡ä»¶' &#125;; if (form.act_type === 3) &#123; value = 1; &#125; return &#123; value: value, options: map &#125;; &#125; &#125;] å½“ç„¶ï¼Œé™¤äº†é€šè¿‡ props æ¥é™åˆ¶ç‰¹å®šå€¼å¤–ï¼Œä¹Ÿå¯ä»¥è®¾è®¡ä¸ª watch è§‚å¯Ÿè€…å›è°ƒå‡½æ•°æ¥å¯¹è¡¨å•æ•°æ®çŠ¶æ€ä¸­çš„æŸä¸ªå­—æ®µæ¥èµ‹å€¼ï¼Œå–å†³äºè¿™å¥— JSON è¡¨å•é…ç½®æ€ä¹ˆè®¾è®¡ã€‚ å°ç»“é€šè¿‡ JSON é…ç½®æ¥å®šä¹‰ä¸€ä¸ªè¡¨å•æ˜¯å¯è¡Œçš„ï¼Œç›¸è¾ƒäºä»¥å¾€çš„ä¸šåŠ¡ä»£ç ï¼Œçœå»äº†æ¨¡æ¿ï¼Œä¸ä¼šå‡ºç°æ¨¡æ¿ä¸é€»è¾‘æ··åœ¨ä¸€èµ·çš„æƒ…å†µã€‚å¯¹äºè¡¨å•ä¸­ä»¤äººè®¨åŒçš„è”åŠ¨éœ€æ±‚ï¼Œåˆ—ä¸¾äº†3ç±»å¸¸è§çš„è”åŠ¨å¥—è·¯ï¼Œå¹¶ä¸”å°è¯•äº†é€šè¿‡ JSON é…ç½®æ¥æ»¡è¶³è”åŠ¨éœ€æ±‚çš„å¯è¡Œæ€§ã€‚ å®ç°åŸç†æ—¢ç„¶è¯´é…ç½®å‹è¡¨å•çœå»äº†æ¨¡æ¿ï¼Œæ¨¡æ¿å…¶å®è¢«å±è”½äº†ï¼Œé…ç½®ä¸­çš„æ¯ä¸ªè¡¨å•æ§ä»¶çš„ title å’Œ type è¶³ä»¥è¡¨è¾¾æ¨¡æ¿äº†ã€‚title å³è¡¨å•ä¸€è¡Œä¸­çš„ labelï¼Œè€Œ type åˆ™æ˜ å°„åˆ°å…·ä½“çš„ç»„ä»¶ï¼Œæ˜¯ checkbox è¿˜æ˜¯ selectã€‚ ä½¿ç”¨å§¿åŠ¿ä¸Šé¢å•°å—¦äº†è¿™ä¹ˆå¤šé…ç½®å‹è¡¨å•çš„ JSON ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¸Œæœ›å°è£…ä¸€ä¸ªè¡¨å•ï¼Œåªéœ€ä¼ å…¥ JSON é…ç½®ã€‚ä»¥ Vue ä¸ºä¾‹ï¼Œå¸Œæœ›å¯ä»¥è¿™æ ·æŒ‡å®šè¡¨å•ã€‚ 1&lt;json-form v-model="formModel" :config="formItems"/&gt; å…¶ä¸­ formItems å°±æ˜¯ä¸Šæ–‡ä»‹ç»çš„ JSON é…ç½®ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯é¡¹ä»£è¡¨ä¸€ä¸ªè¡¨å•æ§ä»¶ã€‚ æ˜ å°„åˆ°ç»„ä»¶ä»è¡¨å•é…ç½®ä¸­çš„ type æ˜ å°„åˆ°ä¸€ä¸ªçœŸæ­£çš„ç»„ä»¶ï¼Œæ˜¯è¿™å¥—è¡¨å•æ–¹æ¡ˆçš„æ ¸å¿ƒã€‚ ä¸ºäº†é™ä½åŸºç¡€ç»„ä»¶çš„å¼€å‘æˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆé€‰æ‹©ä¸€å¥—æˆç†Ÿçš„ç»„ä»¶åº“ï¼Œæ¯”å¦‚ Elementï¼Œé€šè¿‡ç®€å•çš„ type ä¸ç»„ä»¶ tag çš„æ˜ å°„ï¼Œå°±èƒ½å®ç°ç»„ä»¶æ˜ å°„ã€‚ 123456789101112export default &#123; // é»˜è®¤è¾“å…¥ç±»å‹ text: &#123; // å¯¹åº”åˆ° Element ä¸­çš„ç»„ä»¶ tag component: 'el-input', // ä¼ é€’ç»™ Element ç»„ä»¶çš„é»˜è®¤ props props: &#123; clearable: true &#125; &#125;, // çœç•¥...&#125; å¦‚ä¸Šï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œkey å³è¡¨å•é…ç½®ä¸­çš„ typeï¼Œä¾‹å¦‚ type: &#39;text&#39; åˆ™ä¼šæ˜ å°„åˆ° Element ä¸­çš„ el-input ç»„ä»¶ï¼Œå¹¶ä¸”è¿™é‡Œç»™å‡ºçš„ props ä¼šä½œä¸ºé»˜è®¤å±æ€§ä¼ é€’ç»™ Element ä¸­çš„ç›¸åº”ç»„ä»¶ã€‚è¿™æ ·ï¼Œå°±ä»¥ä¸€ç§ä½æˆæœ¬çš„æ–¹å¼å®ç°äº†ä»è¡¨å•é…ç½® type åˆ°çœŸæ­£çš„è¡¨å•ç»„ä»¶ä¹‹é—´çš„æ˜ å°„ã€‚ Form å°è£…åªæœ‰ä¸Šé¢çš„æ˜ å°„è¡¨ï¼Œè¿˜ä¸å¤Ÿç»„æˆå®Œæ•´çš„è¡¨å•ï¼Œå› ä¸ºä¸€ä¸ªè¡¨å•ä¼šåŒ…å«å¤šä¸ªç»„ä»¶ï¼Œå¹¶ä¸”åœ¨ä¸Šæ–‡ä»‹ç»çš„å‡ ç±»è”åŠ¨ä¹Ÿéœ€è¦åœ¨è¡¨å•å±‚æ¥å®ç°ã€‚ å¥½åœ¨ Vue ä¸­æœ‰ä¸ªç¥å¥‡çš„åŠ¨æ€ç»„ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆæ˜ å°„åçš„ç»„ä»¶ã€‚ 1234567891011121314151617&lt;el-form :model="formModel"&gt; &lt;el-form-item v-for="(input, i) in formItems" v-if="input._ifRender" :key="input.key + '_' + i" :rules="input.rules" :prop="input.key || null" :label="input.title" &gt; &lt;component ref="component" :is="input.tag" v-model="form[input.key]" v-bind="input.props || &#123;&#125;" /&gt; &lt;/el-form-item&gt;&lt;/el-form&gt; å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼ŒformInputs æ˜¯ä»è¡¨å•æ¥æ”¶åˆ°çš„ JSON config è½¬åŒ–è€Œæ¥ï¼Œå®ƒä¼šæ ¹æ®ç»„ä»¶æ˜ å°„è¡¨å¾—åˆ°äº†ç›¸åº”çš„ç»„ä»¶ tag å’Œ propsï¼Œå¹¶ä¸”å¤„ç†æ¡ä»¶æ¸²æŸ“çš„é…ç½® ifRender å‡½æ•°ã€‚ 1this.formInputs = (this.config || []).map(item =&gt; computeFormItem(item, this.formModel)) å¯ä»¥çœ‹åˆ°æ ¸å¿ƒå°±æ˜¯è¿™ä¸ª computeFormItem å‡½æ•°ï¼Œå®ƒå°†è¡¨å•é…ç½®è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¸”ä»¥å½“å‰çš„è¡¨å•æ•°æ® model ä½œä¸ºå…¥å‚ã€‚ 1234567891011121314151617181920212223242526272829function computeFormItem(&#123; config, form &#125;) &#123; // è¿”å›ç»“æ„ä½“ const item = &#123; ...config &#125;; // è¡¨å•æ§ä»¶çš„ç±»å‹ let type = item.type || 'text'; // å¯¹åº”åˆ°ç»„ä»¶æ˜ å°„è¡¨ let def = ElementMapping[type]; item.tag = def.component; item.props = merge(&#123;&#125;, def.props, item.props); // è·å–åŠ¨æ€ props if (isFunction(item.getProps)) &#123; item.props = Object.assign(&#123;&#125;, item.props, item.getProps(form)); &#125; // æ¡ä»¶æ¸²æŸ“ item._ifRender = isFunction(item.ifRender) ? !!item.ifRender(form) : true; // é˜²æ­¢è¡¨å•æäº¤æ—¶å­˜åœ¨å¤šä½™ key if (!item._ifRender) &#123; delete form[item.key]; &#125; // form-item é…ç½® return item;&#125;; å®ƒé¦–å…ˆæ ¹æ®é…ç½®ç±»å‹ï¼Œè¯»å–ç»„ä»¶æ˜ å°„è¡¨ï¼Œå¾—åˆ°çœŸæ­£çš„ç»„ä»¶ tagï¼Œå¹¶åˆå¹¶é…ç½®ä¸­çš„ propsã€æ˜ å°„è¡¨ä¸­ç»„ä»¶çš„é»˜è®¤ propsï¼Œä»¥åŠä¾èµ–è¡¨å• model çš„åŠ¨æ€ propsï¼ˆç”¨äºå®ç°ä¸Šæ–‡ä¸­ç¬¬2ç±»è”åŠ¨ï¼‰ã€‚æœ€åå¤„ç†æ¡ä»¶æ¸²æŸ“ï¼Œæ‰§è¡Œé…ç½®ä¸­çš„ ifRender å‡½æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨ä»¥è¡¨å•æ¨¡æ¿ä¸­ v-if åˆ¤æ–­ã€‚ å‘Šåˆ«è¡¨å•ä¸Šæ–‡è¯´é…ç½®å‹è¡¨å•çœå»äº†æ¨¡æ¿ï¼Œå› ä¸ºæ¨¡æ¿å·²ç»è¢«æ ‡å‡†åŒ–ï¼Œå¹¶ä¸”è¢«å°è£…åœ¨äº† Form ä¸­ï¼Œå³ä¸‹é¢çš„ &lt;json-form&gt; 1&lt;json-form v-model="formModel" :config="formItems"/&gt; å¯¹ä½¿ç”¨è€…æ¥è¯´åªéœ€è¦å†™å¥½ JSON é…ç½®å°±å¯ä»¥äº†ã€‚ç”±æ­¤å¸¦æ¥çš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼Œé‚£å°±æ˜¯è¡¨å•éœ€æ±‚ä¸­çš„ä¸šåŠ¡é€»è¾‘åªéœ€è¦å…³æ³¨æ•°æ®å±‚é¢ï¼Œå³æŸä¸ªè¡¨å•æ§ä»¶å¯¹åº”çš„æ•°æ® key æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¯¹åº”çš„ç»„ä»¶ç±»å‹ã€‚å¹¶ä¸”å½“å¤„ç†è¡¨å•è”åŠ¨éœ€æ±‚æ—¶ï¼Œåªéœ€åœ¨é…ç½®ä¸­å†™ä¸Šä¸€äº›å‡½æ•°ï¼Œè¿™æ ·é€»è¾‘æ›´é›†ä¸­ï¼Œå› ä¸ºä½ ä¸éœ€è¦åœ¨åŸå…ˆçš„é¡µé¢æ¨¡æ¿ä»¥åŠä»£ç é€»è¾‘ä¸­å¯»æ‰¾æœ‰å“ªäº›è€¦åˆäº†ã€‚ æ›´è¿œåœ°æ¥è¯´ï¼Œé…ç½®å‹è¡¨å•å¯ä»¥è½»æ¾åº”å¯¹åº•å±‚çš„å˜åŒ–ã€‚æ¯”å¦‚ç°åœ¨ Element ç»„ä»¶åº“éœ€è¦å‡çº§å¤§ç‰ˆæœ¬äº†ï¼Œå¿…ç„¶æœ‰ä¸å…¼å®¹çš„å‘ï¼Œä½ å°±ä¸å¿…åœ¨æ‰€æœ‰é¡µé¢ä¸­ç¿»æ¥è¦†å»åœ°å¯»æ‰¾åˆ°åº•å“ªäº›å±æ€§è¦æ”¹ã€‚åªéœ€è¦æå®šå°è£…åçš„ Formï¼Œåœ¨ä¸å…¼å®¹çš„ props ä¹‹é—´åšä¸€å±‚æ˜ å°„ï¼Œä¸šåŠ¡ä»£ç éƒ¨åˆ†æ˜¯æ— éœ€æ”¹åŠ¨çš„ã€‚ è¯»åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯ä»¥ä¸ºä¼šæœ‰å¹¿å‘Šï¼Ÿæ˜¯ä¸ºäº†å®‰åˆ©æŸä¸ªè½®å­ğŸ˜‡ æ€»ç»“ç„¶è€Œå¹¶æ²¡æœ‰â€¦â€¦ æœ¬æ–‡ä»å®é™…çš„éœ€æ±‚å‡ºå‘ï¼Œè®¨è®ºäº†é…ç½®å‹è¡¨å•çš„å¯è¡Œæ€§ï¼Œå¹¶æ•´ç†äº†å¸¸è§çš„è¡¨å•è”åŠ¨åœºæ™¯ã€‚é€šè¿‡é…ç½®å‹çš„è¡¨å•å¯ä»¥é™ä½ä¸šåŠ¡ä»£ç çš„å¼€å‘å’Œç»´æŠ¤æˆæœ¬ã€‚ å·²ç»åœ¨å…¬å¸çš„åå°ä¸šåŠ¡ä¸­å°è¯•äº†æ•°åä¸ªé¡µé¢ï¼Œè¿˜æœ‰å¾ˆå¤šé…ç½®é¡¹åŠå®ç°ç»†èŠ‚æ²¡æœ‰åˆ—å‡ºï¼Œæ¯”å¦‚æ‰©å±•è‡ªå®šä¹‰ç»„ä»¶ã€æ¸²æŸ“è‡ªå®šä¹‰æ¨¡æ¿ã€è¡¨å•ç”Ÿå‘½å‘¨æœŸä»¥åŠè¡¨å• API çš„è®¾è®¡ç­‰ã€‚ ç»“åˆçœŸå®çš„ä¸šåŠ¡åœºæ™¯ï¼Œä½¿ç”¨é…ç½®æ¥ç»„ç»‡è¡¨å•ç”šè‡³ç»„ç»‡æ•´ä¸ªé¡µé¢ï¼Œæ˜¯ä¸€æ¡è·¯å­ã€‚å®ƒé™ä½äº†ä»£ç çš„å¤æ‚åº¦ï¼Œå´æ— å½¢ä¸­æé«˜äº†ç†è§£é…ç½®çš„å¤æ‚åº¦ã€‚å› ä¸ºä¸šåŠ¡åœºæ™¯åƒå˜ä¸‡åŒ–ï¼Œä¼—å£éš¾è°ƒï¼Œä½ å¿…é¡»åœ¨å…¶ä¸­æŠ½ç¦»å‡ºç›¸ä¼¼çš„ä¸œè¥¿ï¼Œå°†å…¶è®¾è®¡æˆé…ç½®ã€‚é…ç½®é¡¹æ—¢è¦é€šç”¨ï¼Œåˆä¸èƒ½é™å¤ªæ­»ï¼Œå¿…è¦æ—¶è¦èƒ½æä¾›å¯è‡ªå®šä¹‰å’Œæ‰©å±•çš„æ–¹å¼ã€‚ é…ç½®çš„è®¾è®¡æ˜¯æœ€éš¾çš„ï¼Œä¹Ÿæœ€å®¹æ˜“çº ç»“ï¼ŒçœŸæ­£å»å®ç°è¿™ä¹ˆä¸€å¥—è¡¨å•é…ç½®ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„å‘¢ï¼]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2018æœªæ¥åœ¨å“ªå„¿]]></title>
    <url>%2Fblog%2F2018%2F04%2Ffuture-rolls-on.html</url>
    <content type="text"><![CDATA[è¿™å¹¶ä¸æ˜¯ä¸€ç¯‡ç•…æƒ³æŠ€æœ¯è¶‹åŠ¿çš„æ–‡ç« ï¼Œæ–‡ä¸­è™½ç„¶æ¶‰åŠä¸€äº›ï¼Œä½†æ›´å¤šæ˜¯å¯¹è‡ªå·±å·¥ä½œçš„åæ€ï¼Œåœ¨èˆ’é€‚åŒºä¸­æ„Ÿåˆ°äº†æ— å°½çš„æ‹…å¿§å’Œè¿·èŒ«ã€‚ Originå›é¡¾è‡ªå·±çš„å­¦ä¹ ç»å†ï¼Œä¼¼ä¹æ¶‰åŠè¿‡å¾ˆå¤šé¢ï¼Œä½†çœ‹ç€åˆåƒä¸€ç‰‡ç©ºç™½ã€‚ å¤§ä¸‰æ—¶è¿·ä¸Šæœºå™¨å­¦ä¹ å’Œæ¸¸æˆAIï¼Œå–œæ¬¢çœ‹ä¹¦ï¼Œè¢«å„ç§é¢„æµ‹æ¨¡å‹æƒŠè‰³åˆ°äº†ã€‚ç»“æœå‘¢ï¼Œæ­»äºæ•°å­¦åŠŸåº•å·®ï¼Œè¶Šå¾€æ·±è¶Šå•ƒä¸åŠ¨ï¼Œé‚å’ã€‚ã€‚ å¤§å››æ—¶æ‰çŸ¥é“ web å‰ç«¯ï¼Œå½“æ—¶çš„ web æ¡†æ¶ç‰¹æŒ‡ web åç«¯æ¡†æ¶ï¼Œå‡ ä¹æ˜¯ Structs å’Œ Spring çš„ä¸€ç‰‡å¤©ã€‚èœ»èœ“ç‚¹æ°´ï¼Œæ²¡æœ‰æ·±å…¥è¿‡æ¡†æ¶åŸç†ã€‚ è¯»ç ”å all in å‰ç«¯ï¼Œç»™å¯¼å¸ˆåšä¸€äº›æ•™å­¦ç®¡ç†å’Œè€ƒè¯•ç³»ç»Ÿã€‚é ç€è¿™ä¸ªç³»ç»Ÿæœ‰å¹¸å¾—åˆ°äº†ä¸šå†…é¡¶å°–å‰ç«¯å›¢é˜Ÿçš„å®ä¹ æœºä¼šï¼Œæ°é€¢æ‹¥æŠ±å˜åŒ–ï¼Œæ²¡èƒ½ç•™ä¸‹ï¼Œå…¶å®è‡ªå·±ä¹Ÿè§‰å¾—å¤ªç´¯äº†ã€‚ å½“æ—¶æ˜¯2015å¹´ï¼Œå‰ç«¯éƒ½çŸ¥é“çš„æŠ€æœ¯å¤§çˆ†å‘ä¹‹å¹´ï¼ŒES6ã€React Native éƒ½åœ¨2015å¹´ç«äº†ã€‚å½“æ—¶å®ä¹ æ—¶ï¼Œå›¢é˜Ÿå†…å·²ç»æœ‰ä¸å°‘äººåœ¨å¼€å§‹ RN çš„æ¢ç´¢è¸©å‘ï¼Œæˆ‘ä¹Ÿå°è¯•å­¦è¿‡ï¼Œåªå› è‡ªå·±åŸºç¡€è¿˜ä¸å¤Ÿæ‰å®ï¼Œåº”å¯¹æ—¥å¸¸ä¸šåŠ¡è¿˜ä¸èƒ½æ¸¸åˆƒæœ‰ä½™ï¼Œä¸€è¾¹è¿˜åœ¨å­¦ä¹ åˆ«äººä¼˜ç§€çš„ä»£ç ï¼Œä¸€è¾¹è¿˜è¦å†å°è¯•å­¦ä¹ æœ‰ç‚¹è·¨ç•Œçš„ RNï¼ŒçœŸå¿ƒåŠ›ä¸ä»å¿ƒã€‚ å‰ç«¯ 2015 å¹´çš„è½¬æŠ˜ç‚¹ï¼Œå°±è¿™ä¹ˆä»èº«è¾¹æ“¦è¿‡ã€‚å½“æ—¶ä¼š React å’Œ RN çš„å°±èƒ½æ‰¾åˆ°å¾ˆå¥½çš„å·¥ä½œã€‚å®ä¹ çŸ­çŸ­ä¸‰ä¸ªæœˆå°±å›æ ¡äº†ï¼Œç»ˆç©¶æ•Œä¸è¿‡æƒ°æ€§ï¼Œä¹Ÿæ²¡æœ‰é€¼è¿«è‡ªå·±å»å­¦ã€‚ã€‚ ç ”ä¸‰æœ€åä¸€å¹´ï¼Œæ¥äº†ä¸ªå¯¼å¸ˆä¸å¤–éƒ¨åˆä½œçš„è¯•æ°´é¡¹ç›®ï¼Œç½‘ç«™å®‰å…¨ç›‘æ§ï¼Œçˆ¬è™« + æ¼æ´æ‰«æï¼Œä»é›¶å¼€å§‹åšå‡ºäº†ä¸€ç‰ˆ demoï¼Œå¯¹è‡ªå·±ç‹¬ç«‹åˆ†æçš„èƒ½åŠ›æå‡æŒºå¤§çš„ï¼Œä½†å®‰å…¨æ–¹é¢ç„¶åä¹Ÿæ²¡æœ‰å»æ·±æŒ– &gt;_&lt; æ¯•ä¸šç¬¬ä¸€ä»½å·¥ä½œï¼Œé‡æ„äº†ç»„ä»¶åº“å’Œå‰ç«¯ä»“åº“ï¼Œé™·å…¥äº†èˆ’é€‚åŒºä»¥åŠè€é¡¹ç›®å†å²åŒ…è¢±çš„çŸ›ç›¾ä¸­ï¼Œçœ‹ä¸åˆ°è‡ªå·±çš„æˆé•¿ï¼Œå¾…äº†ä¸€å¹´åå†³å®šèµ°äº†ã€‚ ç¬¬äºŒä»½å·¥ä½œï¼Œä¸€ä¸ªå¿«é€Ÿè¿­ä»£çš„æ¨ªå‘å›¢é˜Ÿï¼Œéœ€è¦åœ¨ä¸šåŠ¡çš„é‡è¦æ€§ã€ç´§æ€¥æ€§ä»¥åŠå¼€å‘ä»£ä»·é—´æƒè¡¡ï¼Œå­¦ä¼šäº† Vueï¼Œç¡®å®æ¯” React æ›´é€‚åˆè¿™ç±»æœ‰Nå¤šå­é¡¹ç›®å¹¶ä¸”è¦å¿«é€Ÿä¸Šæ‰‹çš„åœºæ™¯ã€‚æ¸æ¸åœ°ï¼Œä¹Ÿå¼€å§‹æ­¥å…¥äº†èˆ’é€‚åŒºã€‚ å›é¡¾ä¸€åˆ‡ï¼Œåˆå›åˆ°äº†åŸç‚¹ï¼Œæƒ°æ€§ä¸è‡ªé©±çš„çŸ›ç›¾ä¸€ç›´å­˜åœ¨ã€‚ Smashå‰ç«¯ç«äº†ä¸‰å››å¹´äº†ï¼Œä¹Ÿèµ¶ä¸Šäº†ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ä¸€èµ·è“¬å‹ƒã€‚è¿‡å»è°ˆè®ºå¤§æ•°æ®çš„ï¼Œç°åœ¨è°ˆè®ºAIäº†ï¼›è¿‡å»è¯´ç§»åŠ¨å¼€å‘çš„ï¼Œç°åœ¨è¯´å¤§å‰ç«¯äº†ã€‚å˜åŒ–æ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œè·Ÿä¸Šå˜åŒ–æ˜¯å¿…ç„¶çš„ï¼Œå¦åˆ™ç›¸å½“äºä¸»åŠ¨é€€å‡ºã€‚ è¦æƒ³çªç ´åŸç‚¹ï¼Œæˆ‘è®¤ä¸ºæœ‰ä»¥ä¸‹å‡ ä¸ªå…¥å£ 1ã€æè‡´ä½“éªŒç›®å‰å¤§å‰ç«¯é£ä¸‹ï¼Œå·²ä¸å†å°† Native ç«¯ä¸ web ç«¯å¼ºæ‹†åˆ†äº†ï¼Œå¤§å®¶çš„ç›®æ ‡éƒ½å¾ˆä¸€è‡´ã€‚ ä¸€æ˜¯ï¼Œç»™ C ç«¯ç”¨æˆ·æ›´å¥½çš„ä½“éªŒï¼Œç®¡TMæ˜¯ native è¿˜æ˜¯ web å‘¢ï¼Œè°ä½“éªŒå¥½ã€è°çµæ´»ï¼Œå°±ç”¨è°çš„å®ç°ï¼ˆå½“ç„¶è¿™è‚¯å®šå…·ä½“åœºæ™¯å…·ä½“åˆ†æï¼‰ äºŒæ˜¯ï¼Œæ—¢ç„¶ native ä¸ web æŠ±å›¢äº†ï¼Œé‚£èƒ½ä¸èƒ½åªå†™1å¥—ä»£ç ï¼ˆæˆ–è€…80%ä»¥ä¸Šçš„ä»£ç éƒ½ç”¨1å¥—ï¼‰ï¼Œè®©å®ƒåœ¨ iosã€androidã€web ä¸Šéƒ½æœ‰å¾ˆå¥½çš„ä½“éªŒã€‚è¿‡å»è®² PC ä¸ mobile web 1å¥—ä»£ç å“åº”å¼ï¼Œç°åœ¨æ›´å¤šè°ˆè®ºçš„æ˜¯ native ä¸ web çœŸæ­£çš„è·¨ç»ˆç«¯ä¸€è‡´ã€‚Write once, run everywhere 2ã€å·¥ç¨‹æ•ˆç‡å·¥ç¨‹æ•ˆç‡ä¹Ÿå¯ä»¥ä» C ç«¯å’Œ B ç«¯åˆ†åˆ«å±•å¼€ï¼Œä¸Šé¢è¯´çš„è·¨ç»ˆç«¯ä¸€è‡´ï¼ˆWrite onceï¼‰ï¼Œä¹Ÿæ˜¯åœ¨ C ç«¯çš„å·¥ç¨‹æ•ˆç‡ä½“ç°ã€‚ åœ¨å®é™…çš„å·¥ä½œä¸­ï¼Œä¸šåŠ¡æ›´å¤šçš„ä¼šåœ¨ B ç«¯ï¼ˆæˆ–è€…æ˜¯ç®¡ç†ç«¯ï¼‰ï¼Œä¸ºäº†èƒ½å¤Ÿå¿«é€Ÿå“åº”ä¸šåŠ¡å†³ç­–çš„å˜åŒ–ï¼Œæˆ‘ä»¬å¿…é¡»è¦æœ‰å¾ˆå¼ºå¤§çš„åå°ç³»ç»Ÿå¯ä»¥çµæ´»çš„é…ç½®ä¸åŒçš„å†³ç­–ã€‚æ‰€ä»¥å·¥ç¨‹æ•ˆç‡æ–¹é¢æ›´å¤šä¼šä½“ç°åœ¨ï¼š åå°ç®¡ç†é¡µé¢ï¼šä¸»è¦éƒ½æ˜¯ CRUD æ“ä½œï¼Œä¼šåŒ…å«ä¸šåŠ¡é€»è¾‘çš„åˆ¶çº¦å…³ç³»ï¼Œå¸Œæœ›è¿™ç±»é¡µé¢å¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆ ä¸šåŠ¡ç›‘æ§ç³»ç»Ÿï¼šä»æ•°æ®æºåˆ°æ•°æ®æ¸…æ´—å¤„ç†ï¼Œå†åˆ°å­—æ®µæ˜ å°„å…³ç³»ï¼Œå†ç›´æ¥åœ¨å‰ç«¯å‡ºæŠ¥è¡¨ï¼Œå¸Œæœ›è¿™ç±» BI éœ€æ±‚ä¹Ÿå¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆ å‰ç«¯å‘å¸ƒç³»ç»Ÿï¼šç»“åˆä¸Šé¢è¯´çš„å‰ç«¯ write onceï¼Œå¸Œæœ›å‰ç«¯çš„å‘å¸ƒæµç¨‹æ˜¯æå…¶ç®€æ´çš„ï¼Œå¹¶å¯ä»¥å¿«é€Ÿå›æ»šï¼Œæ¯•ç«Ÿæ”¹å‰ç«¯æ¯”æ”¹åç«¯å¿«çš„å¤š è¿˜æœ‰å¾ˆå¤šæ•ˆç‡æ–¹é¢çš„ç‚¹ï¼Œæ¯”å¦‚å¼€å‘æ•ˆç‡ã€å¼€å‘ä½“éªŒï¼Œä¹Ÿæ˜¯å€¼å¾—æå‡çš„æ–¹é¢ã€‚ 3ã€è·¨ç•Œäº¤å‰ä»ç§»åŠ¨æ—¶ä»£åˆ°å¤§å‰ç«¯ï¼Œä»å‰ç«¯åˆ°å…¨æ ˆï¼Œä»å¤§æ•°æ®åˆ°AIï¼Œæˆ‘è§‰å¾—ä¸‹ä¸€ä¸ªå¼•çˆ†ç‚¹å°±åœ¨äºè·¨ç•Œçš„èåˆï¼Œå°¤å…¶æ˜¯è·Ÿä¸Šæµªæ½®çš„è·¨ç•Œã€‚ FEer å·²ç»å…·å¤‡äº†å¾ˆå¤šå¾—å¤©ç‹¬åšçš„æŠ€èƒ½æ ‘ Nodejs å»¶ä¼¸äº†åšæœåŠ¡çš„èƒ½åŠ›ï¼ŒGolang åˆå°†åç«¯æ€§èƒ½æå‡äº†ä¸€ä¸ªå°é˜¶ React ä½“ç³»å æ®äº†å‰ç«¯æ¡†æ¶çš„åŠå£æ±Ÿå±±ï¼Œä¸‰å¤§æ¡†æ¶å°†ä¼šå˜æˆ framework ç•Œçš„ BAT 3Dã€VR ä¹Ÿæ˜¯ä»Šåäº¤äº’çš„è¶‹åŠ¿ï¼Œç›¸ä¿¡ç”µå½±ã€Šå¤´å·ç©å®¶ã€‹é‡Œçš„åœºæ™¯æ—©å°±ä¸æ˜¯ç§‘å¹»ï¼Œè€Œæ˜¯è€ç¾ä»¬åˆ‡åˆ‡å®å®åœ¨ç ”ç©¶çš„ä¸œè¥¿ ç‰©è”ç½‘ã€åŸå¸‚æ™ºæ…§ç½‘ï¼Œæ˜¯å›½å®¶åˆ›æ–°çš„ä¸€ä¸ªå¤§æ–¹å‘ï¼Œä¸ç™¾å§“æœ€è´´è¿‘çš„è½åœ°ç‚¹åº”è¯¥æ˜¯æ™ºèƒ½ç©¿æˆ´è®¾å¤‡ï¼ŒAI ä¹Ÿåœ¨æ‚„æ‚„åœ°æ¸—é€åˆ°å‰ç«¯ï¼Œä»Šåâ€œå‰ç«¯â€çš„èŒƒç•´æ›´å¹¿ï¼Œâ€œç»ˆç«¯â€ä¹Ÿå°±æ˜¯ä»Šåçš„å‰ç«¯ã€‚ å‰ç«¯+å…¨æ ˆï¼Œå‰ç«¯+è·¨ç»ˆç«¯ï¼Œå‰ç«¯+äº¤äº’ï¼Œå‰ç«¯+AIï¼Œå‰ç«¯+å®‰å…¨ï¼Œç­‰ç­‰ä»»ä½•ä¸€ç§ç»“åˆï¼Œç›¸ä¿¡éƒ½æ˜¯å€¼å¾—æŠ•èµ„è‡ªå·±çš„ï¼Œåœ¨æœªæ¥è‚¯å®šä¸ä¼šå€’ä¸‹ã€‚ å¦å¤–è¡¥å……ä¸€ç‚¹ï¼Œå‰ç»æ€§çš„æŠ€æœ¯æŠ¼å®ï¼Œæ˜¯éœ€è¦â€œç†¬â€çš„ï¼ŒGolang å‡ºç°äº†å¥½å¤šå¹´åå»å¹´æ‰å¼€å§‹çœŸæ­£çš„ç«ï¼ŒçœŸä¸å¾—ä¸ä½©æœä¸ƒç‰›-è®¸å¼ä¼Ÿçš„æŠ€æœ¯çœ¼å…‰ã€‚å†è€…ï¼Œäº¤äº’æ–¹å¼ä¸Šéœ€è¦ç†¬çš„æ›´ä¹…ï¼Œå°±ä¸¾ç°åœ¨æ‰‹æœºè§¦æ‘¸äº¤äº’ï¼Œæ—©åœ¨1990s å¹´ä»£è€ç¾å°±åœ¨å®éªŒäº†ï¼Œåˆ°å•†ç”¨å†åˆ°é‡äº§ï¼Œç»å†äº†è¿‘20å¹´ã€‚ã€‚ã€‚ JobsJobs æŒ‡æˆ‘ä»¬æ¯å¤©çš„å·¥ä½œï¼Œè¿™é‡Œå¼•ç”¨ä¹”å¸ƒæ–¯2005å¹´åœ¨æ–¯å¦ç¦å¤§å­¦çš„æ¼”è®²æ¥çŒä¸ªé¸¡æ±¤ You canâ€™t connect the dots looking forward, you can only connect them looking backwards. Believing that the dots will connet down the road will give you the confidence to follow your heart, even when it leads you off the well-worn path, and that will make all the difference. Your work is going to fill a large part of your life, and the only way to be truly satisfied is to do what you believe is great work. And the only way to do great work is to love what you do. å¸æ”¶å„ç§ dots ä¸ä»£è¡¨è‡ªå·±æ¯ä¸ªç‚¹ä¸Šéƒ½è¦æˆä¸º topï¼Œè€Œæ˜¯ä¸ºäº†æ”¶é›†æ›´å¤šçš„ä¿¡æ¯ï¼Œä½ è·å¾—çš„ä¿¡æ¯è¶Šå¤šï¼Œä»Šåèƒ½åˆ›æ–°çš„ç‚¹ä¹Ÿå°±è¶Šå¤šã€‚ç›¸ä¿¡è¿™å°±æ˜¯ä¹”è€çˆ·å­è®¾è®¡å‡ºçš„äº§å“ç‹¬ä¸€æ— äºŒçš„åŸå› ã€‚ ã€5.5æ›´æ–°ã€‘ ä»Šå¤©çœ‹äº† FDConf å®˜ç½‘ æ€»ç»“äº†å‰ç«¯æŠ€æœ¯ä»2011å¹´åçš„å˜åŒ– 11 å¹´ï¼Œçœ‹é½æ ‡å‡†ï¼Œå…³æ³¨ Web æ€§èƒ½12 å¹´ï¼Œå“åº”å¼å¼€å‘ï¼Œå·¥ç¨‹åŒ–æ¨è¿›13 å¹´ï¼Œçˆ†å‘å¼å¢é•¿ï¼Œç™¾èŠ±é½æ”¾14 å¹´ï¼Œç§»åŠ¨ç«¯çš„å´›èµ·ï¼ŒHTML5 å’Œ ES6 è½åœ°15 å¹´ï¼Œè§‚å¿µçš„è½¬å˜ï¼Œæ­¥å…¥å‰ç«¯å·¥ä¸šåŒ–ç”Ÿäº§16 å¹´ï¼Œåç«¯æœåŠ¡åŒ–ï¼Œäº‘æ•°æ®ï¼Œäº‘å®‰å…¨17 å¹´ï¼Œç«¯çš„èåˆï¼Œæ ˆçš„èåˆã€‚ â€” æ‘˜è‡ªFDConf 2018ï¼Œæˆ‘è§‰å¾—å°†ä¼šæ˜¯ï¼šå‰ç«¯èµ‹èƒ½ï¼Œä»è·¨ç«¯åˆ°è·¨ç•Œã€‚]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[babel preset â‰  polyfill]]></title>
    <url>%2Fblog%2F2018%2F04%2Fbabel-preset.html</url>
    <content type="text"><![CDATA[ä¹‹å‰ä¸€ç›´æ— è„‘ç”¨ç€ cli è„šæ‰‹æ¶ï¼Œç”¨ç€é»˜è®¤ç”Ÿæˆçš„é…ç½®ï¼Œæ²¡æœ‰å»ä»”ç»†çœ‹ Babel æ–‡æ¡£ã€‚ç›´åˆ°æœ€è¿‘æ¥å…¥äº†å‰ç«¯æŠ¥é”™ç›‘æ§åï¼Œæ‰å‘ç°äº†è®¸å¤šé—®é¢˜ã€‚è¿™é‡Œæ•´ç†ä¸‹å…³äº babel preset ä¸ polyfill çš„ä¸€äº›ç‚¹ ES6ES6 æ—¢æ˜¯ä¸€ä¸ªå†å²åè¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ³›æŒ‡ï¼Œå«ä¹‰æ˜¯ ES5.1 ç‰ˆä»¥åçš„ JavaScript çš„ä¸‹ä¸€ä»£æ ‡å‡†ï¼Œæ¶µç›–äº† ES2015ã€ES2016ã€ES2017 ç­‰ç­‰ã€‚â€”â€” å¼•è‡ªECMAScript 6 å…¥é—¨ ES6 çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œäº 2015 å¹´ 6 æœˆå‘å¸ƒäº†ï¼Œæ­£å¼åç§°å°±æ˜¯ã€ŠECMAScript 2015 æ ‡å‡†ã€‹ï¼ˆç®€ç§° ES2015ï¼‰ã€‚2016 å¹´ 6 æœˆï¼Œå°å¹…ä¿®è®¢çš„ã€ŠECMAScript 2016 æ ‡å‡†ã€‹ï¼ˆç®€ç§° ES2016ï¼‰å¦‚æœŸå‘å¸ƒï¼Œè¿™ä¸ªç‰ˆæœ¬å¯ä»¥çœ‹ä½œæ˜¯ ES6.1 ç‰ˆï¼Œå› ä¸ºä¸¤è€…çš„å·®å¼‚éå¸¸å°ï¼ˆåªæ–°å¢äº†æ•°ç»„å®ä¾‹çš„includesæ–¹æ³•å’ŒæŒ‡æ•°è¿ç®—ç¬¦ï¼‰ï¼ŒåŸºæœ¬ä¸Šæ˜¯åŒä¸€ä¸ªæ ‡å‡†ã€‚æ ¹æ®è®¡åˆ’ï¼Œ2017 å¹´ 6 æœˆå‘å¸ƒ ES2017 æ ‡å‡†ã€‚ è¯­æ³•ææ¡ˆçš„ 5 ä¸ªé˜¶æ®µ Stage 0 - Strawmanï¼ˆå±•ç¤ºé˜¶æ®µï¼‰ Stage 1 - Proposalï¼ˆå¾æ±‚æ„è§é˜¶æ®µï¼‰ Stage 2 - Draftï¼ˆè‰æ¡ˆé˜¶æ®µï¼‰ Stage 3 - Candidateï¼ˆå€™é€‰äººé˜¶æ®µï¼‰ Stage 4 - Finishedï¼ˆå®šæ¡ˆé˜¶æ®µï¼‰ Babel plugins1ã€babel 6.x ä¹‹åå–æ¶ˆäº†ä¾›æµè§ˆå™¨ç›´æ¥ä½¿ç”¨çš„ç‰ˆæœ¬ï¼ˆä¹‹å‰æ˜¯ browser.jsï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­å¯¹ ES6 ä»£ç è¿›è¡Œè½¬æ¢ï¼Œä½†å¾ˆä½æ•ˆï¼‰ï¼Œç°åœ¨è¦æ±‚å¿…é¡»åœ¨ build è¿‡ç¨‹å°† ES6 è½¬æ¢å¥½ã€‚ 2ã€babel æ ¹æ® .babelrc æ–‡ä»¶çš„çº¦å®šæ¥å·¥ä½œï¼Œbabel é»˜è®¤æ˜¯å•¥éƒ½ä¸åšçš„ï¼Œå¿…é¡»æŒ‡å®šå„ç§ pluginsï¼Œå¹¶ä¸”é€šå¸¸ä¸€ä¸ª plugin åªåšä¸€ä»¶äº‹ã€‚æ¯”å¦‚ transform-es2015-for-of å°±åªåš forâ€¦ofâ€¦ è¯­æ³•çš„å¤„ç†ã€‚éä¸¥æ ¼åœ°æ¥è¯´ï¼Œè¿™ç§å¤„ç†æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºâ€œç¼–è¯‘â€ã€‚ 3ã€ç”±äº ES6 æ¶‰åŠçš„è¯­æ³•ç³–éå¸¸å¤šï¼Œè€Œä¸”æœ‰äº›è¿˜åªåœ¨ç‰¹å®š stage çš„ææ¡ˆä¸­ï¼Œæ‰€ä»¥éœ€è¦ presets æ¥çº¦å®šä¸€ä¸ª plugins çš„é›†åˆï¼Œå…å»æˆ‘ä»¬é…ç½®ä¸€å¤§å † pluginsã€‚ Babel presetsES2015 presetï¼šä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ ES6 ç›¸å…³æ–¹æ³•ï¼ŒåŒ…å«ä»¥ä¸‹ plugins check-es2015-constants // æ£€éªŒconstå¸¸é‡æ˜¯å¦è¢«é‡æ–°èµ‹å€¼ transform-es2015-arrow-functions // ç¼–è¯‘ç®­å¤´å‡½æ•° transform-es2015-block-scoped-functions // å‡½æ•°å£°æ˜åœ¨ä½œç”¨åŸŸå†… transform-es2015-block-scoping // ç¼–è¯‘constå’Œlet transform-es2015-classes // ç¼–è¯‘class transform-es2015-computed-properties // ç¼–è¯‘è®¡ç®—å¯¹è±¡å±æ€§ transform-es2015-destructuring // ç¼–è¯‘è§£æ„èµ‹å€¼ transform-es2015-duplicate-keys // ç¼–è¯‘å¯¹è±¡ä¸­é‡å¤çš„keyï¼Œå…¶å®æ˜¯è½¬æ¢æˆè®¡ç®—å¯¹è±¡å±æ€§ transform-es2015-for-of // ç¼–è¯‘forâ€¦of transform-es2015-function-name // å°†function.nameè¯­ä¹‰åº”ç”¨äºæ‰€æœ‰çš„function transform-es2015-literals // ç¼–è¯‘æ•´æ•°(8è¿›åˆ¶/16è¿›åˆ¶)å’Œunicode transform-es2015-modules-commonjs // å°†modulesç¼–è¯‘æˆcommonjs transform-es2015-object-super // ç¼–è¯‘super transform-es2015-parameters // ç¼–è¯‘å‚æ•°ï¼ŒåŒ…æ‹¬é»˜è®¤å‚æ•°ï¼Œä¸å®šå‚æ•°å’Œè§£æ„å‚æ•° transform-es2015-shorthand-properties // ç¼–è¯‘å±æ€§ç¼©å†™ transform-es2015-spread // ç¼–è¯‘å±•å¼€è¿ç®—ç¬¦ transform-es2015-sticky-regex // æ­£åˆ™æ·»åŠ stickyå±æ€§ transform-es2015-template-literals // ç¼–è¯‘æ¨¡ç‰ˆå­—ç¬¦ä¸² transform-es2015-typeof-symbol // ç¼–è¯‘Symbolç±»å‹ transform-es2015-unicode-regex // æ­£åˆ™æ·»åŠ unicodeæ¨¡å¼ transform-regenerator // ç¼–è¯‘generatorå‡½æ•° ES2016 presetï¼šåªå°† ES2016 ä¸­æ–°å‡ºç°çš„è¯­æ³•è½¬æ¢æˆ ES2015 çš„å†™æ³• transform-exponentiation-operator // ç¼–è¯‘å¹‚è¿ç®—ç¬¦ ES2017 presetï¼šåªå°† ES2017 ä¸­æ–°å‡ºç°çš„è¯­æ³•è½¬æ¢æˆ ES2016 çš„å†™æ³• syntax-trailing-function-commas // functionæœ€åä¸€ä¸ªå‚æ•°å…è®¸ä½¿ç”¨é€—å· transform-async-to-generator // æŠŠasyncå‡½æ•°è½¬åŒ–æˆgeneratorå‡½æ•° æ­¤å¤–ï¼Œè¿˜æœ‰ç”¨äºæ”¯æŒ React çš„ React presetï¼Œè¿˜æœ‰ Env preset ç”¨æ¥æ ¹æ®ä½ éœ€è¦æ”¯æŒçš„æµè§ˆå™¨ç¯å¢ƒæ¥å†³å®šåˆ°åº•éœ€è¦å¼•å…¥å¤šå°‘ pluginsï¼Œæµè§ˆå™¨æ”¯æŒåº¦çš„ç»†èŠ‚å¯å‚è€ƒè¿™é‡Œï¼Œä»¥åŠ compat-table åŒå‰é¢åˆ—å‡ºçš„è¯­æ³•ææ¡ˆçš„ 5 ä¸ªé˜¶æ®µï¼Œä¹Ÿæœ‰æ ¹æ® stage åˆ’åˆ†çš„ presetï¼Œstage 4 æŒ‡å·² Finished çš„éƒ¨åˆ†ï¼Œç„¶è€Œæ²¡æœ‰ stage-4 çš„ presetï¼Œå› ä¸ºå®ƒç­‰åŒäº [&#39;es2015&#39;, &#39;es2016&#39;, &#39;es2017&#39;] çš„ presetsã€‚ Stage 3 preset transform-object-rest-spread // ç¼–è¯‘å¯¹è±¡çš„è§£æ„èµ‹å€¼å’Œä¸å®šå‚æ•° transform-async-generator-functions // å°† async generator function å’Œ for await ç¼–è¯‘ä¸º es2015 çš„ generator æ³¨ï¼štrailing-commas, async, exponentiation will be removed in the next major since they are stage 4 already Stage 2 preset syntax-dynamic-import transform-class-properties // ç¼–è¯‘é™æ€å±æ€§(es2015)å’Œå±æ€§åˆå§‹åŒ–è¯­æ³•å£°æ˜çš„å±æ€§(es2016) Stage 1 preset transform-export-extensions // ç¼–è¯‘é¢å¤–çš„exprtè¯­æ³•ï¼Œå¦‚ export * as ns from &#39;mod&#39; ç»†èŠ‚å¯ä»¥å‚è€ƒè¿™é‡Œ æ³¨ï¼štransform-class-constructor-call åœ¨ Babel7 ä¸­ä¼šè¢«ç§»é™¤ Stage 0 preset transform-do-expressions // ç¼–è¯‘doè¡¨è¾¾å¼ transform-function-bind // ç¼–è¯‘bindè¿ç®—ç¬¦ï¼Œä¹Ÿå°±æ˜¯:: ç”±äº stage 0 ~ 4 æ˜¯è¯­æ³•ææ¡ˆä»å¼€å§‹åˆ°å®šæ¡ˆçš„è¿‡ç¨‹ï¼Œå› æ­¤ stage 0 ä¼šåŒ…å«æ›´å¤šçš„è¯­æ³•ç³–ï¼Œstage 4 =&gt; 3 =&gt; 2 =&gt; 1 =&gt; 0 æ˜¯é€æ¸å¢é‡çš„è¿‡ç¨‹ã€‚ plugins VS presetsæœ‰äº› plugins æ˜¯ presets ä¸­æ²¡æœ‰æä¾›çš„ï¼Œè¿™æ—¶å°±é…åˆç€ä½¿ç”¨ï¼Œéœ€è¦å•ç‹¬å¼•å…¥ plugins transform-runtime å¼ºçƒˆæ¨è transform-remove-console plugins / presets ç¼–è¯‘é¡ºåº plugins ä¼˜å…ˆäº presets è¿›è¡Œç¼–è¯‘ã€‚ plugins æŒ‰ç…§æ•°ç»„çš„ index å¢åºè¿›è¡Œç¼–è¯‘ã€‚ presets æŒ‰ç…§æ•°ç»„çš„ index å€’åºè¿›è¡Œç¼–è¯‘ï¼ˆå› ä¸ºä½œè€…è®¤ä¸ºå¤§éƒ¨åˆ†äººä¼šæŠŠ presets å†™æˆ [&quot;es2015&quot;, &quot;stage-0&quot;] ï¼‰ Babel polyfill1ã€Babel é»˜è®¤åªè½¬æ¢æ–°çš„ JavaScript å¥æ³•ï¼ˆsyntaxï¼‰ï¼Œè€Œä¸è½¬æ¢æ–°çš„ APIã€‚æ¯”å¦‚Setã€Mapsã€Proxyã€Reflectã€Symbolã€Promise ç­‰å…¨å±€å¯¹è±¡ï¼Œä»¥åŠåœ¨ ES5 å…¨å±€å¯¹è±¡ä¸Šæ–°å¢çš„æ–¹æ³•ï¼ˆå¦‚ Array.fromï¼‰ Babel ä¸ä¼šè½¬ç è¿™äº›æ–¹æ³•ï¼Œå¿…é¡»ä½¿ç”¨ babel-polyfillï¼Œä¸ºå½“å‰ç¯å¢ƒæä¾›ä¸€ä¸ªå«ç‰‡ã€‚ 2ã€Babel é»˜è®¤ä¸è½¬ç çš„ API éå¸¸å¤šï¼Œè¯¦ç»†æ¸…å•å¯ä»¥æŸ¥çœ‹ babel-plugin-transform-runtime æ¨¡å—çš„ definitions.js æ–‡ä»¶ã€‚ 3ã€polyfill çš„ä½¿ç”¨å§¿åŠ¿ï¼Œæœ‰ä»¥ä¸‹3ç§ ä½¿ç”¨æ–¹å¼ ä¼˜ç‚¹ ç¼ºç‚¹ åœ¨&lt;script&gt;å‰æ’å…¥ babel-polyfill çš„CDNæ–‡ä»¶ å¤§è€Œå…¨ æ‰“åŒ…è¿‡ç¨‹æ— æ³•å‚ä¸ï¼Œæ— æ³•åš tree shaking ä¼˜åŒ– åœ¨ webpack entry ä¸­ç¬¬ä¸€ä¸ªæ’å…¥ babel-polyfill å¤§è€Œå…¨ æ‰“åŒ…åæ–‡ä»¶ä½“ç§¯å¢å¤§ åœ¨å…¥å£æ–‡ä»¶å¼•å…¥ core-js è‡ªè¡Œå–æ‰€éœ€ æœ€å°åŒ– ä»¥åä¼šä¸æ–­è¿½åŠ æ‰€éœ€ï¼Œå®¹æ˜“é—æ¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>es</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸­çš„â€œå¤šç»§æ‰¿â€(2)]]></title>
    <url>%2Fblog%2F2018%2F03%2Fmulti-inheritance-2.html</url>
    <content type="text"><![CDATA[é¦–å…ˆ JavaScript ä¸­ä¸å­˜åœ¨å¤šç»§æ‰¿ï¼Œå¹¶ä¸”ä¹Ÿä¸æ¨èä½¿ç”¨ç»§æ‰¿ã€‚å¦‚æœä½ ä¹Ÿè¿™ä¹ˆè®¤ä¸ºçš„è¯ï¼Œé‚£ç¬”è€…çš„è§‚ç‚¹ä¹Ÿå°±å†™å®Œå•¦ 233333â€¦. å¦‚æœè¿˜æƒ³å›é¡¾ä¸‹ JavaScript ä¸­â€œç»§æ‰¿â€çš„å‰ä¸–ä»Šç”Ÿï¼Œä»¥åŠå¯¹â€œå¤šç»§æ‰¿â€çš„è®¨è®ºï¼Œä¸å¦¨çœ‹ä¸‹å»ã€‚ ï¼ˆæ¥ä¸Šä¸€ç¯‡ï¼‰ è¯•è¯•å¤šç»§æ‰¿è´ªå¿ƒæ˜¯äººä¹‹å¸¸æƒ…ï¼Œæœ‰äº†â€œç»§æ‰¿â€åï¼Œæˆ‘ä»¬å°±ä¼šæƒ³è¦â€œå¤šç»§æ‰¿â€ã€‚å³ä½¿åœ¨åç«¯è¯­è¨€ä¸­ï¼Œä¹Ÿæ²¡æœ‰å‡ ä¸ªè¯­è¨€èƒ½çœŸæ­£å®ç°å¤šç»§æ‰¿ï¼Œç¬”è€…åªçŸ¥é“ C++ å’Œ python æä¾›äº†å¤šç»§æ‰¿çš„è¯­æ³•ï¼Œè€Œåƒ Java åªå…è®¸ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†å¯ä»¥åŒæ—¶ implements å¤šä¸ªæ¥å£ç±»ï¼Œä¹Ÿç®—ä¸€ç§å˜ç›¸çš„å¤šç»§æ‰¿å§ã€‚ å¤šç»§æ‰¿è¦è€ƒè™‘çš„é—®é¢˜å¤šç»§æ‰¿å¹¶æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç¾å¥½ï¼Œé¦–å…ˆæ˜¯å¯¹ instanceof æå‡ºäº†æ›´é«˜çš„è¦æ±‚ 123456789class A &#123;&#125;class B &#123;&#125;// å‡å®šæœ‰æ”¯æŒå¤šç»§æ‰¿çš„è¯­æ³•class C extends A, B &#123;&#125;// é‚£ä¹ˆ C çš„å®ä¾‹å¯¹è±¡ï¼Œåº”è¯¥åŒæ—¶ä¹Ÿæ˜¯ A å’Œ B çš„ instancelet c = new C()c instanceof C // truec instanceof A // truec instanceof B // true å¦‚ä¸Šç¤ºä¾‹ï¼Œåœ¨å¤šç»§æ‰¿ä¸­å¿…é¡»å°†æ‰€æœ‰çš„çˆ¶ç±»æ ‡è¯†è®°å½•åœ¨å­ç±»ä¸­ï¼Œæ‰èƒ½è®© instanceof å®ç°ä¸Šé¢çš„æ•ˆæœã€‚è€Œ JavaScript ä¸­åªæœ‰ prototype é“¾ï¼Œè¯¥æ­»çš„è¿˜çº¦æŸäº†ä¸€ä¸ªå¯¹è±¡åªèƒ½æŒ‡å®šä¸€ä¸ª prototypeï¼Œæ‰€ä»¥è¿˜å¾—å¦å¤–æƒ³åŠæ³•å»æ¨¡æ‹Ÿ instanceof è¿™è¿˜ä¸ç®—å•¥ï¼Œè¯·çœ‹ä¸‹ä¸€å¼ å›¾ è¿™æ˜¯å¤šç»§æ‰¿ä¸­å…¸å‹çš„é—®é¢˜ï¼Œç§°ä¸º Diamond Problemï¼Œå½“ A, B, C ä¸­éƒ½å®šä¹‰äº†ä¸€ä¸ªç›¸åŒåç§°çš„å‡½æ•°æ—¶ï¼Œè€Œåœ¨ D çš„å®ä¾‹å¯¹è±¡ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œç©¶ç«Ÿåº”è¯¥å»æ‰§è¡Œè°ã€‚ã€‚ã€‚ é—´æ¥å¤šç»§æ‰¿å…ˆé€€è€Œæ±‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å€Ÿé‰´äº† Java ä¸­çš„æ€è·¯ï¼Œå®é™…åªç»§æ‰¿ä¸€ä¸ªç±»ï¼Œé€šè¿‡å…¶ä»–æ–¹å¼å°†å…¶ä»–ç±»çš„åŠŸèƒ½èå…¥ã€‚Java ä¸­å¯ä»¥ç”¨ Interface çº¦æŸä¸€ä¸ªç±»åº”è¯¥æ‹¥æœ‰çš„è¡Œä¸ºï¼Œå½“ç„¶ JavaScript ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼Œå®ç° interface çš„è¯­æ³•ç³–ï¼Œæ£€æŸ¥â€œç±»â€ä¸­æœ‰æ²¡æœ‰é‡å†™ interface ä¸­çš„æ‰€æœ‰å‡½æ•°ã€‚ä½†è¿™æ ·çš„è¯ï¼Œinterface é™¤äº†åšæ ¡éªŒä¹‹ç”¨ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ï¼Œä¸å¦‚ç›´æ¥ mixin çš„æ–¹å¼æ¥çš„å®åœ¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940const mixinClass = (base, ...mixins) =&gt; &#123; const mixinProps = (target, source) =&gt; &#123; Object.getOwnPropertyNames(source).forEach(prop =&gt; &#123; if (/^constructor$/.test(prop)) &#123; return; &#125; Object.defineProperty(target, prop, Object.getOwnPropertyDescriptor(source, prop)); &#125;) &#125;; let Ctor; if (base &amp;&amp; typeof base === 'function') &#123; Ctor = class extends base &#123; constructor(...props) &#123; super(...props); &#125; &#125;; mixins.forEach(source =&gt; &#123; mixinProps(Ctor.prototype, source.prototype); &#125;); &#125; else &#123; Ctor = class &#123;&#125;; &#125; return Ctor;&#125;;class A &#123; methodA() &#123;&#125;&#125;class B &#123; methodB() &#123;&#125;&#125;class C extends mixinClass(A, B) &#123; methodA() &#123; console.log('methodA in C'); &#125; methodC() &#123;&#125;&#125;let c = new C();c instanceof C // truec instanceof A // truec instanceof B // false è¿™æ ·å°±ç®€å•æ¨¡æ‹Ÿäº†é—´æ¥å¤šç»§æ‰¿ï¼Œé€šè¿‡æ„é€ ä¸€ä¸ªä¸­é—´ç±»ï¼Œè®©ä¸­é—´ç±»ç›´æ¥ç»§æ‰¿ Aï¼Œå¹¶ä¸” mixin äº† B çš„åŸå‹æˆå‘˜ï¼Œç„¶åå†è®© C å»ç»§æ‰¿è¿™ä¸ªä¸­é—´ç±»ã€‚ç”±äº B æ˜¯é€šè¿‡ mixin æ–¹å¼æµ…æ‹·è´äº†ä¸€ä»½ï¼ŒB.prototype å¹¶ä¸åœ¨ C çš„åŸå‹é“¾ä¸Šï¼ˆC.__proto__.__proto__ï¼‰ï¼Œæ‰€ä»¥ c instanceof B ä¸º falseã€‚ è¦æƒ³ä¿®æ­£ instanceofï¼Œåªèƒ½è‡ªå·±å¦å¤–å®ç°ä¸€å¥— isInstanceOf() çš„é€»è¾‘ï¼Œåœ¨ç»§æ‰¿æ—¶å°†æ‰€æœ‰çš„çˆ¶ç±»å¼•ç”¨è®°å½•ä¸‹æ¥ï¼Œå†å»æ¯”å¯¹ã€‚ MROç®—æ³•é’ˆå¯¹å¤šç»§æ‰¿è€ƒè™‘çš„ç¬¬2ä¸ªé—®é¢˜ï¼Œå‰é¢æåˆ°çš„ Diamond Problemï¼Œéœ€è¦å¼•å…¥ä¸€ä¸ªå®šä¹‰ã€‚ Method Resolution Order (MRO) æŒ‡çš„æ˜¯åœ¨ç»§æ‰¿ç»“æ„ä¸­ç¡®å®šç±»çš„çº¿æ€§é¡ºåºï¼Œä¾‹å¦‚ C =&gt; B =&gt; A è¡¨ç¤º C ç»§æ‰¿ Bï¼ŒB ç»§æ‰¿ Aï¼Œé‚£ä¹ˆ C çš„ MRO å°±æ˜¯ C B Aï¼Œä¹Ÿå°±æ„å‘³ç€å½“è°ƒç”¨ C å®ä¾‹ä¸­çš„ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼šæŒ‰ç…§ C B A çš„ä¼˜å…ˆçº§é¡ºåºå»â€œå¯»æ‰¾â€è¯¥å‡½æ•°ã€‚åœ¨å•ç»§æ‰¿çš„ç»“æ„ä¸­è‡ªç„¶æ²¡æœ‰é—®é¢˜ï¼Œè€Œåœ¨å¤šç»§æ‰¿ä¸­ MRO å‘æŒ¥ç€å…¶ä½œç”¨ã€‚ å¸¸ç”¨çš„C3ç®—æ³•å°±æ˜¯ç”¨æ¥è®¡ç®— MROï¼Œåœ¨ python æ–‡æ¡£ä¸­æœ‰å¯¹å…¶çš„å®Œæ•´æè¿°ï¼Œè¿™é‡Œç”¨ä¸€ä¸ªä¾‹å­ç®€è¿°ä¸‹ç®—æ³•æµç¨‹ã€‚ å‡è®¾ç°åœ¨æœ‰è¿™æ ·çš„å¤šç»§æ‰¿ç»“æ„ é¦–å…ˆå¼•å…¥ç±»çš„çº¿æ€§é¡ºåºçš„è¡¨ç¤ºæ–¹æ³•ï¼Œåœ¨ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ° B =&gt; Y =&gt; O è¿™ä¸€éƒ¨åˆ†æ˜¯å•ç»§æ‰¿çš„ç»“æ„ï¼Œæ˜¾ç„¶ B çš„ MRO ä¸º B Y Oï¼Œè®°ä¸º L(B) = BYO ç„¶åè¿˜è¦å¼•å…¥å‡ ä¸ªç¬¦å·ï¼Œåœ¨ MRO çš„çº¿æ€§é¡ºåºä¸­ï¼Œç”¨ head è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç”¨ tail è¡¨ç¤ºä½™ä¸‹éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼ŒB Y O ä¸­çš„ head å°±æ˜¯ Bï¼Œtail åˆ™æ˜¯ Y Oã€‚MRO ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚å›¾ä¸­çš„ O å…ƒç´ ï¼Œhead ä¸ºOï¼Œtail åˆ™æ˜¯ç©ºã€‚ æ¥ä¸‹æ¥æ˜¯æœ€å…³é”®çš„ï¼Œå›¾ä¸­ A çš„ MRO è®°ä¸º L(A(X, Y))ï¼ŒA(X, Y) è¡¨ç¤º A åŒæ—¶ç»§æ‰¿äº† X å’Œ Yï¼Œé‚£ä¹ˆ L(A(X, Y)) = A + merge(L(X), L(Y), XY) å…¶ä¸­ merge çš„è§„åˆ™å¦‚ä¸‹ 12345å–å‡ºç¬¬ä¸€ä¸ªåºåˆ—çš„ headå¦‚æœï¼Œè¯¥ head ä¸åœ¨å…¶å®ƒåºåˆ—çš„ tail ä¸­ åˆ™æŠŠè¿™ä¸ª head æ·»åŠ åˆ°ç»“æœä¸­å¹¶ä»æ‰€æœ‰çš„åºåˆ—ä¸­ç§»é™¤å®ƒå¦åˆ™ï¼Œç”¨ä¸‹ä¸€ä¸ªåºåˆ—çš„ head é‡å¤ä¸Šä¸€æ­¥ç›´åˆ°æ‰€æœ‰åºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¢«ç§»é™¤ï¼ˆæˆ–è€…æ— æ³•æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆçš„headï¼‰ æœ€åæˆ‘ä»¬æ¥è®¡ç®—ä¸‹ä¸Šå›¾ä¸­å„ä¸ªç±»çš„çº¿æ€§é¡ºåº 123456789101112131415L(O) = OL(X) = X + L(O) = XOL(Y) = Y + L(O) = YOL(A) = A + merge(L(X), L(Y), XY) = A + merge(XO, YO, XY) = AX + merge(O, YO, Y) = AXY + merge(O, O) = AXYOL(B) = B + L(Y) = BYOL(C) = C + merge(L(A), L(B), AB) = C + merge(AXYO, BYO, AB) = CA + merge(XYO, BYO, B) = CAX + merge(YO, BYO, B) = CAXB + merge(YO, YO) = CAXBYO ä¸Šè¿°å¤šç»§æ‰¿ç»“æ„çš„ python ç¤ºä¾‹å¯å‚è§ https://glot.io/snippets/ez5bqslav2 è¾“å‡ºäº† C è¿™ä¸ªç±»çš„ MRO å³ C A X B Y O å½“ç„¶C3ç®—æ³•ä¹Ÿæœ‰ bad caseï¼Œä¼šå¯¼è‡´ä¸Šè¿°çš„ merge åœ¨ä¸­é€”å¤±è´¥ï¼Œä¹Ÿå°±æ˜¯æ— æ³•æ±‚å‡º MRO çš„ caseã€‚å…³äº MRO çš„æ›´å¤šç»†èŠ‚å¯å‚è€ƒ https://www.python.org/download/releases/2.3/mro/ æ€»ä¹‹ä¸æ¨èè®¾è®¡å‡ºè¿‡äºå¤æ‚çš„å¤šç»§æ‰¿ç»“æ„ =_= æ¨¡æ‹Ÿå¤šç»§æ‰¿æœ‰äº†ä¸Šé¢çš„åŸºç¡€åï¼Œæˆ‘ä»¬æ¥æ¨¡æ‹Ÿå®ç°ä¸‹å¤šç»§æ‰¿ï¼š ä¸ºæ¯ä¸ªâ€œç±»â€æä¾›ç‹¬ç«‹çš„ isInstanceOf() å‡½æ•°ä»¥è§£å†³ instanceof çš„é—®é¢˜ åŒæ—¶å¼•å…¥ Method Resolution Order (MRO) çš„C3ç®—æ³•ï¼Œå°†æ¯ä¸ªâ€œç±»â€çš„ MRO çº¿æ€§åºåˆ—å­˜åœ¨ meta æ•°æ®ä¸­ å°†å¤šç»§æ‰¿ä¸­çš„ç¬¬ä¸€ä¸ªçˆ¶ç±»ï¼Œä½¿ç”¨åŸå‹é“¾çš„æ–¹å¼ç»§æ‰¿ï¼Œè€Œå‰©ä¸‹çš„çˆ¶ç±»åˆ™ä½¿ç”¨ mixin çš„æ–¹å¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990const mixinProps = (target, source) =&gt; &#123; Object.getOwnPropertyNames(source).forEach(prop =&gt; &#123; if (/^(?:constructor|isInstanceOf)$/.test(prop)) &#123; return; &#125; Object.defineProperty(target, prop, Object.getOwnPropertyDescriptor(source, prop)); &#125;)&#125;;const mroMerge = (list) =&gt; &#123; if (!list || !list.length) &#123; return []; &#125; for (let items of list) &#123; let item = items[0]; let valid = true; for (let items2 of list) &#123; if (items2.indexOf(item) &gt; 0) &#123; valid = false; break; &#125; &#125; if (valid) &#123; let nextList = []; for (let items3 of list) &#123; let _index = items3.indexOf(item); if (_index &gt; -1) &#123; items3.splice(_index, 1); &#125; items3.length &amp;&amp; nextList.push(items3); &#125; return [item, ...mroMerge(nextList)]; &#125; &#125; throw new Error('Unable to merge MRO');&#125;;const c3mro = (ctor, bases) =&gt; &#123; if (!bases || !bases.length) &#123; return [ctor]; &#125; let list = bases.map(b =&gt; b._meta.bases.slice()); list = list.concat([bases]); let res = mroMerge(list); return [ctor, ...res];&#125;;const createClass = (parents, props) =&gt; &#123; const isMulti = parents &amp;&amp; Array.isArray(parents); const superCls = isMulti ? parents[0] : parents; const mixins = isMulti ? parents.slice(1) : []; const Ctor = function(...args) &#123; // TODO: call each parent's constructor if (props.constructor) &#123; props.constructor.apply(this, args); &#125; &#125;; // save c3mro into _meta let bases = [superCls, ...mixins].filter(item =&gt; !!item); Ctor._meta = &#123; bases: c3mro(Ctor, bases) &#125;; // inherit first parent through proto chain if (superCls &amp;&amp; typeof superCls === 'function') &#123; Ctor.prototype = Object.create(superCls.prototype); Ctor.prototype.constructor = Ctor; &#125; // mix other parents into prototype according to [Method Resolution Order] // NOTE: Ctor._meta.bases[0] always stands for the Ctor itself if (Ctor._meta.bases.length &gt; 1) &#123; let providers = Ctor._meta.bases.slice(1).reverse(); providers.forEach(provider =&gt; &#123; // TODO: prototype of superCls is already inherited by __proto__ chain (provider !== superCls) &amp;&amp; mixinProps(Ctor.prototype, provider.prototype); &#125;); &#125; mixinProps(Ctor.prototype, props); Ctor.prototype.isInstanceOf = function(cls) &#123; let bases = this.constructor._meta.bases; return bases.some(item =&gt; item === cls) || (this instanceof cls); &#125; return Ctor;&#125;; æ¥ç€æ¥æµ‹è¯•ä¸€ä¸‹å¦‚å›¾3ä¸­çš„å¤šç»§æ‰¿ç»“æ„ 123456789101112131415161718192021222324252627const O = createClass(null, &#123;&#125;);const X = createClass([O], &#123;&#125;);const Y = createClass([O], &#123; methodY() &#123; return 'Y'; &#125;&#125;);const A = createClass([X, Y], &#123; testName() &#123; return 'A'; &#125;&#125;);const B = createClass([Y], &#123; testName() &#123; return 'B'; &#125;&#125;);const C = createClass([A, B], &#123; constructor() &#123; this._name = 'custom C'; &#125;&#125;);let obj = new C();console.log(obj.isInstanceOf(O)); // trueconsole.log(obj.isInstanceOf(X)); // trueconsole.log(obj.isInstanceOf(Y)); // trueconsole.log(obj.isInstanceOf(A)); // trueconsole.log(obj.isInstanceOf(B)); // trueconsole.log(obj.isInstanceOf(C)); // trueconsole.log(obj.testName());console.log(obj.methodY()); ä»¥ä¸Šä»£ç ä»…ä¾›å­¦ä¹ ï¼Œè¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œæ¯”å¦‚æ„é€ å‡½æ•°ä¸­åªèƒ½è°ƒç”¨è‡ªèº«çš„ constructor å‡½æ•°ï¼Œæ— æ³•è°ƒç”¨çˆ¶ç±»çš„constructorã€‚è¿™æ˜¯ç”±äº JavaScript é™åˆ¶äº†æ— æ³•é€šè¿‡ X.prototype.constructor.apply() çš„æ–¹å¼è°ƒç”¨å…¶ä»–ç±»çš„æ„é€ å‡½æ•°ï¼ˆconstructor åªèƒ½åœ¨ new çš„æ—¶å€™è°ƒç”¨ï¼‰ï¼Œæƒ³ç»•å¼€è¿™ä¸ªé—®é¢˜çš„è¯ï¼Œåªèƒ½æ¢ä¸ªå‡½æ•°åï¼Œå« initializtionã€init ä¹‹ç±»çš„åå­—éƒ½è¡Œã€‚ demo ä»£ç åœ¨è¿™é‡Œï¼Œå¤šæ”¹å˜ä¸‹å‚æ•°è¯•è¯•ï¼Œå°è¯•ç†è§£å‰é¢æ‰€è¯´çš„ C3 MRO ç®—æ³•ã€‚ å­˜åœ¨çš„é—®é¢˜ä¸Šé¢çš„ä»£ç ï¼Œä¸ºäº†æ¨¡æ‹Ÿå¤šç»§æ‰¿ï¼Œåªå°†ç¬¬ä¸€ä¸ªçˆ¶ç±»æ”¾å…¥äº†å­ç±»çš„åŸå‹é“¾ä¸­ï¼Œè€Œå…¶ä»–çˆ¶ç±»åªèƒ½é€šè¿‡ mixin çš„æ–¹å¼å°†å…¶ prototype ä¸­çš„å±æ€§æ‹·è´åˆ°å­ç±»çš„ prototype ä¸­ã€‚è¿™å—é™äº JavaScript åŸå‹é“¾çš„æœºåˆ¶ï¼Œå³å›¾1ä¸­ __proto__ åªèƒ½æŒ‡å‘ä¸€ä¸ªç›®æ ‡ã€‚æ‰€ä»¥æ—¢ç„¶è¿™æ ·å®ç°çš„ï¼Œè‚¯å®šæ˜¯ä¸çœŸæ­£çš„å¤šç»§æ‰¿ç›¸æ‚–çš„ï¼Œåƒ C++ ä¸­æœ‰è™šå‡½æ•°è¡¨çš„æœºåˆ¶ï¼Œåœ¨å¤šç»§æ‰¿ä¸­è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼šå»æŸ¥è¡¨æ‰¾å‡ºçœŸæ­£çš„å‡½æ•°åœ°å€ã€‚è€Œæˆ‘ä»¬æ¨¡æ‹Ÿå‡ºçš„ JavaScript å¤šç»§æ‰¿ï¼Œæ˜¯å°†æ‰€æœ‰çˆ¶ç±»ä¸­çš„å‡½æ•°éƒ½æ‰åˆ°äº†ä¸€ä¸ª prototype ä¸­ï¼ˆåªä¸è¿‡æŒ‰ç…§ MRO ä¼˜å…ˆçº§é¡ºåºæ¥ä¾æ¬¡æ‰å…¥ï¼‰ã€‚ ä»”ç»†çœ‹ä¸Šé¢ä»£ç çš„è¯ä¼šå‘ç°ï¼Œc.testName() è¾“å‡ºçš„ä¸ Method Resolution Order ä¸­æ‰€è¿°çš„ç®—æ³•ä¸ç¬¦ã€‚åœ¨é‚£ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ C çš„ MRO åº”è¯¥ä¸º C A X B Y Oï¼Œç¤ºä¾‹ä»£ç ä¸­æŒ‰ç†æ¥è¯´åº”è¯¥ä¼˜å…ˆè°ƒç”¨ A ä¸­çš„ testName() å‡½æ•°ï¼Œå®é™…å´è¾“å‡ºäº†â€Bâ€â€¦â€¦å§æ§½ï¼Œè¿™ä»£ç æœ‰æ¯’çš„å§ï¼Ÿï¼Ÿ 123456789101112131415// inherit first parent through proto chainif (superCls &amp;&amp; typeof superCls === 'function') &#123; Ctor.prototype = Object.create(superCls.prototype); Ctor.prototype.constructor = Ctor;&#125;// mix other parents into prototype according to [Method Resolution Order]// NOTE: Ctor._meta.bases[0] always stands for the Ctor itselfif (Ctor._meta.bases.length &gt; 1) &#123; let providers = Ctor._meta.bases.slice(1).reverse(); providers.forEach(provider =&gt; &#123; // TODO: prototype of superCls is already inherited by __proto__ chain (provider !== superCls) &amp;&amp; mixinProps(Ctor.prototype, provider.prototype); &#125;);&#125; æ³¨æ„ä»£ç é‡Œæœ‰å¥ (provider !== superCls) çš„è¿‡æ»¤ï¼Œä½ å¯ä»¥æŠŠå®ƒå»äº†å†è¯•ä¸‹ demoã€‚ã€‚ç¬”è€…è¿™é‡Œä¹Ÿçº ç»“ï¼Œå› ä¸º superCls æ˜¯ç¬¬ä¸€ä¸ªçˆ¶ç±»ï¼Œå·²ç»åœ¨åŸå‹é“¾ä¸Šç»§æ‰¿äº†ï¼Œè€Œåœ¨æ ¹æ® MRO é¡ºåº mixin å…¶ä»–çˆ¶ç±»æ—¶ï¼ŒæŒ‰ç†åº”è¯¥å°†ç¬¬ä¸€ä¸ªçˆ¶ç±»è¿‡æ»¤æ‰ã€‚ç„¶è€Œä¸€æ—¦åŠ ä¸Šäº† (provider !== superCls) æ¡ä»¶åï¼Œå…¶ä»–çˆ¶ç±» prototype ä¸Šçš„å±æ€§éƒ½è¢«æ‹·è´åˆ°äº† Ctor.prototype ä¸Šï¼Œè€Œç¬¬ä¸€ä¸ªçˆ¶ç±»ä¸­çš„åŸå‹å´åœ¨ Ctor çš„åŸå‹é“¾ä¸Šï¼Œæ˜¾ç„¶ Ctor.prototype ä¸Šçš„å‡½æ•°ä¼˜å…ˆçº§æ›´é«˜ã€‚ é‚£æˆ‘ä»¬å°†è¿™ä¸ªæ¡ä»¶å¹²æ‰ï¼ç„¶è€Œä»æœ‰ bad caseã€‚ã€‚ å› ä¸ºå®ƒå°†æ‰€æœ‰çˆ¶ç±»ä¸­çš„ prototype éƒ½æ‹·è´åˆ°äº†è‡ªå·±èº«ä¸Šï¼ˆå®ƒæ˜æ˜ä¸åº”è¯¥æœ‰çš„ï¼‰ï¼Œè€Œå½“åˆ«äººå†ç»§æ‰¿å®ƒæ—¶ï¼Œåˆ«äººä¼šè¯¯ä»¥ä¸ºå®ƒå®šä¹‰äº†é‚£ä¹ˆå¤šå‡½æ•°ï¼Œå°±ä¼šå‡ºç°å‡½æ•°è¦†ç›–æ—¶çš„é¡ºåºä¸ MRO è®¡ç®—å‡ºçš„é¡ºåºä¸ä¸€è‡´çš„é—®é¢˜äº†ã€‚ å½’æ ¹åˆ°åº•è¿˜æ˜¯â€œæ²¡æœ‰æŸ¥å‡½æ•°è¡¨â€çš„é”…ï¼æˆ–è€…æˆ‘ä»¬åœ¨ä½¿ç”¨æ–¹å¼ä¸Šåšå¼ºçº¦æŸï¼Œå¤šç»§æ‰¿ä¸­çš„æ‰€æœ‰å‡½æ•°è°ƒç”¨éƒ½å¿…é¡»ç»è¿‡ç»Ÿä¸€çš„å½¢å¦‚ invoke(methodName, args) çš„æ¥å£ï¼Œåœ¨ invoke æ—¶æ ¹æ® MRO çš„ä¼˜å…ˆçº§é¡ºåºï¼Œä¾æ¬¡æŸ¥æ‰¾æœ‰æ—  methodName çš„å‡½æ•°ï¼Œå†çœŸæ­£è°ƒç”¨ã€‚ ä¸ºä»€ä¹ˆä¸å»ºè®®ç»§æ‰¿è¯´äº†é‚£ä¹ˆå¤šï¼Œç¬”è€…çš„ä½“ä¼šæ˜¯ä¸è¦æƒ³ç€ç»§æ‰¿ï¼Œä¸è¦æƒ³ç€ç»§æ‰¿ï¼Œä¸è¦æƒ³ç€ç»§æ‰¿ã€‚ã€‚ã€‚ JavaScript æœ¬èº«å°±ä¸æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œå¹²å˜›è¦è®©å®ƒåšå®ƒä¸æ“…é•¿çš„äº‹æƒ… =_= è™½ç„¶è¯­æ³•ç³–å·²ç»æä¾›äº†â€œç±»â€çš„æ”¯æŒï¼Œé‚£æ˜¯ç…§é¡¾æœ‰é¢å‘å¯¹è±¡æƒ³æ³•çš„äººï¼Œä½†å®ƒæœ¬è´¨ä¸Šä¸åŒäºå…¶ä»–è¯­è¨€ä¸­çš„ç»§æ‰¿ã€‚ä¸è¦æŠŠä»–äººçš„å®½å®¹å½“ä½œæ”¾ä»»çš„ç†ç”±ï¼Œèƒ½æ¨¡æ‹Ÿç»§æ‰¿å°±ä¸é”™äº†ï¼Œå°±åˆ«å†æƒ¦è®°â€œå¤šç»§æ‰¿â€äº†ã€‚ å†å›è¿‡å¤´æ¥æƒ³ä¸€æƒ³ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ç»§æ‰¿ï¼Ÿç»§æ‰¿æ˜¯ä¸€ç§å¼ºè€¦åˆå…³ç³»ï¼Œåˆ°åº•æ˜¯å¦æœ‰å¿…è¦ç”¨ç»§æ‰¿ï¼Œå¯ä»¥è€ƒè™‘ä¸‹åœ¨åº”ç”¨åœºæ™¯ä¸­æ˜¯å¦éœ€è¦ç”¨çˆ¶ç±»å‹å»æ¥æ”¶å­ç±»å‹çš„å®ä¾‹ï¼Œå³å­ç±»å‘çˆ¶ç±»çš„å‘ä¸Šè½¬å‹ã€‚åœ¨ JavaScript ä¸­ä¸ä¼šå‡ºç°è¿™æ ·çš„éœ€æ±‚ï¼Œåº”è¯¥æ›´å¤šä½¿ç”¨ç»„åˆçš„æ–¹å¼ä»¥ä»£æ›¿ç»§æ‰¿ï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹ä¹Ÿè®¸æ˜¯æ›´å¥½çš„æ–¹æ¡ˆã€‚ æ€»ç»“æœ¬æ–‡ä» JavaScript å¯¹â€œç±»â€çš„è¯­è¨€æœºåˆ¶å‡ºå‘ï¼Œå›é¡¾äº†éšç€è¯­è¨€çš„è¿›æ­¥ï¼Œâ€œç»§æ‰¿â€åœ¨ JavaScript ä¸­å˜å¾—è¶Šæ¥è¶Šæ–¹ä¾¿ã€‚ç„¶åè®¨è®ºäº†â€œå¤šç»§æ‰¿â€æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œä»‹ç»äº† Method Resolution Order (MRO)ï¼Œå¹¶å°è¯•åœ¨ JavaScript ä¸­æ¨¡æ‹Ÿâ€œå¤šç»§æ‰¿â€ã€‚ ç„¶è€Œï¼ŒJavaScript æœ¬è´¨ä¸Šä¸å­˜åœ¨ç»§æ‰¿çš„æ¦‚å¿µï¼Œè¿™ç§é€šè¿‡ prototype æ¨¡æ‹Ÿå‡ºæ¥çš„â€œå¤šç»§æ‰¿â€ä¸ä¼šå¾ˆå®Œç¾ï¼Œä½“éªŒä¸Šæ¯”åŸç”Ÿæ”¯æŒç»§æ‰¿æˆ–å¤šç»§æ‰¿çš„è¯­è¨€è¦å·®çš„å¤šã€‚å› æ­¤ä¸è¦æƒ³ç€å¤šç»§æ‰¿ï¼ŒJavaScript ä¸­ä¹Ÿä¸å»ºè®®ä½¿ç”¨ç»§æ‰¿ã€‚ ã€2018.4.4æ›´æ–°ã€‘ çœ‹äº†çŸ¥ä¹ç½‘å‹çš„è¯„è®ºï¼Œæ¨èäº†ä¸€ç¯‡æ–‡ç«  How to use classes and sleep at nightï¼Œè¯»å®Œåæ›´æ˜¯è§‰å¾—ä»¥å‰è‡ªå·±ä½¿ç”¨å¤šå±‚ç»§æ‰¿ï¼ˆéå¤šç»§æ‰¿ï¼‰æ˜¯å¤šä¹ˆ naive äº†ï¼Œæ–‡ä¸­ä¸»è¦ç»™å‡ºäº†è¿™å‡ ç‚¹å»ºè®®ï¼š å¯¹å¤–æä¾›APIæ—¶ä¸è¦ç›´æ¥æš´éœ² classã€‚å› ä¸ºè¿™æ ·ä½ ä¸çŸ¥é“åˆ«äººä¼šæ€ä¹ˆç”¨ä½ çš„ç±»ï¼Œä¼šè®©ä½ ä»Šåå‡çº§APIæ—¶å‡ºç°å¾ˆå¤š break changes ä¸è¦ä½¿ç”¨å¤šå±‚ç»§æ‰¿ã€‚å—¯â€¦æˆ‘åœ¨ä»¥å¾€çš„å·¥ä½œä¸­å°±è¿™ä¹ˆåšï¼Œæœ€åé™·å…¥äº†æ‰¾ bug çš„å‘ä¸­ï¼Œéƒ½ä¸çŸ¥é“çœŸæ­£æ‰§è¡Œçš„å‡½æ•°åœ¨å“ªä¸€å±‚ ä¸è¦è°ƒç”¨ super ä¸­çš„å‡½æ•°ï¼Œç›´æ¥è¦†ç›–å®ƒä»¬ã€‚againâ€¦æˆ‘åœ¨ä»¥å¾€çš„å·¥ä½œä¸­ä¹ŸçŠ¯äº†åŒæ ·çš„é”™è¯¯ï¼Œä¸ºäº†é‡ç”¨ super ä¸­çš„é€»è¾‘ï¼Œä½†åˆæœ‰éƒ¨åˆ†é€»è¾‘ä¸åŒï¼Œä¸å¾—ä¸ç»§ç»­æ‹†åˆ†æ›´ç»†ç²’åº¦çš„å‡½æ•°ï¼Œä»¥æ»¡è¶³å¯ä»¥å¤ç”¨ superã€‚ç»“æœä¸€æ ·ï¼Œæœ€åé™·å…¥äº†æ‰¾ bug çš„å‘ä¸­ã€‚ã€‚ã€‚ ä¸å»ºè®®å¯¹å¤–æä¾›ç±»ï¼Œå³ä½¿ä¸å¾—ä»¥è¿™ä¹ˆåšï¼Œæä¾›æ–¹ä¹Ÿè¦åšå¥½ç±»å‹æ ¡éªŒå’Œå¯¹â€œå¯è§æ€§â€çš„ä¿æŠ¤ï¼Œé˜²æ­¢ä½¿ç”¨æ–¹æ»¥ç”¨ã€‚è¦æä¾›æ›´åŠ æ˜ç¡®çš„APIï¼Œè®©ä½¿ç”¨æ–¹ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°æ¥æ»¡è¶³è‡ªå®šä¹‰éœ€æ±‚ï¼Œè€Œä¸æ˜¯è®©ä½¿ç”¨æ–¹æ¥ override å°è¯•å…¥å‘ Functional Programming Good Night å‚è€ƒèµ„æ–™You-Dont-Know-JS Java Doc - Polymorphism Python Doc - MRO C3 linearization Class declare in dojo]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>es</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸­çš„â€œå¤šç»§æ‰¿â€(1)]]></title>
    <url>%2Fblog%2F2018%2F03%2Fmulti-inheritance-1.html</url>
    <content type="text"><![CDATA[é¦–å…ˆ JavaScript ä¸­ä¸å­˜åœ¨å¤šç»§æ‰¿ï¼Œå¹¶ä¸”ä¹Ÿä¸æ¨èä½¿ç”¨ç»§æ‰¿ã€‚å¦‚æœä½ ä¹Ÿè¿™ä¹ˆè®¤ä¸ºçš„è¯ï¼Œé‚£ç¬”è€…çš„è§‚ç‚¹ä¹Ÿå°±å†™å®Œå•¦ 233333â€¦. å¦‚æœè¿˜æƒ³å›é¡¾ä¸‹ JavaScript ä¸­â€œç»§æ‰¿â€çš„å‰ä¸–ä»Šç”Ÿï¼Œä»¥åŠå¯¹â€œå¤šç»§æ‰¿â€çš„è®¨è®ºï¼Œä¸å¦¨çœ‹ä¸‹å»ã€‚ è‹¦è‹¦è¿½æ±‚çš„è¯­æ³•ç³–åœ¨ES6ä¹‹å‰ï¼Œåœ¨è¿˜æ²¡æœ‰ä½¿ç”¨ React, Vue ç­‰æ¡†æ¶ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨åšç¨å¤æ‚çš„å‰ç«¯é¡µé¢å’Œç»„ä»¶æ—¶ï¼Œä¼šç»å¸¸ç”¨æ¨¡å—åŒ–çš„æ€æƒ³å»å°è£…ä¸€äº›å¯å¤ç”¨çš„é€»è¾‘ï¼Œä¼šæƒ³ç€ç»™ JavaScript æä¾›â€œç±»â€çš„æ”¯æŒï¼Œå†ç»“åˆä¸€äº›è®¾è®¡æ¨¡å¼ï¼Œå°±å¯ä»¥åšå‡ºå„ç§çµæ´»çš„ä»£ç ç»“æ„ã€‚ æˆ‘ä»¬çŸ¥é“ JavaScript ä¸­å¹¶ä¸å­˜åœ¨ classï¼Œå­˜åœ¨çš„åªæ˜¯åŸå‹é“¾ï¼Œéƒ½æ˜¯é€šè¿‡å‡½æ•°å’Œ prototype å»å°è£…ä¸€äº›ä¸œè¥¿æ¥æ¨¡æ‹Ÿâ€œç±»â€ã€‚å¯ä»¥è¯´ä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªâ€œç±»â€ï¼Œåªè¦ä½ æ„¿æ„ã€‚ å…³äº prototype ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œç¬”è€…ä¸€ç›´æ”¶è—äº†è¿™å¼ å›¾ç»å¸¸ç”¨æ¥ç»™è‡ªå·±å¤ä¹ ã€‚ é‚£äº›å¹´ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ç­‰å¾…â€œç±»â€çš„è¯­æ³•ç³–ã€‚ã€‚ã€‚ æ¨¡æ‹Ÿä¸€ä¸ªç±»åœ¨å¼ºç±»å‹çš„è¯­è¨€ä¸­ï¼Œç±»æ˜¯ä¸ºäº†é¢å‘å¯¹è±¡ï¼Œå°±ä¸å¾—ä¸æå…¶ä¸‰å¤§ç‰¹æ€§ã€å°è£…ã€‘ã€ç»§æ‰¿ã€‘ã€å¤šæ€ã€‘ 1234567891011121314151617181920212223var Book = (function() &#123; // ç§æœ‰é™æ€å±æ€§ var privateStaticAttribute = 0; // ç§æœ‰é™æ€æ–¹æ³• var privateStaticMethod = function() &#123;&#125;; // æ„é€ å‡½æ•° return function(props) &#123; // ç§æœ‰å±æ€§ var title; // ç§æœ‰æ–¹æ³• this.getTitle = function() &#123; return title; &#125;; this.setTitle = function(title) &#123;&#125;; &#125;&#125;)();// å…¬æœ‰é™æ€æ–¹æ³•Book.staticMethod = function() &#123;&#125;;// å…¬æœ‰æ–¹æ³•Book.prototype.publicSharedMethod = function() &#123;&#125;; è¿™æ ·çš„ä»£ç æƒ³å¿…éƒ½å¾ˆé¢ç†Ÿï¼Œå€Ÿé‰´äº†å¼ºç±»å‹è¯­è¨€ä¸­çš„â€œç±»â€çš„æ¦‚å¿µï¼Œæ—¢ç„¶æ˜¯ç±»ï¼Œå®ƒé™¤äº†å°è£…ä¸€äº›å±æ€§å’Œæ–¹æ³•ï¼Œè¿˜éœ€è¦åšåˆ°å¯è§æ€§çš„æ§åˆ¶ã€‚ç”±äº JavaScript ä¸­æ²¡æœ‰å¯è§æ€§ä¿®é¥°ç¬¦ï¼Œåªèƒ½ç”¨é—­åŒ…æ¥æ¨¡æ‹Ÿ public ä¸ privateã€‚è™½ç„¶æ¯”èµ· Java ä¸­çš„ç±»è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è‡³å°‘åšåˆ°äº†ä¸€äº›å°è£…ï¼Œè€Œä¸”é€šå¸¸æˆ‘ä»¬è¿˜å¯ä»¥å»ºç«‹å‘½åè§„èŒƒï¼Œçº¦å®šä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§åæˆ–æ–¹æ³•åä¸ºç§æœ‰çš„ã€‚ æœ‰äº†ã€å°è£…ã€‘ä¹‹åï¼Œæˆ‘ä»¬å°±è¦è€ƒè™‘ã€ç»§æ‰¿ã€‘äº†ã€‚JavaScript ä¹Ÿæ²¡æœ‰ç»§æ‰¿çš„æœºåˆ¶ï¼Œéƒ½æ˜¯ä½¿ç”¨ prototype å»æ¨¡æ‹Ÿï¼Œå®ç°æ–¹å¼æœ‰å¾ˆå¤šï¼Œå‡ºç°äº†å„ç§å„æ ·çš„â€œç»§æ‰¿â€æ–¹æ³•ã€‚åŸå‹å¼ç»§æ‰¿ã€ç±»å¼ç»§æ‰¿ï¼Œç”šè‡³æ¨¡æ‹Ÿsuperå…³é”®å­—ï¼Œæä¾› Class.extend()ã€this.super() ç­‰ä¾¿åˆ©çš„ç”¨æ³•ï¼Œéƒ½æ˜¯è¿ç”¨é—­åŒ…å’Œ prototype å®ç°çš„ Syntactic sugarã€‚è¿™ä¹Ÿå°±æ˜¯è¿‡å» Prototype.js è¿™æ ·çš„åº“å¯¹å‰ç«¯äº§ç”Ÿçš„å½±å“ã€‚ è€Œè‡³äºã€å¤šæ€ã€‘ï¼Œè¿™æ˜¯åªåœ¨å¼ºç±»å‹è¯­è¨€ä¸­éœ€è¦è€ƒè™‘çš„ï¼Œå½“æ— æ³•åœ¨ç¼–è¯‘æ—¶ç¡®å®šä¸€ä¸ªå¯¹è±¡çš„ç±»å‹æ—¶ï¼Œåªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šä¸€ä¸ªå‡½æ•°è¦ä»å“ªå„¿å»è·å–ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ï¼šç”¨çˆ¶ç±»å‹çš„å¼•ç”¨å»æ¥æ”¶å­ç±»å‹çš„å¯¹è±¡ï¼Œä½¿ç”¨çˆ¶ç±»å‹ä¸­å®šä¹‰çš„å‡½æ•°å»ç»Ÿä¸€æ“ä½œä¸åŒå­ç±»çš„å¯¹è±¡ï¼Œå¹¶ä¸”å­ç±»ä¸­å¯ä»¥è¦†ç›–çˆ¶ç±»ä¸­çš„å‡½æ•°ã€‚æ­£å·§ JavaScript çš„å¼±ç±»å‹ç‰¹å¾ï¼Œä¸å­˜åœ¨ç¼–è¯‘æ—¶è¦ç¡®å®šç±»å‹ï¼Œå¤©ç„¶æ”¯æŒå¤šæ€ã€‚ åˆ°äº†ES5åES5æœ‰äº†Object.create()ï¼Œè®©æˆ‘ä»¬æ›´ä¾¿æ·åœ°ä½¿ç”¨åŸå‹ç»§æ‰¿ï¼ŒObject.getPrototypeOfã€Object.setPrototypeOf å¯ä»¥æ›´è‡ªç”±åœ°æ“æ§åŸå‹é“¾ã€‚ 123456789101112131415161718192021222324252627282930313233var Book = function(title) &#123; Object.defineProperty(this, 'title', &#123; writable: false, value: title &#125;);&#125;;Book.prototype.getTitle = function() &#123; return this.title; &#125;;var EBook = function(link) &#123; Object.defineProperty(this, 'link', &#123; writable: false, value: link &#125;);&#125;;EBook.prototype = Object.create(Book.prototype, &#123; download: &#123; writable: false, value: function() &#123; console.log('Start...'); &#125; &#125;&#125;);// ä¸€å®šè¦ä¿®æ­£ constructorEBook.prototype.constructor = EBook;// testingvar jsorz = new EBook('//jsorz.cn');console.log(jsorz instanceof Book);console.log(jsorz instanceof EBook);console.log(jsorz.constructor === EBook);console.log(jsorz.hasOwnProperty('getTitle') === false);console.log(Object.getPrototypeOf(jsorz) === EBook.prototype);console.log(Object.getPrototypeOf(jsorz).constructor === EBook); æ³¨ï¼šObject.getPrototypeOf è¿”å›çš„å³å›¾1ä¸­ __proto__ çš„æŒ‡å‘ã€‚ ES6ä¸­çš„ç»§æ‰¿åœ¨ES2015ä¸­æœ‰äº† class è¯­æ³•ç³–ï¼Œæœ‰äº† extendsã€superã€static è¿™æ ·çš„å…³é”®å­—ï¼Œæ›´åƒå¼ºç±»å‹è¯­è¨€ä¸­çš„â€œç±»â€äº†ã€‚ 12345678910111213141516171819202122class Book &#123; constructor(props) &#123; this._title = props.title; &#125; get title() &#123; return this._title; &#125; static staticMethod() &#123;&#125; toString() &#123; return `Book_$&#123; this._title &#125;`; &#125;&#125;class EBook extends Book &#123; constructor(props) &#123; super(props); this._link = props.link; &#125; set link(val) &#123; this._link = val; &#125; toString() &#123; return `Book_$&#123; this._link &#125;`; &#125;&#125; ä¸Šé¢çš„è¯­æ³•ç¡®å®æ¸…æ™°ç®€å•äº†ï¼Œæˆ‘ä»¬å†çœ‹ä¸‹ç¼–è¯‘æˆES5åçš„ä»£ç æ˜¯æ€æ ·çš„~ 123456789101112131415161718192021222324252627282930313233343536var Book = function () &#123; function Book(props) &#123; _classCallCheck(this, Book); this._title = props.title; &#125; _createClass(Book, [&#123; key: "toString", // çœç•¥... &#125;, &#123; key: "title", // çœç•¥... &#125;], [&#123; key: "staticMethod", // çœç•¥... &#125;]); return Book;&#125;();var EBook = function (_Book) &#123; function EBook(props) &#123; // çœç•¥... &#125; _inherits(EBook, _Book); _createClass(EBook, [&#123; key: "toString", // çœç•¥... &#125;, &#123; key: "link", // çœç•¥... &#125;]); return EBook;&#125;(Book); ç¤ºä¾‹ç”Ÿæˆçš„ä»£ç å¯ä»¥ç”¨ Babel REPL æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ° ES6 æä¾›çš„ class è¯­æ³•çœŸçš„æ˜¯ Syntactic sugarï¼Œæœ¬è´¨ä¸Šä¸æˆ‘ä»¬ç”¨ ES5 ç”šè‡³æ›´æ—©æ—¶æ¨¡æ‹Ÿâ€œç±»â€ä¸ç»§æ‰¿å¦‚å‡ºä¸€è¾™ã€‚å…¶ä¸­é‡ç‚¹çš„ _inherits å‡½æ•°å¦‚ä¸‹ï¼š 1234567891011121314function _inherits(subClass, superClass) &#123; if (typeof superClass !== "function" &amp;&amp; superClass !== null) &#123; throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); &#125; subClass.prototype = Object.create(superClass &amp;&amp; superClass.prototype, &#123; constructor: &#123; value: subClass, enumerable: false, writable: true, configurable: true &#125; &#125;); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;&#125; å°ç»“JavaScript å¾ˆå®¹æ˜“æ¨¡æ‹Ÿä¸€ä¸ªâ€œç±»â€ï¼Œå¹¶ä¸”å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šåšåˆ°é¢å‘å¯¹è±¡ä¸­çš„ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚ä»æœ€åˆå»æ¨¡æ‹Ÿä¸€ä¸ªâ€œç±»â€ï¼Œåˆ° ES5 æä¾›æ›´ä¾¿æ·çš„åŸå‹æ“æ§APIï¼Œåˆ° ES6 ä¸­æä¾›æ›´å¤šâ€œç±»â€ç›¸å…³çš„å…³é”®å­—ï¼Œéƒ½æ˜¯åœ¨å¸®æˆ‘ä»¬å‡å° JavaScript ä¸­é¢å‘å¯¹è±¡çš„ä½¿ç”¨æˆæœ¬ï¼Œä½¿å®ƒçœ‹èµ·æ¥åƒè·Ÿå®ƒæ²¡æœ‰åŠæ¯›é’±å…³ç³»çš„ Java è¯­è¨€ã€‚ è™½ç„¶ JavaScript ä¸­çš„â€œç»§æ‰¿â€å¹¶ä¸æ˜¯çœŸæ­£çš„ç»§æ‰¿ï¼Œâ€œç±»â€ä¹Ÿä¸æ˜¯çœŸæ­£çš„â€œç±»â€ï¼Œç›¸æ¯” Java è‚¯å®šè¿˜æœ‰å¾ˆå¤šå®ç°ä¸äº†çš„åœ°æ–¹ï¼Œæ¯”å¦‚ abstract classã€Interface ç­‰ï¼Œåªèƒ½é€šè¿‡ä¸€äº› tricky çš„åŠæ³•å»æ¨¡æ‹Ÿã€‚å› æ­¤ JavaScript ä¸­æ‰€è°“çš„â€œç»§æ‰¿â€ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥ç»„ç»‡ä»£ç ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>es</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç»„åˆè®¡æ•°é—®é¢˜]]></title>
    <url>%2Fblog%2F2018%2F03%2Fmath-counting-question.html</url>
    <content type="text"><![CDATA[å‡è®¾æœ‰ Aã€Bã€C ä¸‰ç§è¯ä¸¸ï¼Œç°åœ¨è¦ä» Aã€Bã€C ä¸‰ç§è¯ä¸¸ä¸­å–100ç²’è¿›è¡Œè°ƒå‰‚ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š Aã€Bã€C è¿™ä¸‰ç§è¯ä¸¸æ¯ç§è‡³å°‘æœ‰1ç²’ ä¸è€ƒè™‘è¯ä¸¸çš„é¡ºåº åŒç§è¯ä¸¸æ¯ç²’éƒ½ç›¸åŒ é—®ï¼šè¯å“è°ƒå‰‚çš„ç»„åˆå…±æœ‰å¤šå°‘ç§ï¼Ÿ æ’åˆ—ç»„åˆé¦–å…ˆå›é¡¾ä¸‹æ’åˆ— (Permutation) ä¸ç»„åˆ (Combination) çš„åŸºæœ¬å…¬å¼ $ P_n^k = C_n^k \times P_k^k = \frac{n!}{(n-k)!} $ ä¸Šé¢çš„è¯å“è°ƒå‰‚é—®é¢˜ï¼Œéœ€è¦è½¬åŒ–ä¸‹æ¨¡å‹ï¼Œå…ˆå°†â€œ100ç²’â€æ”¹ä¸ºâ€œ5ç²’â€ï¼Œçœ‹ä¸‹æœ‰æ²¡æœ‰è§„å¾‹ å¦‚å›¾ï¼Œå‡†å¤‡å¥½5ä¸ªæ”¾è¯ä¸¸çš„ç›˜å­ï¼Œå†åœ¨ç›˜å­ä¹‹é—´æ”¾å…¥2å—â€œéš”æ¿â€ï¼Œå¹¶è§„å®šåœ¨å·¦èµ·ç¬¬1å—éš”æ¿çš„å·¦è¾¹éƒ½æ”¾ Aï¼Œç¬¬2ã€3å—éš”æ¿ä¸­é—´éƒ½æ”¾Bï¼Œç¬¬3å—éš”æ¿å³è¾¹éƒ½æ”¾Cã€‚5ä¸ªç›˜å­å…±æœ‰4ä¸ªé—´éš™ï¼Œå› æ­¤ç»„åˆæ•°å°±æ˜¯ $ C_4^2 $ åŒç†ï¼Œæ¢æˆâ€œ100ç²’â€åï¼Œè¯å“è°ƒå‰‚çš„ç»„åˆå…±æœ‰ $ C_{100-1}^{3-1} $ ç§ ä¸‰è§’å½¢é—®é¢˜æ­¤é—®é¢˜æ¥è‡ª ä¸€ä¸ªå¹³åº¸çš„ç å†œ ä¸‹å›¾ä¸­æœ‰å¤šå°‘ä¸ªä¸‰è§’å½¢ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„è®¡æ•°ç­–ç•¥ å…ˆå°è¯•ç”¨ç»„åˆè®¡æ•°æ¥æ±‚è§£ï¼Œå¦‚æœæ¯ä¸ªç‚¹ä¸å…¶ä»–æ‰€æœ‰ç‚¹ éƒ½å­˜åœ¨è¿çº¿çš„è¯ï¼Œé‚£ä¹ˆä¸‰è§’å½¢ä¸ªæ•°å°±å®¹æ˜“ç®—äº†ï¼Œå°±æ˜¯ ä»»æ„3ä¸ªç‚¹çš„ç»„åˆæ•° - 3ç‚¹åœ¨ä¸€æ¡ç›´çº¿ä¸Šçš„ç»„åˆæ•° å…¶ä¸­â€œä»»æ„3ä¸ªç‚¹çš„ç»„åˆæ•°â€å°±æ˜¯ $ C_n^3 $ è€Œâ€œ3ç‚¹åœ¨ä¸€æ¡ç›´çº¿ä¸Šçš„ç»„åˆæ•°â€åªè¦æ‰¾å‡ºæ‰€æœ‰çš„ç›´çº¿ï¼Œå†å¯¹ç›´çº¿ä¸Šçš„èŠ‚ç‚¹æ•°æ±‚ $ C_k^3 $ ä½†æ˜¯å¾ˆé—æ†¾ï¼Œä¸Šå›¾ä¸­ä¸æ»¡è¶³â€œæ¯ä¸ªç‚¹ä¸å…¶ä»–æ‰€æœ‰ç‚¹ éƒ½å­˜åœ¨è¿çº¿â€ã€‚ã€‚ã€‚ã€‚ https://myst729.github.io/#/blog/articles/2016/counting-triangles/ æä¾›äº†ä¸€ç§å·§å¦™çš„æ–¹æ³• å°†ä¸‰è§’å½¢åšæ‹“æ‰‘å˜æ¢ï¼ˆTopologyï¼‰ï¼Œå³å¯ç”¨å¦‚ä¸‹æ•°æ®ç»“æ„ç®€å•çš„è¡¨ç¤ºå›¾å½¢ä¸­çš„ç‚¹å…³ç³» 123456[ ['A', 'A', 'A', 'A'], ['B', 'C', 'D', 'E'], ['H', 'G', 'F', 'E'], ['H', 'I', 'J', 'K']] å†éå†å˜æ¢åçš„çŸ©å½¢ï¼Œåªè¦æ»¡è¶³çŸ©å½¢çš„4ä¸ªèŠ‚ç‚¹æœ‰ä¸”åªæœ‰3ä¸ªä¸ç›¸åŒçš„èŠ‚ç‚¹ï¼Œå³ä»£è¡¨ä¸€ä¸ªä¸‰è§’å½¢ æœ€åã€‚ã€‚ã€‚ç­”æ¡ˆæ˜¯ 24]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>Math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RN License æ›´æ”¹]]></title>
    <url>%2Fblog%2F2018%2F02%2Fopen-source-license.html</url>
    <content type="text"><![CDATA[ã€Newsã€‘ä¸¤å¤©å‰ï¼ŒReact Native å°† License æ”¹æˆäº† MITï¼Œè¯¦è§Commit è¿™æ˜¯åŠå¹´æ¥ Facebook ç¬¬äºŒæ¬¡ä¿®æ”¹ React ç›¸å…³çš„åè®®äº†ï¼Œæ­¤å‰é¥±å—å–·å‡»çš„ BSD + Patents æ²¡å‡ å¤©å°±è®¤æ€‚äº†ã€‚ä¸ä¹‹å‰çš„ Commit ç±»ä¼¼ï¼ŒReact Native ä¹Ÿæ‰“å¼€äº† MIT çš„å¤§é—¨ã€‚ å›¾ç‰‡å¼•ç”¨è‡ª å¦‚ä½•é€‰æ‹©å¼€æºè®¸å¯è¯ï¼Ÿ MITæ˜¯å’ŒBSDä¸€æ ·å®½æ¾çš„è®¸å¯åè®®ï¼Œä½œè€…åªæƒ³ä¿ç•™ç‰ˆæƒï¼Œè€Œæ— ä»»ä½•å…¶ä»–äº†é™åˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¿…é¡»åœ¨ä½ çš„å‘è¡Œç‰ˆé‡ŒåŒ…å«åŸè®¸å¯åè®®çš„å£°æ˜ï¼Œæ— è®ºä½ æ˜¯ä»¥äºŒè¿›åˆ¶å‘å¸ƒçš„è¿˜æ˜¯ä»¥æºä»£ç å‘å¸ƒçš„ã€‚]]></content>
      <categories>
        <category>News</category>
      </categories>
      <tags>
        <tag>News</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è„šæœ¬deferä¸async]]></title>
    <url>%2Fblog%2F2017%2F11%2Fscript-defer-async.html</url>
    <content type="text"><![CDATA[åœ¨ä¹‹å‰ä¸€ç¯‡ç¬”è®°ä¸­å†™åˆ°ï¼š defer æºè‡ªIEï¼Œä¿è¯æ‰§è¡Œé¡ºåºï¼Œéƒ½ä¼šåˆ° domReady åå†æ‰§è¡Œ async ç°ä»£æ ‡å‡†ï¼Œä¸ä¿è¯æ‰§è¡Œé¡ºåºï¼Œä»€ä¹ˆæ—¶å€™ä¸‹è½½å®Œå°±ä»€ä¹ˆæ—¶å€™æ‰§è¡Œ ç°åœ¨å°±æ¥å…·ä½“å±•å¼€è§£é‡Šä¸‹~ MDNä»‹ç»defer This Boolean attribute is set to indicate to a browser that the script is meant to be executed after the document has been parsed, but before firing DOMContentLoaded. This attribute must not be used if the src attribute is absent (i.e. for inline scripts), in this case it would have no effect. To achieve a similar effect for dynamically inserted scripts use async=false instead. Scripts with the defer attribute will execute in the order in which they appear in the document. async A boolean attribute indicating that the browser should, if possible, execute the script asynchronously. This attribute must not be used if the src attribute is absent (i.e. for inline scripts). If it is included in this case it will have no effect. Dynamically inserted scripts execute asynchronously by default, so to turn on synchronous execution (i.e. scripts execute in the order they were loaded) set async=false åˆ’é‡ç‚¹ defer ä¸ async ä¸é€‚ç”¨äºå†…è”è„šæœ¬ï¼Œæµè§ˆå™¨ç›´æ¥æ— è§†è¿™ä¸ªå±æ€§ æ²¡æœ‰ defer æˆ– async æ—¶ï¼Œæµè§ˆå™¨é‡åˆ° &lt;script&gt; å°±ä¼šç«‹å³åŠ è½½å¹¶æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ï¼Œâ€œç«‹å³â€æŒ‡çš„æ˜¯å®ƒæ˜¯ä¸€ä¸ªåŒæ­¥çš„è¿‡ç¨‹ï¼Œå®ƒä¼šä¸­æ–­åç»­ html æ–‡æ¡£çš„è§£æï¼ˆç›´åˆ° &lt;script&gt; æ‰§è¡Œå®Œåï¼‰ æœ‰ async æ—¶ï¼Œ&lt;script&gt; çš„åŠ è½½ä¸æ‰§è¡Œä¸ä¼šé˜»å¡åç»­ html æ–‡æ¡£çš„è§£æå’Œæ¸²æŸ“ï¼Œå³ &lt;script&gt; æ˜¯å¼‚æ­¥çš„ã€å¹¶è¡Œçš„ã€‚ æœ‰ defer æ—¶ï¼Œ&lt;script&gt; çš„åŠ è½½ä¹Ÿæ˜¯ä¸åç»­ html æ–‡æ¡£çš„å¤„ç†å¹¶è¡Œçš„ï¼Œä½†æ˜¯ &lt;script&gt; çš„æ‰§è¡Œæ˜¯åœ¨æ‰€æœ‰æ–‡æ¡£è§£æå®Œæˆä¹‹åï¼Œä¸” DOMContentLoaded äº‹ä»¶ä¹‹å‰æ‰æ‰§è¡Œã€‚ ä¸€å›¾æµ éœ€è¦è¡¥å……è¯´æ˜çš„æ˜¯ï¼š ä¸ç®¡æ˜¯ä»€ä¹ˆ scriptï¼Œå®ƒæ‰§è¡Œæ—¶ï¼ˆéåŠ è½½ï¼‰ä¸€å®šæ˜¯ä¼šé˜»å¡ html è§£æçš„ï¼Œå› ä¸ºæµè§ˆå™¨ä¸çŸ¥é“ script é‡Œæœ‰æ²¡æœ‰ document.write document.append è¿™æ ·çš„æ”¹å˜æ–‡æ¡£ç»“æ„çš„æ“ä½œï¼Œæ‰€ä»¥æµè§ˆå™¨è‚¯å®šéœ€è¦åœä¸‹æ¥ç­‰ script æ‰§è¡Œå®Œå†ç»§ç»­è§£ææ–‡æ¡£ã€‚ å½“æœ‰å¤šä¸ª defer è„šæœ¬æ—¶ï¼Œå®ƒä»¬æœ€åæ‰§è¡Œæ—¶æ˜¯æŒ‰ç…§åŠ è½½æ—¶çš„é¡ºåºæ‰§è¡Œçš„ è€Œå¤šä¸ª async è„šæœ¬æ—¶ï¼Œæ— æ³•ä¿è¯é¡ºåºï¼Œå®ƒä»¬æ˜¯æŒ‰ç…§â€è°å…ˆåŠ è½½å®Œï¼Œå°±è°å…ˆæ‰§è¡Œâ€œçš„è§„åˆ™ åº”ç”¨åœºæ™¯ é¦–å…ˆå…»æˆå¥½ä¹ æƒ¯ï¼Œ&lt;script&gt; å°½é‡éƒ½æ’åœ¨ &lt;body&gt; çš„æœ€å è„šæœ¬çš„å¹¶è¡ŒåŠ è½½ï¼Œå¯ç”¨æ¥åŠ å¿«é¦–å±æ˜¾ç¤ºï¼Œå½“ä¾èµ–å¤šä¸ªå¤–éƒ¨è„šæœ¬æ—¶ï¼Œæ•ˆæœå°±æ¯”è¾ƒæ˜æ˜¾ ä¸€äº›åŠ¨æ€æ’å…¥çš„ &lt;script&gt; æ¯”å¦‚ pollyfill ä¹‹ç±»çš„ï¼Œå¯ä»¥ä½¿ç”¨ defer è€Œä¸€äº›ä¸ä¼šä¸å…¶ä»–ä»»ä½•è„šæœ¬å‘ç”Ÿä¾èµ–çš„ &lt;script&gt;ï¼Œåˆ™ async ä¼šæ›´é€‚åˆ]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>æµè§ˆå™¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°¾è°ƒç”¨å°¾é€’å½’]]></title>
    <url>%2Fblog%2F2017%2F10%2Ftail-call-recursion.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡æ¥æºäºä¸€é“é¢˜ç›®ï¼šä»¥ä¸‹é€’å½’å‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºçš„é£é™©ï¼Œè¯·é—®å¦‚ä½•ä¼˜åŒ–ï¼Ÿ 123function factorial (n) &#123; return n * factorial(n - 1);&#125; æ™®é€šé€’å½’ä¸€çœ‹ï¼Œé€’å½’æ²¡å†™é€€å‡ºæ¡ä»¶ï¼Œå¤ª easy äº† 1234function factorial (n) &#123; if (n === 1) return n; return n * factorial(n - 1);&#125; åº”è¯¥æ˜¯é¢˜ç›®æ•…æ„åŸ‹çš„å‘ï¼Œå½“nå¾ˆå¤§çš„æ—¶å€™ï¼Œä»ä¼šæº¢å‡ºï¼Œå› ä¸ºå‡½æ•°è°ƒç”¨æ—¶ä¼šä¸æ–­çš„å‹æ ˆ æ–‡è‰ºé€’å½’å‡ºé¢˜è€…çš„æ„å›¾åº”è¯¥æ˜¯ä½¿ç”¨å°¾é€’å½’~~ï¼ˆè§å‚è€ƒé“¾æ¥ï¼‰ 1234function factorial (n, total = 1) &#123; if (n === 1) return total; return factorial(n - 1, n * total);&#125; ç„¶è€Œæ”¾åœ¨æµè§ˆå™¨è¯•ä¸‹ï¼Œfactorial(10000)ä»æ˜¯æº¢å‡ºçš„ã€‚ã€‚ å› ä¸ºï¼ŒES6 çš„å°¾è°ƒç”¨ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¼€å¯ï¼Œæ­£å¸¸æ¨¡å¼æ˜¯æ— æ•ˆçš„~ å°¾é€’å½’è½¬åŒ–123456789101112131415161718192021function tailCall (f) &#123; let value; let active = false; const argsQueue = []; return function () &#123; argsQueue.push(arguments); if (!active) &#123; active = true; while (argsQueue.length) &#123; value = f.apply(null, argsQueue.shift()); &#125; active = false; return value; &#125; &#125;&#125;const factorial = tailCall(function (n, total = 1) &#123; if (n === 1) return total; return factorial(n - 1, n * total);&#125;); å½“æ‰§è¡Œfactorial(3)çš„æ—¶å€™ï¼Œå®ƒä¼šå…ˆåœ¨argsQueue.push([3, 1])ï¼Œç„¶åæ‰§è¡Œåˆ°whileå¾ªç¯é‡Œï¼Œè¿™æ—¶æ‰§è¡Œf.apply(null, [3, 1])å…¶å®æ‰æ˜¯çœŸæ­£è¦é€’å½’çš„å‡½æ•°ã€‚ ç„¶ååˆæ‰§è¡Œäº†factorial(2, 3)ï¼Œå› æ­¤åˆåœ¨argsQueue.push([2, 3])ã€‚è€Œç”±äºå‰ä¸€æ¬¡å·²ç»å°†activeç½®ä½äº†ï¼Œæ‰€ä»¥factorial(2, 3)å°±ç®—æ‰§è¡Œç»“æŸäº†ï¼Œæ— è¿”å›å€¼ å›åˆ°ç¬¬ä¸€æ¬¡çš„whileé‡Œï¼Œå‘ç°argsQueueå¤šäº†æ¡[2, 3]ï¼Œäºæ˜¯ç»§ç»­è°ƒç”¨f.apply(null, [2, 3])ã€‚åŒç†ï¼Œä¼šæ‰§è¡Œfactorial(1, 6)ï¼Œåˆåœ¨argsQueue.push([1, 6])ã€‚ å†æ¬¡å›åˆ°ç¬¬ä¸€æ¬¡çš„whileé‡Œï¼Œå‘ç°argsQueueåˆå¤šäº†æ¡[1, 6]ï¼Œäºæ˜¯ç»§ç»­è°ƒç”¨f.apply(null, [1, 6])ã€‚è€Œæ³¨æ„æ­¤æ—¶f(1, 6)ç›´æ¥è¿”å›totaläº†ï¼Œå› æ­¤argsQueueé‡Œæ²¡æœ‰æ–°å¢å‚æ•°äº†ï¼Œäºæ˜¯factorialå°±è¿”å›äº†value = 6 ä»¥ä¸Šè¿‡ç¨‹è¯´ç™½äº†ä»æ˜¯é€’å½’ï¼ŒåŒºåˆ«åœ¨äºæ™®é€šé€’å½’æ—¶å‡½æ•°è°ƒç”¨é‡Œç»§ç»­å‡½æ•°è°ƒç”¨ï¼Œéœ€è¦ä¿å­˜å‡½æ•°è°ƒç”¨å‰çš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ä¿¡æ¯ã€‚è€Œä½¿ç”¨äº†å°¾é€’å½’è½¬åŒ–åï¼Œé€’å½’è°ƒç”¨æ—¶åªä¼šå‘å…±äº«çš„argsQueueé‡Œå‹å…¥å‚æ•°ï¼Œåœ¨å¤–å±‚é€šè¿‡å¾ªç¯çš„æ–¹å¼ï¼ˆç›´åˆ°argsQueueä¸ºç©ºï¼‰é€æ­¥è°ƒç”¨å‡½æ•°ä¸»ä½“ã€‚ æ€»ç»“æ‰“ä¸ªæ¯”æ–¹æ¥è¯´ï¼Œæ™®é€šé€’å½’çš„è¿‡ç¨‹æœ‰ç‚¹åƒæ·±åº¦ä¼˜å…ˆéå†ï¼Œå‡½æ•°è°ƒç”¨ä¸€å±‚å±‚æ·±å…¥ä¸‹å»ï¼Œéœ€è¦ä¸æ–­ä¿å­˜ context ä¿¡æ¯ï¼Œæœ€åå†é€å±‚å›æº¯ã€‚å› æ­¤å‡½æ•°è°ƒç”¨æ ˆæ˜¯è¿ç»­å¢é•¿çš„ï¼Œå®¹æ˜“å‘ç”Ÿæ ˆæº¢å‡ºã€‚ è€Œå°¾é€’å½’ä¼˜åŒ–åçš„é€’å½’è¿‡ç¨‹å°±åƒå¹¿åº¦ä¼˜å…ˆéå†ï¼Œå‡½æ•°è°ƒç”¨ååªåœ¨é˜Ÿåˆ—é‡Œå¢åŠ ä¸€æ¡å‚æ•°ï¼Œå¹¶ä¸æ˜¯é€å±‚æ·±å…¥ï¼Œè€Œæ˜¯é€šè¿‡å¾ªç¯é€æ¸æ‰§è¡Œå‡½æ•°ä½“ã€‚å› æ­¤å‡½æ•°è°ƒç”¨æ ˆæ˜¯å‹å…¥1æ¬¡å†å¼¹å‡º1æ¬¡ï¼Œä¸ä¼šå‘ç”Ÿæº¢å‡º~ è¿™æ˜¯å°¾é€’å½’ä¼˜åŒ–åçš„æ‰§è¡Œç»“æœï¼Œè™½ç„¶ç»“æœå€¼å·²ç»è¶…å‡º MAX_VALUEï¼Œä½†å‡½æ•°è°ƒç”¨ä¸ä¼šæº¢å‡º å‚è€ƒé“¾æ¥stackoverflow: What is tail recursion? ruanyifeng: å°¾è°ƒç”¨ä¼˜åŒ– ruanyifeng: es6å°¾é€’å½’ä¼˜åŒ–]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†çœ‹reduce]]></title>
    <url>%2Fblog%2F2017%2F08%2Fmore-about-reduce.html</url>
    <content type="text"><![CDATA[å‰ä¸€ç¯‡ä¸­æåˆ°äº†å¯åˆ©ç”¨reduceå‡½æ•°åšæ•°ç»„æ‰å¹³åŒ–ä»¥åŠæ•°æ®ç»Ÿè®¡ä¹‹ç±»çš„æ“ä½œï¼Œè¿™ç¯‡ä¸­å°†ä¼šä»‹ç»åˆ©ç”¨ reduce å®ç°çš„æ›´é«˜çº§æ“ä½œã€‚ reduce çš„ç”¨æ³•ä¸º arr.reduce(callback[, initialValue])ï¼Œåœ¨MDNä¸­å¯¹ initialValue æœ‰è¿™ä¹ˆä¸€æ®µè§£é‡Šã€‚ Value to use as the first argument to the first call of the callback. If no initial value is supplied, the first element in the array will be used. Calling reduce() on an empty array without an initial value is an error. callback å‡½æ•°æ¥å—4ä¸ªå‚æ•°ï¼šä¹‹å‰å€¼ã€å½“å‰å€¼ã€ç´¢å¼•å€¼ä»¥åŠæ•°ç»„æœ¬èº«ã€‚è‹¥æŒ‡å®š initialValueï¼Œåˆ™å½“ä½œæœ€åˆä½¿ç”¨çš„ previous å€¼ï¼›å¦‚æœä¸æŒ‡å®š initialValueï¼Œåˆ™ä½¿ç”¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸º previous åˆå§‹å€¼ï¼ŒåŒæ—¶ current å¾€åé¡ºå»¶ã€‚å› æ­¤ä¸æŒ‡å®š initialValue æ—¶ä¼šæ¯”æŒ‡å®šæ—¶å°‘ä¸€æ¬¡è¿­ä»£ã€‚ 123[1, 2, 3].reduce((previous, current) =&gt; previous * current)[1, 2, 3].reduce((previous, current) =&gt; previous * current, 0) ç”¨è¿™ä¸ªç®€å•çš„ä¾‹å­å¯ä»¥ä½“ä¼šå‡ºæœ‰æ—  initialValue çš„å·®åˆ«äº†å§ã€‚ ç»™åŠ›ä¸€ç‚¹æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªé»‘ç§‘æŠ€ï¼Œåˆ©ç”¨ reduce ç»“åˆå‡½æ•° bind å¯ä»¥å®ç°å‡½æ•°çš„é“¾å¼è°ƒç”¨ 1234567891011121314// ç»™å®š2ä¸ªå­—ç¬¦ä¸²å¤„ç†å‡½æ•°const reverse = str =&gt; str.split('').reverse().join('');const upper = str =&gt; str.toUpperCase();// å†™æ³•1[reverse, upper].reduce((prev, action) =&gt; action(prev), 'abcdefg');// å†™æ³•2const compose = (...fns) =&gt; &#123; return (str) =&gt; &#123; return fns.reduce((prev, action) =&gt; action(prev), str); &#125;&#125;;compose(reverse, upper)('abcdefg'); å†ç»™åŠ›ä¸€ç‚¹æ³¨ï¼šä»¥ä¸‹ä»£ç å‡ºè‡ªåå¹´è¸ªè¿¹(æœˆå½±)çš„å‡½æ•°å¼ç¼–ç¨‹å…¥é—¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253class Task&#123; constructor()&#123; this.plugins = &#123; '*': [] &#125;; this.pluginId = 0; &#125; use(router, functor)&#123; if(typeof router === 'function')&#123; [router, functor] = ['*', router]; &#125; this.plugins[router] = this.plugins[router] || []; this.plugins[router].push(&#123; functor, id: ++this.pluginId &#125;); &#125; dispatch(router, ...args)&#123; let plugins = this.plugins['*']; if(router !== '*')&#123; plugins = plugins.concat(this.plugins[router] || []); &#125; plugins.sort((a, b) =&gt; a.id - b.id); // å…³é”®åœ¨è¿™é‡Œ let entrace = plugins .map(plugin =&gt; plugin.functor.bind(this, ...args)) // æ³¨æ„æ—  initialValue æ—¶, aæŒ‡å‘å‰ä¸€ä¸ªå‡½æ•°ï¼Œä½œä¸ºå‚æ•°ä¼ å…¥b .reduceRight((a, b) =&gt; b.bind(this, a)); entrace(); &#125;&#125;// for testlet task = new Task();task.use(function(req, res, next)&#123; console.log(req, res); next();&#125;);task.use('/', function(req, res, next)&#123; req.a++; res.x++; next();&#125;);task.use('/', function(req, res)&#123; console.log(req, res);&#125;);task.dispatch('/', &#123;a: 1&#125;, &#123;x: 2&#125;);]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦ä¼šreduceå‡½æ•°]]></title>
    <url>%2Fblog%2F2017%2F08%2Fmake-use-of-reduce.html</url>
    <content type="text"><![CDATA[Array ä¸­æœ‰å‡ ä¸ªå¾ˆå®ç”¨çš„å‡½æ•°ï¼Œæ¯”å¦‚ each, map, filter, find, some ç­‰ï¼Œè¿™äº›æˆ‘ä»¬å¹³æ—¶çš„ä¸šåŠ¡å®ç°ä¸­ä¼šç»å¸¸ç”¨åˆ°ï¼Œè€Œæœ‰ä¸€ä¸ª reduce å‡½æ•°å¯èƒ½ç»å¸¸è¢«å¿½è§†ã€‚ ç®€å•ä»‹ç»å¯ç›´æ¥å‚è€ƒMDN: Array.prototype.reduce ç®€å•æ¥è¯´å°±æ˜¯è¿™æ ·çš„å‡½æ•°å½¢å¼ 1234[].reduce(function (accumulator, currentValue, currentIndex, array) &#123; // do something return accumulator;&#125;, initialValueOfAccumulator); åœ¨è¿­ä»£å‡½æ•°ä¸­ä¼šæ¥æ”¶ä¸€ä¸ªaccumulatorï¼Œåœ¨ reduce å¼€å§‹æ—¶å¯ä»¥ä¸ºå®ƒè®¾ç½®åˆå§‹å€¼ï¼ˆå³ä¸Šé¢çš„initialValueOfAccumulatorï¼‰ã€‚åœ¨è¿­ä»£ä¸­åšçš„äº‹æƒ…å°±æ˜¯æŠŠå¤„ç†åçš„ç»“æœè¿½åŠ åˆ°accumulatorä¸Šå†å°†å…¶è¿”å›ï¼Œè¿™æ ·å°±ä½¿å¾—accumulatoråœ¨è¿­ä»£ä¸­ä¾æ¬¡ä¼ é€’ï¼ˆç¬¬0æ¬¡çš„ç»“æœä¼šä¼ ç»™ç¬¬1æ¬¡ï¼Œç¬¬1æ¬¡çš„ç»“æœä¼ é€’ç»™ç¬¬2æ¬¡ï¼Œâ€¦ï¼‰ï¼Œæ‰€æœ‰çš„å¤„ç†ç»“æœéƒ½æ±‡èšåœ¨accumulatorä¸Šã€‚æœ€å reduce å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯æœ€ç»ˆçš„accumulatorå€¼ã€‚ map-reduce å…³ç³»MapReduce æ˜¯åœ¨åˆ†å¸ƒå¼ä¸­æå‡ºçš„è®¡ç®—æ–¹æ³•ï¼Œæˆ‘çœ‹è¿‡ä¸¤ç¯‡è§£é‡Šç®€å•åˆæ¸…æ™°çš„æ–‡ç« ï¼Œå¯ä¾›å‚è€ƒ ç”¨é€šä¿—æ˜“æ‡‚çš„å¤§ç™½è¯è®²è§£Map/ReduceåŸç† åå¼ å›¾è§£é‡ŠMapReduce js ä¸­ä¹Ÿæœ‰mapå’Œreduceå‡½æ•°ï¼Œç”¨å®ƒä¿©ä¹Ÿèƒ½å®ç° MapReduceï¼ŒåŒºåˆ«æ˜¯ js æ²¡æœ‰åˆ†å¸ƒå¼è®¡ç®—çš„æ”¯æŒã€‚è¿™é‡Œç®€å•ç¤ºæ„ä¸‹ word count ç¨‹åº 123456789101112131415161718192021222324252627// ä¸€äº›åˆ—æ–‡ç« ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ç›¸å½“äºä¸€ç¯‡æ–‡ç« çš„å®Œæ•´å­—ç¬¦ä¸²var articles = [ 'This is an example of word count.', 'This is an example of word count.', 'todo...'];articles.map(function (content) &#123; // å°†æ¯ç¯‡æ–‡ç« çš„å­—ç¬¦ä¸²éƒ½åˆ‡æˆå•è¯æ•°ç»„ï¼Œå¦‚æœéœ€è¦é¢„å¤„ç†ï¼ˆæ¯”å¦‚å‰”é™¤æŸäº›åŠ©åŠ¨è¯ï¼‰ä¹Ÿåœ¨è¿™æ—¶å¤„ç† var words = content.replace(/[^\w\s]/g, '').split(/\s+/); // ç»Ÿè®¡è¯¥ç¯‡æ–‡ç« çš„ word count var countMap = words.reduce(function (accumulator, word) &#123; accumulator[word] = (accumulator[word] || 0) + 1; return accumulator; &#125;, &#123;&#125;); // è¿”å›æ¯ç¯‡æ–‡ç« çš„å•è¯ç»Ÿè®¡ return countMap;&#125;).reduce(function (stats, countMap) &#123; // å°†æ¯ç¯‡æ–‡ç« çš„ç»Ÿè®¡ç»“æœåˆå¹¶èµ·æ¥ for (var word in countMap) &#123; stats[word] = (stats[word] || 0) + countMap[word]; &#125; return stats;&#125;, &#123;&#125;); è¿ç”¨åœºæ™¯ä¸¾ä¾‹1. æ•°ç»„æ‰å¹³åŒ–é¢˜ç›®ï¼šå°†å½¢å¦‚ [[0, 1], [2, 3, 4], [5]] çš„æ•°ç»„è½¬æˆæ‰å¹³ç»“æ„çš„ä¸€ç»´æ•°ç»„ [0, 1, 2, 3, 4, 5]ã€‚ ç”¨ reduce å®ç°çš„è¯ä»£ç å°±å¾ˆç®€å• 123[[0, 1], [2, 3, 4], [5]].reduce(function (flatten, item) &#123; return flatten.concat(item);&#125;, []); ç°åœ¨è€ƒè™‘ä¸€ä¸‹ï¼šå¦‚æœè¾“å…¥çš„æ•°ç»„å¯èƒ½åµŒå¥—å¤šå±‚å‘¢ï¼Ÿå½¢å¦‚ [[0, [1]], [2, [3, 4]], [[[5]]]] ä¸”åµŒå¥—çš„æ·±åº¦æˆ‘ä»¬æ— æ³•é¢„çŸ¥ 1234567891011121314151617181920212223// å¯¹å¤šç»´æ•°ç»„çš„ flattenvar flatten = function (array) &#123; // å¦‚æœå½“å‰ array å·²ç»æ˜¯åŸºç¡€ç±»å‹äº†ï¼Œå°±è½¬æˆ1ç»´æ•°ç»„ if (array instanceof Array === false) &#123; return [array]; &#125; // ä¸´æ—¶ç©ºé—´ï¼Œå®ƒçš„æ¯ä¸ªæˆå‘˜éƒ½è¦ä¿è¯æ˜¯1ç»´æ•°ç»„ var tmps = []; for (var i in array) &#123; tmps.push(flatten(array[i])); &#125; // åˆ©ç”¨ reduce å‡½æ•°å¯ä»¥å°†å½¢å¦‚ [[a], [b, c]] çš„æ•°ç»„æ‰å¹³åŒ–æˆ1ç»´æ•°ç»„ return tmps.reduce(function (res, item) &#123; return res.concat(item); &#125;, []);&#125;;flatten([0, 1, 2, 3, 4, 5]);flatten([0, [1], [2, 3], 4, 5]);flatten([[0, [1]], [[2], [3]], [[4, 5]]]);flatten([[[0, 1]], [2, [3, 4]], [[[5]]]]); å¦‚æœéœ€è¦ä»å³å‘å·¦çš„é¡ºåº flatten å¤„ç†ï¼Œåˆ™å¯ä½¿ç”¨ reduceRight ä»£æ›¿ reduce å½“ç„¶ï¼Œè¿™ä¸ªå¤šç»´æ•°ç»„çš„ä¾‹å­æœ‰ç‚¹åˆ»æ„ä½¿ç”¨ reduce çš„æ„Ÿè§‰ï¼Œåªè¦ä½¿ç”¨é€’å½’ï¼Œå…¶ä¸­ reduce å¯ä»¥ç”¨ tmps = tmps.concat(flatten(array[i])) ä»£æ›¿ã€‚ é¡ºä¾¿é™„ä¸Š flatten å‡½æ•°çš„ underscore å®ç°ç‰ˆæœ¬ï¼ˆéé€’å½’å®ç°ï¼‰ 123456789101112131415161718192021// Internal implementation of a recursive `flatten` function.var flatten = function(input, shallow, strict, output) &#123; output = output || []; var idx = output.length; for (var i = 0, length = getLength(input); i &lt; length; i++) &#123; var value = input[i]; if (isArrayLike(value) &amp;&amp; (_.isArray(value) || _.isArguments(value))) &#123; // Flatten current level of array or arguments object. if (shallow) &#123; var j = 0, len = value.length; while (j &lt; len) output[idx++] = value[j++]; &#125; else &#123; flatten(value, shallow, strict, output); idx = output.length; &#125; &#125; else if (!strict) &#123; output[idx++] = value; &#125; &#125; return output;&#125; 2. ç»Ÿè®¡èŠ‚ç‚¹æ ‡ç­¾æ•°å¦ä¸€ä¸ªå®ç”¨ä¾‹å­æ˜¯ç»Ÿè®¡ä¸€ä¸ªé¡µé¢ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹æ•°ï¼Œåˆ©ç”¨ document.getElementsByTagName(&#39;*&#39;) å¯å–å‡ºæ‰€æœ‰èŠ‚ç‚¹çš„ HTMLCollectionï¼Œå†é…åˆ map å’Œ reduce å‡½æ•°å°±å¯è½»æ¾ç»Ÿè®¡å‡ºå„ tagName çš„æ•°ç›®ã€‚ 12345678Array.prototype.slice.call(document.getElementsByTagName('*')) .map(function (el) &#123; return el.tagName; &#125;) .reduce(function (total, tag) &#123; total[tag] = (total[tag] || 0) + 1; return total; &#125;, &#123;&#125;); reduce å†…éƒ¨å®ç°æ ¹æ® reduce å‡½æ•°çš„å®šä¹‰ï¼Œå¯ä»¥ç®€å•è¿™æ ·å®ç°ï¼ˆä»…ä¾›å­¦ä¹ ä½¿ç”¨ï¼‰ 123456Array.prototype.reduce = function (iterator, accumulator) &#123; for (var i = 0; i &lt; this.length; i++) &#123; accumulator = iterator(accumulator, this[i], i, this); &#125; return accumulator;&#125; reduce å‡½æ•°æ˜¯ es5 ä¸­çš„æ ‡å‡†ï¼Œä» MDN ä¸ŠæŠ„äº†ä¸€ä»½ Polyfillï¼ˆå¯ç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263// Production steps of ECMA-262, Edition 5, 15.4.4.21// Reference: http://es5.github.io/#x15.4.4.21// https://tc39.github.io/ecma262/#sec-array.prototype.reduceif (!Array.prototype.reduce) &#123; Object.defineProperty(Array.prototype, 'reduce', &#123; value: function(callback /*, initialValue*/) &#123; if (this === null) &#123; throw new TypeError( 'Array.prototype.reduce ' + 'called on null or undefined' ); &#125; if (typeof callback !== 'function') &#123; throw new TypeError( callback + ' is not a function'); &#125; // 1. Let O be ? ToObject(this value). var o = (Objectthis); // 2. Let len be ? ToLength(? Get(O, "length")). var len = o.length &gt;&gt;&gt; 0; // Steps 3, 4, 5, 6, 7 var k = 0; var value; if (arguments.length &gt;= 2) &#123; value = arguments[1]; &#125; else &#123; while (k &lt; len &amp;&amp; !(k in o)) &#123; k++; &#125; // 3. If len is 0 and initialValue is not present, // throw a TypeError exception. if (k &gt;= len) &#123; throw new TypeError( 'Reduce of empty array ' + 'with no initial value' ); &#125; value = o[k++]; &#125; // 8. Repeat, while k &lt; len while (k &lt; len) &#123; // a. Let Pk be ! ToString(k). // b. Let kPresent be ? HasProperty(O, Pk). // c. If kPresent is true, then // i. Let kValue be ? Get(O, Pk). // ii. Let accumulator be ? Call( // callbackfn, undefined, // Â« accumulator, kValue, k, O Â»). if (k in o) &#123; value = callback(value, o[k], k, o); &#125; // d. Increase k by 1. k++; &#125; // 9. Return accumulator. return value; &#125; &#125;);&#125;]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>es</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ES6åŸºç¡€éƒ¨åˆ†]]></title>
    <url>%2Fblog%2F2017%2F08%2Fes6-basic.html</url>
    <content type="text"><![CDATA[ã€é˜…è¯»ç¬”è®°ã€‘æœ¬æ–‡å†…å®¹å‡æ¥è‡ªï¼šECMAScript 6 å…¥é—¨ å˜é‡let ä¸å­˜åœ¨å˜é‡æå‡ æš‚æ—¶æ€§æ­»åŒº ä¸å…è®¸é‡å¤å£°æ˜ ä¸é¡¶å±‚å¯¹è±¡çš„å±æ€§è„±é’© let a = 1 ä¸ä¼šæŒ‚åˆ° window ä¸Š å—çº§ä½œç”¨åŸŸ ES5 åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸ ES6 å…è®¸å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥— å—çº§ä½œç”¨åŸŸçš„å‡ºç°ï¼Œå®é™…ä¸Šä½¿å¾—è·å¾—å¹¿æ³›åº”ç”¨çš„ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰ä¸å†å¿…è¦äº† ES6 æ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ï¼Œä½†åœ¨æµè§ˆå™¨çš„ES6å®ç°ä¸­ä»æŠŠå—çº§ä½œç”¨åŸŸçš„å‡½æ•°å£°æ˜å½“ä½œvarå¤„ç†ï¼Œå»ºè®®å†™æˆå‡½æ•°è¡¨è¾¾å¼ã€‚ const åªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œç‰¹æ€§åŒlet const å£°æ˜å˜é‡æ—¶å¿…é¡»å¤åˆ¶ï¼Œä»¥åä¸èƒ½èµ‹å€¼ const å®é™…ä¸Šä¿è¯çš„ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å€¼ä¸å¾—æ”¹åŠ¨ï¼Œè€Œæ˜¯å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ä¸å¾—æ”¹åŠ¨ã€‚ å¯¹äºåŸºç¡€æ•°æ®ç±»å‹ï¼Œconst æŒ‡å‘çš„å°±æ˜¯å…¶å€¼ï¼›è€Œå¯¹äºå¯¹è±¡ç±»å‹ï¼Œconst æŒ‡å‘å…¶å¼•ç”¨åœ°å€ï¼Œå¯¹è±¡çš„åœ°å€ä¸å¯æ”¹å˜ï¼Œä½†å¯¹è±¡æœ¬èº«çš„å±æ€§å€¼ä»å¯ä»¥æ”¹ã€‚ å¦‚æœå¿…é¡»å°†å¯¹è±¡å†»ç»“ï¼ˆåœ°å€å’Œå€¼éƒ½ä¸èƒ½æ”¹ï¼‰ï¼Œåº”è¯¥ä½¿ç”¨Object.freeze è§£æ„èµ‹å€¼æ•°ç»„è§£æ„å½¢å¼1234let [x, y, ...z] = ['a'];x // "a"y // undefinedz // [] åªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰ Iterator æ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚ 1234567891011function* fibs() &#123; let a = 0; let b = 1; while (true) &#123; yield a; [a, b] = [b, a + b]; &#125;&#125;let [first, second, third, fourth, fifth, sixth] = fibs();sixth // 5 è§£æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼ï¼Œé»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼šæ•°ç»„æˆå‘˜çš„å€¼ä¸¥æ ¼ç­‰äºundefined 12345let [x = 1] = [undefined];x // 1let [x = 1] = [null];x // null å¯¹è±¡è§£æ„å½¢å¼123let &#123; foo: baz &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;baz // "aaa"foo // error: foo is not defined é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼šå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äºundefined 12345var &#123;x = 3&#125; = &#123;x: undefined&#125;;x // 3var &#123;x = 3&#125; = &#123;x: null&#125;;x // null å¦‚æœè¦å°†ä¸€ä¸ªå·²ç»å£°æ˜çš„å˜é‡ç”¨äºè§£æ„èµ‹å€¼ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚å› ä¸º JavaScript å¼•æ“ä¼šå°†{x}ç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œä»è€Œå‘ç”Ÿè¯­æ³•é”™è¯¯ã€‚ è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äºundefinedå’Œnullæ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚ å¸¸ç”¨åœºæ™¯ï¼šlet { log, sin, cos } = Math; å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼12345[[1, 2], [3, 4]].map(([a, b]) =&gt; a + b);// [ 3, 7 ][1, undefined, 3].map((x = 'yes') =&gt; x);// [ 1, 'yes', 3 ] å˜é‡è§£æ„èµ‹å€¼çš„ç”¨é€” æå–å¯¹è±¡æ•°æ®ï¼ˆæˆ–ç”¨äºéå†æ•°æ®ç»“æ„ï¼‰ å‡½æ•°å‚æ•°çš„æ˜ å°„åŠé»˜è®¤å€¼ è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³• å­—ç¬¦ä¸²çš„æ‰©å±• ES6ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†Iteratoræ¥å£ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢«for...ofå¾ªç¯éå†ã€‚ æ–°å¢ï¼šincludes(), startsWith(), endsWith(), repeat() æ¨¡æ¿å­—ç¬¦ä¸² æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ï¼Œéœ€è¦å°†å˜é‡åå†™åœ¨${}ä¹‹ä¸­ã€‚ å¤§æ‹¬å·å†…éƒ¨å¯ä»¥æ”¾å…¥ä»»æ„çš„JavaScriptè¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ã€‚ æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­è¿˜èƒ½è°ƒç”¨å‡½æ•° é«˜çº§ç”¨æ³• 12345678const tmplFn = addrs =&gt; ` &lt;table&gt; $&#123;addrs.map(addr =&gt; ` &lt;tr&gt;&lt;td&gt;$&#123;addr.first&#125;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;$&#123;addr.last&#125;&lt;/td&gt;&lt;/tr&gt; `).join('')&#125; &lt;/table&gt;`; æ¨¡æ¿ç¼–è¯‘ 123456789101112131415161718192021222324252627282930313233var template = `&lt;ul&gt; &lt;% for(var i=0; i &lt; data.supplies.length; i++) &#123; %&gt; &lt;li&gt;&lt;%= data.supplies[i] %&gt;&lt;/li&gt; &lt;% &#125; %&gt;&lt;/ul&gt;`;function compile(template)&#123; var evalExpr = /&lt;%=(.+?)%&gt;/g; var expr = /&lt;%([\s\S]+?)%&gt;/g; template = template .replace(evalExpr, '`); \n echo( $1 ); \n echo(`') .replace(expr, '`); \n $1 \n echo(`'); template = 'echo(`' + template + '`);'; var script = `(function parse(data)&#123; var output = ""; function echo(html)&#123; output += html; &#125; $&#123; template &#125; return output; &#125;)`; return script;&#125; æ­£åˆ™çš„æ‰©å±•ä»¥ä¸‹é es6 æ–°å¢ æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹.æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä»»æ„çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯è¡Œç»ˆæ­¢ç¬¦ï¼ˆline terminator characterï¼‰é™¤å¤–ã€‚ä»¥ä¸‹å››ä¸ªå­—ç¬¦å±äºâ€è¡Œç»ˆæ­¢ç¬¦â€œï¼š U+000A æ¢è¡Œç¬¦\n U+000D å›è½¦ç¬¦\r U+2028 è¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰ U+2029 æ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰ ä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åŒ¹é…çš„æ˜¯ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œæœ‰ä¸€ç§å˜é€šçš„å†™æ³•[^] æ•°å€¼çš„æ‰©å±•æ–°å¢ Number.isFinite() Number.isNaN() Number.parseInt() Number.parseFloat() Number.isInteger() Number.EPSILON 2.220446049250313e-16 Number.isSafeInteger() -2^53 ~ 2^53 å‡½æ•°çš„æ‰©å±•å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ å‚æ•°å˜é‡æ˜¯é»˜è®¤å£°æ˜çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨letæˆ–constå†æ¬¡å£°æ˜ã€‚ å‚æ•°é»˜è®¤å€¼ä¸æ˜¯ä¼ å€¼çš„ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—é»˜è®¤å€¼è¡¨è¾¾å¼çš„å€¼ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå‚æ•°é»˜è®¤å€¼æ˜¯æƒ°æ€§æ±‚å€¼çš„ã€‚ 123456789let x = 99;function foo(p = x + 1) &#123; console.log(p);&#125;foo() // 100x = 100;foo() // 101 rest å‚æ•°rest å‚æ•°æ­é…çš„å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å˜é‡å°†å¤šä½™çš„å‚æ•°æ”¾å…¥æ•°ç»„ä¸­ã€‚ 1234567// argumentså˜é‡çš„å†™æ³•function sortNumbers() &#123; return Array.prototype.slice.call(arguments).sort();&#125;// restå‚æ•°çš„å†™æ³•const sortNumbers = (...numbers) =&gt; numbers.sort(); æ³¨æ„ rest å‚æ•°ä¹‹åä¸èƒ½å†æœ‰å…¶ä»–å‚æ•°ï¼ˆå³åªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ å‡½æ•°çš„lengthå±æ€§ï¼Œä¸åŒ…æ‹¬ rest å‚æ•°ã€‚ ç®­å¤´å‡½æ•° å‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚ ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨newå‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ ä¸å¯ä»¥ä½¿ç”¨argumentså¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚ ä¸å¯ä»¥ä½¿ç”¨yieldå‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚ï¼ˆä½†æ˜¯ç®­å¤´å¯ä»¥ä½œä¸º async å‡½æ•°ï¼‰ 123456789101112131415function foo() &#123; return () =&gt; &#123; return () =&gt; &#123; return () =&gt; &#123; console.log('id:', this.id); &#125;; &#125;; &#125;;&#125;var f = foo.call(&#123;id: 1&#125;);var t1 = f.call(&#123;id: 2&#125;)()(); // id: 1var t2 = f().call(&#123;id: 3&#125;)(); // id: 1var t3 = f()().call(&#123;id: 4&#125;); // id: 1 æ³¨æ„ï¼šç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œæ‰€ä»¥å½“ç„¶ä¹Ÿå°±ä¸èƒ½ç”¨call()ã€apply()ã€bind()è¿™äº›æ–¹æ³•å»æ”¹å˜thisçš„æŒ‡å‘ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>es</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[H5æ— åŸ‹ç‚¹æ•°æ®é‡‡é›†]]></title>
    <url>%2Fblog%2F2017%2F06%2Fauto-tracker-on-h5.html</url>
    <content type="text"><![CDATA[å‰ä¸€é˜µå›¢é˜Ÿé‡Œåšäº†ä¸ªé¡¹ç›®ï¼Œç§°ä¸ºâ€œæ— åŸ‹ç‚¹åœˆé€‰â€ï¼Œç›®çš„æ˜¯åœ¨ app ä¸­æ— éœ€ä¸ºç‰¹æ®Šçš„æŒ‰é’®æˆ–äº‹ä»¶ç¼–å†™åŸ‹ç‚¹ï¼Œå¯åœ¨ app å‘å¸ƒåé€šè¿‡å¯è§†åŒ–çš„æ–¹å¼æ¥åœˆé€‰éœ€è¦â€œåŸ‹â€çš„ç‚¹ï¼Œç„¶ååœ¨ app ç«¯é€šè¿‡é…ç½®ä¸‹æ‹‰çš„æ–¹å¼æ¥è·å–åŸ‹ç‚¹ä¿¡æ¯ï¼Œå®ç°åŸ‹ç‚¹æ•°æ®çš„è‡ªåŠ¨å‘é€ã€‚ å·¥ä½œæµç¨‹åœˆé€‰çš„ä¸»è¦æ­¥éª¤ä¸º åœ¨ web ç®¡ç†ç«¯æ‰“å¼€ã€åœˆé€‰ã€‘åŠŸèƒ½çš„å…¥å£ï¼Œå¼€å¯é•¿è¿æ¥ åœ¨ app ä¸­é€šè¿‡ç‰¹æ®Šæ‰‹åŠ¿å¼€å¯ã€åœˆé€‰ã€‘çŠ¶æ€ï¼Œè¿æ¥ socket app ç«¯å®æ—¶å°†æ‰‹æœºæˆªå±ä»¥åŠæ§ä»¶ç»“æ„ä¼ é€ç»™ web ç«¯ åœ¨ web ç«¯åœˆå‡ºéœ€è¦ã€åŸ‹ç‚¹ã€‘çš„æ§ä»¶ï¼Œå¹¶ä¿å­˜ä¸ºé…ç½® è€Œæ•°æ®é‡‡é›†æ—¶çš„æ­¥éª¤ä¸º app å¯åŠ¨æ—¶è‡ªåŠ¨æ›´æ–°ä¸€ä»½åŸ‹ç‚¹é…ç½®ä¿¡æ¯ Native ä¸ webview éƒ¨åˆ†çš„é¡µé¢ï¼Œåˆ†åˆ«æ•è·ç”¨æˆ·çš„ç‚¹å‡»äº‹ä»¶ï¼Œå¹¶æ ¹æ®åŸ‹ç‚¹é…ç½®ä¿¡æ¯å‘é€æŒ‡å®šçš„åŸ‹ç‚¹äº‹ä»¶æ—¥å¿— éœ€æ³¨æ„çš„æ˜¯ï¼ŒNative éƒ¨åˆ†çš„æ§ä»¶å‡ç”± app SDK è´Ÿè´£å¤„ç†ï¼Œè€Œ webview é‡Œé¢çš„é¡µé¢ï¼Œç”± app SDK å°†ç‰¹å®š js æ³¨å…¥ webview ä¸­ï¼Œå†ç”± js è´Ÿè´£å¤„ç†ã€‚ æ•´ä½“æ¶æ„Hybrid å…³ç³»H5 ä¸ SDK éƒ¨åˆ†çš„å…³ç³»å¦‚ä¸‹ï¼š 12345678 å‘èµ·è¯·æ±‚SDK ------------&gt; æ³¨å…¥js (æ ¹æ®åŠŸèƒ½åœºæ™¯æ³¨å…¥ä¸‹é¢ä¸åŒçš„jsæ–‡ä»¶) getViewportTreeåœˆé€‰js -------------------&gt; å¾—åˆ°é¡µé¢å¯è§†ç»“æ„ (ç”±SDKä¸»åŠ¨è°ƒç”¨js bridge) ç›‘å¬ç‚¹å‡»äº‹ä»¶ï¼Œäº‹ä»¶è¿‡æ»¤ï¼Œè°ƒç”¨SDKé‡‡é›†js --------------------------------&gt; ç”±SDKå¤„ç†æ—¥å¿—å‘é€ å…¶ä¸­â€œåœˆé€‰jsâ€åªè´Ÿè´£åˆ†æå½“å‰é¡µé¢çš„å¯è§†ç»“æ„ï¼Œå¹¶å°†ç»“æœä¼ é€’ç»™ SDK ç«¯ã€‚è€Œâ€œé‡‡é›†jsâ€åªè´Ÿè´£ç›‘å¬å½“å‰é¡µé¢äº‹ä»¶ï¼Œå¹¶æ ¹æ®åŸ‹ç‚¹é…ç½®è¿‡æ»¤å‡ºæœ‰æ•ˆåŸ‹ç‚¹äº‹ä»¶ï¼Œå¹¶å‘é€ç»™ SDK ç«¯ï¼ˆç”±SDKè´Ÿè´£å¤„ç†æ—¥å¿—çš„å‘é€ï¼‰ åœˆé€‰éƒ¨åˆ†è·å–å¯è§†ç»“æ„æ ‘éå†ç®—æ³• 1TO be continue æ•ˆæœç¤ºæ„å›¾ ç»“æ„åŒ–æ•°æ®è¡¨ç¤ºå¯è§†ç»“æ„å–è‡ªDOM documentï¼Œæœ¬è´¨ä¸Šä»ä½¿ç”¨ XPath æ¥è¡¨ç¤ºä¸€ä¸ªDOMèŠ‚ç‚¹åœ¨ document ä¸­æ‰€å¤„çš„è·¯å¾„ï¼Œå½¢å¦‚BODY[0]/DIV[0]#main/DIV[1]/A[0]#query â€¦â€¦ ä¸ºäº†æ–¹ä¾¿ä¸å…¶ä»–ç«¯çš„æ•°æ®äº¤äº’ï¼Œè¿™é‡Œä½¿ç”¨ç»Ÿä¸€çš„ JSON ç»“æ„æ¥è¡¨ç¤ºä»»ä¸€æ§ä»¶å…ƒç´ çš„è·¯å¾„ï¼ŒåŒ…æ‹¬åœ¨ Native ä¸­çš„éƒ¨åˆ†ä»¥åŠåœ¨ webview ä¸­çš„éƒ¨åˆ†ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&#123; // æ³¨ï¼šç”±äº Native éƒ¨åˆ†çš„æ§ä»¶ä¸æ˜¯å‡å¯ç‚¹å‡»ï¼Œæ‰€ä»¥pathä¿ç•™ä»ä¸Šä¸€ä¸ªçˆ¶èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„ç›¸å¯¹è·¯å¾„ path: [ &#123; p: 'UIWebView', // è·¯å¾„ä¸Šçš„pathèŠ‚ç‚¹ç±»å‹ i: '0', // èŠ‚ç‚¹indexï¼Œç›¸å¯¹äº"åŒç±»å‹"æ§ä»¶ t: 'UIWebView' // æ§ä»¶ç»§æ‰¿çš„ç³»ç»Ÿæ§ä»¶ç±»å‹ &#125; ], type: 'UIWebView', // ç³»ç»Ÿæ§ä»¶ç±»å‹ url: 'http://m.ctrip.com/html5/', // åªæœ‰webviewæ—¶æ‰æœ‰urlå­—æ®µ value: '', // SDKç«¯ä»æ§ä»¶å±æ€§å–å‡ºæ¥ frame: &#123; // ç›¸å¯¹äºå½“å‰å±å¹•å·¦ä¸Šè§’ï¼Œå››èˆäº”å…¥ x: 0, y: 100, w: 320, h: 480 &#125;, child: [ &#123; // H5ä¸­çš„è·¯å¾„è¡¨ç¤ºæ³•ä¸ Native ä¿æŒä¸€è‡´ï¼Œç”±äºH5ä¸­ä¸ä¼šå­˜åœ¨çˆ¶å…ƒç´ ä¸å¯åœˆé€‰è€Œå­å…ƒç´ å¯åœˆé€‰çš„æƒ…å†µ // å› æ­¤ H5 çš„æ–‡æ¡£æ•°æ®ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„ path æ•°ç»„é‡Œéƒ½åªæœ‰1é¡¹ path: [ &#123; p: 'BODY', // H5ä¸­å³ tagName ï¼ˆ**ä»BODYå¼€å§‹**ï¼‰ i: '0', // åŒç±» tagName åœ¨çˆ¶èŠ‚ç‚¹ä¸­çš„ index t: 'BODY' // H5ä¸­åªæœ‰ä½¿ç”¨è‡ªå®šä¹‰æ ‡ç­¾ï¼ˆå¦‚ &lt;my-app&gt;ï¼‰æ—¶ï¼Œt å’Œ p æ‰ä¸åŒ &#125; ], type: 'BODY' // åŒ path æ•°ç»„ä¸­æœ€åä¸€é¡¹çš„ t value: '', // H5ä¸­çº¦å®šï¼šè¯¦è§â€œè·å–èŠ‚ç‚¹contentâ€ frame: &#123; // ç›¸å¯¹äºå½“å‰webviewå·¦ä¸Šè§’ï¼ˆwebviewæœ‰å¯èƒ½ä¸æ’‘æ»¡æ‰‹æœºå±å¹•ï¼‰ x: 10, // æ³¨ï¼š&lt;body&gt; å¯èƒ½è®¾æœ‰ margin y: 10, w: 300, h: 460 &#125;, child: [ &#123; path: [ &#123; p: 'DIV', i: '0', t: 'DIV', d: 'mainContainer' // å…ƒç´ æœ‰idæ—¶å­˜åœ¨æ­¤å­—æ®µ &#125; ], type: 'DIV', value: '', frame: &#123;...&#125; child: [...] &#125; ] &#125; ]&#125; è·å–èŠ‚ç‚¹contentèŠ‚ç‚¹ content å³ä¸€ä¸ªDOMèŠ‚ç‚¹çš„å†…å®¹æ–‡æ¡ˆï¼Œä¸èƒ½éƒ½ç”¨innerTextæ¥æ¦‚æ‹¬ï¼Œè€Œåº”æ ¹æ®èŠ‚ç‚¹ç±»å‹å–ä¸åŒçš„å±æ€§ å¦‚æœæ˜¯/(input|textarea|select|option|form)/ç­‰è¡¨å•å…ƒç´ ï¼Œä¸å– content ç‰¹ä¾‹&lt;input type=&quot;button&quot;&gt; å’Œ &lt;input type=&quot;submit&quot;&gt; å®ä¸ºæŒ‰é’®ï¼Œå–valueå±æ€§ä½œä¸º content å¦‚æœæœ‰title altå±æ€§ï¼Œå°±ä»¥å…¶å€¼ä½œä¸º content value å¦‚æœå…ƒç´ è®¾æœ‰contenteditableå±æ€§ï¼ˆè§†ä¸ºå¯ç¼–è¾‘çš„å…ƒç´ ï¼‰ï¼Œä¸å– content å¦‚æœå…ƒç´ æ— childrenï¼ˆæœ«ç«¯å¶å­èŠ‚ç‚¹ï¼‰ï¼Œç›´æ¥å–innerText å¦‚æœå…ƒç´ ä»æœ‰å­å…ƒç´ ï¼Œå–æ‰€æœ‰çš„æ–‡æœ¬èŠ‚ç‚¹ï¼ˆä¹Ÿæ˜¯å®ƒçš„å­èŠ‚ç‚¹ï¼Œä¸”nodeType==3ï¼‰ ä»¥ä¸Šè¿‡ç¨‹éƒ½ä¸æ»¡è¶³ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸² é‡‡é›†éƒ¨åˆ†äº‹ä»¶æ•è·ä¸‹é¢ä¸»è¦è®°å½•åœ¨å®ç°H5é¡µé¢çš„æ•°æ®é‡‡é›†æ—¶ï¼Œå…³äº touch äº‹ä»¶æ‰€é‡åˆ°çš„å‘ã€‚ Android IOS å®¢æˆ·ç½‘é¡µä¸­ä½¿ç”¨ touchend è·³è½¬ ç›‘å¬ click äº‹ä»¶ OKï¼ˆåªè¦ç”¨æˆ·ä¸åœ¨ touchend ä¸­æ•…æ„é˜»æ­¢äº‹ä»¶preventDefaultï¼‰ æ— æ³•æ•è· ç›‘å¬ touch äº‹ä»¶ OK æ— æ³•æ•è· å®¢æˆ·ç½‘é¡µä¸­ä½¿ç”¨ æ™®é€š click è·³è½¬ ç›‘å¬ click äº‹ä»¶ OK OK ç›‘å¬ touch äº‹ä»¶ OK æ— æ³•æ’é™¤ safari åŒå‡»æ”¾å¤§ï¼ŒåŒå‡»ä¸­çš„ç¬¬1æ¬¡ touch ä»ä¼šè§¦å‘åŒ¹é…æµç¨‹ å®¢æˆ·ç½‘é¡µä¸­ä½¿ç”¨ fastclick è·³è½¬ ç›‘å¬ click äº‹ä»¶ OK OK ç›‘å¬ touch äº‹ä»¶ OK åŒæ ·æ— æ³•å¾ˆå¥½çš„å¤„ç† double-tap é—®é¢˜ å‡ ä¸ªç°è±¡ android ä¸Šä¸å­˜åœ¨ double-tap æ”¾å¤§ï¼Œä¼šè§¦å‘ä¸¤æ¬¡ click ios ä¸Šå³ä½¿é¡µé¢è®¾äº†user-scalable=noï¼Œdouble-tap æ—¶ä»ä¼šè¢«åˆ¤æœªæ²¡æœ‰ç”Ÿæ•ˆçš„â€œæ”¾å¤§â€æ“ä½œ android ä¸Šçš„é•¿æŒ‰é“¾æ¥ï¼Œæ—¶é•¿é™åˆ¶åœ¨ 590~600msï¼Œä¸ ios ä¸Šé•¿æŒ‰çš„æ—¶é•¿ä¸åŒ ios safari åœ¨é“¾æ¥ä¸Šå¿«é€Ÿflipæ‰‹æŒ‡æ—¶ï¼Œå®¹æ˜“ä¸è§¦å‘ touchstart æŠ˜è¡·æ–¹æ¡ˆ ios ä¸Šåªç›‘å¬ click äº‹ä»¶ android ä¸Šç›‘å¬ touchstart -&gt; touchmove -&gt; touchendï¼ŒåŒæ—¶ç›‘å¬ click äº‹ä»¶ç”¨äºè¡¥å¿ä¸èƒ½åˆ¤å®šçš„case touch äº‹ä»¶ç”¨äºæ’é™¤ã€å¤šæŒ‡è§¦æ‘¸ã€ç§»åŠ¨åå·®è¿‡å¤§ã€é•¿æŒ‰ã€‘ç­‰ä¸åº”è¯¥è§¦å‘åŸ‹ç‚¹çš„æƒ…å†µ åŒæ—¶ double-tap ä¼šè§¦å‘ä¸¤æ¬¡ touchendï¼Œå°†å¿½ç•¥å…¶ä¸­çš„ç¬¬äºŒæ¬¡ åœ¨ touchend é˜¶æ®µåˆ¤å®šæœ‰æ•ˆçš„ç‚¹å‡»ï¼Œå¹¶è§¦å‘åŸ‹ç‚¹ å…¶ä½™ä¸èƒ½åˆ¤å®šçš„caseï¼Œå°†åœ¨ click é˜¶æ®µå†åˆ¤å®šæ˜¯å¦è§¦å‘åŸ‹ç‚¹ è·¯å¾„åŒ¹é…ç®—æ³•H5é¡µé¢ä¸Šå·²è¢«åœˆé€‰çš„ã€åŸ‹ç‚¹ã€‘å…ƒç´ è·¯å¾„å¯èƒ½ä¼šå¾ˆå¤šï¼Œé‡‡ç”¨éå†æ¯æ¡åœˆé€‰è·¯å¾„å¹¶æ‰“åˆ†çš„ç®—æ³•ï¼ˆæœ€å¤š1è½®å¾ªç¯ï¼‰æ‰¾å‡ºæœ€ä½³åŒ¹é…çš„è§„åˆ™ï¼Œä¿è¯æœ€å¤šè§¦å‘1ä¸ªåœˆé€‰çš„äº‹ä»¶ã€‚ 1TO be continue Bad Caseä¸‹é¢ä¸»è¦è®°å½•äº†å¼€å‘è¿‡ç¨‹ä¸­å‘ç°çš„ä¸€äº›ç‰¹æ®Š case ä»¥åŠç›¸åº”çš„å¤„ç†æªæ–½ã€‚ case é˜¶æ®µ çŠ¶æ€ å¤‡æ³¨ float çˆ¶å…ƒç´ å¡Œé™· ç›´æ¥è¿‡æ»¤äº† åœˆé€‰ FIXED æš‚æ—¶ä¸ç›´æ¥è¿‡æ»¤é«˜ä¸º0çš„èŠ‚ç‚¹ï¼ŒåŒºåŸŸè£å‰ªæ—¶ä¹ŸåŠ å…¥äº†overflowçš„åˆ¤æ–­ è½®æ’­ banner ä¸èƒ½åœˆï¼ˆå¾ˆä¾èµ–è½®æ’­çš„å…·ä½“å®ç°ï¼‰ åœˆé€‰ PENDING èƒ½åœˆï¼Œä½†åªèƒ½åœˆå½“å‰é‚£ä¸€å¸§çš„å›¾ç‰‡ã€‚å¦‚æœå›¾ç‰‡æ’‘æ»¡äº†æ•´ä¸ªè½®æ’­å®¹å™¨ï¼Œé‚£å°±æ²¡æ³•åœˆåˆ°è½®æ’­æ•´ä½“ã€‚ã€‚å¦‚æœæ˜¯é€šè¿‡&lt;ul&gt;å®šä½å®ç°çš„ï¼Œleft æˆ– translate è´Ÿå€¼å®ç°çš„è½®æ’­åŠ¨ç”»ï¼Œåˆ™æ— æ³•åœˆé€‰ï¼ˆå› ä¸º&lt;ul&gt;å·²ç»è¢«åˆ¤ä¸ºä¸åœ¨ viewport ä¸­ï¼‰ ä½äºé¡µé¢é¡¶éƒ¨çš„ fixed header å†…å®¹ä¸æ–¹ä¾¿åœˆï¼ˆå¦‚æœåé¢çš„å…ƒç´ è®¾äº†paddingï¼‰ åœˆé€‰ PENDING æ¡ˆä¾‹ï¼šctrip h5 é¡¶éƒ¨æœç´¢ çˆ¶å®¹å™¨è¢«ä¸‹æ–¹å…ƒç´ é®ä½åç»­è€ƒè™‘åœ¨å‰ç«¯åšå±‚å çš„æç¤ºï¼Œè®©ç”¨æˆ·é€‰æ‹©é‚£ä¸€å±‚çš„å…ƒç´  çˆ¶å®¹å™¨è®¾æœ‰marginï¼Œå­å…ƒç´ å®šä½æ—¶çš„å‚è€ƒå…ƒç´ åœ¨å…ƒç´ åœ¨çˆ¶å®¹å™¨ä¹‹å¤–ï¼Œä¼šåœ¨åŒºåŸŸè£å‰ªæ—¶è£æ‰ åœˆé€‰ éƒ¨åˆ†ç¼“è§£ æ¡ˆä¾‹ï¼š&lt;body&gt;è®¾äº† margin, &lt;div&gt;å­å…ƒç´ å®šä½ç›¸å¯¹&lt;html&gt;ï¼Œè¢«è®¤ä¸ºè¶…å‡ºçˆ¶å®¹å™¨&lt;body&gt;è¾¹ç•Œã€‚ç›®å‰å¼•å…¥äº†å­å…ƒç´ æœ€å¤§åŒºåŸŸçš„æ¦‚å¿µï¼Œå½“çˆ¶å…ƒç´ éoverflowæ—¶ï¼Œå­å…ƒç´ å¯æ¥å—çš„èŒƒå›´å¯å‘å³å‘ä¸‹å»¶ç”Ÿï¼Œå»¶ç”Ÿåˆ°çˆ¶å…ƒç´ çš„å¯æ¥å—æœ€å¤§åŒºåŸŸï¼ˆåªè¦è·¯å¾„ä¸Šæ²¡æœ‰èŠ‚èŠ‚ç‚¹è®¾è¿‡overflowï¼ŒåŸç†ä¸Šå­å…ƒç´ å¯æ¥å—èŒƒå›´å¯å»¶ç”Ÿåˆ°è§†çª—çš„æœ€å³å’Œæœ€ä¸‹ï¼‰æ³¨æ„ï¼šç›®å‰åªæ¥å—å‘å³å‘ä¸‹å»¶ç”Ÿåˆ°çˆ¶å…ƒç´ ä¹‹å¤–ï¼Œå…¶ä»–æ–¹å‘è¶…å‡ºçˆ¶å…ƒç´ æ—¶ï¼Œä»ç„¶ä¼šè¢«è£å‰ªåˆ°çˆ¶å…ƒç´ è¾¹ç•Œ ä¸¤ä¸ªå­å…ƒç´ åŒºåŸŸä¹‹å’Œæ­£å¥½ç­‰äºçˆ¶å…ƒç´ åŒºåŸŸï¼Œå°±æ— æ³•åœˆåˆ°çˆ¶å…ƒç´  åœˆé€‰ PENDING ç°è±¡å°±æ˜¯ï¼šå‰ç«¯ç‚¹ä¸åˆ°çˆ¶å…ƒç´ çš„åŒºåŸŸ å¼€å‘è€…å¯¹ html body è®¾äº† height: 100% å¯¼è‡´é¡µé¢æ»šåŠ¨åæ ¹èŠ‚ç‚¹åŒºåŸŸç¼©å° åœˆé€‰ FIXED åœ¨è®¡ç®—å‰å…ˆå¯¹bodyè®¾height: autoï¼Œå®Œäº†åå†è¿˜åŸ ä½¿ç”¨ touch äº‹ä»¶ï¼Œç›´æ¥åœ¨ js ä¸­è·³è½¬é¡µé¢ é‡‡é›† è§£å†³éƒ¨åˆ†case ç›‘å¬ touchstart / touchend äº‹ä»¶æ¥åˆ¤å®šï¼ŒåŒæ—¶ç›‘å¬ click äº‹ä»¶æ¥è¾…åŠ©å½“å‰è§„åˆ™ï¼štouch ä½ç§»å®¹å¿èŒƒå›´ä¸º&lt;=10pxï¼Œtouch æ—¶é•¿å®¹å¿ä¸º&lt;=750msï¼Œä¸¤æ¬¡touché—´éš”æ—¶é—´&gt;250msï¼ˆå‚è€ƒäº† zepto.js ä¸­çš„é˜ˆå€¼ï¼‰FUCK: ä»æ— æ³•æ’é™¤ ios safari ä¸‹â€œåŒå‡»æ”¾å¤§â€ï¼Œä¼šè¯¯åˆ¤ä¸º touchend è§¦å‘2æ¬¡äº‹ä»¶ åŠ¨æ€æ·»åŠ å‡ºæ¥çš„å…ƒç´ ï¼Œç¢°å·§ä¸åœˆé€‰çš„å…ƒç´  path ç›¸åŒï¼Œä¼šè¢«è§†ä¸º1æ¬¡è§¦å‘ é‡‡é›† ä½æˆæœ¬ç¼“è§£ å·²ä½¿ç”¨è·¯å¾„ä¸­çš„idå‡å°‘äº†æ­¤ç±»å¹²æ‰°ï¼ˆåªåŒ¹é…æœ€é‡Œå±‚idä¹‹åçš„ tag å’Œ indexï¼‰ä½†æ— æ³•ä¿è¯ç”¨æˆ·æ‰€æœ‰åœˆé€‰çš„æ§ä»¶å…ƒç´ éƒ½å­˜åœ¨id æš‚ä¸æ”¯æŒï¼š ä¸æ”¯æŒåˆ—è¡¨å†…åŒçº§å…ƒç´ çš„å¿½ç•¥ä¸‹æ ‡ ä¸æ”¯æŒå…¨éƒ¨ iframe / flash å®ç°çš„é¡µé¢ (è§†ä¸º1ä¸ªæ•´ä½“å…ƒç´ )ï¼Œä¾‹å¦‚ http://music.163.com/ ä¸æ”¯æŒæ‰‹åŠ¨æ”¾å¤§ç¼©å°é¡µé¢æ—¶çš„åœˆé€‰]]></content>
      <categories>
        <category>mobile</category>
      </categories>
      <tags>
        <tag>mobile</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æµè§ˆå™¨æ¸²æŸ“åŸç† (å¬è¯¾ç¬”è®°)]]></title>
    <url>%2Fblog%2F2017%2F04%2Fnotes-of-browser-displaying-a-page.html</url>
    <content type="text"><![CDATA[è¿™ä¹Ÿæ˜¯å…¬å¸åŸ¹è®­çš„å¬è¯¾ç¬”è®°ï¼Œå…³äºæµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ä¸­å„ä¸ªé˜¶æ®µçš„æŠ€æœ¯ç»†èŠ‚ï¼Œæ•´ç†çš„èŒƒå›´æ¯”è¾ƒå¹¿ï¼Œéƒ½åˆ—äº†ä¸€äº›ç‚¹ï¼Œå¯ä½œä¸ºä»Šåå­¦ä¹ è¿™å—çš„æçº²ã€‚ èµ„æºä¸‹è½½&lt;script&gt; &amp; &lt;link&gt; cssæœªä¸‹è½½å®Œå‰ï¼Œé¡µé¢ä¸ä¼šæ˜¾ç¤ºå†…å®¹ï¼ˆä¸ºäº†ä½“éªŒï¼‰ jsæœªä¸‹è½½å®Œå‰ï¼Œæ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºé¡µé¢çš„ æœåŠ¡å™¨ç«¯ Response.Flush() åˆ†å—ä¼ è¾“ï¼Œè®©å®¢æˆ·ç«¯å……åˆ†åˆ©ç”¨ä¸‹è½½çš„é—´éš™åšè§£æï¼Œåˆ†å—è§£æ document.write é¡µé¢æ¸²æŸ“å®Œåè°ƒç”¨å®ƒï¼Œä¼šä½¿é¡µé¢å˜æˆç©ºç™½ ã€é‡è¦ã€‘document.write ä¼šä½¿æµè§ˆå™¨é‡æ–°è§£æDOMæ ‘ï¼Œç¦æ­¢ä½¿ç”¨ new Image().src å”¯ä¸€ä¸ç”¨æ·»åŠ å…ƒç´ å°±èƒ½å‘è¯·æ±‚çš„åŠæ³• å¸¸ç”¨äºå‘é€æ—¥å¿— æœ‰äº›æµè§ˆå™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿”å›ç±»å‹ä¸æ˜¯å›¾ç‰‡ defer VS async defer æºè‡ªIEï¼Œä¿è¯æ‰§è¡Œé¡ºåºï¼Œéƒ½ä¼šåˆ° domReady åå†æ‰§è¡Œ async ç°ä»£æ ‡å‡†ï¼Œä¸ä¿è¯æ‰§è¡Œé¡ºåºï¼Œä»€ä¹ˆæ—¶å€™ä¸‹è½½å®Œå°±ä»€ä¹ˆæ—¶å€™æ‰§è¡Œ èµ„æºä¼˜å…ˆçº§ link[rel=stylesheet] / script ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆæ²¡æœ‰å°±æ²¡æ³•çœ‹ï¼‰ object / img / iframe ç¬¬äºŒä¼˜å…ˆçº§ï¼ˆæ˜¯é¡µé¢å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼‰ link[rel=prefetch] é¢„åŠ è½½ï¼ˆä¸å½“å‰é¡µé¢æ²¡æœ‰å…³ç³»ï¼‰ è„šæœ¬ä¾èµ– ä¸‹è½½é˜»å¡ VS æ‰§è¡Œé˜»å¡ æ‰§è¡Œé˜»å¡å¯ä»¥å¹¶è¡Œä¸‹è½½ï¼Œåªéœ€ä¿ç•™æ‰§è¡Œçš„é¡ºåºï¼Œæ•ˆç‡æ›´é«˜ Connectionå¹¶è¡Œåº¦ ç°ä»£æµè§ˆå™¨èµ„æºä¸‹è½½å¹¶è¡Œåº¦æ˜¯6ï¼Œæ—§çš„IEä¸Šæ˜¯4 æœåŠ¡å™¨å‹åŠ› VS å®¢æˆ·ç«¯æ•ˆç‡ æ¯”å¦‚ Socketé‡ç”¨ TCPä¸‰æ¬¡æ¡æ‰‹çš„æ—¶é—´ä¸å®¢æˆ·ç«¯å¸¦å®½æ²¡æœ‰å…³ç³» Connection: keep-alive ä¿è¯TCPè¿æ¥ä¸å…³é—­ ç„¶åä½•æ—¶èƒ½å¤ŸçŸ¥é“æ–‡ä»¶ä¸‹è½½å®Œäº† Content-Length: å‘Šè¯‰ä½ å¤šé•¿å°±è¯»å¤šé•¿ Transfer-Encoding: chuncked åˆ†å—ï¼Œæœ€åä¸€å—éƒ½æ˜¯0ï¼Œè¡¨ç¤ºä¸‹è½½å®Œäº† æ­£ç¡®æ€§ä¿è¯ Content-MD5 æ„ä¹‰ä¹Ÿä¸æ˜¯å¾ˆå¤§ æ–­ç‚¹ç»­ä¼  Accept-Range å‘Šè¯‰æœåŠ¡å™¨æˆ‘è¦å“ªæ®µçš„æ•°æ®ï¼Œä¹Ÿå¯ç”¨äºå¤šçº¿ç¨‹ä¸‹è½½ Content-Range BSæ¶æ„çš„ç²¾é«“ - ç¼“å­˜ è¡¥ä¸æœºåˆ¶ èƒœè¿‡CSè½¯ä»¶ éªŒè¯å‹ç¼“å­˜ï¼šå»é—®æœåŠ¡å™¨æ˜¯ä¸æ˜¯æœ€æ–°çš„ï¼Œä¼šæœ‰ä¸ªè¯·æ±‚ï¼Œä½†çœå»äº†ä¸‹è½½è¿™ä¸ªèµ„æº Last-Modified &amp; If-Modified-Since / If-Unmodified-Since ETag &amp; If-Match / If-None-Match If-Range ééªŒè¯å‹ç¼“å­˜ï¼šå®Œå…¨ä¸å»é—®æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ›´æ–°äº†æœ¬åœ°ä¹Ÿä¸ä¼šçŸ¥é“ Cache-Control Expires ç¼“å­˜å¤±æ•ˆ Vary / Via / Date / Age æ¯”å¦‚ç°åœ¨æ˜¯ä¸ªä»£ç†æœåŠ¡å™¨ï¼ŒChromeè¯·æ±‚èµ„æºç¼“å­˜ä¸‹æ¥åï¼ŒIEå†è¯·æ±‚æ—¶è¦ä¸è¦ä½¿ç”¨ç¼“å­˜ï¼Œé€šè¿‡ Vary æŒ‡å®š ç¼“å­˜å¹´é¾„è®¡ç®— age_value date_value ç¼“å­˜è¿‡æœŸè®¡ç®— max-age=0 VS no-cache åŒºåˆ« max-age=0ï¼šæ˜¯ç”¨äºéªŒè¯å‹ç¼“å­˜çš„ï¼Œç›¸å½“äºå‘Šè¯‰æœåŠ¡å™¨ç¦æ­¢ééªŒè¯å‹ç¼“å­˜ï¼Œ no-cacheï¼šç¦æ­¢ä»»ä½•ç¼“å­˜ å°ç»“ httpçš„è¶…é“¾æ¥ç‰¹æ€§æ³¨å®šèµ„æºä¹‹é—´æœ‰å…³è”çš„ä¾èµ– å¤–éƒ¨èµ„æºä½ç½®ã€ç±»å‹ä¸åŒï¼Œå½±å“ä¸‹è½½æ—¶æœº Response.Flush å¯¹ä¸‹è½½çš„å½±å“ ç¼“å­˜æœºåˆ¶å¤æ‚ä½†å®Œå–„ é¡µé¢è§£æå­—ç¬¦ä¸² â€“&gt; åºåˆ—åŒ– â€“&gt; è½¬ä¹‰ â€“&gt; æ ‡ç­¾åŒ¹é… è„šæœ¬æ‰§è¡Œä¼šå¢åŠ è§£æçš„å›æº¯ DOM ç»“æ„çš„å˜åŒ– document.write ä¼šä½¿æµè§ˆå™¨è§£æè¿‡ç¨‹å›æº¯åˆ°åºåˆ—åŒ–çš„çŠ¶æ€ CSSè®¡ç®— å…ƒç´  - åŒ¹é…æ ·å¼ è€—å†…å­˜ &amp; è€—CPU Webkit ç‰¹å®šæ¡ä»¶ä¸‹æ ·å¼å…±äº«ï¼ˆèŠ‚çœå†…å­˜ï¼‰ é¼ æ ‡çŠ¶æ€ç›¸åŒ æ²¡æœ‰id class å’Œæ ‡ç­¾åç›¸åŒ â€¦. æ ·å¼è®¡ç®—çš„è¿‡æ»¤ï¼ˆçœCPUï¼‰ ä»¥æœ€åé€‰æ‹©å™¨ä¸ºä¾æ® å°†cssè§„åˆ™æŒ‰æœ€å³ä¸º id, class, tag, general åˆ†ç»„ å±æ€§é€‰æ‹©å™¨ä¹Ÿä¼šå½’åˆ° general ç»„é‡Œï¼Œå› æ­¤æ•ˆç‡ä½ CSSå±‚çº§ æ¥æºå±‚çº§ æµè§ˆå™¨UAæ ·å¼ ç”¨æˆ·æ ·å¼ ä½œè€…æ ·å¼ ä½œè€…æ ·å¼ !important ç”¨æˆ·æ ·å¼ !important æ ·å¼å±‚çº§ 1, 1, 1, 1 ç®—æ³• inline(0/1), count(id), count(attribute), count(tag) ä»å·¦åˆ°å³æŒ‰ä½æ¯”ï¼Œæ•°å­—å¤§å°±èƒœå‡ºï¼Œç›´æ¥ç»“æŸæ¯”è¾ƒ Render Tree å…ƒç´ æ²¡æœ‰æ¸²æŸ“å¯¹è±¡ head / meata / script å…ƒç´ æœ‰å¤šä¸ªæ¸²æŸ“å¯¹è±¡ html ä¼šåŒ…å«æ»šåŠ¨æ¡ li ä¼šåŒ…å«å‰é¢çš„å°åœ†ç‚¹ select input[type=file] é€šè¿‡CSSæ”¹å˜æ¸²æŸ“å¯¹è±¡ ::before / ::after display: none js æ§åˆ¶DOMæ ‘ï¼Œcss æ§åˆ¶æ¸²æŸ“æ ‘ å¸ƒå±€ æµå¸ƒå±€ HTMLä¸‰æ¡æµ æ–‡æ¡£æµã€æµ®åŠ¨æµã€å®šä½æµ å…¶ä»–å› ç´  display: list-item display: run-in tableå¸ƒå±€ display: table / inline-table / table-row / â€¦. åæ ‡ç³» å‰ç«¯ä¸­éƒ½ä»¥å·¦ä¸Šè§’ä¸º 0,0 ç‚¹ï¼Œå³|ä¸‹ ä¸ºæ­£åæ ‡ åœ°å›¾æ˜¯ä»¥å·¦ä¸‹è§’ä¸º 0,0 ç‚¹ å¸ƒå±€æ˜¯ä¸ªé€’å½’è¿‡ç¨‹ æµå¸ƒå±€å¯è‡ªå·¦å‘å³ã€è‡ªä¸Šè€Œä¸‹è¿›è¡Œï¼Œæµä¸­é åçš„å…ƒç´ ä¸ä¼šå½±å“æµä¸­é å‰çš„å…ƒç´ çš„å¸ƒå±€ï¼ˆæ— å›æº¯ï¼‰ tableå¸ƒå±€éœ€è¦å›æº¯æ‰èƒ½å¤Ÿå®Œæˆï¼ˆçŸ¥é“æ¯ä¸€ä¸ªå•å…ƒæ ¼çš„å¤§å°ï¼Œæ‰èƒ½å®Œæˆæ•´ä¸ªå¸ƒå±€ï¼‰ æµå¼å¸ƒå±€ç‰¹ç‚¹æ˜¯æ— è®ºå¦‚ä½•åé¢å…ƒç´ éƒ½ä¸ä¼šå½±å“å‰é¢ï¼Œä¾‹å¦‚olä¸­å››ä½æ•°ã€äº”ä½æ•°çš„é¢„ç•™ä½ç½®ä¸å˜ï¼Œæµè§ˆå™¨ç›´æ¥æš´åŠ›åœ°ç•™äº†3ä½æ•°çš„ç©ºé—´ å…¨å±€reflow æ•´ä¸ª Render Tree å…¨éƒ¨é‡æ–°è®¡ç®—å¸ƒå±€ å…¨å±€å¸ƒå±€æ ·å¼å˜æ›´ï¼šbody {} / æ·»åŠ æ–°æ ·å¼è¡¨ çª—å£å¤§å°å˜åŒ– å±€éƒ¨Reflow ä»…æ ‡è¯†ä¸º needLayout / dirty çš„æ¸²æŸ“å…ƒç´ è®¡ç®—å¸ƒå±€ Render Tree ä¸­æ’å…¥æ–°çš„æ¸²æŸ“å…ƒç´  æ¸²æŸ“å…ƒç´ å±æ€§æ¯”æ‹¿è´§ Reflow ä¼šå¼•èµ·å¦ä¸€ä¸ª Reflowï¼šæ¯”å¦‚ Reflow å¯¼è‡´æ»šåŠ¨æ¡ä½ç½®å˜åŒ– åŒæ­¥Reflow å…¨å±€Reflowé€šå¸¸åŒæ­¥è¿›è¡Œ è¯»å– offsetWidth / offsetHeight ç­‰å±æ€§ï¼Œä¼šäº§ç”Ÿ1æ¬¡reflow ç¦æ­¢åœ¨å¾ªç¯ä¸­è¯»å– offsetWidth / offsetHeight å¼‚æ­¥Reflow å±€éƒ¨Reflowé€šå¸¸å¼‚æ­¥è¿›è¡Œ FireFox: Reflowä»»åŠ¡è¿›å…¥çº¿ç¨‹Queueï¼Œä»»åŠ¡è°ƒåº¦å™¨è´Ÿè´£æ‰§è¡Œ Webkit: å®šæ—¶å™¨éå†Render Treeï¼Œå¸ƒå±€æ‰€æœ‰ needLayout å¯¹è±¡ Reflowä»»åŠ¡å¯åˆå¹¶ï¼Œä¸€æ¬¡è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­å¤šä¸ªæ ·å¼ä¿®æ”¹ä»…åš1æ¬¡Reflowï¼Œä½†æœ‰limitï¼ˆå¤§çº¦100~200ä¸ªï¼‰ æ‰‹åŠ¨Reflow æŠŠå…ƒç´ å…ˆremoveï¼Œæ”¹å®Œä¸€å †æ ·å¼åå†appendè¿›å» å¾ªç¯ä¸­ä½¿ç”¨ fragment æ–‡å­—å¸ƒå±€ text-align: justified white-space: nowrap / pre / pre-wrap overflow: hidden / visible æ¢è¡Œè®¡ç®— æ¯è¡Œä¸€ä¸ªline-boxè´Ÿè´£æ¸²æŸ“ å½“éœ€è¦æ¢è¡Œæ—¶ï¼Œé€šçŸ¥çˆ¶å…ƒç´ â€¦. æ¸²æŸ“ transform / filter / z-index / color / visibility â€¦ Reflow VS Repaintï¼šdisplay none VS visibility hidden æ¸²æŸ“é¡ºåºï¼ˆCSS2ï¼‰ background color background image border children outline æ¸²æŸ“è®¡ç®—çš„ä¼˜åŒ– firefox: display list webkit: rectangle storage chrome çš„ Repaint åœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>æµè§ˆå™¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bashåŸºç¡€ç¼–ç¨‹ (å¬è¯¾ç¬”è®°)]]></title>
    <url>%2Fblog%2F2017%2F04%2Fnotes-of-bash-commands.html</url>
    <content type="text"><![CDATA[ä¹Ÿæ˜¯å»å¹´å…¬å¸åŸ¹è®­é‡Œå¬è¯¾çš„ä¸€äº›ç¬”è®°ï¼Œè¾ƒä¸ºç²—ç•¥ï¼Œä¸»è¦ä¾›è‡ªå·±æŸ¥é˜…ç”¨ã€‚bash å‘½ä»¤è‡ªå·±å¹³æ—¶ç”¨çš„å°‘ï¼Œå¾—ç£ä¿ƒäº†ï¼Œåœ¨å†™ build è¿‡ç¨‹ä¸­å¾ˆç®¡ç”¨çš„ã€‚ çƒ­èº«seq 12seq 0 5seq -s bc 12echo 1+2 | bcecho '1+2' | bc æ±‚å’Œ 1seq -s '+' 100 | bc åŸºç¡€æ¦‚å¿µå‘½ä»¤ å…³é”®å­— å†…å»ºå‘½ä»¤ å¤–å»ºå‘½ä»¤ï¼Œå¦‚ wget shell ç‰¹ç‚¹ quick and dirty ç¬¦åˆ unix å“²å­¦ ä¸€åˆ‡éƒ½æ˜¯å­—ç¬¦ ä¸€åˆ‡éƒ½æ˜¯è¿›ç¨‹ é¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹ è¿è¡Œæ¨¡å¼ äº¤äº’å¼ã€ç™»å½•shell echo &#39;aaa&#39; éäº¤äº’å¼ã€éç™»å½•shell ./xxx.sh éäº¤äº’å¼ã€ç™»å½•shenll bash -l xxx.sh äº¤äº’å¼ã€éç™»å½•shell bash -i xxx.sh å‡ ç§æ¨¡å¼ åŠ è½½çš„æ–‡ä»¶ä¸åŒ æŸ¥çœ‹å½“å‰æ¨¡å¼ï¼šecho $- åŸºç¡€ç¼–ç¨‹å˜é‡ èµ‹å€¼æ—¶=ä¸èƒ½åŠ ç©ºæ ¼ $a =&gt; ${a} å˜é‡å­—ç¬¦åŒ¹é…ï¼šè¢«åŒ¹é…çš„ï¼Œå³æ˜¯è¢«åˆ é™¤çš„ echo ${a##.*} 1234567$&#123;a&#125;$&#123;#a&#125; å˜é‡å¾—é•¿åº¦$&#123;a%&#125; å°¾åŒ¹é…$&#123;a%%&#125; æœ€å¤§å°¾åŒ¹é…$&#123;a#&#125; å¤´åŒ¹é…$&#123;a##&#125; æœ€å¤§å¤´åŒ¹é… æ•°ç»„ 12345array=(a b c)$&#123;a[0]&#125;$&#123;#a[0]&#125; ç¬¬ä¸€ä¸ªå…ƒç´ çš„é•¿åº¦$&#123;a[@]&#125;$&#123;#a[@]&#125; æ•°ç»„çš„é•¿åº¦ æˆåŠŸä¸éæˆåŠŸ 0 ä¸ºæˆåŠŸï¼Œé0 ä¸ºä¸æˆåŠŸ æ‰€æœ‰è¿”å›å€¼ï¼Œä»‹äº 0~255 ä¹‹é—´ true, false å‘½ä»¤ ä¸ã€æˆ–ï¼Œâ€œ&amp;&amp;â€ã€â€œ||â€ &amp;&amp; å¯è¿ç»­å¤šä¸ªï¼Œ|| å»ºè®®åªç”¨äºäºŒé€‰ä¸€ï¼Œé¿å…é€»è¾‘æ··ä¹± æ³¨ï¼šæœ‰ç‚¹ç±»ä¼¼ js é‡Œ echo $? å‰ä¸€æ¬¡è„šæœ¬çš„è¿”å›å€¼ æ¡ä»¶åˆ¤æ–­ è¿”å›å€¼â€œ0â€ä¸ºâ€œçœŸï¼ˆæˆåŠŸï¼‰â€ ifã€testã€[[ ]] bashå…¼å®¹äº†å¾ˆå¤šç§å†™æ³•ï¼Œå»ºè®®åªè®°ä½if [[ ]] å¾ªç¯éå† 12345#!/bin/bashary=(a b c)for (( i=0; i&lt;$&#123;#ary[@]&#125;; i++ )) ; do echo $&#123;ary[$i]&#125;done å­—ç¬¦å¤„ç† æ­£åˆ™ä¸é€šé…ç¬¦ æ­£åˆ™ï¼Œä¸€èˆ¬é€šè¿‡å¤–éƒ¨å‘½ä»¤å®ç°ï¼Œå¦‚ awk, grep ç­‰ é€šé…ç¬¦å³ â€œglobâ€ï¼Œä¼˜å…ˆäºæ­£åˆ™ glob ä¼˜å…ˆ echo 2*3 | bc echo 2* 3 | bc echo 2 * 3 | bc æ­¤æ—¶*ä¼šè¢«è®¤ä¸ºæ˜¯é€šé…ç¬¦ æ ‡å‡†å†™æ³•ï¼šecho &#39;2 * 3&#39; | bc ä½¿ç”¨å•å¼•å· set å‘½ä»¤ï¼šæ›´å¥å£®çš„è„šæœ¬ set -u é˜»æ­¢å˜é‡ç©ºå€¼ï¼ŒæŠ›å‡ºé”™è¯¯ set -e å¼‚å¸¸ false å€¼æ˜¯å¦æ”¾è¡Œ 1false || echo 'something false here' set -o pipefail ç®¡é“ä¸­çš„ false å€¼ é«˜é˜¶è¯é¢˜é”ï¼šä¿è¯å¹‚ç­‰æ€§ æ ‡å‡†æ¨¡æ¿ TODO è°ƒè¯• 12trap DEBUGbash -x here-document æ–‡æœ¬è¾“å…¥ï¼š&lt;&lt; è¿›ç¨‹æ›¿æ¢ 1diff &lt;(echo x) &lt;(echo y) here-string 1sed 's/a/A/' &lt;&lt;&lt; abc å¤šè¿›ç¨‹å¹¶å‘æ§åˆ¶ æ ‡å‡†æ¨¡æ¿ TODO ç”¨ read æ¥é˜»å¡ï¼ˆç­‰è¾“å…¥ï¼‰ ç”¨ fd è¯¯æ“ä½œrm é‡ç¾åŒº 123456rm -rf $dir/rm -rf / dir ï¼ˆè·¯å¾„å‰å¤šäº†ä¸€ä¸ªç©ºæ ¼ï¼Œä¹Ÿç›¸å½“äºæŠŠæ ¹ç›®å½•ä¹Ÿåˆ äº†ï¼‰rm -rf /path/a/bcd dir/ ï¼ˆå¦‚æœdirç›®å½•ä¸å­˜åœ¨ï¼Œä¸çŸ¥é“ä¼šåˆ æ‰å•¥ã€‚ã€‚ï¼‰rm -rf * double check set -ue æ‰§è¡Œå‰åŠ #ï¼Œé˜²æ­¢æ²¡æ•²å®Œæ—¶ç›´æ¥æ‰§è¡Œ]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åšPPTæŠ¥å‘Šçš„è¡¨è¾¾æŠ€å·§ (by æ—å¤§ç­)]]></title>
    <url>%2Fblog%2F2017%2F04%2Ftechniques-for-making-presentations.html</url>
    <content type="text"><![CDATA[å»å¹´åœ¨å…¬å¸å¬äº†æ—å¤§ç­è€å¸ˆå…³äºåšâ€œç®€æŠ¥â€çš„åˆ†äº«ï¼Œâ€œç®€æŠ¥â€æ˜¯å°æ¹¾é‚£è¾¹çš„å«æ³•ï¼Œå°±æ˜¯æˆ‘ä»¬è¯´çš„PPTæŠ¥å‘Šã€‚è™½ç„¶ä¸»è¦é’ˆå¯¹çš„æ˜¯å•†ä¸šæ±‡æŠ¥çš„PPTï¼Œä½†å…¶ä¸­ä¸€äº›æŠ€å·§å¯¹æˆ‘ä»¬æ—¥å¸¸å·¥ä½œè¿˜æ˜¯æŒºæœ‰å¯å‘çš„ã€‚è¿™é‡Œå°±è®°å½•äº†ä¸€äº›ç¬”è®°ï¼ˆæœªæç‚¼è¿‡ï¼‰ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å‚è€ƒå¤§ç­è€å¸ˆçš„è±†ç“£å°ç»„ æ‘˜è¦ ç®€æŠ¥æ²Ÿé€šåŠ› = èŒåœºç«äº‰åŠ› åšäººåšäº‹ï¼Œè¿˜è¦ä¼šä½œç§€ ç®€æŠ¥å°±æ˜¯é€ç¤¼ï¼šç®€å•åˆ°éš¾ä»¥ç½®ä¿¡ (æˆ–è€…) æ‚¬ä¹åˆ°é¬¼æ‰ç›¸ä¿¡ pptæ±‡æŠ¥ä¸è¦å æ»¡æ—¶é—´ï¼Œæå‰ç»“æŸæ‰æ˜¯æ­£ç¡®çš„ å¥½çš„ç®€æŠ¥ï¼šè¯´çœŸè¯ã€ç”¨æ•…äº‹è¯´çœŸè¯ã€ç”¨å›¾ç‰‡è¯´æ•…äº‹ é¦–å…ˆä»‹ç»ä½ çš„tag ä¸è¦è¶…è¿‡3ä¸ªé‡ç‚¹ï¼Œè¶…è¿‡3ä¸ªç­‰äºæ²¡æœ‰é‡ç‚¹ ä¸è¦ç”¨å¤ªå¸¸è§çš„å½¢å®¹è¯ï¼Œæ¯”å¦‚â€œçƒ­æƒ…â€ åŒä¸€ä»¶äº‹æƒ…æ¢å¥è¯è¯´ï¼Œæ¯”å¦‚ç”¨å°æ¹¾çš„ç”¨è¯­ ç”¨å…·ä½“é‡åŒ–çš„è¯æ¥ä»‹ç»tagï¼Œæ¯”å¦‚æ˜Ÿå·´å…‹â€œè„‘æ®‹ç²‰â€ï¼Œå¹³å‡æ¯å¤©2.5æ¯ æœ€æ£’çš„ä¸œè¥¿ä¸è¦åœ¨ç¬¬1é¡µè®²ï¼Œåœ¨é€‚å½“çš„æ—¶å€™å‡ºç°ï¼Œä¹Ÿä¸è¦åœ¨æœ€å æŠ€å·§ ä¸€éƒ¨æœ€çˆ±çš„ç”µå½± â€“&gt; è¯´çœŸè¯ ä¸€å¥ç»å…¸å°è¯ â€“&gt; ç”¨æ•…äº‹è¯´çœŸè¯ ä¸€ä¸ªå°è±¡æœ€æ·±çš„ç”»é¢ â€“&gt; ç”¨å›¾ç‰‡è¯´æ•…äº‹ å†…å®¹ã€è®²è€…ã€å¬ä¼— éƒ½é‡è¦ å¬ä¼—æœ€é‡è¦ ç›®æ ‡å½±å“å†…å®¹ï¼Œæ¯”å¦‚åŠ è–ª3kä¸3w ç‰¹å®šå¯¹è±¡äº§ç”Ÿæ€ç»´çš„æ”¹å˜ ç‰¹å®šå¯¹è±¡é‡‡å–å…·ä½“çš„è¡ŒåŠ¨ ç»“å°¾è¦ç»™å‡ºè¡ŒåŠ¨ï¼Œè€Œä¸æ˜¯â€œè°¢è°¢â€ä¸¤ä¸ªå­— åšç®€æŠ¥çš„rule ä¸è¦æ‰“å¼€ç”µè„‘ï¼Œçº¸ä¸Šä½œä¸š æ¶æ„è§„åˆ’ 3åˆ†æ³•ï¼Œåˆ†ä¸ºPart 1,2,3ï¼Œç„¶å 1.1, 1.2, 1.3 ç­‰ ä¸€å®šè¦å¼ºåˆ¶åˆ†æˆ3ä»½ï¼Œç¼ºä¸€ä¸å¯ï¼Œå®åœ¨ä¸è¡Œå¯ä»¥â€œå…¶ä»–â€ ä¸ä¸€å®šè¦å®Œå…¨ç­‰åˆ† ä¸è¦çº¿æ€§åœ°æ¥åš ä½¿ç”¨ä¾¿ç­¾çº¸æ¥å¯è§†åŒ–é€»è¾‘ ç®€æŠ¥æƒ…å¢ƒ ä¼šè®®æŠ¥å‘Š é”€å”®ææ¡ˆ æ•™è‚²è®­ç»ƒ æ¼”è®²æ•…äº‹ ä¼šè®®æŠ¥å‘Š è¯´æ•…äº‹å¯ä»¥æ‹¿æ¥ç”¨ï¼Œä½†ä¸è¦æœ‰è¯´æ•…äº‹çš„æƒ…å¢ƒ D.I.G æ¥ä¸‰åˆ† Data ä¿¡æ¯çŠ¶å†µï¼Œä¸è¦è®²å¤ªå¤šå¤§å®¶éƒ½çŸ¥é“çš„ï¼Œä½†ä¸€å®šè¦æä¸€ä¸‹ï¼Œæ¯”å¦‚çœ‹æ¯”èµ›è‚¯å®šè¦å…ˆçŸ¥é“æ¯”åˆ†å†æ¥çœ‹ä¸‹é¢çš„ Information å¯¼è‡´ç¼˜æ•…ï¼Œé«˜çº§ä¸»ç®¡æé«˜è¿™å—çš„åˆ†æèƒ½åŠ› Go! è§£å†³æ–¹æ¡ˆï¼Œä½çº§ä¸»ç®¡æ˜¯æé«˜è§£å†³æ–¹æ¡ˆçš„èƒ½åŠ› å‘ä¸Šæ±‡æŠ¥æœ€é‡è¦çš„ä¸æ˜¯è¯´æœåŠ›ï¼Œè€Œæ˜¯å½±å“åŠ›ï¼Œå½±å“é¢†å¯¼åšå†³ç­– é”€å”®ææ¡ˆ M.T.H Motivation å¼•å‘åŠ¨æœº Technique ä¸“ä¸šå†…å®¹ How-to å…·ä½“è¡ŒåŠ¨ åŠ¨æœºæ²¡æœ‰å¯¹é”™ä¹‹åˆ†ï¼Œåªæœ‰å¼ºå¼±ä¹‹åˆ†ï¼Œè§†å¬ä¼—è€Œå®š è¦å®ç°åšå¬ä¼—åˆ†æ å¬è§‰ã€è§†è§‰ + ç¬¬3è§‰ï¼Œèƒ½æœ‰å®ç‰©çš„å°±å¸¦demo å¼•å‘å¬ä¼—çš„è¡ŒåŠ¨ï¼Œè¦å†æœ€åï¼Œå¦‚æœä¸€å¼€å§‹å°±æš´éœ²å°±ä¼šè®©å¬ä¼—åæ„Ÿ]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç°åœ¨è¿˜åœ¨é‡æ„jquery...]]></title>
    <url>%2Fblog%2F2017%2F03%2Fupgrade-to-jquery-seems-outdated.html</url>
    <content type="text"><![CDATA[å‰é¢å¿™äº†ä¸‰ä¸ªå¤šæœˆï¼Œä»11æœˆå¼€å§‹å‰æœŸçš„è®¡åˆ’å’Œè°ƒç ”ï¼Œåˆ°12æœˆå¼€å§‹æ¯å¤©æ—©èµ·ï¼Œåˆ°å¹´å2æœˆåº•å·®ä¸å¤šå°ç»“ã€‚é™¤äº†æ­£å¸¸çš„éœ€æ±‚è¿­ä»£å¼€å‘ä¹‹å¤–ï¼Œå…¨éƒ½æŠ•åœ¨äº†è¿™ä¸€ä»¶äº‹ï¼ŒæŠŠç³»ç»Ÿçš„å‰ç«¯åšäº†ä¸ªå¤§é‡æ„ã€‚è¿™æ˜¯è¿™åŠå¹´çš„ä»£ç é‡ç»Ÿè®¡ï¼Œå®é™…æ²¡é‚£ä¹ˆå¤šï¼Œå› ä¸ºæ˜¯é‡æ„ï¼Œinsertions å’Œ deletions éƒ½ä¼šè¢«å½•å…¥ä»£ç è¡Œæ•°ã€‚çœŸçš„ä½“ä¼šäº†æŠŠé‡æ„æ˜¯ä¸ªä½“åŠ›æ´»å„¿ï¼Œèµ·æ­¥é˜¶æ®µä¼šæ¯”è¾ƒå¿«ï¼Œä½†åé¢ä¼šè¶Šæ¥è¶Šé™·å…¥debugï¼Œè¿™å’Œå¼€å‘æ˜¯ä¸€æ ·çš„ã€‚ã€‚ ä¸šåŠ¡èƒŒæ™¯ä¸Šå›¾æ˜¯æˆ‘æœ€è¿‘åŠå¹´çš„ä»£ç æäº¤ç»Ÿè®¡ï¼Œè¿‘ä¸‰ä¸ªæœˆçš„æäº¤æ¿€å¢ï¼Œæ­£æ˜¯å› ä¸ºé‡æ„ã€‚ç®€å•ç½—åˆ—ä¸‹è¿™é¡¹å·¥ä½œçš„èƒŒæ™¯ å…¬å¸è¿™ä¸ªäº§å“æœ€åˆæ˜¯ç”¨äº†ä¸€ä¸ªå¼€æºæ¡†æ¶å®ç°çš„ï¼Œä½†å»å¹´ä¸‹åŠå¹´è¯¥æ¡†æ¶å·²å®£å¸ƒåœæ­¢ç»´æŠ¤ æ­¤å‰çš„ä»£ç å¤¹æ‚ç€åŸç”Ÿjså’Œæ¡†æ¶jså®ç°çš„é€»è¾‘ï¼Œä½†æ˜¯äº§å“ä¸šåŠ¡çš„å‘å±•ä¸å…è®¸æˆ‘ä»¬åœä¸‹æ‰‹å¤´çš„å·¥ä½œæ¥é‡åšæ­¤å‰çš„ä¸šåŠ¡åŠŸèƒ½ æœ‰ä¸ªå…„å¼Ÿäº§å“å·²ç»å®Œæˆäº†æ—§ä»£ç å’Œæ–°ä¸šåŠ¡é½å¤´å¹¶è¿›çš„æ•´æ”¹ï¼Œå°†æ—§ä»£ç é‡æ„çš„åŒæ—¶ï¼ŒåŠ äº†ä¸€äº›æ–°ä¸šåŠ¡æˆ–æ–°UIå…ƒç´ è¿›å» å› æ­¤å›¢é˜Ÿå†³å®šä»å…„å¼Ÿäº§å“ä¸­æŠ½å–å¯å¤ç”¨çš„ç»„ä»¶å…ƒç´ ï¼Œå½¢æˆæˆ‘ä»¬ä¿©äº§å“é€šç”¨çš„ç»„ä»¶åº“ï¼Œè€Œåœ¨è¿™åŸºç¡€ä¸Šå†å°†æˆ‘ä»¬çš„äº§å“ä»£ç è¿ç§»æˆæ–°ä»£ç ã€‚ è¯´äº†è¿™ä¹ˆå¤šåºŸè¯ï¼Œå…¶å®è¿™å¥—â€œæ–°ä»£ç â€ä»æ˜¯jqueryï¼Œå› ä¸ºä»¥å‰æˆ‘ä»¬è¿jqueryéƒ½ç”¨ä¸èµ·ã€‚ã€‚è™½ç„¶è¿™é¡¹é‡æ„å·¥ä½œæ˜¯å®å®åœ¨åœ¨çš„ä½“åŠ›æ´»ï¼Œä½†ç»å†è¿‡ååˆè®©æˆ‘é‡æ–°æ€è€ƒä»¥å‰å¯¹æ‰€è°“çš„â€œç»„ä»¶â€çš„è®¤è¯†ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹ä¸­èµ°äº†ä¸å°‘å¼¯è·¯ã€‚ åšäº†å•¥ç®€å•ç½—åˆ—ä¸‹æˆ‘æ‰€åšçš„äº‹æƒ… ä»å…„å¼Ÿäº§å“ä¸­æŠ½å–å¯å¤ç”¨çš„ç»„ä»¶å’Œäº¤äº’å…ƒç´ ï¼Œå½¢æˆç»„ä»¶åº“çš„base è¦ä¿è¯ç»„ä»¶ä¸­æ²¡æœ‰ä¸šåŠ¡å¼ºç›¸å…³çš„é€»è¾‘ï¼Œæœ‰åˆ™å¿…é¡»æŠ½ç¦»å‡ºå»ï¼Œä½œä¸ºè‡ªå®šä¹‰å‚æ•°æˆ–å›è°ƒå‡½æ•°çš„æ–¹å¼å®ç° ä¿è¯ç»„ä»¶åº“ä¸­çš„ç»„ä»¶éƒ½æ˜¯å¯ä»¥å¤ç”¨åˆ°ç›¸ä¼¼äº§å“çš„ï¼ŒåŒæ—¶å°½é‡ä¸è¦ç ´åç»„ä»¶åŸæœ‰çš„å‚æ•°æ ¼å¼ ç»„ä»¶åº“ä¸­çš„ç»„ä»¶éƒ½æ˜¯å¯ä»¥å†äºŒæ¬¡æ‰©å±•çš„ï¼Œå¯ä»¥ä½¿ç”¨ç»§æ‰¿æˆ–ç»„åˆçš„æ–¹å¼ï¼Œæ‰å…¥ä¸šåŠ¡å¼ºç›¸å…³é€»è¾‘ ä¸šåŠ¡ç‰¹æœ‰çš„ç»„ä»¶å°±æ”¾åœ¨ä¸šåŠ¡çš„ä»£ç åº“ä¸­ï¼Œæˆ–è€…ç§°ä¸ºä¸šåŠ¡åº“ç»„ä»¶ ä¸šåŠ¡é¡µé¢ä¸­ä¼šåŒæ—¶ä¾èµ–ç»„ä»¶åº“ä¸­çš„ç»„ä»¶å’Œä¸šåŠ¡åº“ç»„ä»¶ ä¸šåŠ¡åº“ç»„ä»¶å¯èƒ½æ˜¯åŸºäºç»„ä»¶åº“ç»„ä»¶åšäºŒæ¬¡å¼€å‘è€Œå½¢æˆçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ç‹¬ç«‹çš„æ–°ç»„ä»¶ ä½¿ç”¨ gulp è¿›è¡Œæ‰“åŒ…ï¼Œå¹¶åšæˆå¯å¤ç”¨çš„buildæ¨¡å— å¯ç”±ä¸šåŠ¡æŒ‡å®šâ€œæˆ‘åªéœ€è¦ç»„ä»¶åº“ä¸­çš„å“ªäº›ç»„ä»¶â€ ç»„ä»¶åº“çš„ç»„ä»¶å’Œä¸šåŠ¡åº“çš„åŒåç»„ä»¶ï¼Œå¯é€šè¿‡ä¸åŒçš„ namespace åŒºåˆ† å¯è‡ªåŠ¨åˆ¤æ–­ä¸€ä¸ªé¡µé¢ä¸­æ‰€éœ€ç»„ä»¶çš„æœ€å°é›†ï¼Œåªå°†æœ€å°‘ä»£ç æ‰“åŒ…åˆ°é¡µé¢ä¸­ æœ€åï¼Œåˆ©ç”¨è¿™å¥—æ¡†æ¶ï¼Œå°†æ—§çš„ä¸šåŠ¡ä»£ç é€é¡µé¢è¿ç§»è¿‡æ¥ã€‚ã€‚è™½ç„¶æœ€åè¿™æ­¥æ˜¯çº¯ç²¹çš„ä½“åŠ›æ´»å„¿ï¼Œä½†å…¶ä¸­è¸©äº†ä¸å°‘å‘ï¼Œä¹Ÿåæ˜ äº†ä¸€äº›è®¾è®¡é—®é¢˜ï¼Œä¼šåœ¨æœ¬æ–‡æœ€åä¸€éƒ¨åˆ†ä¸­ä¸€èµ·æ¥reviewã€‚ ç»„ä»¶åº“class.js å®ç°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950define(function () &#123; var initializing = false; var fnTest = /xyz/.test(function () &#123;var xyz; &#125;) ? /\b_super\b/ : /.*/; // The base Class implementation (does nothing) var Class = function () &#123;&#125;; // Create a new Class that inherits from this class Class.extend = function (prop) &#123; var superProto = this.prototype; // Instantiate a base class (but only create the instance, // don't run the init constructor) initializing = true; var prototype = new this(); initializing = false; // Copy the properties over onto the new prototype for (var name in prop) &#123; // Check if we're overwriting an existing function prototype[name] = typeof prop[name] === 'function' &amp;&amp; typeof superProto[name] === 'function' &amp;&amp; fnTest.test(prop[name]) ? (function (name, fn) &#123; return function () &#123; var tmp = this._super; // Add a new ._super() method that is the same method // but on the super-class this._super = superProto[name]; // The method only need to be bound temporarily, so we // remove it when we're done executing var ret = fn.apply(this, arguments); this._super = tmp; return ret; &#125;; &#125;)(name, prop[name]) : prop[name]; &#125; // The dummy class constructor function Class() &#123; // All construction is actually done in the init method if (!initializing &amp;&amp; this.init) &#123; this.init.apply(this, arguments); &#125; &#125; // Populate our constructed prototype object Class.prototype = prototype; // Enforce the constructor to be what we expect Class.prototype.constructor = Class; // And make this class extendable Class.extend = arguments.callee; return Class; &#125;; return Class;&#125;); ç‰¹ç‚¹ï¼š ç±»å¼ç»§æ‰¿ ç»§æ‰¿çš„é“¾å¼è°ƒç”¨ æä¾›_superè°ƒç”¨çˆ¶ç±»å‡½æ•°çš„æ–¹å¼ ç¼ºç‚¹ ä½¿ç”¨è¿™å¥—æ–¹å¼å®šä¹‰çš„ç±»ï¼Œå®ä¾‹åŒ–åå¯¹è±¡çš„constructoréƒ½æŒ‡å‘äº†ä¸Šé¢çš„Classå‡½æ•°ï¼Œä¸¢å¤±äº†é¢å‘å¯¹è±¡ä¸­é‡è¦çš„instanceofä¿¡æ¯ã€‚ æ³¨ï¼šåœ¨Javascriptæ¨¡å¼ä¹‹äº”-ä»£ç å¤ç”¨æ¨¡å¼å†™è¿‡å¦ä¸€ç§å®ç°ï¼Œä¿ç•™äº†constructor ç±»å±‚æ¬¡ç»“æ„123456789 Class | -------------------------------- | | | ClassBase UIBase ChartBase | | ------- -------- | | | |RecordTarget ç­‰ Dialog, Table ç­‰ å®šä¹‰äº†ä¸‰ç§ base classï¼Œåˆ†åˆ«ä»£è¡¨éUIç»„ä»¶ï¼ŒUIç»„ä»¶å’Œç»˜å›¾ç»„ä»¶ï¼Œå…·ä½“ç»„ä»¶å†ä¾æ¬¡ç»§æ‰¿ã€‚ ç§æœ‰æˆå‘˜ä¿æŠ¤12345678910UIBase.extend(&#123; options: &#123; &#125;, __private: &#123; _items: null, _selectedItems: null &#125;, type: ''&#125;); ç”±äºé€šè¿‡Class.extendï¼Œä¼šå°†æ‰€æœ‰å±æ€§æŒ‚åˆ°prototypeä¸Šï¼Œæ‰€ä»¥å¿…é¡»å°†å®ä¾‹å±æ€§åŒºåˆ†å¼€ï¼Œè¿™é‡Œçº¦å®šå°†__privateé‡Œé¢çš„å±æ€§ç›´æ¥æŒ‚åœ¨å®ä¾‹ä¸Šã€‚ï¼ˆåœ¨ UIBase çš„ init å‡½æ•°é‡Œæ“ä½œï¼‰ ç»„ä»¶æ‰©å±•123456789101112define(function (require) &#123; var Table = require('sawse/component/Table'); return Table.extend(&#123; // è¦†ç›–çˆ¶ç±»æ–¹æ³• render: function (table) &#123; // è°ƒç”¨çˆ¶ç±»çš„åŒåæ–¹æ³• this._super(table); // do something else &#125; &#125;);&#125;); æ„å»ºæ‰“åŒ…1gulp [task] [--dir=PROJECT_DIR] [--config=CONFIG_FILE] ä½¿ç”¨ gulp æ¥ç»„ç»‡æ„å»ºï¼Œå¯¹åº“ä»£ç å’Œä¸šåŠ¡ä»£ç åˆ†åˆ«é…ç½®ã€‚ 123456789101112131415161718192021222324252627282930313233343536&#123; // ç»„ä»¶åº“æ‰“åŒ… libPackConf: &#123; febase: &#123; baseDir: 'fe-base/js/', // ç›¸å¯¹äº src çš„è·¯å¾„ patternsInCopy: ['**/*.js'], // ä»¥ä¸‹è·¯å¾„éƒ½ ç›¸å¯¹äº baseDir ignoresInCopy: ['dep/**/*.js'], // åœ¨ copy æ—¶è¿‡æ»¤ prependsInPack: [], // åœ¨ pack æ—¶è¿½åŠ åœ¨å¼€å¤´ï¼Œä»¥ä¿è¯ä¼˜å…ˆé¡ºåº patternsInPack: ['**/*.js'], // è¦ pack çš„æ–‡ä»¶ï¼Œå¯åŒ…å« prependsInPack çš„æ–‡ä»¶ ignoresInPack: [], // åœ¨ pack æ—¶è¿‡æ»¤ namespace: 'sawse', // ç»„ä»¶å®šä¹‰æ—¶è¿½åŠ çš„å‘½åå‰ç¼€ outputName: 'sawse.js', // æ‰“åŒ…äº§ç‰©çš„æ–‡ä»¶å outputDir: 'js/' // æ‰“åŒ…äº§ç‰©çš„ç›¸å¯¹äº webroot çš„ç›®å½• &#125;, febaseCss: &#123; baseDir: 'fe-base/sass/', // ç›¸å¯¹äº src çš„è·¯å¾„ patternsInCopy: [ // ä»¥ä¸‹è·¯å¾„éƒ½ ç›¸å¯¹äº baseDir '**/*.scss', '**/*.css', 'decorator/**/*' // css å›¾ç‰‡è¦ä¸€èµ· copy è¿‡æ¥ ], ignoresInCopy: [ // åœ¨ copy æ—¶è¿‡æ»¤ 'base/normalize.css', 'base/reset.css' ], prependsInPack: [ 'base/sprite_def.css', // sprite å…ˆå®šä¹‰åœ¨å¼€å¤´ 'base/*.css' // css åˆå¹¶æ—¶è¦ä¿è¯ä¼˜å…ˆé¡ºåº ], patternsInPack: ['**/*.css'], // åªæ‰“åŒ…ç¼–è¯‘åçš„ css æ–‡ä»¶ ignoresInPack: [], // åœ¨æ‰“åŒ…æ—¶æ‰è¿‡æ»¤ outputName: 'sawse.css', // è¾“å‡ºæ‰“åŒ…çš„æ–‡ä»¶åï¼ˆä¸å«è·¯å¾„ï¼‰ outputDir: 'css/sawse/' // ä½œä¸º css/ ä¸‹çš„å®Œæ•´å­ç›®å½•ï¼ˆä¿è¯å›¾ç‰‡å¼•ç”¨æ­£ç¡®ï¼‰ &#125; &#125;&#125; ä»¥ä¸Šåªåˆ—äº†ç»„ä»¶åº“çš„ä¸€äº›é…ç½®é¡¹ï¼Œè¿˜æœ‰å¯¹ä¸šåŠ¡åº“ã€é¡µé¢çš„æ‰“åŒ…é…ç½®ï¼Œå…·ä½“çš„å®ç°æŠ½æˆäº†ä¸€ä¸ªç‹¬ç«‹æ¨¡å—ï¼Œç»†èŠ‚è¿™é‡Œç•¥è¿‡ã€‚ ä½¿ç”¨ glulp å°±æ˜¯å¾ˆå¤šäº‹æƒ…å¾—è‡ªå·±åšï¼Œåœ¨ stream é‡Œåšå­—ç¬¦ä¸²å¤„ç†ï¼Œæ‹¼æ¥æ–‡ä»¶ç­‰æ“ä½œã€‚ã€‚ã€‚ ä¸Šçº¿è€ƒè™‘ç®€å•æ¥è¯´å°±æ˜¯å¾—å…¼å®¹ï¼Œå› ä¸ºé‡æ„å’Œè¿ç§»æ˜¯é€æ­¥æ¨è¿›çš„ï¼Œçº¿ä¸Šä¼šå­˜åœ¨ä¸€ä¸ªè¿‡æ¸¡æœŸï¼Œé€šè¿‡è·¯ç”±å­—å…¸æŒ‡æ˜å“ªäº›æ˜¯èµ°æ–°é¡µé¢ï¼Œå“ªäº›èµ°æ—§é¡µé¢ã€‚è€Œä¸”æ–°æ—§é¡µé¢çš„äº§ç‰©å¿…é¡»åœ¨ä¸¤ä¸ªå®Œå…¨éš”ç¦»çš„ç›®å½•ä¸‹ï¼Œä¾¿äºå‘å¸ƒå’Œå›æ»šã€‚ï¼ˆæ—§é¡µé¢ä¹Ÿå¯èƒ½åœ¨è¿™ä¸ªè¿‡æ¸¡æœŸæœ‰bugfixå‘å¸ƒï¼‰ æ€»ç»“æ€è€ƒ1ã€åŠ¨æ€ç±»å‹ä¸€æ—¶çˆ½ï¼Œä»£ç é‡æ„ç«è‘¬åœº çœŸç†ï¼ç‰¹åˆ«æ˜¯é¢å¯¹å¥½å‡ å¹´å‰çš„Næ‰‹ä»£ç ï¼Œçœ‹ç€å¾ˆæ­£è§„çš„å‡½æ•°åœ¨è°ƒç”¨æ—¶éƒ½ä¼šé˜²ä¸èƒœé˜² éœ€è¦å¥½å¥½è¯„ä¼°é‡æ„çš„ä»£ä»·ï¼Œé‡æ„ä¹‹åä¸€ä¸¤å¹´å†…æ˜¯å¦è¿˜éœ€è¦é‡æ„ï¼Œé•¿ç—›ä¸å¦‚çŸ­ç—›çš„é‡åšè¿˜æ˜¯é‡æ„ 2ã€ä½¿ç”¨ä»€ä¹ˆåº“å¹¶ä¸æ˜¯ç¬¬ä¸€ä½çš„é‡è¦ï¼Œä¸šåŠ¡ç»„ä»¶çš„æ¢³ç†å’Œè§„èŒƒæ€§æ‰æ˜¯é¡µé¢å®ç°æ—¶çš„ç“¶é¢ˆ ä¸ç®¡ç”¨ä»€ä¹ˆåº“ï¼ŒæŠŠä¸šåŠ¡é€šç”¨çš„ç»„ä»¶æ¢³ç†å‡ºæ¥å¹¶è§„èŒƒå‡ ç§ä½¿ç”¨åœºæ™¯ï¼Œè¿™æ˜¯é¡¹ç›®éœ€è¦æ²‰æ·€å‡ºçš„baseï¼Œåœ¨è¿™ä¹‹ä¸Šåšéœ€æ±‚ä¼šå¾ˆå¿« 3ã€ä¸è¦è½»æ˜“å°†ä¸€ä¸ªäº§å“ä¸­çš„ç»„ä»¶å»ç»Ÿä¸€åˆ°å¦ä¸€ä¸ªäº§å“ å³æœ¬æ–‡å¼€å¤´åˆ—çš„ä»å…„å¼Ÿäº§å“ä¸­æŠ½å–å¯å¤ç”¨çš„ç»„ä»¶å’Œäº¤äº’å…ƒç´ ï¼Œå½¢æˆç»„ä»¶åº“çš„baseï¼Œç°åœ¨æ„Ÿè§‰æ˜¯ä»¶å¾ˆå‚»çš„äº‹æƒ…ï¼Œç»éªŒä¸è¶³ ä¸åŒäº§å“å¿…å®šæœ‰ä¸åŒçš„äº¤äº’æ€è·¯ï¼Œæƒ³è¦ä»å…¶ä»–äº§å“æŠ½å‡ºçš„ç»„ä»¶åº“ä½œä¸ºbaseç»„ä»¶ï¼ŒåŠ¿å¿…è¿˜è¦å†åŒ…ä¸€å±‚æ”¹é€ æˆè‡ªå·±äº§å“çš„ä¸šåŠ¡ç»„ä»¶ åªæœ‰çº¯ç²¹çš„ç»„ä»¶åº“æ˜¯å¯å–çš„ï¼Œæ¯”å¦‚ Bootstrapã€ElementUIã€AntDesignï¼Œå¯ä»¥åœ¨å…¶ä¸ŠåŒ…è£…æˆè‡ªå·±çš„ä¸šåŠ¡ç»„ä»¶ 4ã€å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ gulp çš„è‡ªåŠ¨åŒ–ç¨‹åº¦è¿˜ä¸å¤Ÿï¼Œå¾ˆå¤šç‰¹æ€§æ¯”å¦‚å­é¡µé¢çš„æ‰“åŒ…ï¼Œæ¯”å¦‚ç»„ä»¶åŠæ ·å¼çš„åˆ†æ‰¹åˆå¹¶ï¼Œéœ€è¦åœ¨ stream æ‰‹å†™å¾ˆå¤šã€‚ã€‚]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>webç»„ä»¶</tag>
        <tag>AMD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨gitå‘½ä»¤]]></title>
    <url>%2Fblog%2F2017%2F02%2Fcommon-usage-of-git.html</url>
    <content type="text"><![CDATA[ä¸»è¦è®°å½•äº› git å·¥ä½œæµä¸­æœ€æœ€å¸¸ç”¨çš„å‡ ä¸ªæ“ä½œï¼Œå¦‚ï¼šæäº¤åˆå¹¶ï¼Œæ’¤é”€ä¿®æ”¹ï¼Œå›æ»šç­‰æ“ä½œã€‚ ä¹‹å‰ä¹Ÿæ•´ç†è¿‡å…³äº git submodule çš„æ–‡æ¡£ï¼Œè¿™é‡Œç®€å•è®°å½•ä¸€äº›è‡ªå·±å¸¸ç”¨çš„å‘½ä»¤ã€‚ æäº¤ç”¨äºä¿æŒcommitæ ‘çš„æ•´æ´ 12git commit --amend ã€ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ã€‘git pull --rebase æ‰‹åŠ¨åˆå¹¶ 12git fetchgit merge branch_name ã€åœ¨ä¸€ä¸ªåˆ†æ”¯ä¸‹åˆå¹¶å¦ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„æ”¹åŠ¨ã€‘ æ’¤é”€å›é€€1234git rm --cache file_path ã€æ’¤æ¶ˆå·²æš‚å­˜çš„æ–‡ä»¶ã€‘git checkout -- file_path ã€æ’¤æ¶ˆå¯¹æ–‡ä»¶çš„ä¿®æ”¹ã€‘git reset --hard commit_id ã€æ’¤æ¶ˆcommitã€‘git reset --hard HEAD^ ã€å›é€€åˆ°æœ€æ–°çš„å‰ä¸€æ¬¡commitã€‘ Gitå…¥é—¨æŒ‡å—å…«:Gitæ’¤æ¶ˆæ“ä½œ Gitå…¥é—¨æŒ‡å—åä¸€:Git branch åˆ†æ”¯ä¸åˆå¹¶åˆ†æ”¯ å›æ»šçš„ä¸¤ç§æƒ…å†µA) è¿˜æ²¡æœ‰ pushè¿™ç§æƒ…å†µå‘ç”Ÿåœ¨ä½ çš„æœ¬åœ°ä»£ç ä»“åº“ï¼Œå¯èƒ½ä½  add commit ä»¥åå‘ç°ä»£ç æœ‰ç‚¹é—®é¢˜ï¼Œå‡†å¤‡å–æ¶ˆæäº¤ï¼Œç”¨åˆ°ä¸‹é¢å‘½ä»¤ 1git reset [--soft | --mixed | --hard] 1ã€--mixed ä¼šä¿ç•™æºç ï¼Œåªæ˜¯å°† git commit å’Œ index ä¿¡æ¯å›é€€åˆ°äº†æŸä¸ªç‰ˆæœ¬ã€‚git reset é»˜è®¤æ˜¯ â€“mixed æ¨¡å¼ã€‚ 2ã€--soft ä¿ç•™æºç ï¼Œåªå›é€€åˆ° commit ä¿¡æ¯åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œä¸æ¶‰åŠindexçš„å›é€€ã€‚å¦‚æœè¿˜éœ€è¦æäº¤ï¼Œç›´æ¥commitå³å¯ã€‚ 3ã€--hard æºç ä¹Ÿä¼šå›é€€åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œcommit å’Œ index éƒ½å›å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ã€‚æ³¨æ„ï¼Œè¿™ç§æ–¹å¼æ˜¯æ”¹å˜æœ¬åœ°ä»£ç ä»“åº“æºç ã€‚ å½“ç„¶æœ‰äººåœ¨ push ä»£ç ä»¥åï¼Œä¹Ÿä½¿ç”¨ git reset --hard &lt;commit_id&gt; å›é€€ä»£ç åˆ°æŸä¸ªç‰ˆæœ¬ä¹‹å‰ï¼Œä½†æ˜¯è¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œä½ çº¿ä¸Šçš„ä»£ç æ²¡æœ‰å˜ï¼Œçº¿ä¸Šcommit å’Œ indexéƒ½æ²¡æœ‰å˜ï¼Œå½“ä½ æŠŠæœ¬åœ°ä»£ç ä¿®æ”¹å®Œæäº¤çš„æ—¶å€™ä½ ä¼šå‘ç°å…¨æ˜¯å†²çªã€‚ã€‚ã€‚ B) å·²ç» pushå¯¹äºå·²ç»æŠŠä»£ç pushåˆ°çº¿ä¸Šä»“åº“ï¼Œä½ å›é€€æœ¬åœ°ä»£ç å…¶å®ä¹Ÿæƒ³åŒæ—¶å›é€€çº¿ä¸Šä»£ç ã€‚å›æ»šåˆ°æŸä¸ªæŒ‡å®šçš„ç‰ˆæœ¬ï¼Œå¹¶ä½¿çº¿ä¸Š/çº¿ä¸‹ä»£ç ä¿æŒä¸€è‡´ï¼Œè¦ç”¨åˆ°revertå‘½ä»¤ã€‚ git revert: ç”¨äºåè½¬æäº¤ï¼Œæ‰§è¡Œ revert å‘½ä»¤æ—¶è¦æ±‚å·¥ä½œæ ‘å¿…é¡»æ˜¯å¹²å‡€çš„ã€‚ ã€æ³¨æ„ã€‘git revert ç”¨ä¸€ä¸ªæ–°æäº¤æ¥æ¶ˆé™¤ä¸€ä¸ªå†å²æäº¤æ‰€åšçš„ä»»ä½•ä¿®æ”¹ revert ä¹‹åä½ çš„æœ¬åœ°ä»£ç ä¼šå›æ»šåˆ°æŒ‡å®šçš„å†å²ç‰ˆæœ¬ï¼Œè¿™æ—¶ä½ å† git push æ—¢å¯ä»¥æŠŠçº¿ä¸Šçš„ä»£ç æ›´æ–°ï¼Œä¹Ÿä¸ä¼šåƒ reset é€ æˆå†²çªçš„é—®é¢˜ã€‚ 1git revert commit_id revert ä¸ reset åŒºåˆ«reset æ˜¯åœ¨æ­£å¸¸çš„ commit å†å²ï¼Œåˆ é™¤äº†æŒ‡å®šçš„ commitï¼Œè¿™æ—¶ HEAD æ˜¯å‘åç§»åŠ¨äº†ã€‚è€Œ revert æ˜¯åœ¨æ­£å¸¸çš„ commit å†å²ä¸­å† commit ä¸€æ¬¡ï¼Œåªä¸è¿‡æ˜¯åå‘æäº¤ï¼Œå®ƒçš„ HEAD æ˜¯ä¸€ç›´å‘å‰çš„ã€‚ å¦‚æœåœ¨æ—¥åç°æœ‰åˆ†æ”¯å’Œå†å²åˆ†æ”¯éœ€è¦åˆå¹¶çš„æ—¶å€™ï¼Œreset æ¢å¤éƒ¨åˆ†çš„ä»£ç ä¾ç„¶ä¼šå‡ºç°åœ¨å†å²åˆ†æ”¯é‡Œï¼Œä½†æ˜¯ revert æ–¹å¼æäº¤çš„ commit å¹¶ä¸ä¼šå‡ºç°åœ¨å†å²åˆ†æ”¯é‡Œã€‚ å‚è€ƒå›¾è§£Gitï¼šhttps://marklodato.github.io/visual-git-guide/index-en.html å®˜æ–¹æ‰‹å†Œï¼šhttps://git-scm.com/book/zh/v2/]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[1æ¬¡ä¹¦ç­¾åŒæ­¥çš„è¯¯æ“ä½œå]]></title>
    <url>%2Fblog%2F2017%2F02%2Fa-mistake-of-collection.html</url>
    <content type="text"><![CDATA[äº‹æƒ…ç»è¿‡æ˜¯è¿™æ ·çš„ï¼Œå¯èƒ½ chrome è‡ªåŠ¨å‡çº§åï¼Œå½“æˆ‘è®© chrome å¸®æˆ‘è®°ä½å¯†ç æ—¶ï¼Œçªç„¶å¼¹å‡ºç™»å½•è°·æ­Œè´¦å·ã€‚ç”±äºå…¬å¸ç”µè„‘ï¼Œæˆ‘ä»¥å‰æ•…æ„ä¸ç™»å½•ï¼Œä»¥å…åŒæ­¥åœ¨å­¦æ ¡æ—¶ç”¨çš„ä¸€å †è¿‡æ—¶ä¹¦ç­¾ã€‚ä½†å°±åœ¨ä»Šå¤©ï¼Œæˆ‘æ‰‹æŠ–äº†ï¼Œå¿˜äº†è¿™ä¸ªäº‹ï¼Œè¾“å®Œ google è´¦å·åå®ƒæ—§å¼€å§‹å¸®æˆ‘åŒæ­¥ bookmarks äº†ï¼ç„¶è€Œç½‘é€Ÿå¾ˆå¿«ï¼Œä¸€çœ¨çœ¼å°±è¿˜åŸåˆ°æˆ‘å­¦ç”Ÿæ—¶ä»£çš„æ”¶è—å¤¹äº†ã€‚ã€‚ã€‚ æ»¡æ»¡çš„å›å¿†ï¼Œåœ¨å­¦æ ¡çš„æœ€åä¸¤å¹´é‡Œï¼Œè‡ªå·±ç½‘ä¸Šæ‰¾èµ„æ–™å­¦å‰ç«¯ï¼Œæ•´ä¸ªå®éªŒå®¤è¿‘20å·äººå°±æˆ‘ç‹¬çˆ±å‰ç«¯ï¼Œchrome å­˜äº†ä¸€å †ä¹¦ç­¾ï¼Œevernote é‡Œä¹Ÿæ”¶è—äº†ä¸Šç™¾æ¡æ–‡ç« ã€‚åœ¨æˆ‘å‡†å¤‡æ ¡æ‹›é¢è¯•æœŸé—´ï¼Œéƒ½æœ‰æŠŠè¿™äº›å›é¡¾çœ‹è¿‡ã€‚ Webé‡Œå†…å®¹å¤ªå¹¿ï¼Œä»€ä¹ˆéƒ½çœ‹è¿‡ä¸€ç‚¹ï¼Œè¿˜æœ‰æœ¬ç§‘æ—¶ä¸€ç›´å­¦çš„Javaï¼Œè¿™å·®ä¸å¤šæ˜¯æˆ‘åœ¨å­¦æ ¡é‡Œäº†è§£è¿‡çš„æ‰€æœ‰åˆ†ç±» ç„¶è€Œé—®é¢˜æ¥äº†ã€‚ã€‚ã€‚åœ¨å­¦æ ¡é‡Œä¸»è¦ç§¯ç´¯çŸ¥è¯†çš„å¹¿åº¦ï¼Œå› ä¸ºåšçš„â€œäº§å“â€å¹¶ä¸ä¼šæœ‰ç™¾ä¸‡æ•°é‡çº§çš„ç”¨æˆ·å’Œå¹¶å‘ï¼Œæ‰€ç”¨çš„è§£å†³æ–¹æ¡ˆåªè¦å¤Ÿç”¨å°±è¡Œäº†ï¼Œä¸»è¦è¿˜æ˜¯è€ƒå¯Ÿå¦‚ä½•æ›´å¿«æ›´å»‰ä»·çš„æ»¡è¶³éœ€æ±‚ï¼Œé‡åˆ°é—®é¢˜æ—¶å¯ä»¥é€‰æ‹©ç»•è¿‡é—®é¢˜ï¼Œè€Œä¸æ˜¯è§£å†³é—®é¢˜ã€‚ äºæ˜¯åˆ°äº†å…¬å¸ï¼Œçœ‹è§ä»€ä¹ˆéƒ½æ„Ÿè§‰â€œå’¦ è¿™æ„Ÿè§‰å’Œä»¥å‰çœ‹è¿‡çš„å•¥å•¥ç±»ä¼¼â€ï¼Œæƒ³æçš„æ–¹å‘å¤ªå¤šï¼Œæœ€åä»€ä¹ˆä¹Ÿæ²¡æã€‚ã€‚æˆ’éª„æˆ’èºï¼Œå°±æŠ“ä¸€ä¸¤ä¸ªç‚¹ï¼Œåšåˆ°æè‡´]]></content>
      <categories>
        <category>life</category>
      </categories>
      <tags>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥prototype]]></title>
    <url>%2Fblog%2F2017%2F01%2Fprototype-in-detail.html</url>
    <content type="text"><![CDATA[æ¥è‡ªä¸€ä¸ªçŸ¥ä¹ä¸Šçš„è®¨è®º Mark key points here.]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>mark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[(éä¸“ä¸š)å¦‚ä½•å¿«é€Ÿå»ºç«™]]></title>
    <url>%2Fblog%2F2017%2F01%2Fnon-technical-site-making.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡é’ˆå¯¹éè½¯ä»¶è¡Œä¸šäººå£«ï¼Œå¦‚ä½•å¿«é€Ÿå»ºç«™ã€‚è¿™æ ·çš„å»ºç«™éœ€æ±‚å¤§å¤šæ˜¯é¢å‘ä¸­å°å…¬å¸ï¼Œæˆ–è€…ä¸ªä½“å·¥å•†æˆ·ï¼Œæˆ‘å¤§è‡´åˆ†ä¸ºä¸¤ç±»ã€‚ä¸€ç±»æ˜¯é—¨æˆ·å‹ï¼Œåªåšå†…å®¹çš„å®£ä¼ æˆ–è€…äº§å“å¼•å¯¼ï¼Œä¸æ¶‰åŠåˆ°å®¢æˆ·å…¬å¸çš„å…·ä½“ä¸šåŠ¡ã€‚å¦ä¸€ç±»æ˜¯ä¸šåŠ¡å‹ï¼Œå³éœ€è¦åœ¨ç½‘ç«™ä¸Šå®Œæˆå®¢æˆ·çš„å…·ä½“ä¸šåŠ¡ï¼Œæ¯”å¦‚è´­ä¹°ï¼Œæˆ–è€…æ”¶é›†ç”¨æˆ·çš„è¡Œä¸ºã€‚ é—¨æˆ·å‹ç½‘ç«™è¿™ç±»ç½‘ç«™éœ€æ±‚éƒ½æ¯”è¾ƒç®€å•ï¼Œç®€å•ç‚¹éƒ½æ˜¯æ”¾äº›å…¬å¸çš„ä»‹ç»ã€ä¸šåŠ¡èŒƒå›´ã€è”ç³»æ–¹å¼ç­‰å®£ä¼ ææ–™å°±è¡Œäº†ï¼Œå†æ”¾ä¸ªå…¬å¸ä½ç½®çš„ç™¾åº¦åœ°å›¾ï¼Œé¡¶å¤šå†æ¥ä¸ªç•™è¨€åŠŸèƒ½ã€‚å¦å¤–çš„è¯ï¼Œéœ€è¦æœ‰ä¸ªç®¡ç†åå°ï¼Œå¯ä»¥è®©å®¢æˆ·è‡ªå·±ä¿®æ”¹é¡µé¢æ–‡ç« çš„å†…å®¹ã€‚ è¿™ç±»ç®€å•çš„é—¨æˆ·å‹ç½‘ç«™ï¼Œæ‰¾ä¸“ä¸šå¼€å‘äººå‘˜çš„è¯ï¼Œä¼°ä»·åœ¨ 3000 å…ƒå·¦å³ï¼Œè§†ä¸ªäººæˆ–ç½‘ç«™è¡Œä¸šè€Œå®šã€‚è‹¥è¦æ±‚ç‰¹æ®Šçš„æ•ˆæœï¼Œæ¯”å¦‚3Dåœºæ™¯ï¼Œæˆ–è€…éœ€è¦é«˜åº¦å®šåˆ¶çš„äº¤äº’æ•ˆæœçš„è¯ï¼Œä»·æ ¼å¤§å‡ åƒæˆ–ä¸Šè‡³ä¸‡å…ƒä¹Ÿæ˜¯å¯èƒ½çš„ï¼ˆæ¯”å¦‚è¿™ç§ï¼‰ã€‚ å¯¹äºå‰è€…ç®€å•çš„ç½‘ç«™ï¼Œæ²¡å¿…è¦æ‰¾ä¸“ä¸šäººå‘˜å¼€å‘ï¼Œä¸€èˆ¬åƒå…ƒä»¥å†…å°±èƒ½æå®šï¼Œé‚£å°±æ˜¯ä½¿ç”¨â€œå»ºç«™äº§å“â€ã€‚æˆ‘è¿™å„¿æ¨èä¸¤æ¬¾ï¼š 1. å»ºç«™ä¹‹æ˜Ÿï¼šhttp://www.sitestar.cn/å»ºç«™ä¹‹æ˜Ÿæ˜¯ç¾æ©™äº’è”æ——ä¸‹çš„æ¿å—ï¼Œå¯ä»¥åˆ°å®˜ç½‘çš„ä¼ä¸šå»ºç«™æ¿å—ä¸‹çœ‹ã€‚ä»˜çš„è´¹ç”¨å…¶å®å°±æ˜¯ä¹°â€œæ¨¡æ¿â€ï¼Œå‡ ç™¾å—å°±èƒ½ä¹°ä¸€ä¸ªã€‚åŒæ—¶å®ƒä¹Ÿæä¾›äº†ç§äººè®¢åˆ¶çš„æœåŠ¡ï¼Œé‚£å°±è´µäº†ï¼Œå‡ åƒå’Œä¸Šä¸‡çš„éƒ½æœ‰ã€‚ ä¸ºä»€ä¹ˆæˆ‘æ¨èè¿™å®¶å…¬å¸çš„å»ºç«™äº§å“å‘¢ï¼Œå› ä¸ºæˆ‘åšå®¢çš„åŸŸåå°±æ˜¯åœ¨ç¾æ©™äº’è”ä¸Šä¹°çš„ï¼Œå®ƒæ˜¯å›½å†…æ¯”è¾ƒæ—©çš„æåŸŸåæ³¨å†Œå’ŒæœåŠ¡å™¨æ‰˜ç®¡çš„å…¬å¸äº†ï¼Œåº”è¯¥æ¯”é˜¿é‡Œäº‘å’Œä¸‡ç½‘ï¼ˆåŸæ¥æ˜¯ www.net.cnï¼‰éƒ½è¦æ—©ã€‚å› æ­¤è®ºå…¬å¸èµ„è´¨çš„è¯ï¼Œâ€œå»ºç«™ä¹‹æ˜Ÿâ€ä½œä¸ºç¾æ©™äº’è”å…¬å¸çš„ä¼ä¸šå»ºç«™äº§å“ï¼Œåº”è¯¥é è°±ã€‚ è¿™æ˜¯å»ºç«™çš„å¥—é¤ä»·æ ¼ï¼ŒåŒ…å«äº†æœåŠ¡å™¨ç§Ÿè´¹(å å¤§å¤´)ã€åŸŸåè´¹(å¾ˆä¾¿å®œ)ã€ä»¥åŠå»ºç«™æ¨¡æ¿å’Œåå°æœåŠ¡è´¹ã€‚ æ³¨ï¼šè¿™é‡Œçš„â€œç½‘åº—ç‰ˆâ€å³æˆ‘åé¢è¦è¯´çš„ä¸šåŠ¡å‹ç½‘ç«™ 2. å‡¡ç§‘ï¼šhttp://www.faisco.com/å‡¡ç§‘çš„å»ºç«™äº§å“æ˜¯æˆ‘åœ¨çŸ¥ä¹é‡Œçœ‹åˆ°çš„ï¼Œè¯¥å…¬å¸æˆç«‹äº2009å¹´ï¼Œç›¸æ¯”ç¾æ©™äº’è”çš„å…¬å¸èµ„è´¨ç¨é€Šï¼Œè¿™ä¸€ç‚¹å¯ä»¥ä»å®ƒä»¬çš„å®˜ç½‘ä¸Šå¾ˆå®¹æ˜“æ„Ÿè§‰å‡ºæ¥ã€‚ å‡¡ç§‘æœ€å¤§çš„ä¸€ä¸ªä¼˜åŠ¿å°±æ˜¯ä»·æ ¼ï¼Œå¹¶ä¸”å®ƒæä¾›å…è´¹ç‰ˆï¼Œå¯ä»¥å…ˆè¯•ç”¨çœ‹æ•ˆæœã€‚å„ç‰ˆæœ¬çš„åŠŸèƒ½å¯¹æ¯”å¯è¯¦è§ï¼šhttp://jz.faisco.com/proFunc.html æœ€åçœ‹å„äººé€‰æ‹©ï¼Œæƒ³è¦é•¿æœŸç¨³å®šçš„è¯å°±é€‰å»ºç«™ä¹‹æ˜Ÿï¼Œæ¯•ç«Ÿå…¬å¸è§„æ¨¡å¤§ï¼Œé…å¥—è®¾æ–½å¤šï¼›ä½†æƒ³è¦èŠ‚çº¦æˆæœ¬çš„è¯ï¼Œå¯ä»¥å…ˆç”¨å‡¡ç§‘çœ‹æ˜¯å¦èƒ½è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚è¿™é‡Œæœ‰ä¸ªå¯¹ä¸¤è€…äº§å“çš„ä½¿ç”¨è¯„æµ‹ï¼šhttp://jz.faisco.com/news/443 ä¸šåŠ¡å‹ç½‘ç«™å…¶å®ä¸Šé¢ä»‹ç»é—¨æˆ·å‹ç½‘ç«™çš„ä¸¤ä¸ªå…¬å¸é‡Œä¹Ÿéƒ½åŒ…å«â€œè¥é”€ç‰ˆâ€/â€œå•†åŸç‰ˆâ€çš„äº§å“ï¼Œå³ä¸šåŠ¡å‹ç½‘ç«™ã€‚ 1. å¾®ç›Ÿï¼šhttp://weimob.com/å¾®ç›Ÿåœ¨å¾®ä¿¡å…¬ä¼—å·å¼€æ”¾åå¼€å§‹ç«äº†èµ·æ¥ï¼Œæˆ‘ä¸¤ä¸‰å¹´å‰å°±å¬è¯´è¿‡ã€‚å½“æ—¶æœ‰ä¸ªè¢«ç‚’èµ·æ¥çš„æ¦‚å¿µâ€œå¾®å•†â€ï¼Œè€Œå¾®ç›ŸæŠ“ä½äº†è¿™æ¡èˆ¹ï¼ŒæŠŠå¾®ä¿¡å•†åŸåšäº†èµ·æ¥ã€‚æˆ‘å‰å‡ å¤©æœ‰ä¸“é—¨æ‰“è¿‡å’¨è¯¢ç”µè¯ï¼Œäº†è§£åˆ°ä»–ä»¬å»å¹´å°±å¾—åˆ°äº†è…¾è®¯çš„æŠ•èµ„ï¼Œè…¾è®¯å·²æ˜¯ä»–ä»¬ç¬¬äºŒå¤§è‚¡ä¸œã€‚ä¸è¨€è€Œè®ºï¼Œå¾®ç›Ÿçš„å¾®ä¿¡å•†åŸäº§å“è‚¯å®šæ˜¯å¸‚é¢ä¸Šä¸å¾®ä¿¡ç»“åˆåšå¾—æœ€å¥½çš„äº§å“ä¹‹ä¸€ã€‚ï¼ˆ2017.1.10æ—¥æ›´æ–°ï¼Œå¾®ç›Ÿå·²æ‰“é€šå¾®ä¿¡å°ç¨‹åºï¼Œè¯¦è§ä½¿ç”¨è¯´æ˜ï¼‰ è¿™æ¬¾äº§å“å«å¾®ç›Ÿæ—ºé“ºï¼Œæˆ‘åœ¨å¾®ç›Ÿå®˜ç½‘æ‰¾äº†ä¸ªå®¢æˆ·æ¡ˆä¾‹ï¼šhttp://318325.m.weimob.com/vshop/index å¯ç”¨ä»¥ä¸‹äºŒç»´ç æŸ¥çœ‹ 2. åƒç±³ç½‘ï¼šhttp://www.qianmi.com/åƒç±³ç½‘æ˜¯æˆ‘åœ¨å—äº¬è½¯ä»¶å¼€å‘è€…å¤§ä¼šä¸Šäº†è§£çš„è¿™å®¶å…¬å¸ï¼Œå…¬å¸æ€»éƒ¨åœ¨å—äº¬ï¼Œåº”è¯¥è¯´æ˜¯åœ¨æ±Ÿè‹å†…åšç”µå•†äº§å“çš„è¾ƒä¸“ä¸šçš„å…¬å¸ã€‚å…¶å®åœ¨å‰é¢ä»‹ç»é—¨æˆ·å‹ç½‘ç«™æ—¶ï¼Œå»ºç«™ä¹‹æ˜Ÿå’Œå‡¡ç§‘çš„â€œè¥é”€ç‰ˆâ€/â€œç½‘åº—ç‰ˆâ€ä¹Ÿèƒ½æ»¡è¶³å•†åŸçš„éœ€æ±‚ï¼Œä½†æˆ‘ä¼šæ›´å€¾å‘ä¸“ä¸€åšç”µå•†è§£å†³æ–¹æ¡ˆçš„åƒç±³ç½‘çš„äº‘å•†åŸäº§å“ã€‚ä¸»æ‰“â€œé­”æ–¹å»ºç«™â€çš„æ¦‚å¿µï¼Œå³åƒç©é­”æ–¹ä¸€æ ·ï¼Œä¸€è½¬å°±æ˜¯ä¸€ä¸ªé¢ï¼Œç”µå•†çš„å„ä¸ªé¢ã€‚ è¿™æ˜¯è”ç³»ä»–ä»¬å”®å‰é¡¾é—®ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªç¤ºä¾‹ï¼šhttp://store148551.b2c.1000.com/ ï¼ˆæ³¨æ„è¿™æ˜¯æµ‹è¯•çš„ç«™ç‚¹ï¼Œè¯·ä¸è¦çœŸä¸‹å•ï¼‰ æ‰‹æœºç‰ˆ/å¾®ä¿¡ç‰ˆçš„æ¼”ç¤ºå¦‚å›¾ å¯ç”¨ä»¥ä¸‹äºŒç»´ç ä½“éªŒ äº§å“å¯¹æ¯” å¾®ç›Ÿ - æ—ºé“º åƒç±³ç½‘ - äº‘å•†åŸ å¹´è´¹ 10800 6800 PCç‰ˆ æ—  æœ‰ æ‰‹æœºç‰ˆ(æ‰‹æœºæµè§ˆå™¨) æœ‰ æœ‰ å¾®ä¿¡ç‰ˆ åŒæ‰‹æœºç‰ˆ åŒæ‰‹æœºç‰ˆ æ­å»ºæ—¶é—´æˆæœ¬ å…¨åŒ…ï¼Œ1~2å‘¨äº¤ä»˜ æä¾›æ•™ç¨‹ï¼Œéœ€è¦è‡ªå·±åŠ¨æ‰‹ ç»‘å®šåŸŸå ä¸æ”¯æŒï¼ˆç»Ÿä¸€åœ¨ m.weimob.com ä¸‹ï¼‰ æ”¯æŒ ç»‘å®šå¾®ä¿¡å…¬ä¼—å· æ”¯æŒï¼Œå¦‚æœæ˜¯å¾®ä¿¡æœåŠ¡å·çš„è¯ï¼Œå¯ä»¥äº’é€š æ”¯æŒï¼Œä½†ä»…æ˜¯åŠ ä¸ªèœå•é“¾æ¥ æ”¯ä»˜å®ä»˜æ¬¾ æ”¯æŒ ä¸æ”¯æŒ å¾®ä¿¡ä»˜æ¬¾ æ”¯æŒ æ”¯æŒ é“¶è¡Œå¡ä»˜æ¬¾ æ”¯æŒ æ”¯æŒ ä½™é¢å……å€¼ ä¸æ”¯æŒ æ”¯æŒï¼Œä½†ä½œä¸ºä¹°å®¶ä¸€èˆ¬ä¸æ„¿æ„å…… è´­ç‰©éœ€å¦æ³¨å†Œ ä¸éœ€è¦ï¼Œç›´æ¥ä¸ä¹°å®¶å¾®ä¿¡ç»‘å®š éœ€è¦æ³¨å†Œç‹¬ç«‹è´¦å· è®¢å•è·Ÿè¸ª å¯åœ¨å¾®ä¿¡æœåŠ¡å·ä¸­æŸ¥çœ‹ éœ€è¦ä»å…¬ä¼—å·èœå•è¿›å…¥å•†åŸå†æŸ¥çœ‹ å®¢æœæ”¯æŒç³»ç»Ÿ æœªè¯¢é—® ï¼ˆæœŸå¾…ä¸å¾®ä¿¡æœåŠ¡å·çš„æ¶ˆæ¯å¹³å°æ•´åˆï¼‰ ç”±åˆä½œçš„ç¬¬ä¸‰æ–¹å…¬å¸æä¾›å®¢æœç³»ç»Ÿ åˆä½œä»· 199å…ƒ/å¹´ æ€»ç»“ è¦æƒ³å’Œå¾®ä¿¡ç»“åˆç´§å¯†ï¼Œå°±ç”¨å¾®ç›Ÿçš„äº§å“ ä¼˜ç‚¹æ˜¯å…¨åŒ…ï¼ŒæŠŠå•†å“ç´ æå’Œå¾®ä¿¡æœåŠ¡å·æˆæƒç»™ä»–ä»¬ï¼Œå¸®ä½ å…¨ä¸²é€š ç¼ºé™·æ˜¯ä¸èƒ½ç»‘å®šç‹¬ç«‹åŸŸåï¼Œä¹Ÿå°±ä¸èƒ½ä½¿ç”¨ç™¾åº¦æ¥æ¨å¹¿ å»ºè®®ä¹‹åå¯è€ƒè™‘ä½¿ç”¨å»ºç«™ä¹‹æ˜Ÿæˆ–å‡¡ç§‘ï¼Œåšä¼ä¸šé—¨æˆ·ç½‘ç«™ï¼Œç»‘å®šç‹¬ç«‹åŸŸåï¼Œä½¿ç”¨ç™¾åº¦æ¨å¹¿ï¼Œå†åœ¨ç½‘ç«™é‡Œå¼•å¯¼ç”¨æˆ·å…³æ³¨ä¸å•†åŸç»‘å®šçš„å…¬ä¼—å· è¦æƒ³ä¸€æ¬¡æ€§æå®š PC å’Œ æ‰‹æœºç‰ˆ ç»Ÿä¸€çš„å•†åŸï¼Œå°±ç”¨åƒç±³äº‘å•†åŸ ç¼ºç‚¹æ˜¯éœ€è¦æ‰‹å·¥æ“ä½œçš„éƒ¨åˆ†æ¯”è¾ƒå¤š ä¼˜ç‚¹æ˜¯ä¸€æ¬¡æ€§å°±æ”¯æŒåŸŸåï¼Œå¯ä¸º PC å’Œ æ‰‹æœºç‰ˆ åˆ†åˆ«ç»‘å®šäºŒçº§åŸŸå ä½†æˆ‘ä¸æ˜¯å¾ˆå»ºè®®æŠŠ PC ç‰ˆä¹Ÿåšæˆå•†åŸï¼Œå› ä¸ºPCä¸Šçš„è®¢å•é‡åªå 20%ï¼Œè¿™æ˜¯æ·˜å®å¤©çŒ«çš„æ•°æ® ç½‘ç«™è¿è¥é¡ºåº”ç°åœ¨ Mobile First çš„æ½®æµï¼Œæˆ‘çš„å»ºç«™æ€è·¯æ˜¯ å…ˆåšå¥½ç§»åŠ¨ç‰ˆçš„ç«™ç‚¹ï¼Œä¸€å¼€å§‹ä¸è¦åœ¨ PC ç‰ˆæŠ•å…¥è¿‡å¤šäººåŠ›è´¢åŠ› ä½¿ç”¨å¾®ä¿¡å…¬ä¼—å·æ¥è¿è¥ç½‘ç«™ï¼ŒåˆæœŸä¸å»ºè®®åšç‹¬ç«‹ Appï¼Œè´¹é’±ä¸”é»åº¦æ¯”å¾®ä¿¡ä½ å¾…ç§¯ç´¯ä¸€å®šé‡å®¢æˆ·åï¼Œå†åšä¸€ä¸ª PC ç‰ˆçš„ä¸»é¡µï¼Œå¼•æµåˆ°å…¬ä¼—å·ã€‚å¦‚æœä½“é‡çœŸçš„ä¸Šå»äº†ï¼Œå†è€ƒè™‘åš PC ä¸Šçš„ä¸šåŠ¡ç³»ç»Ÿ 1. å¾®ä¿¡è¿è¥å¾®ä¿¡å…¬ä¼—å·çš„ç”³è¯·æ˜¯å…è´¹çš„ï¼Œå»ºè®®ä½¿ç”¨å…¬å¸åä¹‰å»æ³¨å†Œã€‚ä½¿ç”¨å…¬å¸è¥ä¸šæ‰§ç…§å®Œæˆè®¤è¯ï¼Œåªéœ€ 300å…ƒ çš„å¹´è´¹ï¼Œä½†è¿™æ ·å°±å¯ä»¥å‡çº§ä¸ºå¾®ä¿¡â€œæœåŠ¡å·â€ï¼Œæ‹¥æœ‰æ›´å¤šçš„èƒ½åŠ›ã€‚ å¾®ä¿¡æœ‰é…å¥—çš„åå°ç³»ç»Ÿï¼Œå¯ç®¡ç†å…¬ä¼—å·çš„èœå•ï¼Œæ¨é€æ¶ˆæ¯æ–‡ç« ã€‚æ‰¾äººåšäº›è½¯æ–‡å’Œå†…å®¹ç­–åˆ’ï¼Œè¿è¥çš„æˆæœ¬å¾ˆä½ã€‚ 2. ç™¾åº¦æ¨å¹¿ç™¾åº¦æ¨å¹¿æ˜¯ç™¾åº¦é‡è¦çš„æ”¶å…¥æ¥æºï¼Œå…¶ä¸¤å¤§é‡è¦äº§å“å°±æ˜¯å…³é”®è¯æ’åå’Œç½‘ç›Ÿæ¨å¹¿ã€‚å…³é”®è¯å°±ä¸å¤šè¯´äº†ï¼Œç½‘ç›Ÿæ¨å¹¿å°±æ˜¯æŒ‡åœ¨ä¸ç™¾åº¦åˆä½œçš„ä¸Šç™¾ä¸‡å®¶ç½‘ç«™çš„å¹¿å‘Šä½ä¸Šæ¨é€ä½ çš„ç½‘ç«™å’Œå›¾ç‰‡é“¾æ¥ã€‚ æˆ‘ä¹Ÿå’¨è¯¢è¿‡ç™¾åº¦æ¨å¹¿çš„é”€å”®é¡¾é—®ï¼Œé¦–æ¬¡å¼€é€šçš„è¯éœ€è¦ 1000å…ƒå¼€é€šè´¹ + 5000å…ƒå¹¿å‘Šè´¹ã€‚å…¶ä¸­ï¼Œå¦‚æœä½ å·²æœ‰ç‹¬ç«‹åŸŸåçš„ç½‘ç«™ï¼Œ1000å…ƒå¼€é€šè´¹ä¼šåœ¨3ä¸ªæœˆåè¿”å›åˆ°ä½™é¢è´¦æˆ·ä¸­ã€‚è€Œå¹¿å‘Šè´¹æ˜¯æŒ‰æ¬¡æ•°æ‰£è´¹çš„ï¼Œå³ç”¨æˆ·é€šè¿‡ç™¾åº¦çš„æ¨å¹¿ç‚¹å‡»è¿›å…¥ä½ çš„ç½‘ç«™ï¼Œç½‘ç«™æ˜¾ç¤ºæ­£å¸¸çš„è¯å°±è¦æ‰£1æ¬¡è´¹ã€‚ ç«ä»·æ’åï¼Œè¿™ä¸ªè¯ä¹Ÿè®¸å¬è¯´è¿‡ï¼Œæ˜¯æŒ‡å¯¹å…·ä½“ä¸€ä¸ªå…³é”®è¯çš„å‡ºä»·ï¼Œå‡ºä»·è¶Šé«˜åˆ™ä¼šè¶Šä¼˜å…ˆæ˜¾ç¤ºåœ¨æœç´¢ç»“æœçš„å‰æ’ã€‚ä½†ä¹Ÿå¹¶ä¸ç»å¯¹ï¼Œå‡è®¾ä½ ç°åœ¨çš„å‡ºä»·å¯ä»¥æ’åœ¨æœç´¢çš„å‰3é¡µï¼Œä»ç„¶å¯ä»¥é€šè¿‡å¯¹ç½‘ç«™æ ‡é¢˜å’Œå†…å®¹çš„æ›´æ–°ï¼Œä¸»è¦æ˜¯å†…å®¹è¦æœ‰æ–°æ„ï¼Œkeywords å†™å¾—å¥½ï¼Œæ…¢æ…¢åœ°ä½ çš„ç½‘ç«™æ˜¯å¯ä»¥ä¸Šå‡åˆ°ç¬¬1é¡µçš„ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ SEO ä¼˜åŒ–ã€‚ æˆ‘å¬é”€å”®é¡¾é—®è¿™ä¹ˆè¯´ï¼Œä¸€èˆ¬ä¸æ˜¯å¾ˆé€šç”¨å¾ˆå¸¸è§çš„å…³é”®è¯ï¼Œåªè¦å‡ºåˆ°å…³é”®è¯çš„å¹³å‡ä»·ï¼Œä¸€èˆ¬éƒ½èƒ½æŒ¤è¿›å‰ä¸¤é¡µï¼ŒåæœŸå°±é ç½‘ç«™è¿è¥æ…¢æ…¢æå‡æ’åã€‚è€Œè¿™å…³é”®è¯çš„ä»·æ ¼ï¼Œè¦æ ¹æ®æ‰€è¦†ç›–çš„åŸå¸‚ï¼Œå—äº¬ä¸€ä¸ªä»·ï¼Œæ±Ÿè‹ä¸€ä¸ªä»·ï¼Œæ±Ÿæµ™æ²ªåˆæ˜¯ä¸€ä¸ªä»·ï¼Œè¦è¦†ç›–å…¨å›½å°±æ›´è´µäº†ã€‚ æˆ‘è¿™å„¿åªèƒ½æä¾›ä¸€ä¸ªç²—ç•¥çš„æ•°å­—ï¼Œ1~3å…ƒ/æ¬¡ï¼Œéƒ½æ˜¯æ™®é€šè¯è¯­ï¼ˆä¸æ˜¯çƒ­é—¨è¯ï¼‰çš„å¹³å‡ä»·ï¼Œå¯ä»¥ä¼°ç®—ä¸‹è‡ªå·±ç½‘ç«™æ¨å¹¿çš„é¢„ç®—ã€‚ä¸€ä¸ªæ¨å¹¿è´¦å·é‡Œå¯ä»¥é…ç½®1ä¸‡ä¸ªå…³é”®è¯ï¼Œè¦å¯¹æ¯ä¸ªè¯è¯­éƒ½å‡ºä»·ï¼Œæ‰£è´¹ä¹Ÿæ˜¯å¯¹æ¯ä¸ªè¯è¯­ç´¯è®¡çš„ã€‚ æ•°æ®ç»Ÿè®¡æœåŠ¡ç½‘ç«™åšäº†åï¼Œè¿è¥èµ·æ¥åï¼Œå½“ç„¶è¿˜éœ€è¦ç»å¸¸è§‚å¯Ÿä¸‹ç½‘ç«™çš„ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬æœ€åŸºæœ¬çš„ PV / UV è¿™æ ·çš„æ•°æ®ï¼Œè¿›é˜¶äº›å¯èƒ½è¦çœ‹å„é¡µé¢çš„è®¿é—®é‡åˆ†å¸ƒä»¥åŠæ–°è€ç”¨æˆ·çš„å æ¯”ã€‚å†é«˜çº§äº›ä¹Ÿè®¸è¿˜è¦æŸ¥çœ‹ä¸€äº›è½¬åŒ–ç‡æ•°æ®ï¼Œæ¯”å¦‚ä» å•†å“è¯¦æƒ…=&gt;åŠ å…¥è´­ç‰©è½¦=&gt;ä¸‹å•ï¼Œæ¯ä¸ªæ­¥éª¤çš„è½¬åŒ–æ¯”ä¾‹ã€‚ å¯¹äºè¿™æ ·çš„æ•°æ®ç»Ÿè®¡å’Œè§‚å¯Ÿéœ€æ±‚ï¼Œæˆ‘é¦–æ¨ç™¾åº¦ç»Ÿè®¡ï¼Œä¸ä»…ä»…æ˜¯å› ä¸ºæˆ‘è¿™ä¸ªåšå®¢ä¹Ÿä½¿ç”¨äº†å®ƒï¼Œè€Œæ˜¯è¿™ä¸¤ä¸‰å¹´é‡Œæˆ‘ç¡®å®çœ‹åˆ°äº†å®ƒåœ¨è¿›æ­¥ã€‚ï¼ˆå…³é”®è¿˜æ˜¯å…è´¹çš„ï¼‰ å‚è€ƒèµ„æ–™çŸ¥ä¹è®¨è®ºï¼šhttps://www.zhihu.com/question/26027774 å»ºç«™ä¹‹æ˜Ÿï¼šhttp://www.sitestar.cn/ å‡¡ç§‘å»ºç«™ï¼šhttp://jz.faisco.com/ å¾®ç›Ÿé¦–é¡µï¼šhttp://weimob.com/ æ—ºé“ºå®£ä¼ é¡µï¼šhttp://www.weimob.com/website/topic/wangpu æ—ºé“ºäº§å“æ‰‹å†Œï¼šhttp://www.weimob.com/website/site/help?help=12 åƒç±³ç½‘-äº‘å•†åŸï¼šhttp://www.qianmi.com/products/ysc/ ç™¾åº¦æ¨å¹¿ï¼šhttp://e.baidu.com/ ç™¾åº¦ç»Ÿè®¡ï¼šhttp://tongji.baidu.com/]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å»ºç«™</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2016: ç”Ÿæ´»ä¸æ­¢çœ¼å‰çš„è‹Ÿä¸”]]></title>
    <url>%2Fblog%2F2016%2F12%2Fthe-end-of-2016.html</url>
    <content type="text"><![CDATA[ä»Šå¤©åœ£è¯èŠ‚ï¼Œå¯æ˜¯ç¬¬ä¸€æ¬¡ä¸€ä¸ªäººåœ¨å¤–é¢ï¼Œè¿˜ä¸‹ç€é›¨ï¼Œæœªå…æœ‰äº›å‡‰æ„ã€‚è¿˜æ˜¯å’Œä»¥å¾€ä¸€æ ·ï¼Œå‘¨æœ«æ²¡ä»€ä¹ˆäº‹çš„è¯å°±æ¥å…¬å¸å§ï¼Œè‡³å°‘å¹ç€æš–æ°”ï¼Œåº§ä½èˆ’æœäº›ã€‚æœ€è¿‘ä¸¤ä¸‰ä¸ªæœˆæœ‰äº†ç‚¹å†³å¿ƒï¼Œæ¯å¤©éƒ½èƒ½æ—©èµ·ï¼Œæ—©æ—©çš„æ¥å…¬å¸ï¼Œèƒ½é¿å¼€ä¸€æ³¢å…¬äº¤é«˜å³°ã€‚ç›¸å½“æ ‡å‡†çš„ä¸‰ç‚¹ä¸€çº¿ç”Ÿæ´»ï¼Œæ¯å¤©çš„æ­¥æ•°éƒ½èƒ½è¸©åˆ° 6~7 åƒä¹‹é—´ï¼Œè¦è¯´ä¸ç´¯è¿˜çœŸæœ‰ç‚¹ç´¯ï¼Œè¦è¯´æ— èŠè¿˜çœŸæœ‰ç‚¹æ— èŠã€‚ ä¸€ã€æ˜¨å¤©çœ‹åˆ°é˜®ä¸€å³°è€å¸ˆçš„æ–‡ç« ï¼Œç¬¬ä¸€å¥å°±æ˜¯â€œäººç”Ÿæ²¡æœ‰å¤§å˜åŒ–ï¼Œä¸€æ•´å¹´éƒ½åœ¨å·¥ä½œâ€ã€‚ä»–çš„ github çŠ¶æ€ä¹Ÿæ˜¯å˜æ€åˆ°ä»¤äººé¢¤æŠ–ã€‚ã€‚ã€‚ æ­å–œé˜®è€å¸ˆï¼Œæˆ‘å±…ç„¶æ‰¾åˆ°äº†ä¸€ä¸ªç©ºç™½çš„æ ¼å­ã€‚ã€‚ã€‚ æˆ‘çš„å¯¼å¸ˆä¹Ÿå’Œä»–ä¸€æ ·ï¼Œæ˜¯ä¸ªå…¨å¹´å·¥ä½œçš„ç–¯å­ã€‚æˆ‘å¾ˆä½©æœï¼Œçœ‹ç€å®éªŒå®¤è¶Šæ¥è¶Šå¼ºå¤§ï¼Œé™ˆè€æ¿æ­£åœ¨ä¸€æ­¥æ­¥èµ°å‘å·…å³°ï¼Œæ˜¯èº«è¾¹æœ€çœŸå®çš„åŠ±å¿—é¸¡æ±¤ã€‚ äºŒã€æˆ‘å¾ˆåº†å¹¸è‡ªå·±é‡åˆ°äº†é™ˆè€æ¿ï¼Œæˆ‘ä¸å¤ªä¼šè¡¨è¾¾ï¼Œç»å¸¸è¯ä¸è¾¾æ„ã€‚å¤§å››é‚£å¹´æˆ‘è¿˜æ˜¯ä¸ªåªé¡¾ç€è‡ªå·±ï¼Œæœ‰ç‚¹ä¸ç¾ï¼Œè¿˜yyç€å“ªå¤©ä¸€ä¸ªäººè·‘åˆ°è’å±±é‡å¤–å»çœ‹å¤§è‡ªç„¶çš„å¥‡å¦™ã€‚äº†è§£æˆ‘çš„æœ‹å‹æˆ–è®¸çŸ¥é“é‚£æ®µæ—¶é—´æˆ‘ç»å¸¸ä¸€ä¸ªäººéª‘è½¦ã€ç¡è§‰ã€é”»ç‚¼ã€åƒé¥­ï¼Œç”Ÿæ´»å°±æ˜¯è¿™æ ·çš„å¾ªç¯ã€‚ çœŸæ­£æˆé•¿çš„æ—¶å€™åœ¨ 2014 å¹´ï¼Œé‚£å¹´å¼€å§‹å­¦ä¹ äº†å¼€äº†åšå®¢ï¼Œè¿˜å­¦äº†é©¾ç…§ï¼Œé‚£å¹´å¼€å§‹è®¤çœŸç»™è€æ¿å¹²æ´»ï¼Œæ‹¿äº†ä¸å°‘æŠ¥é…¬ã€‚è¿˜æœ‰ï¼Œé‚£å¹´è®¤è¯†äº†æˆ‘çš„é‚£ä¸ªå¥¹ã€‚ ä¸‰ã€è¦è¯´ä»Šå¹´éƒ½å¹²äº†å•¥ï¼Œæ— ééƒ½å’Œè€æ¿å’Œæˆ‘çš„å¥¹æœ‰å…³ã€‚é€šè¿‡é™ˆè€æ¿è®¤è¯†äº†å¦ä¸€ä½â€œè€æ¿â€ï¼Œå¯ä»–å¹¶ä¸åƒè‡ªå·±è€æ¿é‚£æ ·ï¼Œä»–æ›´åƒä¸ªâ€œå•†äººâ€ä¹Ÿè®¸è¿™æ‰æ˜¯çœŸæ­£çš„â€œè€æ¿â€ã€‚é™ˆè€æ¿æ¨èäº†æˆ‘ï¼Œç‰µå¤´ç»™â€œè€æ¿â€åšäº†ä¸€ä¸ªäº§å“çš„åŸå‹ï¼Œè¿‡ç¨‹æœ‰ç‚¹è¾›é…¸ï¼ŒæœŸé—´èº«ä½“è¿˜çŠ¯äº†è€æ¯›ç—…ï¼Œå¹´åˆæ—¶åŠ¨äº†æ‰‹æœ¯ï¼Œæ¢å¤äº†å¥½ä¹…ã€‚ç”Ÿæ´»å°±æ˜¯åœ¨åŒ»é™¢ã€ç”µè„‘ã€å’ŒåºŠä¹‹é—´åˆ‡æ¢ï¼Œè¿˜æœ‰é‚£ä¸ªæˆ‘æ‹…å¿ƒå¥¹ã€å¥¹åˆæ‹…å¿ƒæˆ‘çš„é‚£ä¸ªå¥¹ã€‚ å››ã€é¡ºåˆ©æ¯•ä¸šäº†ï¼Œé™ˆè€æ¿ç»å¯¹æ˜¯ä¸­å›½è‰¯å¿ƒè€æ¿ï¼Œä»–è®©ä½ æ˜ç™½ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥å¹²è‡ªå·±å–œæ¬¢çš„äº‹ï¼Œä½†ä½ ä¸èƒ½ä»€ä¹ˆéƒ½ä¸å¹²ã€‚ä¹Ÿæ²¡å‘è¿‡ä¸€ç¯‡è®ºæ–‡ï¼Œä½†æ‰˜è€æ¿çš„ç¦ï¼Œå»è¿‡äº†åŒ—äº¬ã€æ¡‚æ—ã€å¦é—¨ï¼Œè¿˜æœ‰æ–°åŠ å¡ï¼Œéå¸¸æ£’ï¼åªæ˜¯ä»¥å‰ç­”åº”è¿‡æˆ‘çš„é‚£ä¸ªå¥¹è¦ä¸€èµ·å»å“ªé‡Œå“ªé‡Œï¼Œç»“æœéƒ½å˜æˆäº†æˆ‘è¹­äº†è€æ¿ä¸€ä¸ªäººå»æµªäº†ã€‚ äº”ã€è€æ¿çš„åå¹´ï¼Œä»ä¸€ç©·äºŒç™½å˜æˆäº†ä¸€â€œç©·â€äºŒå¨ƒï¼Œè¿™ç¢—é¸¡æ±¤æˆ‘ä¼šç»§ç»­ç†¬ä¸‹å»ã€‚è¦è¯´ä¸€ç‚¹éƒ½ä¸ç¾¡æ…•åˆ«äººé‚£æ˜¯å‡è¯ï¼Œä½†è‡³å°‘ç°åœ¨è¿˜æœ‰å…¬å¹³çš„æœºä¼šå¯ä»¥åˆ›é€ å¯èƒ½ã€‚æ˜å¹´ä¸€å®šè¦å¸¦æˆ‘çš„é‚£ä¸ªå¥¹å»ä¸€æ¬¡è¯´èµ°å°±èµ°çš„æ—…è¡Œã€‚ è¿™æ ·å°±è¿™æ ·ï¼Œæˆ‘ä»æ˜¯ä¸€ä¸ªä¸å¤ªä¼šè¡¨è¾¾çš„äººã€‚ window.MusicUtil.insertIframe('//music.163.com/outchain/player?type=2&id=167802&auto=1&height=66');]]></content>
      <categories>
        <category>life</category>
      </categories>
      <tags>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹ domReady]]></title>
    <url>%2Fblog%2F2016%2F12%2Fcode-patterns-of-dom-ready.html</url>
    <content type="text"><![CDATA[ç¬¬ä¸€æ¬¡çœ‹åˆ° domReady è¿™ä¸ªå­—çœ¼æ˜¯åœ¨ jquery ä¸­ï¼Œå³ document readyã€‚ä¹‹åä¹Ÿè§åˆ°ä¸€äº›åˆ«äººçš„ä»£ç é‡Œæœ‰ DOMContentLoadedï¼Œå®ƒå’Œé¡µé¢çš„ onload æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä»¥åŠå’Œ document ready æœ‰ä½•æ¸Šæºã€‚ä»¥å‰éƒ½è§è¿‡è¿™äº›è¯ï¼Œä½†éƒ½ä¼¼æ‡‚éæ‡‚ï¼Œä»Šå¤©æŸ¥äº†äº›èµ„æ–™æ”¶é›†äº†äº›ä»£ç ï¼Œåšä¸ªå®Œæ•´çš„ç†è§£ã€‚ ç¬¬ä¸€å°è±¡åœ¨ jquery ä¸­ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª hello world ç¨‹åºï¼Œæ•™ç¨‹ä¸­å¯èƒ½ä¼šæ•™å¦‚ä¸‹çš„å†™æ³•ï¼š 123$(document).ready(function () &#123; // $('#el').on('click', function () &#123;&#125;)&#125;); jquery ä¹Ÿæä¾›äº†ä¸€ä¸ªæ›´ç®€æ´çš„å†™æ³•ï¼Œå³ $(function(){...}) é‚£è¿™æ ·å¥—äº†ä¸€å±‚åï¼Œèƒ½ä¿è¯é‡Œé¢çš„ js ä»£ç ä¼šåœ¨é¡µé¢ DOM æ ‘éƒ½è§£æå®Œåå†æ‰§è¡Œã€‚ 12345678910&lt;head&gt; &lt;script&gt; $(function () &#123; $('#el').html('hello'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="el"&gt;&lt;/div&gt;&lt;/body&gt; å› ä¸ºå¾ˆä¹…ä»¥å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¹ æƒ¯æŠŠ &lt;script&gt; å†™åœ¨ &lt;head&gt; ä¸­ï¼Œè€Œæˆ‘ä»¬çŸ¥é“æµè§ˆå™¨åœ¨è§£æ HTML æ—¶ï¼Œé‡åˆ° script æ˜¯ä¼šé˜»å¡ DOM çš„è§£æï¼ˆå‡†ç¡®æ¥è¯´æ˜¯å¢åŠ  DOM è§£æçš„å›æº¯ï¼‰ã€‚å› ä¸ºæµè§ˆå™¨è¦çŸ¥é“ script é‡Œå¯¹é¡µé¢å¹²äº†å“ªäº›äº‹ï¼Œå¯èƒ½å…ƒç´ åˆä¼šå˜åŒ–ï¼Œæ‰€ä»¥è¦ç­‰ä¸­é€”çš„ script æ‰§è¡Œå®Œæ‰èƒ½ç»§ç»­è§£ææ¸²æŸ“åé¢çš„ DOM elementã€‚ æˆ‘ä»¬å¯ä»¥æ‹¿ä¸‹é¢çš„ä»£ç åšä¸ªå®éªŒï¼š 1234567&lt;body&gt; &lt;h1&gt;hahaha&lt;/h1&gt; &lt;script&gt; debugger &lt;/script&gt; &lt;div id="el"&gt;can you see me&lt;/div&gt;&lt;/body&gt; åœ¨æµè§ˆå™¨ä¸­å¼€ debug æ¨¡å¼ï¼Œå¯ä»¥çœ‹åˆ°åœåœ¨è¿™è¡Œæ—¶ï¼Œé¡µé¢ä¸­èƒ½çœ‹åˆ° &lt;h1&gt; å…ƒç´ ï¼Œä½†ä¸‹é¢é‚£ä¸ª &lt;div&gt; è¿˜æœªè§£æåˆ° DOM æ ‘ä¸­ã€‚ å› æ­¤ï¼Œä¸ºäº†é¿å…åœ¨æ–‡æ¡£è¿˜æœªè§£æå®Œæˆå‰å°±æ“ä½œ DOMï¼ˆå¯èƒ½ä¼šæŠ¥é”™ï¼‰ï¼Œä¹Ÿä¸ºäº†è®© éé¡µé¢å‰ç½®ä¾èµ– çš„è„šæœ¬åœ¨ DOM è§£æå®Œåå†æ‰§è¡Œï¼Œæ‰€æœ‰æ•™ç¨‹ä¸Šéƒ½å»ºè®®æŠŠèƒ½æ”¾åœ¨æœ€åçš„è„šæœ¬éƒ½æ”¾åœ¨æœ€åã€‚ 123456789&lt;body&gt; &lt;h1&gt;hahaha&lt;/h1 &lt;div id="el"&gt;can you see me&lt;/div&gt; &lt;script src="jquery.js"&gt;&lt;/script&gt; &lt;script&gt; // é¡µé¢äº¤äº’é€»è¾‘ ... &lt;/script&gt;&lt;/body&gt; å›åˆ°æœ€å‰é¢ï¼Œ$(document).ready(fn) å°±æ˜¯ç”¨æ¥ä¿è¯ï¼Œå¦‚æœä¸å°å¿ƒå°† script æåˆ°äº†å‰é¢ï¼Œæˆ–è€…å‡ºäºæŸäº›è€ƒè™‘ä¸€å®šè¦ script æå‰ï¼Œé‚£ä¹ˆå®ƒå°†ä¿è¯æ–‡æ¡£ DOM éƒ½è§£æå®Œåå†æ‰§è¡Œ fn å†…éƒ¨çš„ js é€»è¾‘ã€‚ è¦ç†è§£ document readyï¼Œé¦–å…ˆå¾—çœ‹ä¸‹ document çš„æ–‡æ¡£çŠ¶æ€ã€‚ æ–‡æ¡£çŠ¶æ€æ–‡æ¡£åŠ è½½çš„çŠ¶æ€éƒ½åœ¨ document.readyState ä¸­ï¼Œå…·ä½“å¯å‚è§ MDN ä¸Šçš„å®šä¹‰ï¼Œå®ƒæœ‰ä¸‰ä¸ªçŠ¶æ€å€¼ï¼š loadingï¼šæ–‡æ¡£è¿˜åœ¨åŠ è½½ interactiveï¼šdocument å·²åŠ è½½å¹¶è§£æå®Œï¼Œä½†æ–‡æ¡£é‡Œçš„èµ„æºï¼ˆå¦‚æ ·å¼ã€å›¾ç‰‡ã€iframeï¼‰ä»åœ¨åŠ è½½ä¸­ completeï¼šdocument å’Œæ–‡æ¡£é‡Œçš„èµ„æºéƒ½å·²åŠ è½½å®Œï¼Œæ„å‘³ç€å°†è§¦å‘ load äº‹ä»¶ readystatechange äº‹ä»¶å½“ document.readyState å€¼å˜åŒ–æ—¶ï¼Œä¼šè§¦å‘ readystatechange äº‹ä»¶ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹ä»£ç ç›‘å¬ï¼š 12345678document.onreadystatechange = function () &#123; if (document.readyState === 'interactive') &#123; // initLoader ... &#125; else if (document.readyState === 'complete') &#123; // initApp ... &#125;&#125; ç­‰ä»·çš„å†™æ³•ä¹Ÿå¯ä»¥æ˜¯è¿™æ · 123document.addEventListener('readystatechange', function (event) &#123; // event.target.readyState&#125;); DOMContentLoaded VS onloadä» MDN çš„å®šä¹‰ä¸­å¯ä»¥æ˜ç¡®ä¸¤ä»¶äº‹ DOMContentLoaded åœ¨ document.readyState === &#39;interactive&#39; æ—¶è§¦å‘ï¼Œå³é¡µé¢ DOM æ ‘å·²æœ‰ï¼Œä½†æ ·å¼ã€å›¾ç‰‡ç­‰èµ„æºè¿˜åœ¨åŠ è½½ä¸­ã€‚ window.onload åœ¨ document.readyState === &#39;complete&#39; æ—¶è§¦å‘ï¼Œå³é¡µé¢ DOM å’Œå…¶ä»–èµ„æºéƒ½å·²åŠ è½½å®Œæˆã€‚ 123456789document.addEventListener('DOMContentLoaded', function(event) &#123; // ç­‰åŒäº onreadystatechange ä¸­çš„ // document.readyState === 'interactive'&#125;);window.onload = function() &#123; // ç­‰åŒäº onreadystatechange ä¸­çš„ // document.readyState === 'complete'&#125;); åè€…è¿˜å¯ä»¥å†™æˆ window.addEventListener(&#39;load&#39;, function(event) {})ï¼Œä½†è¦æ³¨æ„ä¸‹ addEventListener çš„å…¼å®¹æ€§æ–¹å¼ï¼ˆattachEventï¼‰ã€‚ è¿˜æœ‰æ›´å¤šæ–‡æ¡£çŠ¶æ€çš„äº‹ä»¶ï¼Œå…³äº unload &amp; beforeunload å¯å‚è§MDNç¤ºä¾‹ï¼Œè¿™é‡Œå…ˆè·³è¿‡äº†ã€‚ Polyfillä»ä¸Šä¸€å°èŠ‚ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåˆ¤æ–­é¡µé¢åŠ è½½çš„çŠ¶æ€ï¼Œå…³é”®æ˜¯ readystatechange äº‹ä»¶ï¼Œåœ¨ä¸€ä¸ªäº‹ä»¶å›è°ƒä¸­å¯ä»¥åˆ¤æ–­ document.readyState çš„ä¸‰ç§çŠ¶æ€ã€‚é‚£è¿™ä¹ˆ diao çš„æ–¹å¼ä¸€å®šä¼šå­˜åœ¨å…¼å®¹æ€§é—®é¢˜çš„ï¼Œ æ¥è‡ªMDNï¼š Internet Explorer 8 supports the readystatechange event, which can be used to detect when the DOM is ready. In earlier versions of Internet Explorer, this state can be detected by repeatedly trying to execute document.documentElement.doScroll(â€œleftâ€);, as this snippet will throw an error until the DOM is ready. æœ¬æ–‡æœ€åˆæåˆ°çš„ $(document).ready(fn)ï¼Œç­‰åŒäº DOMContentLoaded çš„è§¦å‘æ—¶åˆ»ï¼Œå³ document.readyState === &#39;interactive&#39; çš„æ—¶åˆ»ã€‚å› æ­¤ jquery åœ¨å®ç° ready å‡½æ•°æ—¶ï¼Œè‚¯å®šè¦æœ‰å¾ˆå¤šå…¼å®¹æ€§çš„è€ƒè™‘ã€‚ åˆæ­¥å…¼å®¹123456789101112131415161718192021document.ready = function (callback) &#123; // å…¼å®¹ FF, Chrome if (document.addEventListener) &#123; document.addEventListener('DOMContentLoaded', function () &#123; document.removeEventListener('DOMContentLoaded', arguments.callee, false); callback(); &#125;, false) &#125; // å…¼å®¹ IE else if (document.attachEvent) &#123; document.attachEvent('onreadytstatechange', function () &#123; if (document.readyState == 'complete') &#123; document.detachEvent('onreadystatechange', arguments.callee); callback(); &#125; &#125;) &#125; else if (document.lastChild == document.body) &#123; callback(); &#125;&#125; è¿™æ˜¯ç½‘ä¸Šæ”¶é›†çš„ä¸€æ®µå®ç° ready çš„ä»£ç ï¼Œä½†æ˜¯ä»ä¸Šé¢ MDN çš„å®šä¹‰ä¸­çŸ¥é“ï¼ŒIE 8 ä»¥ä¸‹æ˜¯ä¸æ”¯æŒ onreadystatechange äº‹ä»¶çš„ã€‚ æ·±åº¦å…¼å®¹123456789101112131415161718192021222324252627282930313233343536373839404142(function () &#123; var ie = !!(window.attachEvent &amp;&amp; !window.opera); var wk = /webkit\/(\d+)/i.test(navigator.userAgent) &amp;&amp; (RegExp.$1 &lt; 525); var fn = []; var run = function () &#123; for (var i = 0; i &lt; fn.length; i++) &#123; fn[i](); &#125; &#125;; var d = document; d.ready = function (f) &#123; if (!ie &amp;&amp; !wk &amp;&amp; d.addEventListener) &#123; return d.addEventListener('DOMContentLoaded', f, false); &#125; if (fn.push(f) &gt; 1) &#123; return; &#125; if (ie) &#123; (function () &#123; try &#123; d.documentElement.doScroll('left'); run(); &#125; catch (err) &#123; setTimeout(arguments.callee, 0); &#125; &#125;)(); &#125; else if (wk) &#123; var t = setInterval(function () &#123; if (/^(loaded|complete)$/.test(d.readyState)) &#123; clearInterval(t); run(); &#125; &#125;, 0); &#125; &#125;;&#125;)(); å¯ä»¥çœ‹åˆ°è¿™é‡Œå°±æ˜¯ç”¨äº† MDN ä¸­æåˆ°çš„ document.documentElement.doScroll(&quot;left&quot;)ï¼Œä¸æ–­å¾ªç¯åœ°å»æ‰§è¡Œå®ƒï¼Œç›´åˆ° DOM ready æ—¶ï¼Œå®ƒå°±ä¸ä¼šæŠ›å¼‚å¸¸äº†ã€‚è¿™æ˜¯ä¸€ç§å€¼å¾—å­¦ä¹ çš„ trick æ–¹å¼ã€‚ jquery å®˜æ–¹å®ç°å®˜æ–¹å®ç°çš„ä»£ç å’Œä¸Šé¢å¤§ä½“ç›¸ä¼¼ï¼Œæˆ‘æ‰¾äº† jquery 1.4.4 çš„ç‰ˆæœ¬ï¼Œå› ä¸ºä¹‹å 1.5.x çš„ ready å‡½æ•°å®ç°ä¸­å¼•å…¥äº†ç±»ä¼¼ promise ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œæ‰€ä»¥ç”¨ä¹‹å‰çš„ç‰ˆæœ¬æ›´èƒ½çº¯ç²¹çš„ç†è§£ dom ready çš„å®ç°ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344bindReady: function() &#123; if ( readyBound ) &#123; return; &#125; readyBound = true; // Catch cases where $(document).ready() is called after the // browser event has already occurred. if ( document.readyState === "complete" ) &#123; // Handle it asynchronously to allow scripts the opportunity to delay ready return setTimeout( jQuery.ready, 1 ); &#125; // Mozilla, Opera and webkit nightlies currently support this event if ( document.addEventListener ) &#123; // Use the handy event callback document.addEventListener( "DOMContentLoaded", DOMContentLoaded, false ); // A fallback to window.onload, that will always work window.addEventListener( "load", jQuery.ready, false ); // If IE event model is used &#125; else if ( document.attachEvent ) &#123; // ensure firing before onload, // maybe late but safe also for iframes document.attachEvent("onreadystatechange", DOMContentLoaded); // A fallback to window.onload, that will always work window.attachEvent( "onload", jQuery.ready ); // If IE and not a frame // continually check to see if the document is ready var toplevel = false; try &#123; toplevel = window.frameElement == null; &#125; catch(e) &#123;&#125; if ( document.documentElement.doScroll &amp;&amp; toplevel ) &#123; doScrollCheck(); &#125; &#125;&#125; jquery ä¸­ ready å‡½æ•°æœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯ä¸Šé¢è¿™æ®µï¼Œå’Œå‰é¢æ·±åº¦å…¼å®¹çš„åŸç†å¤§ä½“ä¸€è‡´ï¼Œä½†æœ‰ä¸€äº›ç‰¹æ®Šçš„ fallback å¤„ç†ï¼Œè¿˜åˆ¤æ–­äº†åœ¨ IE ä¸­æ˜¯å¦æ˜¯é¡¶å±‚ frameã€‚æºä»£ç å¯å‚è§ä»¥ä¸‹é“¾æ¥ï¼š ready å‡½æ•°å…¥å£ bindReady DOMContentLoaded handler doScrollCheck æ£€æµ‹trick jQuery.ready æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ¬¡è®¤çœŸå­¦ä¹  jquery æºç ]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹ RAF]]></title>
    <url>%2Fblog%2F2016%2F12%2Fcode-patterns-of-js-raf.html</url>
    <content type="text"><![CDATA[RAF(requestAnimationFrame) åœ¨å¥½å¤šåœ°æ–¹éƒ½æœ‰è§åˆ°è¿‡ï¼ŒåªçŸ¥é“å®ƒå’Œæµè§ˆå™¨çš„åŠ¨ç”»æœ‰ç‚¹å…³ç³»ï¼Œå®ƒåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Œæœ‰å•¥ä½œç”¨æœ‰å•¥å¥½å¤„ï¼Œä»Šå¤©æŸ¥äº†ä¸€äº›èµ„æ–™å’Œä»¥å¾€çš„ç¬”è®°ï¼Œåšä¸ªæ•´ç†ã€‚ ä»€ä¹ˆæ˜¯ RAFå›æƒ³ç¬¬ä¸€æ¬¡è§åˆ° requestAnimationFrame åº”è¯¥æ˜¯å½“æ—¶åœ¨å…¬å¸å®ä¹ çš„æ—¶å€™ï¼Œç»å¸¸çœ‹åˆ°å®ƒå¸¸å¸¸å’Œ setTimeout åŒæ—¶å‡ºç°ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·çš„ä»£ç ç‰‡æ®µ 1234567var raf = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) &#123; // ä¿è¯ 60fps å¸§ç‡çš„æµç•…æ•ˆæœï¼Œæ¯å¸§é—´éš” 16.7 ms window.setTimeout(callback, 1000 / 60); &#125;; ç¬¬ä¸€å°è±¡ï¼šè¿™è´§å’ŒåŠ¨ç”»æœ‰å…³ï¼Œand è¿™è´§å¯ä»¥ç”¨ setTimeout æ¥æ¨¡æ‹Ÿã€‚ å…³äºå®ƒä»¬ä¸¤è€…çš„å…³ç³»ï¼Œå¯ä»¥çœ‹å¼ é‘«æ—­çš„ç§‘æ™®æ–‡ç« ï¼Œå¯ä»¥æ˜ç¡®ä¸¤ä»¶äº‹ï¼š é€’å½’è°ƒç”¨ setTimeout æ¥åšåŠ¨ç”»æ—¶ï¼Œå¦‚æœé—´éš”æ—¶é—´é€‰æ‹©ä¸å½“ï¼Œæˆ–è€…ä¸­é€”æœ‰å…¶ä»– timer ä»»åŠ¡ä¹±å…¥æ—¶ï¼Œä¼šå¯¼è‡´åŠ¨ç”»å¡é¡¿ è€Œ requestAnimationFrame ä¼šè·Ÿç€æµè§ˆå™¨çš„ç»˜åˆ¶èµ°ï¼Œç”±æµè§ˆå™¨æ¥ä¿è¯å®ƒçš„æ‰§è¡Œé—´éš”æ—¶é—´ï¼ˆ60fps çš„åŠ¨ç”»ç›¸å½“äº 16.7ms ä¸€å¸§ï¼‰ å®˜ç½‘è§£é‡Š The window.requestAnimationFrame() method tells the browser that you wish to perform an animation and requests that the browser call a specified function to update an animation before the next repaint. The method takes as an argument a callback to be invoked before the repaint. ä»¥ä¸Šæ˜¯æ¥è‡ª MDN çš„è§£é‡Šï¼Œé“¾æ¥é‡Œè¿˜åŒ…å«äº† demo ä»£ç ï¼Œä»¥åŠå®ƒçš„å…¼å®¹æ€§æƒ…å†µã€‚ ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨é¡µé¢å½“å‰ä¸åœ¨æ´»åŠ¨çŠ¶æ€ä¸‹ï¼ŒrequestAnimationFrameæ˜¯ä¸ä¼šè¿è¡Œçš„ï¼Œè€Œ setTimeout ä»ä¼šåœ¨åå°è¿è¡Œã€‚ æˆ‘ä¸¾ä¸ªä¸ä¸€å®šæ°å½“çš„ç±»æ¯”ï¼šå¦‚æœ setTimeout æ˜¯ä¸åœé‡è®¾å…ƒç´  position æ¥åšçš„åŠ¨ç”»ï¼Œé‚£ requestAnimationFrame å°±å¥½æ¯”æ˜¯ CSS3 transition åŠ¨ç”»ã€‚æ•ˆæœå’Œæ€§èƒ½ï¼Œæ˜¾ç„¶åè€…èƒœäºå‰è€…ã€‚ PolyfillRAF æ—¢ç„¶è¿™ä¹ˆå¥½çš„ä¸œè¥¿ï¼Œæ˜¾ç„¶æ˜¯å­˜åœ¨å…¼å®¹é—®é¢˜çš„ï¼Œåœ¨ä¸Šé¢ MDN é“¾æ¥é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒIE 10+ï¼Œä¸å®¹ä¹è§‚å•Šã€‚ã€‚ã€‚æ‰€ä»¥æœ¬æ–‡æœ€åˆç¬¬ä¸€å°è±¡çš„é‚£æ®µä»£ç å¯ä»¥è§†ä¸ºä¸€ç§ Polyfill (å¯ä»¥ç†è§£ä¸ºâ€œå¤‡èƒâ€å‡½æ•°) æŸ¥äº†ç½‘ä¸Šçš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ æ·˜å® ä¹Ÿä½¿ç”¨äº†è¿™å¥— Polyfillï¼š 12345678910111213141516171819202122232425262728// http://paulirish.com/2011/requestanimationframe-for-smart-animating/// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating// requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel// MIT license(function() &#123; var lastTime = 0; var vendors = ['ms', 'moz', 'webkit', 'o']; for (var x = 0; x &lt; vendors.length &amp;&amp; !window.requestAnimationFrame; ++x) &#123; window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame']; window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame']; &#125; if (!window.requestAnimationFrame) &#123; window.requestAnimationFrame = function(callback, element) &#123; var currTime = new Date().getTime(); var timeToCall = Math.max(0, 16 - (currTime - lastTime)); var id = window.setTimeout(function() &#123; callback(currTime + timeToCall); &#125;, timeToCall); lastTime = currTime + timeToCall; return id; &#125;; &#125; if (!window.cancelAnimationFrame) &#123; window.cancelAnimationFrame = function(id) &#123; clearTimeout(id); &#125;; &#125;&#125;()); å…³é”®æ˜¯ timeToCall çš„è®¡ç®—ï¼Œä¿è¯æ¯æ¬¡è°ƒç”¨ requestAnimationFrame éƒ½æ˜¯åœ¨æµè§ˆå™¨çš„ç©ºé—²æœŸï¼ˆå‰ä¸€å¸§åŠ¨ç”»å·²ç»æ‰§è¡Œå®Œï¼‰ã€‚ç›¸æ¯”åªä½¿ç”¨ setTimeoutï¼Œå¯ä»¥å‡å°‘åŠ¨ç”»ä¸¢å¸§çš„æƒ…å†µã€‚ åº”ç”¨åœºæ™¯åº”ç”¨1ï¼šç¡®ä¿é¡µé¢onload12345678910111213onLoad: function(callback) &#123; var rAF = window.requestAnimationFrame || window.webkitRequestAnimationFrame || function(fun) &#123; setTimeout(fun, 16); &#125;; if (document.readyState === 'complete') &#123; rAF(callback); &#125; else &#123; window.addEventListener('load', function() &#123; rAF(callback); &#125;); &#125;&#125; ä¸Šè¿°æ•ˆæœå³ window.onload()ï¼Œç¡®ä¿äº† callback éƒ½åœ¨ RAF ä¸­æœ‰åºçš„æ‰§è¡Œï¼Œå‡å°‘äº†æ‰§è¡Œ onload å›è°ƒæ—¶é¡µé¢å¡é¡¿ï¼ˆä¸¢å¸§ï¼‰çš„å‘ç”Ÿæƒ…å†µã€‚ï¼ˆ2017.1.6æ—¥æ›´æ–°ï¼‰ç°åœ¨æˆ‘è§‰å¾—æ˜¯é¿å… onload æ—¶é¡µé¢å·²ä¸å¤„äº active çŠ¶æ€ï¼ˆæ¯”å¦‚ç”¨æˆ·åˆ‡æ¢äº†æµè§ˆå™¨æ ‡ç­¾ï¼‰ï¼Œå› æ­¤ç”¨ RAF å¯ä»¥ä¿è¯é¡µé¢åœ¨ active æ—¶æ‰æ‰§è¡Œå›è°ƒã€‚ åº”ç”¨2ï¼šæ”¹è¿›åŠ¨ç”»æ€§èƒ½12345678910111213141516171819202122232425var requestAnimFrame = window.requestAnimationFrame || (function () &#123; var timeLast = 0; return window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (callback) &#123; var timeCurrent = (new Date()).getTime(); var timeDelta; /* Dynamically set the delay on a per-tick basis to more closely match 60fps. */ /* Technique by Erik Moller. MIT license. */ timeDelta = Math.max(0, 16 - (timeCurrent - timeLast)); timeLast = timeCurrent + timeDelta; return setTimeout(function () &#123; callback(timeCurrent + timeDelta); &#125;, timeDelta); &#125;;&#125;)();// é€’å½’è°ƒç”¨ timeoutself.timer = setTimeout(function () &#123; // ä¿è¯åœ¨ä¸Šä¸€æ¬¡åŠ¨ç”»ç»“æŸåå†æ‰§è¡Œ // è‹¥é¡µé¢ä¸åœ¨ active çŠ¶æ€ä¸‹ï¼ŒrequestAnimFrame ä¸ä¼šæ‰§è¡Œ // ç›¸æ¯” â€œé€’å½’ setTimeoutâ€ åŠ¨ç”»ä¼šä¸€ç›´è¿è¡Œï¼ŒèŠ‚çœCPUï¼ˆå°¤å…¶åœ¨ç§»åŠ¨ç«¯ï¼‰ requestAnimFrame(function () &#123; clearTimeout(self.timer); self.next(); &#125;);&#125;, self.timeout); æ³¨ï¼šè¿™ä¸ªåŠ¨ç”»æ–¹æ¡ˆä¸»è¦ç”¨åœ¨ app å†…åµŒ webview çš„é¡µé¢ä¸­ï¼Œå½“ app ä¸åœ¨æ´»åŠ¨çŠ¶æ€æ—¶ï¼ˆåœ¨åå°é©»ç€ï¼‰ï¼Œé€’å½’çš„ setTimeout ä»ä¼šæ‰§è¡Œä¸‹å»ï¼Œä¼šå¯¼è‡´åå°CPUä½¿ç”¨ç‡å‡é«˜ã€‚è€Œ requestAnimFrame åªä¼šåœ¨é¡µé¢é‡ç»˜çš„æ—¶å€™è°ƒç”¨ï¼Œå½“é¡µé¢ä¸åœ¨ active æ—¶ï¼ŒRAF çš„å›è°ƒå¹¶ä¸ä¼šæ‰§è¡Œã€‚ åº”ç”¨3ï¼šæ¨¡å—æ‡’åŠ è½½1234567891011121314151617181920212223242526var __lazyLoaded = false;function runLazyQueue() &#123; if(__lazyLoaded) &#123; return; &#125; __lazyLoaded = true; $(window).detach("mousemove scroll mousedown touchstart touchmove keydown resize onload", runLazyQueue); var module; while (module = lazyQueue.shift()) &#123; ~function(m)&#123; // ä¿è¯åœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´å¤„ç† JS ç¨‹åº, ä¿è¯ä¸é˜»å¡ window.requestAnimationFrame(function() &#123; new Loader(m.$mod, m.data, m.force); &#125;); &#125;(module); &#125;&#125;$(window).on("mousemove scroll mousedown touchstart touchmove keydown resize onload", runLazyQueue);// æ‹…å¿ƒæœªè§¦å‘ onload äº‹ä»¶, 5s ä¹‹åæ‰§è¡Œæ‡’åŠ è½½é˜Ÿåˆ—window.requestAnimationFrame(function() &#123; runLazyQueue();&#125;, 5000); ä¸»è¦ç”¨äºå½“é¡µé¢ä¸Šæœ‰å¾ˆå¤šä¸ªæ¨¡å—ç»„æˆçš„æ—¶å€™ï¼ˆå°¤å…¶æ˜¯ä¸€äº›å•†å“æ´»åŠ¨é¡µé¢ï¼‰ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ js æ‰§è¡Œé€»è¾‘ï¼Œè€Œåœ¨é¡µé¢åŠ è½½åï¼Œæ²¡å¿…è¦ä¸€ä¸‹å­æŠŠæ‰€æœ‰æ¨¡å—çš„ js é€»è¾‘éƒ½æ‰§è¡Œä¸€éã€‚è¿™é‡Œä¾¿é‡‡ç”¨çš„æ˜¯å½“ç”¨æˆ·æ“ä½œï¼ˆä¾‹å¦‚æ»šåŠ¨é¡µé¢ï¼‰æ—¶ï¼Œæ‰æ‰§è¡Œå„æ¨¡å—çš„ jsã€‚ æˆ‘ä»¬å¯ä»¥ç»“åˆä¹‹å‰çš„å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹JSè§†çª—ï¼Œæ”¹è¿›æ‡’åŠ è½½çš„é€»è¾‘ï¼šå½“æ¨¡å—å¤„åœ¨å½“å‰è§†çª—çš„ä¸€å®šèŒƒå›´å†…æ—¶ï¼Œæ‰æ‰§è¡Œè¯¥æ¨¡å—çš„ js ä»£ç ã€‚ requestAnimationFrame æ˜¯ä¸ªå¥½ä¸œè¥¿ ï¼ˆä»¥ä¸‹ 2017.1.6æ—¥è¡¥å……ï¼‰ åº”ç”¨4ï¼šå‡½æ•°èŠ‚æµ[å¼•è‡ªï¼šghugo.com] åœ¨é«˜é¢‘ç‡äº‹ä»¶ä¸­ï¼Œä¸ºäº†é˜²æ­¢16mså†…å‘ç”Ÿå¤šæ¬¡å‡½æ•°æ‰§è¡Œï¼Œä½¿ç”¨ raf å¯ä¿è¯16mså†…åªè§¦å‘ä¸€æ¬¡ï¼Œè¿™æ—¢èƒ½ä¿è¯æµç•…æ€§ä¹Ÿèƒ½æ›´å¥½çš„èŠ‚çœå‡½æ•°æ‰§è¡Œçš„å¼€é”€ã€‚16mså†…å‡½æ•°æ‰§è¡Œå¤šæ¬¡æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºæ˜¾ç¤ºå™¨16msåˆ·æ–°ä¸€æ¬¡ï¼Œå¤šæ¬¡æ‰§è¡Œå¹¶ä¸ä¼šåœ¨ç•Œé¢ä¸Šæœ‰ä»»ä½•æ˜¾ç¤ºã€‚ 12345678$box.on('mousemove', function(e)&#123; requestAnimationFrame(function()&#123; $point.css(&#123; top : e.pageY, left : e.pageX &#125;) &#125;)&#125;) [å¼•è‡ªï¼š404forest.com] è®¤ä¸ºåœ¨å¾ªç¯ä½“ä¸­è°ƒç”¨ raf å¹¶ä¸èƒ½è¾¾åˆ°çœŸæ­£çš„å‡½æ•°èŠ‚æµï¼Œå› ä¸ºå¾ªç¯ä¸­çš„ raf å·²ç»ä¸€ä¸‹å­æ‰§è¡Œå®Œäº†ï¼Œåªæ˜¯ raf ä¸­çš„å›è°ƒä¼šæŒ‰ç…§ 16ms çš„é¢‘ç‡ä¾æ¬¡æ’é˜Ÿæ‰§è¡Œã€‚ 123456789101112$(function()&#123; var lazyLoadList = [A, B, C, D]; var load = function() &#123; var module = lazyLoadList.shift(); if(module) &#123; new module(); // è¦å†™ä¸ªé€’å½’ï¼Œæ‰èƒ½çœŸæ­£ä¿è¯ä¸€ä¸ªæ¨¡å—åŠ è½½å®Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªæ¨¡å— window.requestAnimationFrame(load); &#125; &#125; window.requestAnimationFrame(load);&#125;) å‚è€ƒæ–‡ç«  å¤©çŒ«å®ä¹ æ—¶ç»„é‡Œçš„å¤§ç¥åšå®¢ï¼šhttp://www.ghugo.com/requestanimationframe-best-practice/ è¯¦ç»†çš„å®éªŒå¯¹æ¯”æ–‡ç« ï¼šhttps://www.404forest.com/2016/08/15/ä½¿ç”¨%20requestAnimationFrame%20å®ç°æ€§èƒ½ä¼˜åŒ–ä¸æ‡’æ‰§è¡Œ/]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘ç«™å®‰å…¨ç›‘æµ‹ - Nodeå®æˆ˜]]></title>
    <url>%2Fblog%2F2016%2F11%2Fnode-action-in-website-detection.html</url>
    <content type="text"><![CDATA[ï¼ˆæ‹–äº†è¿‘ä¸€å¹´çš„æ–‡ç« ï¼‰å»å¹´è¿™ä¸ªæ—¶å€™æ¥äº†ä¸€ä¸ªå¿ƒåŠ›äº¤ç˜çš„é¡¹ç›®ï¼Œå¤§ä½“ç›®æ ‡æ˜¯ï¼š1ã€ä¸ºç”¨æˆ·çš„ç½‘ç«™æä¾›å®‰å…¨ç›‘æµ‹çš„æœåŠ¡ï¼Œç”¨æˆ·åœ¨æˆ‘ä»¬çš„ç®¡ç†ç«¯ç³»ç»Ÿä¸­æ·»åŠ ä¸€ä¸ªç«™ç‚¹å¹¶å‹¾é€‰è¦æ£€æµ‹çš„é¡¹ï¼›2ã€ç„¶åç”±åå°çˆ¬è™«ç³»ç»Ÿå®Œæˆç”¨æˆ·ç«™ç‚¹é“¾æ¥çš„å…¥åº“ï¼Œå¹¶å®šæ—¶é’ˆå¯¹ç«™å†…é“¾æ¥æ‰§è¡Œå„ç§æ£€æµ‹ä»»åŠ¡ï¼›3ã€å†ç”±å‰ç«¯ç³»ç»Ÿç»™ç”¨æˆ·äº¤ä»˜ç½‘ç«™ç›‘æµ‹æŠ¥è¡¨ã€‚åœ¨ä¸­é—´è¿™ä¸€æ­¥ï¼Œæœ€é‡è¦çš„çˆ¬è™«ç³»ç»Ÿï¼Œæˆ‘ç¬¬ä¸€æ¬¡å­¦ä¹ ç”¨ Nodejs æ¥åšã€‚ Nodeèµ·æ­¥å®‰è£… nvm 1curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.25.2/install.sh | bash node 0.12.x 1nvm install 0.12 cnpm é•œåƒ 1npm install --registry=http://r.cnpmjs.org -g cnpm debug å·¥å…· 12cnpm install -g node-inspectornode-debug yourApp.js æ•™ç¨‹ Node.js åŒ…æ•™ä¸åŒ…ä¼š ä¸­æ–‡APIæ–‡æ¡£ ä¸€äº›åº“ ç”¨äºçˆ¬è™« superagent å¤„ç†è¯·æ±‚çš„æ¨¡å— request å¦ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¨¡å—ï¼Œæ¯”èµ· superagentï¼Œè¯­æ³•é…ç½®é¡¹æ›´å¤šä¸€äº›ã€‚å¦‚æœè¯´ superagent æ˜¯ $.post()ï¼Œé‚£ request å°±æ˜¯ $.ajax() cheerio ç”¨äºDOMè§£æï¼Œæä¾›ä¸ jquery é€‰æ‹©å™¨ç±»ä¼¼çš„æ¥å£ å¼‚æ­¥æµç¨‹æ§åˆ¶ Q in Github Promise åŒ–çš„ä¸€ç§å®ç°ï¼Œpromise ä¸æ˜¯ä¸‡èƒ½ï¼Œæ”¹é€ å¤æ‚çš„åŠ¨æ€å†³å®šçš„æ‰§è¡Œé“¾æ˜¯æ¯”è¾ƒçƒ¦çš„äº‹æƒ… async ç‚¹èµæ•°å¾ˆé«˜çš„åº“ï¼Œæœ‰äººè¯´æœ‰æ¯’ï¼Œæˆ‘è§‰ç€å¾ˆå¥½ç”¨ eventproxy @æœ´çµçš„åŸºäºäº‹ä»¶çš„æµç¨‹æ§åˆ¶ï¼Œæˆ‘è§‰ç€å’Œ promise æˆ– async æ­é…ç€ä½¿ç”¨å¾ˆå¥½ç”¨ ä¸»ç¨‹åºè®¾è®¡åœ¨æ‘˜è¦ä¸­å·²ç»æåˆ°ï¼Œè¿™ä¸ªé¡¹ç›®çš„ç›®æ ‡åˆ†ä¸º3æ­¥ï¼šæ·»åŠ æ£€æµ‹ä»»åŠ¡ =&gt; çˆ¬è™«æ‰§è¡Œä»»åŠ¡ =&gt; å‰ç«¯æŠ¥è¡¨å±•ç°ã€‚ä½†åœ¨å…·ä½“å®ç°æ—¶ï¼Œéœ€è¦å¯¹çˆ¬è™«è¿›è¡Œç»†åˆ†ï¼Œæœ€ç»ˆä¼šæœ‰6æ­¥è¿‡ç¨‹ã€‚ 1ã€æ·»åŠ è¦ç›‘æµ‹çš„ç«™ç‚¹ åœ¨webç«¯æ·»åŠ ä¸€ä¸ªç«™ç‚¹ä»»åŠ¡ï¼Œè¾“å…¥å®¢æˆ·çš„æ‘˜è¦ä¿¡æ¯ä»¥åŠè¦ç›‘æ§çš„ç«™ç‚¹åˆ—è¡¨ï¼Œç„¶åå¯ä»¥æ›´æ”¹æ£€æµ‹ç±»åˆ«çš„å‘¨æœŸä»¥åŠå…·ä½“æ£€æµ‹é¡¹ç­‰é…ç½®ã€‚ â€œå¯ç”¨æ€§â€æ£€æµ‹ä¸»è¦æ˜¯ç½‘ç«™çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œé€šå¸¸éƒ½åœ¨é¦–é¡µçš„ http å¤´ä¸­å°±èƒ½æ‰¾åˆ°ã€‚è€Œâ€œå†…å®¹æ£€æµ‹â€éœ€è¦å¯¹ç½‘ç«™ä¸­çš„æ‰€æœ‰é¡µé¢è¿›è¡Œæ£€æµ‹ï¼Œå› æ­¤ä¼šæœ‰ä¸€ä¸ªâ€œæ£€æµ‹æ·±åº¦â€å’Œâ€œæœ€å¤§é¡µæ•°â€çš„é…ç½®ï¼Œé¡µé¢æ·±åº¦è¶Šæ·±ï¼Œé¡µé¢æ•°ç›®ä¼šå‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œè¿™å¯¹çˆ¬è™«æœåŠ¡å™¨æ˜¯å·¨å¤§çš„å‹åŠ›ã€‚ æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªâ€œå®‰å…¨æ£€æµ‹â€çš„æ¨¡å—ï¼Œå…·ä½“æ£€æµ‹é¡¹æœ‰ï¼šActiveXæŒ‚é©¬ï¼ŒiframeæŒ‚é©¬ï¼ŒjsæŒ‚é©¬ï¼ŒWebShellåé—¨ï¼Œæš—é“¾ï¼Œä»¥åŠåå°åœ°å€æ£€æµ‹ã€‚ç”±äºæˆ‘å¯¹å®‰å…¨æ–¹é¢äº†è§£å¤ªå°‘ï¼Œåœ¨è¿™ä¸ªç³»ç»Ÿä¸­å®ç°å¾—ä¹Ÿå¾ˆsimpleï¼Œå°±ä¸å¤šè¯´äº†ã€‚ã€‚ã€‚ 2ã€ç«™ç‚¹å…¥åº“ç”±äºä¸Šé¢â€œå†…å®¹æ£€æµ‹â€å’Œâ€œå®‰å…¨æ£€æµ‹â€éƒ½éœ€è¦å¯¹ç½‘ç«™é¦–é¡µä¸‹çš„å…¶ä»–é¡µé¢å…¨éƒ¨æ£€æµ‹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ä¸ª site è¡¨å’Œ site_link è¡¨ï¼Œè®°å½•ä¸‹ç½‘ç«™çš„åŸŸåå’Œ ip ä¿¡æ¯ï¼Œå¹¶ä¸”å­˜ä¸‹æ¯ä¸ªé¡µé¢é“¾æ¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¥é¡µé¢ç›¸å¯¹äºé¦–é¡µçš„æ·±åº¦å±‚çº§ï¼Œè¯¥é¡µé¢çš„é“¾æ¥æ˜¯ åŒæºã€åŒåŸŸ è¿˜æ˜¯ å¤–é“¾ï¼Œä»¥åŠé¡µé¢çš„å‘ç°æ—¶é—´ã€çŠ¶æ€ä¿¡æ¯ç­‰ã€‚ å¦å¤–æ³¨æ„çš„æ˜¯ï¼Œä»é¦–é¡µå¼€å§‹å–é“¾æ¥ï¼Œç„¶åå†å¯¹é“¾æ¥å†å–å®ƒçš„åç»§é“¾æ¥ï¼Œæ•´ä¸ªè¿‡ç¨‹åº”é‡‡ç”¨â€œå¹¿åº¦ä¼˜å…ˆâ€çš„ç­–ç•¥ã€‚è€Œâ€œæ£€æµ‹æ·±åº¦â€å’Œâ€œæœ€å¤§é¡µæ•°â€ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™è¿›è¡Œé™åˆ¶çš„ï¼Œå¦‚æœå½“å‰é¡µé¢æ·±åº¦ä¸º Nï¼ŒN + 1 &gt; æ£€æµ‹æ·±åº¦ï¼Œé‚£ä¹ˆè¯¥é¡µé¢å°±ä¸å†å¾€çˆ¬å–é˜Ÿåˆ—ä¸­ push åç»§é“¾æ¥äº†ã€‚ 3ã€å‘¨æœŸæ€§ç”Ÿæˆæ£€æµ‹ä»»åŠ¡ç«™ç‚¹ä»»åŠ¡é…ç½®å®Œï¼Œç«™ç‚¹é“¾æ¥ä¹Ÿå…¥å®Œåº“ï¼Œè¿™æ—¶å€™å°±å¯ä»¥æ ¹æ®ä¸Šé¢é…ç½®çš„æ£€æµ‹å‘¨æœŸæ¥å®šæ—¶äº§ç”Ÿä»»åŠ¡ã€‚ä¾‹å¦‚å½“å†…å®¹æ£€æŸ¥çš„å‘¨æœŸåˆ°æ¥æ—¶ï¼Œéœ€è¦å–å‡ºè¯¥ç«™ç‚¹ä¸‹æ‰€æœ‰ç¬¦åˆçš„é¡µé¢é“¾æ¥ï¼Œå¯¹æ¯ä¸ªé¡µé¢çš„æ¯ä¸ªæ£€æµ‹é¡¹éƒ½ç”Ÿæˆ1ä¸ªæ£€æµ‹ä»»åŠ¡ã€‚ éœ€è¦æ³¨æ„ç”Ÿæˆä»»åŠ¡æ—¶ï¼Œè¦æŒ‰ç…§é¡µé¢é“¾æ¥çš„é¡ºåºæ¥éå†ï¼Œè€Œä¸æ˜¯å…ˆéå†æ£€æµ‹é¡¹ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯å½“å…·ä½“çˆ¬è™«æ‰§è¡Œæ—¶ï¼Œç›¸åŒ url çš„æ£€æµ‹ä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­ä¼šè¿ç»­æŒ¨ç€ï¼Œè¿™æ ·å¯ä»¥ç»™çˆ¬è™«åšçˆ¬å–çš„åˆå¹¶ï¼ŒåŒæ ·çš„ url åªéœ€è¦çˆ¬å–1éï¼Œå°±å¯ä»¥ç»™ä¸åŒçš„æ£€æµ‹ä»»åŠ¡å»æ‰§è¡Œã€‚ 4ã€çˆ¬è™«æ‰§è¡Œæ£€æµ‹ä»»åŠ¡å¦‚æœè¯´ç¬¬3æ­¥ç”Ÿæˆä»»åŠ¡æ˜¯â€œç”Ÿäº§è€…â€ï¼Œé‚£ä¹ˆç°åœ¨å°±è½®åˆ°â€œæ¶ˆè´¹è€…â€ã€‚çˆ¬è™«ç³»ç»Ÿè¦æ”¯æŒå¹¶å‘ï¼Œå¤šæœºå™¨ + å¤šçº¿ç¨‹ã€‚åœ¨1å°æœºå™¨ä¸Šï¼Œ1æ¬¡ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–100ä¸ªå‡ºæ¥ï¼Œå¦‚ç¬¬3æ­¥æ‰€è¯´æ£€æµ‹ä»»åŠ¡æ˜¯æŒ‰ç›¸åŒurlè¿ç»­æ’åˆ—çš„ï¼Œé‚£ä¹ˆè¿™100ä¸ªæ£€æµ‹ä»»åŠ¡å¯ä»¥æŠ½å‡º20ä¸ªä»»åŠ¡ç»„ï¼ˆä¸¾ä¸ªä¾‹å­ï¼‰ï¼Œæ¯ä¸ªä»»åŠ¡ç»„éƒ½å¯ä»¥åªçˆ¬å–1ä¸ªé¡µé¢ï¼Œç„¶åå°†å†…å®¹ä¼ é€’ç»™å„æ£€æµ‹é¡¹å»æ‰§è¡Œã€‚è€Œæ¯ä¸ªæ£€æµ‹é¡¹çš„æ‰§è¡Œç»“æœéƒ½ä»¥ log çš„å½¢å¼å­˜å‚¨ã€‚ å¦‚æœçˆ¬è™«çš„æœºå™¨ä¸æ˜¯é‚£ç§â€œæ ‘è“æ´¾â€å¾®å‹æœºå™¨ï¼Œé‚£å¯ä»¥å…ˆå°† log ä»¥æ–‡ä»¶å½¢å¼å­˜åˆ°æœ¬åœ°ï¼Œç•™å‡ºå¸¦å®½ç»™çˆ¬è™«ã€‚æˆ–è€…æ¯ä¸ªæ£€æµ‹é¡¹çš„ç»“æœ log éƒ½å‘é€åˆ°1ä¸ªæŒ‡å®šçš„åœ°æ–¹ï¼Œè¿™å°±ä¼šå¤šå ç”¨å¸¦å®½ï¼Œä¹Ÿéœ€è¦ä¸“é—¨æ1å°æ—¥å¿—æœåŠ¡å™¨ã€‚ 5ã€å®šæ—¶è®¡ç®—æ—¥å¿—çˆ¬è™«çš„ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹æ˜¯å¾ˆè¿ç»­åˆå¾ˆç¦»æ•£çš„ï¼Œè¿ç»­æ˜¯å› ä¸ºåšå®Œ1ä¸ªå°±è¦åšä¸‹1ä¸ªï¼Œç¦»æ•£æ˜¯è¯´æ—¥å¿—çš„ç¦»æ•£ï¼Œå•ç‹¬1ä¸ªé¡µé¢çš„1ä¸ªæ£€æµ‹é¡¹çš„1æ¬¡æ‰§è¡Œæ—¥å¿—å¹¶æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œè¦æ•´åˆåˆ°æ•´ä¸ªç«™ç‚¹å’Œæ—¶é—´æ®µã€æ£€æµ‹ç±»åˆ«çš„ç»´åº¦æ¥çœ‹æ‰æœ‰ä»·å€¼ã€‚ä»å‰é¢çš„æ­¥éª¤å¯ä»¥çœ‹åˆ°ï¼Œç«™ç‚¹é“¾æ¥çš„å…¥åº“ä»¥åŠå‘¨æœŸæ€§çš„ç”Ÿæˆä»»åŠ¡æ—¶ï¼Œä¼šæœ‰ä¸€å®šçš„â€œé¡ºåºâ€æ§åˆ¶ï¼Œå¹¶ä¸”åªæœ‰å…¨éƒ¨å…¥å®Œåº“æ‰ä¼šè¿›å…¥ä¸‹ä¸€æ­¥éª¤ã€‚è€Œçˆ¬è™«ç³»ç»Ÿæ˜¯å¾ˆç¦»æ•£çš„ï¼Œå®ƒå¯èƒ½åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ä¸Šï¼Œåªè¦ä»»åŠ¡é˜Ÿåˆ—ä¸­æœ‰ä¸œè¥¿ï¼Œå®ƒå°±ä¼šå–å‡ºæ¥æ‰§è¡Œï¼Œä¹Ÿä¸ä¼šåŒºåˆ†ä»»åŠ¡æ˜¯æ¥è‡ªå“ªä¸ªç«™ç‚¹å“ªä¸ªç±»åˆ«çš„ã€‚ å› æ­¤ï¼Œå¦‚æœ log åˆ†å¸ƒåœ¨å„çˆ¬è™«æœºå™¨ä¸Šï¼Œé‚£å°±éœ€è¦ä¸€ä¸ªå®šæ—¶çš„è„šæœ¬å¯¹å…¶è¿›è¡Œæ±‡æ€»è®¡ç®—åä¼ å›æ•°æ®ä¸­å¿ƒã€‚è€Œå¦‚æœæœ‰ç»Ÿä¸€çš„æ—¥å¿—æœåŠ¡å™¨ï¼Œé‚£åŒæ ·éœ€è¦å°†åŸå§‹æ—¥å¿—è®¡ç®—æˆæœ‰æ•ˆçš„æ•°æ®ã€‚ 6ã€å‰ç«¯æŠ¥è¡¨æŸ¥è¯¢å‰ç«¯ç³»ç»Ÿç›´æ¥æŸ¥æ•°æ®ä¸­å¿ƒï¼Œå¯ä»¥å¾—åˆ°ç«™ç‚¹çº§å’Œæ£€æµ‹ç±»åˆ«çº§çš„æŠ¥å‘Šã€‚å‰é¢â€œç”Ÿäº§è€…â€ç”Ÿæˆæ£€æµ‹ä»»åŠ¡æ—¶ï¼Œä¼šåœ¨æ•°æ®åº“ä¸­æ‰“ä¸Šä¸€äº›ä»»åŠ¡æ¨¡å—çš„æ—¶é—´ä¿¡æ¯ï¼Œå‰ç«¯ç³»ç»Ÿä¹Ÿèƒ½å¤ŸæŸ¥åˆ°ä¸€äº›è°ƒåº¦çŠ¶æ€ä¿¡æ¯ã€‚ æ¶æ„å›¾æ•´ä¸ªç³»ç»Ÿåˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼šå‰ç«¯ç³»ç»Ÿã€ä»»åŠ¡Producerã€çˆ¬è™«ç³»ç»Ÿã€æ—¥å¿—è®¡ç®—åŒæ­¥è¿›ç¨‹ã€‚æ¶æ„å›¾å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ç®­å¤´å°±ä»£è¡¨ç€æ•°æ®æµçš„æ–¹å‘ã€‚ è€Œçˆ¬è™«è°ƒåº¦å’Œæ‰§è¡Œæ˜¯å…¸å‹çš„â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼ï¼Œè¿™é‡Œç”Ÿäº§è€…åªæœ‰1ä¸ªï¼Œè€Œæœ‰Nä¸ªæ¶ˆè´¹è€…çˆ¬è™«è¿›ç¨‹ã€‚ æ‰€è°“çš„æ£€æµ‹ä»»åŠ¡é˜Ÿåˆ—ï¼Œå®é™…å°±æ˜¯æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨ï¼Œå¤šä¸ªçˆ¬è™«è¿›ç¨‹æˆ–å¤šå°çˆ¬è™«æœºå™¨éƒ½å…±äº«è¿™å¼ è¡¨ï¼Œåªè¦ä¿è¯ä»è¡¨çš„é¡¶éƒ¨å¼€å§‹è¯»å–ï¼Œè¯»å®Œåå°±è¦é‡ç½®çŠ¶æ€ä½ï¼Œé˜²æ­¢è¢«å…¶ä»–è¿›ç¨‹é‡å¤è¯»å–ã€‚è€Œå½“ä»»åŠ¡æ‰§è¡Œå¤±è´¥åï¼Œä¼šå°†è¯¥æ£€æµ‹ä»»åŠ¡çš„è®°å½•ç§»åˆ° table çš„é˜Ÿå°¾ï¼Œå¹¶è®¾ç½®1ä¸ªå¤±è´¥æ¬¡æ•°çš„å­—æ®µã€‚ çˆ¬è™«å®ç°æ€è·¯æŠ€æœ¯æ¡†æ¶åœ¨æœ¬æ–‡ç¬¬ä¸€èŠ‚ä¸­å°±åˆ—å‡ºäº†ä¸€äº›åº“ï¼Œåœ¨é¡µé¢çˆ¬å–æ–¹é¢ï¼Œä½¿ç”¨ superagent è·å–é¡µé¢å†…å®¹ï¼Œä½¿ç”¨ cheerio åšæ–‡æ¡£è§£æã€‚è€Œå¯¹äºä¸€äº›ä¸éœ€è¦è§£æå†…å®¹çš„çˆ¬å–ä»»åŠ¡ï¼ˆæ¯”å¦‚æŸ¥è¯¢æŸä¸ªé¡µé¢çš„ header ä¿¡æ¯ï¼Œæˆ–æ˜¯æ£€æŸ¥æŸä¸ªé¡µé¢æ˜¯å¦ 200 çŠ¶æ€ï¼‰ï¼Œä½¿ç”¨ request æ¥å‘è¯·æ±‚ã€‚ å¯¹äºçˆ¬è™«ç³»ç»Ÿä¸­æœ€å…³é”®çš„å¼‚æ­¥æµæ§åˆ¶ï¼Œæˆ‘åœ¨å®ç°æ—¶åšäº†å¤šç§é£æ ¼çš„å°è¯•ï¼Œåœ¨æ•°æ®åº“è¯»å†™å±‚é¢ä½¿ç”¨ promise é£æ ¼ï¼Œåœ¨æ£€æµ‹é¡¹å†…éƒ¨ä½¿ç”¨ asyncï¼Œè€Œåœ¨çˆ¬è™«çš„å®ä¾‹ä¸­ä½¿ç”¨ eventproxy æ¥è¿›è¡Œæµæ§åˆ¶ã€‚ ç›®å½•ç»“æ„ base/ è·Ÿç»§æ‰¿å’Œé€šç”¨ç›¸å…³çš„ conf/ å„ç§é…ç½®é¡¹ï¼ˆæ£€æµ‹é¡¹çš„é…ç½®ã€è§„åˆ™çš„é…ç½®ï¼‰ constant/ å„ç§å¸¸é‡çš„å®šä¹‰å’Œé…ç½® database/ æ•°æ®åº“é…ç½®å’Œè¿æ¥æ±  models/ æ•°æ®åº“è¡¨å¯¹åº”çš„ json schema dao/ ä¸ model ç›¸åº”çš„ Dao å¢åˆ æ”¹æŸ¥å°è£… util/ é€šç”¨æ•°æ®çš„helper factory/ å·¥å‚å°è£…ç±»ï¼Œç»Ÿä¸€ä»»åŠ¡çš„ç»„å»ºè¿‡ç¨‹ modules/ å…·ä½“æ£€æµ‹é¡¹ (çˆ¬è™«ä¸Šæ­è½½çš„å…·ä½“taskå®ç°) basic/ åŸºç¡€ä¿¡æ¯ å¯ç”¨æ€§æ£€æµ‹ content/ å†…å®¹æ£€æµ‹å¤§ç±» secure/ å®‰å…¨æ£€æµ‹å¤§ç±» common/ ç«™ç‚¹å…¥åº“ã€é“¾æ¥å…¥åº“ï¼Œä»¥åŠæŠ“å–é¡µé¢å†…å®¹ä¹ŸæŠ½è±¡æˆ1ä¸ªé€šç”¨task crawler/ çˆ¬è™«å¯¹è±¡ä¸æ± ç®¡ç†ï¼ˆ1ä¸ªcrawlerå®ä¾‹åªè´Ÿè´£1æ¬¡é¡µé¢è¯·æ±‚ï¼‰ scheduler/ ç›‘æ§å’Œè°ƒåº¦è¿›ç¨‹ (æ¯éš”ä¸€æ®µæ—¶é—´å°±æ‰§è¡Œä¸€è½®) runner.js ç”¨æ¥æ‰§è¡Œæ£€æµ‹ä»»åŠ¡ (ä»»åŠ¡æ¶ˆè´¹è€…) siteRunner.js é’ˆå¯¹â€œç«™ç‚¹é“¾æ¥å…¥åº“â€çš„ runner app.js ä¸»ç¨‹åºï¼Œç”¨æ¥å¯åŠ¨ runner appSite.js ä¸»ç¨‹åºä¹‹ä¸€ï¼Œç”¨æ¥å¯åŠ¨ SiteRunner appPath.js ç”¨æ¥å¯åŠ¨ä½é¢‘é«˜è¯·æ±‚é‡çš„æ£€æµ‹ä»»åŠ¡ï¼ˆè¯¦è§ä¸‹é¢çš„åœ°å€å‹æ£€æµ‹ç±»ï¼‰ çˆ¬è™«å®ç°æµç¨‹ç”±ä¸Šé¢çš„ç»“æ„å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºè¿è¡Œæ—¶çš„è°ƒç”¨è¿‡ç¨‹æ˜¯ï¼šapp.js =&gt; runner.js =&gt; crawler =&gt; å…·ä½“æ£€æµ‹é¡¹ã€‚ app.jså…¶ä¸­ app.js åªæ˜¯ä¸ªç¨‹åºå…¥å£ï¼Œé‡Œé¢æ„é€ äº†ä¸€äº›å‚æ•°ç»™ runnerï¼Œä»£è¡¨æ€§çš„å‚æ•°æœ‰ï¼šrunner æ¯è½®æ‰§è¡Œæ—¶å–å‡ºçš„ä»»åŠ¡æ•°é‡ï¼ˆå³1ä¸ªæ¶ˆè´¹è€…æ¯æ¬¡æ¶ˆè€—çš„æ•°é‡ï¼‰ï¼Œä»¥åŠæ¯è½®æ‰§è¡Œä¹‹é—´çš„é—´éš”æ—¶é—´ï¼ˆå› ä¸ºæ‰§è¡Œ1è½®ä»»åŠ¡æ—¶ä¼šæœ‰ N ä¸ªè¯·æ±‚ï¼Œå¦‚æœä¸åšé—´éš”æ—¶é—´çš„é™åˆ¶ï¼ŒåŒæ—¶ç­‰å¾…è¯·æ±‚å“åº”çš„çº¿ç¨‹å¤ªå¤šä¼šçˆ†ï¼‰ã€‚ runner.jsrunner.js é¦–å…ˆæä¾›1ä¸ªæ”¯æŒé—´éš”æ—¶é—´çš„å¾ªç¯æ‰§è¡Œæ¥å£ï¼Œè¿™é‡Œä½¿ç”¨ async åº“æ¥å®ç°ã€‚ 123456789101112131415161718192021222324252627282930313233RunnerBase.prototype = &#123; start: function()&#123; var that = this; that._count = 0; async.whilst( function()&#123; if(that.loopCount)&#123; return that._count &lt; that.loopCount; &#125; return true; &#125;, function (callback)&#123; // ç¬¬ä¸€æ¬¡ç«‹å³æ‰§è¡Œ if(!that._count)&#123; that._count = 1; that.run(); callback(null, that._count); &#125; else&#123; that._count++; setTimeout(function()&#123; that.run(); callback(null, that._count); &#125;, that.loopInterval || 10000); // é»˜è®¤10ç§’é—´éš” &#125; &#125;, function (n)&#123; console.log('Runner with [n=' + n + ']'); &#125; ); &#125;&#125;; è€Œ runner ä¸­çš„run()æ–¹æ³•å°±æ˜¯æ¯è½®å…·ä½“è¦æ‰§è¡Œçš„æ“ä½œï¼Œå®ƒå…¶å®æ•´ä½“æ˜¯ä¸ªä¸²è¡Œè¿‡ç¨‹ï¼Œæœ‰ä»¥ä¸‹æ­¥éª¤ï¼š 1ã€å–å‡ºæ•°æ®åº“ä¸­çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­é å‰çš„ N ä¸ªä»»åŠ¡ 2ã€å¦‚æœå–å‡ºä¸ºç©ºï¼Œç›´æ¥è·³åˆ°ç¬¬6æ­¥ 3ã€å°†ä»»åŠ¡çŠ¶æ€æ ‡ä¸º PROCESSING 4ã€å¯¹ N ä¸ªä»»åŠ¡æŒ‰æ£€æµ‹çš„ url é‡æ–°åˆ†ç»„ï¼Œæ¯”å¦‚å¾—åˆ° M ä¸ªç»„ï¼Œåˆ™æ„é€  M ä¸ª Crawler å®ä¾‹ï¼ˆè¿™é‡Œè®¾è®¡çš„å‡†åˆ™å°±æ˜¯1ä¸ª Crawler å®ä¾‹åªçˆ¬å–1ä¸ªé¡µé¢ï¼‰ 5ã€ä½¿ç”¨ async.parallel å¹¶è¡Œæ‰§è¡Œ M ä¸ª Crawler çš„ run() æ–¹æ³• 6ã€ä¸€è½® runner æ‰§è¡Œç»“æŸ è¿™é‡Œæ•´ä½“æ˜¯ä¸²è¡Œï¼Œä½¿ç”¨äº† eventproxy æ¥è¿›è¡Œæµç¨‹æ§åˆ¶ 1234567891011121314Runner.prototype.run = function(cb)&#123; var that = this; var ep = new EventProxy(); // ç»Ÿä¸€é”™è¯¯å¤„ç† TODO ep.fail(function (err)&#123; console.log(err); &#125;); // å„æ­¥éª¤ä¸€èµ·è°ƒç”¨ï¼Œé€šè¿‡ eventä¿¡å· ç­‰å¾… Runner.steps.forEach(function (fn)&#123; fn.call(that, ep, cb); &#125;);&#125; è€Œå…¶ä¸­æœ€å…³é”®çš„æ­¥éª¤æ˜¯å¹¶è¡Œæ‰§è¡Œ M ä¸ª Crawlerï¼Œå…¶å®ç°åŸç†å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243function (ep)&#123; var that = this; ep.on('crawlerReady', function (crawlers)&#123; // æ„é€  async.parallel çš„æ‰§è¡Œå‡½æ•° var threads = crawlers.map(function (crawler)&#123; return function (callback)&#123; // runå‰çš„ç´¯è®¡ that.crawlerCount++; crawler.run(function (err)&#123; // runå®Œçš„ç´¯è®¡ that.crawlerCountDone++; if (err)&#123; console.log(err); callback(err); &#125; else &#123; callback(null); &#125; &#125;); &#125; &#125;); async.parallel(threads, function (err, res)&#123; console.log('[OK] å¹¶è¡ŒCrawler[len=' + threads.length + ']æ‰§è¡Œå®Œæ¯•'); &#125;); // è¿™é‡Œé‡Šæ”¾ä¿¡å·ä¸èƒ½æ”¾åœ¨ async.parallel çš„å›è°ƒé‡Œï¼Œä»¥é˜²æœ‰çˆ¬è™«æŒ‚äº†å°±å¡æ­»äº† // ç›´æ¥åˆ°æœ€å1æ­¥ï¼Œå¯åœ¨æ¯è½®çš„æœ€åçœ‹åˆ°çˆ¬è™«ç´¯è®¡çš„é¡µé¢æ•°ç›®ï¼Œand çˆ¬è™«ç›‘æ§æ±  TODO ep.emit('crawlerDone'); &#125;);&#125;,function (ep, cb)&#123; var that = this; ep.on('crawlerDone', function()&#123; console.log('[OK] æ¶ˆè´¹è€…1è½®, ' + 'ç´¯è®¡çˆ¬äº† ' + that.crawlerCount + ' ä¸ªé¡µé¢, ' + 'ç´¯è®¡ç»“æŸ ' + that.crawlerCountDone + ' ä¸ªé¡µé¢'); cb &amp;&amp; cb(); &#125;);&#125; crawler.jsä¸Šé¢å·²ç»æåˆ°äº†å¤šæ¬¡ï¼š1ä¸ª Crawler å¯¹è±¡åªè´Ÿè´£ 1æ¬¡ é¡µé¢è¯·æ±‚ï¼Œåœ¨ Crawler å¯¹è±¡ä¸­ä¸»è¦è®°å½•ç€åˆ†ç»„åçš„ä»»åŠ¡æ•°ç»„ï¼Œå®ƒä»¬æœ‰ç€åŒæ ·çš„ç›®æ ‡ urlã€‚å…ˆè¯·æ±‚é¡µé¢ urlï¼Œå¾—åˆ°é¡µé¢æ–‡æ¡£åå°†å†…å®¹ä¾æ¬¡ä¼ é€’ç»™å„æ£€æµ‹é¡¹å»å„è‡ªæ‰§è¡Œä»»åŠ¡ã€‚æ‰€ä»¥æ€»çš„æ¥è¯´ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªä¸²è¡Œè¿‡ç¨‹ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š 1ã€å°†åˆ†ç»„åçš„ä»»åŠ¡ï¼Œé€šè¿‡ä»»åŠ¡ç±»å‹çš„ keyï¼Œåå°„åˆ°å…·ä½“çš„ç±»ï¼Œå¾—åˆ°å¯æ‰§è¡Œçš„ä»»åŠ¡å¯¹è±¡çš„æ•°ç»„ã€‚ 2ã€è°ƒç”¨è¯·æ±‚é¡µé¢å†…å®¹çš„é€šç”¨æ£€æµ‹é¡¹ï¼Œä½œä¸º starter 3ã€å°†é¡µé¢å†…å®¹çš„æ–‡æ¡£ä½œä¸º context å…¥å‚ï¼Œä¾æ¬¡è°ƒç”¨å„ä»»åŠ¡å¯¹è±¡çš„æ•°ç»„ 4ã€ä»»åŠ¡å…¨éƒ¨å®Œæˆåï¼Œåœ¨æ•°æ®åº“ä¸­å°†å…¶ç§»å‡ºé˜Ÿåˆ—ï¼›è‹¥å¤±è´¥ï¼Œåˆ™å…ˆç§»é™¤ï¼Œè®¡å¤±è´¥æ¬¡æ•°+1ï¼Œç„¶åé‡æ–°æ’å…¥é˜Ÿå°¾ è¿™é‡Œä¹Ÿæ˜¯ç”¨ eventproxy æ§åˆ¶æµç¨‹çš„ï¼Œå…¶ä¸­å…³é”®çš„ context ä¼ å‚è°ƒç”¨å„ä»»åŠ¡å¯¹è±¡ï¼Œå®ç°å¦‚ä¸‹ 1234567891011121314function (ep)&#123; var that = this; // ä½¿ task.run() ç»“æœæŒ‰é¡ºåºæ’åˆ— ep.after('oneTaskFinished', that.tasks.length, function (results)&#123; ep.emit('allTasksFinished', results); &#125;); ep.on('starterFinished', function (context)&#123; that.tasks.forEach(function (task)&#123; task.run(context, ep.group('oneTaskFinished')); &#125;); &#125;);&#125;, æ³¨æ„ï¼Œä½¿ç”¨ ep.group() æ–¹æ³•å¯ä»¥ä¿è¯å¾—åˆ°çš„æ‰§è¡Œç»“æœçš„é¡ºåºæ˜¯ä¸è°ƒç”¨é¡ºåºä¸€è‡´çš„ï¼Œè€Œå„ task çš„æ‰§è¡Œæ˜¯å¹¶è¡Œçš„ã€‚ æ£€æµ‹é¡¹å·¥ä½œæ¨¡å¼åå°„åŸç†åœ¨ä¸Šé¢è®² crawler çš„ç¬¬1æ­¥ä¸­æåˆ°ï¼šå°†åˆ†ç»„åçš„ä»»åŠ¡ï¼Œé€šè¿‡ä»»åŠ¡ç±»å‹çš„keyï¼Œåå°„åˆ°å…·ä½“çš„ç±»ã€‚å› ä¸ºä»æ•°æ®åº“ä»»åŠ¡é˜Ÿåˆ—å–æ¥çš„æ£€æµ‹ä»»åŠ¡åªä¼šå«æœ‰ æ¨¡æ¿url / æ£€æµ‹å¤§ç±» / æ£€æµ‹é¡¹å°ç±» è¿™æ ·çš„æ•°æ®ï¼Œæ‰€ä»¥å°±è¦åå°„åˆ°å…·ä½“çš„æ£€æµ‹ç±»æ¥æ„é€ å¯¹è±¡ã€‚ â€œåå°„â€æ˜¯å¼ºç±»å‹ç¼–ç¨‹è¯­è¨€ä¸­çš„æ¦‚å¿µï¼ˆæˆ‘æœ€æ—©æ˜¯åœ¨ Java ä¸­äº†è§£çš„ï¼‰ï¼Œè€Œ js å¤©ç„¶çš„å¼±ç±»å‹å’ŒåŠ¨æ€ç‰¹æ€§ï¼Œå¾ˆå®¹æ˜“å®ç°ã€‚ 12345// æ ¹æ®å‘½åè§„åˆ™ï¼Œå–æ£€æµ‹æ¨¡å—çš„å¼•ç”¨getModuleFromCrawlTask: function(crawlTask)&#123; var modulePath = ModuleConf.getPath(crawlTask['item_key']); return require(modulePath);&#125; è¿™é‡Œæ¯ä¸ªæ£€æµ‹é¡¹ä»»åŠ¡éƒ½ä¼šå¸¦æœ‰ item_key å­—æ®µï¼Œè¡¨ç¤ºå…·ä½“çš„æ£€æµ‹é¡¹ï¼Œå…¶å®è¿˜æœ‰ mod_keyï¼Œå¯¹åº”åˆ°ç³»ç»Ÿçš„3å¤§ç±»æ£€æµ‹ï¼šå¯ç”¨æ€§ï¼Œå†…å®¹æ£€æµ‹ï¼Œå®‰å…¨æ£€æµ‹ã€‚å…·ä½“è§ä¸‹ä¸€æ®µã€‚ æ£€æµ‹é¡¹åˆ†ç±»1234567891011121314151617181920// è¡¨æ˜è¿™ä¸ªTaskItemå±äºå“ªä¸€å¤§ç±» (é€šç”¨çš„é™¤å¤–)var modDict = &#123; COMMON_CRAWL: 'COMMON_CRAWL', // é€šç”¨çˆ¬å–æ–¹æ³• å¦‚è¯·æ±‚é¡µé¢document, å–é“¾æ¥ç­‰ BASIC_DETECT: 'BASIC_DETECT', // å¯ç”¨æ€§æ£€æµ‹ CONTENT_DETECT: 'CONTENT_DETECT', // å†…å®¹æ£€æµ‹ åˆå¹¶äº†ç¯¡æ”¹æ£€æµ‹ SECURE_DETECT: 'SECURE_DETECT' // å®‰å…¨æ£€æµ‹&#125;;// è¡¨æ˜è¿™ä¸ªTaskItemèƒ½å¦ä¸å…¶ä»–åˆå¹¶, èƒ½å¦å…±ç”¨1æ¬¡è¯·æ±‚var typeDict = &#123; EXCLUSIVE: 'EXCLUSIVE', // æ’å®ƒæ€§ (ç‹¬å  request çš„ä»»åŠ¡) INCLUSIVE: 'INCLUSIVE' // å¯åˆå¹¶æ€§ (åªéœ€ä¼ é€’ context)&#125;;// è¡¨æ˜è¿™ä¸ªTaskItemåº”è¯¥åœ¨å“ªä¸ªè¡¨ä¸­, åº”è¯¥äº¤ç»™å“ªä¸ªRunnerå¤„ç†var runnerTypeDict = &#123; COMMON: 'COMMON_TASK', // æ™®é€šä»»åŠ¡ -&gt; Runner -&gt; app.js SITE: 'SITE_TASK', // ç«™ç‚¹å…¥åº“ç±» -&gt; SiteRunner -&gt; appSite.js PATH: 'PATH_TASK' // è·¯å¾„æ£€æµ‹ç±» -&gt; Runner -&gt; appPath.js&#125;; è¿™é‡Œå®šä¹‰äº†ä¸¤ç§è¡¨ç¤ºä»»åŠ¡å±æ€§çš„ç±»å‹ï¼šINCLUSIVE è¡¨ç¤ºè¯¥ä»»åŠ¡æ˜¯å¯ä»¥ä¸åŒç›®æ ‡ url çš„å…¶ä»–ä»»åŠ¡åˆå¹¶çš„ï¼Œåªéœ€è¦è¯·æ±‚1æ¬¡é¡µé¢ï¼Œä¼ é€’é¡µé¢å†…å®¹çš„ context å³å¯ï¼Œè¯¦è§ crawler.js çš„éƒ¨åˆ†å®ç°ä»£ç ã€‚è€Œ EXCLUSIVE è¡¨ç¤ºè¯¥ä»»åŠ¡å†…éƒ¨è¦è‡ªå·±å‘è¯·æ±‚ï¼Œæ¯”å¦‚æŸ¥ Whois ä¿¡æ¯ï¼Œæˆ–è€…è¦æ£€æµ‹æ˜¯å¦å­˜åœ¨æŸäº›åé—¨è·¯å¾„ï¼Œè¿™ç±»ä»»åŠ¡æ˜¯ä¸å¯ä»¥åˆå¹¶çš„ã€‚ è€Œ runnerType åˆæ˜¯å¦ä¸€ä¸ªå±‚é¢çš„å¦ä¸€ç§åˆ†ç±»ï¼Œåœ¨ç¬¬äºŒèŠ‚ä¸»ç¨‹åºè®¾è®¡ä¸­æåˆ°è¿‡ç«™ç‚¹é“¾æ¥å…¥åº“ã€‚æˆ‘åœ¨å®ç°æ—¶åšäº†ä¸€å±‚æŠ½è±¡ï¼Œå°†â€œç«™ç‚¹å…¥åº“â€å’Œâ€œé“¾æ¥å…¥åº“â€ä¹Ÿè§†ä¸ºä¸€ç§æ£€æµ‹é¡¹ä»»åŠ¡ï¼Œä»»åŠ¡æ”¾åœ¨å•ç‹¬çš„ä¸€ä¸ªé˜Ÿåˆ—è¡¨ä¸­ã€‚è¿™æ ·å°±èƒ½å…±ç”¨ä¸€äº› crawler å’Œ runner çš„é€»è¾‘ã€‚ æ­¤å¤–å¯¹äºè·¯å¾„ç±»æ£€æµ‹ï¼Œæ¯”å¦‚ Webshell åœ°å€æ£€æµ‹ï¼Œæˆ–æ˜¯æ•æ„Ÿè·¯å¾„æ£€æµ‹ï¼Œç”±äºè§„åˆ™çš„å­—å…¸å¾ˆå¤§ï¼Œ1ä¸ªæ£€æµ‹é¡¹å¯èƒ½ä¼šæœ‰ä¸Šåƒæ¬¡è¯·æ±‚ã€‚å› æ­¤å¯¹äºè¿™ç±»â€œä½é¢‘â€åˆâ€œé«˜è¯·æ±‚é‡â€çš„æ£€æµ‹é¡¹ï¼Œæˆ‘ä¹Ÿå•ç‹¬å°†ä»»åŠ¡æ”¾åœ¨å¦ä¸€ä¸ªç‹¬ç«‹çš„é˜Ÿåˆ—è¡¨ä¸­ï¼Œä¹Ÿç”±å¦ä¸€ä¸ªç¨‹åºå…¥å£å¯åŠ¨ã€‚ å¹¶è¡Œä¸ç®¡é“æ€»ç»“æ•´ä¸ªçˆ¬è™«è°ƒåº¦ä¸æ£€æµ‹é¡¹çš„å·¥ä½œæµç¨‹ï¼Œæ˜¯â€œä¸²è¡Œâ€ä¸â€œå¹¶è¡Œâ€åŒæ—¶å­˜åœ¨ç€ã€‚ ç”± runner æ‰§è¡Œæ—¶æ¯è½®ä¼šå–å‡ºä¸€å †ä»»åŠ¡ï¼Œç”Ÿæˆå¤šä¸ª crawler å®ä¾‹ï¼Œè¿™æ˜¯å¹¶è¡Œçš„ã€‚è€Œåœ¨æ¯ä¸ª crawler å†…éƒ¨å¯ä»¥ç†è§£ä¸ºåƒå·¥å‚çš„æµæ°´çº¿æ¨¡å¼ï¼Œå…ˆè¯·æ±‚é¡µé¢ urlï¼Œç„¶åå°†é¡µé¢å†…å®¹ä¸€ä¸ªä¸ªä¼ é€’ç»™å„æ£€æµ‹é¡¹å»å®Œæˆç›¸åº”çš„æå–æˆ–æ£€æµ‹å·¥ä½œã€‚æ¯ä¸ªæ£€æµ‹é¡¹å†…éƒ¨éƒ½ä¼šå»å†™å„è‡ªçš„ log æ–‡ä»¶ï¼Œæœ€åæ‰€æœ‰æ£€æµ‹ä»»åŠ¡éƒ½å®Œæˆåï¼Œé—´éš”ä¸€æ®µæ—¶é—´åä¼šè¿›å…¥ä¸‹ä¸€è½® runner çš„æ‰§è¡Œã€‚ æ³¨æ„çš„æ˜¯ï¼Œæ£€æµ‹é¡¹æ˜¯æ ¹æ®ç›®æ ‡ url æ¥åˆ†ç»„çš„ï¼Œæ­è½½åœ¨ crawler å®ä¾‹ä¸Šæ‰§è¡Œçš„ï¼ŒåŒä¸€ç»„çš„æ£€æµ‹é¡¹éƒ½æ‰§è¡Œå®Œåï¼Œç›¸åº”çš„ crawler å®ä¾‹ä¹Ÿåº”è¯¥é”€æ¯ã€‚è€Œ runner å¯¹è±¡çš„å®ä¾‹æ˜¯å§‹ç»ˆå­˜åœ¨çš„ï¼Œå®ƒåƒä¸€ä¸ªå®šæ—¶å™¨ä¸€æ ·æ¯éš”åæ¥ç§’å°±ä¼šå†è§¦å‘1è½®æ‰§è¡Œã€‚åŒæ—¶ï¼Œ1ä¸ª runner å®ä¾‹åº”è¯¥å¯¹åº”1ä¸ªè¿›ç¨‹ï¼Œå¤šä¸ª runner å®ä¾‹åº”è¯¥è·‘åœ¨å¤šå°çˆ¬è™«æœåŠ¡å™¨ä¸Šã€‚ æ€»ç»“ä¸ä¸è¶³è¿™ä¸ªé¡¹ç›®ä»å»å¹´11æœˆå¼€å§‹éœ€æ±‚åˆ†æï¼Œåšç•Œé¢ demoï¼Œåˆ°ä»»åŠ¡åˆ†è§£å’Œç»„è£…è¿‡ç¨‹çš„è®¾è®¡ï¼Œå†åˆ°çˆ¬è™«çš„å®ç°ï¼Œä¹Ÿæ˜¯ä»é›¶å¼€å§‹å­¦ nodejsï¼Œæ•´ä¸ªè¿‡ç¨‹æœ€åˆéƒ½åªæœ‰æˆ‘1ä¸ªäººï¼Œå¯¹è‡ªå·±çš„æŒ‘æˆ˜æå‡å¾ˆå¤§ã€‚ç†¬äº†ä¸¤ä¸‰ä¸ªæœˆåæ‰æœ‰äººæ‰‹å¸®æˆ‘åšæ—¥å¿—çš„å›æ”¶è®¡ç®—ä»¥åŠå‰ç«¯çš„æŠ¥è¡¨éƒ¨åˆ†ï¼Œä¹‹åé¡¹ç›®å°±äº¤ç»™ä»–ä»¬äº†ï¼Œä»–ä»¬åæ¥åšäº†ä¸€äº›å®‰å…¨æ£€æµ‹é¡¹æ–¹é¢çš„å¼ºåŒ–ä»¥åŠå¤šæœºå™¨çš„éƒ¨ç½²å’Œé€šä¿¡ã€‚ æˆ‘åœ¨å•æœºï¼ˆMac Air Book @2012ï¼‰ä¸Šè¿è¡Œçš„æ•ˆç‡å¹³å‡1å°æ—¶ï¼Œçˆ¬å–è¿‘1ä¸‡ä¸ªé¡µé¢ï¼Œå¹¶å®Œæˆå‰©ä½™çš„å†…å®¹æ£€æµ‹é¡¹éƒ¨åˆ†ã€‚åœ¨å‰é¢å›¾ä¸­ä¸€è½®å–å‡ºçš„ä»»åŠ¡æ•°é‡ä»¥åŠå¹¶è¡Œ Crawler çš„æ•°ç›®ï¼Œå¯¹æœºå™¨çš„æ€§èƒ½å’Œç½‘é€Ÿéƒ½æœ‰è¦æ±‚ï¼Œå¦‚æœå…¥ä¸æ•·å‡ºï¼ˆæ¯è½®é—´éš”æ—¶é—´å†…éƒ½åªæœ‰å°‘æ•°çš„ crawler æ‰§è¡Œå®Œï¼‰ï¼Œæœ€ç»ˆä¼šäº§ç”Ÿå¾ˆå¤šå†…å­˜é”™è¯¯ï¼Œæˆ–è€… TCP è¿æ¥æ•°è¿‡å¤šï¼Œä¹Ÿå¾—ä¸åˆ°ç»“æœã€‚ æˆ‘å°è¯•åå¾—åˆ°çš„ç»éªŒå‚æ•°æ˜¯ï¼Œæ¯éš” 10 ç§’ï¼Œå– 50 ä¸ªä»»åŠ¡ï¼Œæ ¹æ®ç›®æ ‡ url åˆå¹¶å®Œåå¤§çº¦æœ‰ 20~30 ä¸ªä»»åŠ¡ç»„ã€‚æ³¨ï¼šç”¨çš„æ˜¯äº‘æœåŠ¡å™¨ï¼Œå†…å­˜ 2Gï¼Œå¸¦å®½ 2Mã€‚ è¿˜æ˜¯ç®€å•ç²—æš´è¿™ä¸ªçˆ¬è™«ç³»ç»Ÿå’Œæ£€æµ‹é¡¹éƒ½è¿˜æ¯”è¾ƒç®€é™‹ï¼Œå¯ä»¥ä»ä»¥ä¸‹æ–¹é¢æ”¹è¿›ï¼š nodejs çš„ cluster å°è¯•ï¼Œèƒ½å¦å¯¹çˆ¬å–æ•ˆç‡æœ‰æ€§èƒ½æå‡ æ•°æ®åº“â€œåŒæ­¥å†™â€çš„é”é—®é¢˜ï¼Œå¤šå°çˆ¬è™«æœºå™¨å…±ç”¨åŒä¸€ä¸ªæ•°æ®åº“çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œæœ‰æ€§èƒ½ç“¶é¢ˆï¼ˆæˆ–è€…è¯´é›†ä¸­å¼å­˜å‚¨çš„é€šç—…ï¼‰ å†…å®¹æ£€æµ‹æ–¹é¢çš„ç¯¡æ”¹è¯†åˆ«ç®—æ³•ï¼Œç›®å‰ä»…ç”¨ content-length å’Œ md5 æ¥åˆ¤åˆ«é¡µé¢æ›´æ”¹ å¼•å…¥ phantomJS æ¥åšç½‘é¡µæˆªå›¾ï¼Œè­¦ç¤ºé¡µé¢æ¶æ„ç¯¡æ”¹ åŠ å¼ºå®‰å…¨æ£€æµ‹æ–¹é¢çš„åŠ›åº¦ï¼Œå¯¹å„ç§æŒ‚é©¬å’Œæš—é“¾çš„ä»£ç æ¨¡å¼çš„è¯†åˆ« æ”¯æŒå¯¹æ£€æµ‹é¡¹çš„æ‰©å±•ï¼Œèƒ½è®©æ›´æœ‰ç»éªŒçš„å®‰å…¨å·¥ç¨‹å¸ˆç¼–å†™çš„ python ä»£ç ä¹Ÿæ¥å…¥åˆ°ç³»ç»Ÿä¸­ TODO åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿˜è®°å½•äº†ä¸€äº›é‡åˆ°çš„é—®é¢˜ï¼Œnodejsçˆ¬è™«å®ç°ä¸­é‡åˆ°çš„å‘ åç»­ä¼šæ…¢æ…¢æ•´ç†è¡¥å…… æœ‰æ—¶é—´å†æŠ½è±¡å‡ºä¸€ä¸ªä¸šåŠ¡æ— å…³çš„å¯é…ç½®çš„â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼çš„ç½‘ç«™æ£€æµ‹æ¡†æ¶ï¼Œä¾›å­¦ä¹ äº¤æµ]]></content>
      <categories>
        <category>node</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹ sticky position]]></title>
    <url>%2Fblog%2F2016%2F10%2Fcode-patterns-of-sticky-position.html</url>
    <content type="text"><![CDATA[ä»¥å‰é¢è¯•å½“è¢«é—®åˆ° css position èƒ½å–å“ªäº›å€¼æ—¶ï¼Œåªå›ç­”äº† relative absolute fixed å¤–åŠ  static inheritï¼Œåœ¨ MDN ä¸Šå¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ–°å¢çš„å®éªŒæ€§çš„ position sticky sticky å®šä¹‰å°±æ˜¯å°†æŸä¸ªå…ƒç´ å›ºå®šåœ¨æŸä¸ªä½ç½®ï¼Œä¹ä¸€çœ‹å’Œ fixed å®šä½æœ‰ç‚¹åƒï¼Œä½†å®ƒä»¬æœ‰ä»¥ä¸‹ä¸åŒ fixedæ˜¯ç›¸å¯¹äº viewport æ¥å®šä½ï¼Œè€Œstickyæ˜¯ç›¸å¯¹äºè¯¥å…ƒç´ åœ¨æµä¸­çš„ flow rootï¼ˆBFCï¼‰å’Œ containing blockï¼ˆæœ€è¿‘çš„å—çº§ç¥–å…ˆå…ƒç´ ï¼‰å®šä½ã€‚ fixedä¼šä½¿å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œè€Œstickyåˆ™ä¸ä¼šï¼Œåç»­å…ƒç´ çš„ä½ç½®ä»æŒ‰ç…§æœªå®šä½æ—¶çš„ä½ç½®æ¥ç¡®å®šã€‚ ç®€å•çš„demo sticky è¸©å‘ä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹ å…·æœ‰stickyå±æ€§çš„å…ƒç´ ï¼Œå…¶çˆ¶çº§é«˜åº¦å¿…é¡»å¤§äºstickyå…ƒç´ çš„é«˜åº¦ stickyå…ƒç´ çš„åº•éƒ¨ï¼Œä¸èƒ½å’Œçˆ¶çº§åº•éƒ¨é‡å  stickyå…ƒç´ çš„çˆ¶çº§ä¸èƒ½å«æœ‰ overflow:hidden å’Œ overflow:auto å±æ€§ å¿…é¡»å…·æœ‰topæˆ–bottomå±æ€§ï¼Œå¦‚æœåŒæ—¶å®šä¹‰äº†topå’Œbottomï¼Œtopèƒœ stickyå…ƒç´ ä»…åœ¨ä»–çˆ¶çº§å®¹å™¨å†…æœ‰æ•ˆï¼Œè¶…å‡ºå®¹å™¨èŒƒå›´åˆ™ä¸å†ç”Ÿæ•ˆäº† æµè§ˆå™¨å…¼å®¹æ€§ Chromeå·²ç»ä¸å†æ”¯æŒstickyå±æ€§ ã€2017æ›´æ–°ã€‘Chrome 56 å¼€å§‹æ”¯æŒäº† Safari ä» 6.1å¼€å§‹æ”¯æŒï¼Œä½†è¡¨ç°ä¹Ÿä¸å¤ªå®Œç¾ Firefox ä»ç‰ˆæœ¬ 32å¼€å§‹æ”¯æŒäº† IEä¸€ç›´ä¸æ”¯æŒï¼Œæ”¾å¼ƒå§â€¦ js å®ç°ä»¥å‰æ²¡æœ‰position: stickyçš„æ—¶å€™ï¼Œéƒ½å¿…é¡»ç”¨ js ç›‘å¬æ»šåŠ¨å¹¶ä¸”åŠ¨æ€æ”¹å˜å…ƒç´ å®šä½æ–¹å¼ï¼Œæ‰èƒ½å®ç°ç›¸åº”çš„æ•ˆæœ å…·ä½“å®ç°æ€è·¯æ˜¯ ä¿å­˜å…ƒç´ åˆå§‹çš„ä½ç½®ï¼Œåˆ¤æ–­å½“å‰è·ç¦» viewport çš„ä½ç½® å¦‚æœ&lt;=å®šä¹‰çš„ top å€¼ï¼Œåˆ™å°†å…ƒç´ æ”¹ä¸ºfixedå®šä½ åœ¨å…ƒç´ ä¸ŠæŒ‚ä¸ª data-sticky ä½œä¸ºæ ‡è®° å¹¶ä¸”åœ¨æ–‡æ¡£æµä¸­æ’å…¥ä¸€ä¸ªä¸ä¹‹åŒæ ·å¤§å°çš„å ä½å…ƒç´  å¦åˆ™æ¢å¤å…ƒç´ åˆå§‹çš„ä½ç½®ï¼Œåˆ é™¤ data-sticky æ ‡è®°ï¼Œå¹¶åˆ é™¤å ä½å…ƒç´  ç°æœ‰ jquery æ’ä»¶ jquery.pin fixed-sticky åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒsticky1234567891011121314function supportSticky() &#123; var _supportCSS = function(property, value)&#123; var el = document.createElement('i'); el.style[property] = value; var r = el.style[property]; el = null; return r === value; &#125;; var supportVals = ['-webkit-sticky', '-ms-sticky', 'sticky'].filter(function(item)&#123; return _supportCSS('position', item); &#125;); return supportVals.length ? supportVals[0] : null;&#125;]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹JSè§†çª—]]></title>
    <url>%2Fblog%2F2016%2F10%2Fcode-patterns-of-js-viewport.html</url>
    <content type="text"><![CDATA[ç»§ç»­ã€å¸¸ç”¨æ¨¡å¼ç‰‡æ®µã€‘ç³»åˆ—çš„JSéƒ¨åˆ†ï¼Œé¦–å…ˆæ•´ç†äº†ä¸‹å…³äºæ»šåŠ¨è§†çª—çš„ä¸€äº›åˆ¤å®šæ–¹æ³•ï¼Œç»å¸¸ç”¨äºåšå„ç§æ»šåŠ¨ç›¸å…³çš„äº¤äº’æ•ˆæœï¼Œæ¯”å¦‚æ»šåŠ¨åˆ·æ–°ï¼Œå›¾ç‰‡å»¶è¿ŸåŠ è½½ï¼ˆå½“å›¾ç‰‡ä½äºè§†çª—èŒƒå›´å†…æ‰åŠ è½½ï¼‰ ä¸€ã€é¡µé¢scrollTopåœ¨jqueryä¸­ç›´æ¥$(window).scrollTop()å°±å®Œäº‹äº†ï¼Œä½†ä¹Ÿè¦çŸ¥é“åœ¨åŸç”Ÿjsä¸­çš„å…¼å®¹æ€§å†™æ³•ä¸º 1window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop å¯å‚è€ƒå¦‚ä¸‹ å…³äºpageYOffset scrollY scrollTopçš„å°ç»“ stackoverflowä¸­çš„é—®ç­” äºŒã€åˆ¤æ–­å…ƒç´ è·ç¦»è§†çª—çš„è·ç¦»å…ƒç´ è·è§†çª—é¡¶éƒ¨ deltaTop = el.offset().top - é¡µé¢scrollTop åˆ¤æ–­æ˜¯å¦åœ¨å½“å‰è§†çª—èŒƒå›´å†…çš„ä¸´ç•Œå€¼ (å¼1) deltaTop - TOP_MARGIN &gt; 0 å…ƒç´ è·è§†çª—åº•éƒ¨ deltaBottom = window.innerHeight - deltaTop - el.outerHeight() åˆ¤æ–­æ˜¯å¦åœ¨å½“å‰è§†çª—èŒƒå›´å†…çš„ä¸´ç•Œå€¼ (å¼2) deltaBottom - BOTTOM_MARGIN &gt; 0 æ›¿æ¢deltaBottomçš„è®¡ç®—å¼åï¼Œä¸Šå¼ç­‰ä»·äº (å¼3) deltaTop &lt; window.innerHeight - el.outerHeight() - BOTTOM_MARGIN æ³¨ï¼šä»¥ä¸Šã€TOP_MARGINã€‘ã€BOTTOM_MARGINã€‘è¡¨ç¤ºè·ç¦»è§†çª—èŒƒå›´çš„å›ºå®šé‡ï¼Œç±»ä¼¼äºfixedå®šä½æ—¶çš„ top bottom æ‰€ä»£è¡¨çš„è·ç¦»ã€‚ ç»¼ä¸Šï¼Œå¦‚æœè¦åˆ¤å®šä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨è§†çª—èŒƒå›´å†…ï¼Œåªè¦åŒæ—¶æ»¡è¶³ (å¼1)(å¼2/å¼3) å³å¯ã€‚ ä¸‰ã€åˆ¤æ–­åˆ°è¾¾é¡µé¢åº•éƒ¨åœ¨å„ç§æ‰‹æœºappä¸Šç»å¸¸èƒ½çœ‹åˆ°åˆ°è¾¾é¡µé¢åº•éƒ¨åï¼Œå°±è‡ªåŠ¨è§¦å‘â€œä¸‹æ‹‰åˆ·æ–°â€çš„äº¤äº’ã€‚è¿™é‡Œä¸ä¸Šé¢ç±»ä¼¼ä½†åˆæœ‰æ‰€ä¸åŒ å…ˆå®šä¹‰ä¸¤ä¸ªå€¼ï¼Œè¡¨ç¤ºæ•´ä¸ªæ–‡æ¡£çš„å¯è§åŒºåŸŸé«˜åº¦å’Œå¯æ»šåŠ¨è·ç¦»ï¼ˆé’ˆå¯¹ç§»åŠ¨ç«¯çš„å†™æ³•ï¼‰ viewHeight = document.documentElement.clientHeight scrollHeight = document.documentElement.scrollHeight åˆ¤å®šæ˜¯å¦åˆ°è¾¾é¡µé¢åº•éƒ¨çš„ä¸´ç•Œå€¼ scrollHeight - window.pageYOffset - viewHeight &lt; BOTTOM_MARGIN è¿™é‡Œã€BOTTOM_MARGINã€‘è¡¨ç¤ºè·ç¦»é¡µé¢åº•éƒ¨çš„å¯æ¥å—è·ç¦»ã€‚ é™„offsetHeight &amp; clientHeight &amp; scrollHeightå‚è€ƒæ–‡ç« ï¼šJavaScriptä¸­çš„å„ç§å®½é«˜ä»¥åŠä½ç½®æ€»ç»“ å‡ ç§çª—å£çš„å®½åº¦document.documentElement.offsetWidthï¼šè§†çª—å®½åº¦ï¼ˆä¸æ»šåŠ¨çš„æƒ…å†µä¸‹ï¼Œä¸€å±å¯ä»¥çœ‹åˆ°å¤šå®½çš„æ–‡æ¡£ï¼‰ï¼Œä¸”ä¸åŒ…å«æ»šåŠ¨æ¡çš„å®½åº¦ document.body.offsetWidthï¼šé¡µé¢æ–‡æ¡£çœŸæ­£çš„å®½åº¦ï¼Œå¯ä»¥é€šè¿‡æ»šåŠ¨çœ‹åˆ°çš„æ–‡æ¡£çš„å…¨éƒ¨å®½åº¦ window.innerWidthï¼šåŒâ€œè§†çª—å®½åº¦â€ï¼Œä½†è²Œä¼¼åœ¨ IE8 ä¸‹ä¸ document.documentElement.offsetWidth ä¸ç›¸ç­‰ window.outerWidthï¼šæ•´ä¸ªæµè§ˆå™¨çª—å£çš„å®½åº¦ï¼Œå¦‚æœä¸å¼€è°ƒè¯•å·¥å…·çª—å£ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å…¶ç­‰äº è§†çª—å®½åº¦ + æ»šåŠ¨æ¡å®½åº¦ window.screen.widthï¼šæ•´ä¸ªå±å¹•çš„å®½åº¦ï¼Œä¸ä½ æ€ä¹ˆæ‹–æ‹½çª—å£å¤§å°æ²¡æœ‰å…³ç³»ã€‚ã€‚ã€‚ window.screen.availWidthï¼šå•¥æƒ…å†µä¸‹ä¼šå°äº window.screen.width ï¼Ÿ(TODO)]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ git submodule å»ºç«‹å­é¡¹ç›®ä¾èµ–]]></title>
    <url>%2Fblog%2F2016%2F10%2Fusage-of-git-submodule.html</url>
    <content type="text"><![CDATA[åœ¨ä½¿ç”¨ git åšé¡¹ç›®æ—¶ï¼Œä¹Ÿè®¸ä¼šç¢°åˆ°ä¸€äº›ç»„ä»¶éœ€è¦ç‹¬ç«‹å‡ºå»ï¼ŒåŒæ—¶ä¾›å¤šä¸ªé¡¹ç›®ä½¿ç”¨ï¼Œè€Œä¸æ˜¯åœ¨å¤šä¸ªé¡¹ç›®é‡Œæ‹·è´ä¸¤ä»½ç»„ä»¶çš„ä»£ç ã€‚å¦‚æœå…¬å…±çš„ç»„ä»¶å·²ç»æˆç†Ÿäº†ï¼Œå¯ä»¥å‘å¸ƒåˆ°CDNä¸Šä¾›å¤šä¸ªé¡¹ç›®å»å¼•ç”¨ã€‚ä½†å¦‚æœéƒ½åœ¨å¼€å‘é˜¶æ®µï¼Œåœ¨å¤šä¸ªé¡¹ç›®é‡Œéƒ½è¦å¼•ç”¨æŸä¸ªå…¬å…±ç»„ä»¶ï¼Œè¿™æ˜¯å°±éœ€è¦ç”¨åˆ° git submodule çš„åŠŸèƒ½äº†ã€‚ å»ºç«‹ Submoduleæ¼”ç¤ºä»“åº“ ä¸»é¡¹ç›®ï¼šgit@github.com:xxx/your-app.git å­é¡¹ç›®ï¼šgit@github.com:xxx/your-lib.git åœ¨ä¸»é¡¹ç›® your-app ä¸­ä½¿ç”¨git submodule add å­é¡¹ç›®åœ°å€ åœ¨ä¸»é¡¹ç›®ä¸­çš„è·¯å¾„ git submodule add git@github.com:xxx/your-lib.git libs/your-lib ç„¶ågit statusä¼šå‘ç°å¦‚ä¸‹ new file: .gitmodulesnew file: your-lib æŸ¥çœ‹.gitmoduleså†…å®¹ 123[submodule &quot;libs/your-lib&quot;] path = libs/your-lib url = git@github.com:xxx/your-lib.git éœ€è¦commitï¼Œä½†è¿™é‡Œå­æ¨¡å—ç›®å½•å¹¶ä¸æ˜¯ä»¥æ–‡ä»¶å½¢å¼æäº¤ï¼Œæ³¨æ„ä¸‹é¢å‡ºç°çš„160000æ¨¡å¼ã€‚ è¿™æ˜¯ Git ä¸­çš„ä¸€ç§ç‰¹æ®Šæ¨¡å¼ï¼Œå®ƒæœ¬è´¨ä¸Šæ„å‘³ç€ä½ æ˜¯å°†ä¸€æ¬¡æäº¤è®°ä½œä¸€é¡¹ç›®å½•è®°å½•çš„ï¼Œè€Œéå°†å®ƒè®°å½•æˆä¸€ä¸ªå­ç›®å½•æˆ–è€…ä¸€ä¸ªæ–‡ä»¶ã€‚ create mode 100644 .gitmodulescreate mode 160000 libs/your-lib æ›´æ–° Submoduleæˆ‘ä»¬å…ˆåœ¨ your-lib é‡Œåšäº†æ–°çš„commitï¼Œä½†åœ¨ä¸»é¡¹ç›® your-app ä¸­ç›´æ¥git pullå¹¶ä¸èƒ½è·å–åˆ°å­æ¨¡å—çš„æœ€æ–°æ›´æ–°ã€‚ ã€æ³¨æ„ã€‘éœ€è¦è¿›åˆ°ä¸»é¡¹ç›®ä¸­å­æ¨¡å—çš„å…·ä½“ç›®å½•é‡Œå† git pull ç„¶ååœ¨ä¸»é¡¹ç›®æ ¹ç›®å½•ä¸‹å‘ç°ã€‚ã€‚ã€‚ modified: your-lib (new commits) åœ¨ä¸»é¡¹ç›®ä¸­éœ€è¦å†æ¬¡commitï¼Œä»¥å‘Šè¯‰HEADå½“å‰çš„å­æ¨¡å—æŒ‡å‘å“ªä¸ªç‰ˆæœ¬ã€‚åœ¨ git çš„æäº¤è®°å½•é‡Œèƒ½çœ‹åˆ°å˜åŒ–å†…å®¹åªæ˜¯ä¸ªcommitæ ‡è¯† Git åœ¨ä¸»é¡¹ç›®ä¸­è®°å½•äº†ä¸€ä¸ªå­æ¨¡å—çš„æäº¤æ—¥å¿—çš„æŒ‡é’ˆï¼Œç”¨äºä¿å­˜å­æ¨¡å—çš„æäº¤æ—¥å¿—æ‰€å¤„çš„ä½ç½®ï¼Œä»¥ä¿è¯æ— è®ºå­æ¨¡å—æ˜¯å¦æœ‰æ–°çš„æäº¤ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªåœ°æ–¹å…‹éš†ä¸‹é¡¶çº§é¡¹ç›®æ—¶ï¼Œå„ä¸ªå­æ¨¡å—çš„è®°å½•æ˜¯ä¸€è‡´çš„ã€‚é¿å…å› ä¸ºæ‰€å¼•ç”¨çš„å­æ¨¡å—ä¸ä¸€è‡´å¯¼è‡´çš„æ½œåœ¨é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬æ›´æ–°äº†å­æ¨¡å—ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªæœ€è¿‘çš„è®°å½•æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­ï¼Œä»¥æ–¹ä¾¿å’Œå…¶ä»–äººååŒã€‚ å…‹éš†ä¸»é¡¹ç›®æ–¹æ³•1ï¼š 12git clone git@github.com:xxx/your-app.gitgit submodule update --init --recursive æ–¹æ³•2ï¼š 1git clone --recursive git@github.com:xxx/your-app.git ä»Šåå¯¹ä¸»é¡¹ç›® pull æ—¶ 12git pullgit submodule update --recursive Submodule å¼€å‘åä½œåœ¨ä¸»é¡¹ç›®ä¸­æ·»åŠ äº† submodule ä½œä¸ºå­é¡¹ç›®ï¼Œå…¶å®è¿›å…¥åˆ°å­é¡¹ç›®ä¸­ï¼Œå®ƒè·Ÿå¹³å¸¸git cloneä¸‹æ¥çš„ä»“åº“æ²¡å•¥åŒºåˆ«ï¼ŒåŒæ ·å¯ä»¥åœ¨é‡Œé¢ commit, pull, push å¦‚æœéœ€è¦å°†å­é¡¹ç›®å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨git reset â€“hard commit_idï¼Œå³åœ¨ä¸»é¡¹ç›®ä¸­ä¸ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„å­é¡¹ç›®ï¼ˆæ­¤æ—¶åŒæ ·éœ€åœ¨ä¸»é¡¹ç›®ä¸­ add commit 1æ¬¡ï¼Œä»¥æ›´æ–° Subproject çš„æŒ‡é’ˆä½ç½®ï¼‰ã€‚æ›´å¤š git å·¥ä½œæµçš„åä½œ&gt;&gt; åˆ é™¤ Submoduleåœ¨ä¸»é¡¹ç›®ä¸­git rm libs/your-lib/åˆ é™¤å­æ¨¡å—åï¼Œ.gitmodulesæ–‡ä»¶çš„å†…å®¹ä¹Ÿä¼šç›¸åº”ç§»é™¤ æ›´å¤šå‚è€ƒ Git å·¥å…· - å­æ¨¡å—]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹CSSå¼¹æ€§å¸ƒå±€]]></title>
    <url>%2Fblog%2F2016%2F10%2Fcode-patterns-of-css-flexiable-layout.html</url>
    <content type="text"><![CDATA[ç»­å‰é¢çš„CSSå¸ƒå±€ç¯‡ï¼Œè¿™ç¯‡é’ˆå¯¹ç§»åŠ¨ç«¯å¸ƒå±€çš„ç‰¹ç‚¹æ•´ç†äº†å‡ ç§å¼¹æ€§å¸ƒå±€çš„æ¡ˆä¾‹ã€‚ ç™¾åˆ†æ¯”å¸ƒå±€ç›¸è¾ƒäºå†™æ­»åƒç´ ç»å¯¹å€¼çš„å¸ƒå±€ï¼Œç™¾åˆ†æ¯”å¸ƒå±€æ˜¯æœ€ç®€å•çš„å®ç°å¼¹æ€§å¸ƒå±€çš„æ–¹å¼ï¼Œåªéœ€å°†åŸæ¥å®½åº¦çš„ç»å¯¹å¤§å°éƒ½æ›¿æ¢æˆç™¾åˆ†æ¯”å³å¯ã€‚ 12345678910111213141516171819.layout-container &#123; background: #eee; padding: 5px; font-size: 0; .box &#123; box-sizing: border-box; display: inline-block; height: 80px; padding: 5px; width: percentage(1/3); .inner &#123; background: #ccc; height: 100%; width: 100%; &#125; &#125;&#125; æ³¨ï¼šéƒ¨åˆ†æ‰‹æœºæµè§ˆå™¨æ— æ³•è®¡ç®—åˆ°å¾ˆç²¾ç¡®çš„percentageï¼Œåœ¨å››èˆäº”å…¥æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œæ¯”å¦‚æ€»å®½åº¦è¶…è¿‡äº†100%å°±ä¼šå°†æœ€åä¸€ä¸ªå…ƒç´ æŒ¤åˆ°ä¸‹ä¸€è¡Œå»ã€‚å› æ­¤å°†ä¸Šè¿°percentage(1/3)æ”¹ä¸º33.3%å³å¯ã€‚ flex å¸ƒå±€å…³äºflexå¸ƒå±€çš„æ•™ç¨‹è¯·çœ‹ï¼šä¸€ä¸ªå®Œæ•´çš„FlexboxæŒ‡å— 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475.flexbox()&#123; display: -webkit-box; display: -moz-box; display: -ms-flexbox; display: -webkit-flex; display: flex; -webkit-box-lines: multiple; -moz-box-lines: multiple; -ms-flex-wrap: wrap; -webkit-flex-wrap: wrap; flex-wrap: wrap; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -moz-box-orient: horizontal; -moz-box-direction: normal; -ms-flex-direction: row; -webkit-flex-direction: row; flex-direction: row; &amp;.vertical&#123; -webkit-box-orient: vertical; -moz-box-orient: vertical; -ms-flex-direction: column; -webkit-flex-direction: column; flex-direction: column; &#125;&#125;.flex(@grow, @shrink, @basis)&#123; -webkit-box-flex: @grow; -moz-box-flex: @grow; -ms-flex: @grow @shrink @basis; -webkit-flex-grow: @grow; -webkit-flex-shrink: @shrink; -webkit-flex-basis: @basis; -webkit-flex: @grow @shrink @basis; flex-grow: @grow; flex-shrink: @shrink; flex-basis: @basis; flex: @grow @shrink @basis;&#125;.order($val) &#123; -webkit-box-ordinal-group: $val; -moz-box-ordinal-group: $val; -ms-flex-order: $val; -webkit-order: $val; order: $val;&#125;.layout-container&#123; background: #eee; padding: 5px; .flexbox(); &amp;, *, *:after, *:before &#123; box-sizing: border-box; &#125; .box&#123; background: #ccc; height: 80px; margin: 5px; .flex(1, 1, 0); /*flex-basisåœ¨è€webkitä¸‹ä¸ç”Ÿæ•ˆ*/ width: 0; /*androidæœ‰äº›æµè§ˆå™¨ä¸‹é¢å¦‚æœé‡ç½®å®½åº¦ï¼Œä¸ä¼šé€šè¿‡flexæ¥è®¡ç®—å®½åº¦*/ max-width: 100%; display: block; /*padding: 0 !important;*/ /*position: relative;*/ &#125;&#125; å¼¹æ€§å›¾ç‰‡å¼¹æ€§å›¾ç‰‡çš„éœ€æ±‚æ˜¯å½“å±å¹•å°ºå¯¸å˜åŒ–æ—¶ï¼Œå›¾ç‰‡ä¿æŒç­‰æ¯”ç¼©æ”¾ï¼Œä¸”ä¸èƒ½å‡ºç°æ–‡æ¡£é«˜åº¦çš„æŠ–åŠ¨ã€‚ 12345&lt;div class="item"&gt; &lt;div class="img-wrapper"&gt; &lt;img src="http://img.taobaocdn.com/tfscom/TB1Fhi3HVXXXXXlXpXXSutbFXXX_q50.jpg"&gt; &lt;/div&gt;&lt;/div&gt; 1234567891011121314151617181920.item&#123; float: left; width: 50%;&#125;.img-wrapper&#123; margin: 0 10px 10px 0; position: relative;&#125;.img-wrapper::before&#123; content: ''; display: block; padding-top: 30%;&#125;.img-wrapper img&#123; height: 100%; left: 0; position: absolute; top: 0; width: 100%;&#125; åŸç† padding çš„ç™¾åˆ†æ¯”å€¼éƒ½æ˜¯å‚ç…§çˆ¶å…ƒç´ çš„ width è®¡ç®—å‡ºçš„ absolute å…ƒç´ çš„ widthã€height ç™¾åˆ†æ¯”å€¼ä¹Ÿæ˜¯å‚ç…§æœ€è¿‘ relative çˆ¶å…ƒç´ çš„ é€šè¿‡åœ¨ img çˆ¶å…ƒç´ å†…åšä¸ªä¼ªç±»ï¼Œç”¨padding-topå°†çˆ¶å…ƒç´ æ’‘èµ·æ¥ï¼Œpadding-topçš„ç™¾åˆ†æ¯”ç­‰äºå›¾ç‰‡çš„é«˜å®½æ¯”ã€‚è¿™æ ·å½“å›¾ç‰‡æœªè½½å…¥æ—¶ï¼Œä¹Ÿé¢„ç•™å‡ºå›¾ç‰‡çš„å ä½ï¼Œä¸ä¼šäº§ç”Ÿæ–‡æ¡£é«˜åº¦çš„è·³åŠ¨ã€‚ demoæ•ˆæœ ä¸¤åˆ—åŒæ­¥æ‹‰ä¼¸å¼¹æ€§å›¾ç‰‡çš„éœ€æ±‚å†è¿›ä¸€æ­¥ï¼Œéœ€è¦å®ç°ç­‰æ¯”ç¼©æ”¾çš„ä¸¤åˆ—å¸ƒå±€ï¼Œå¯ä»¥æ˜¯å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å›¾æ–‡æ··æ’ã€‚ï¼ˆå¯å‚è€ƒåŒ11å•†å“æ´»åŠ¨é¡µçš„ç§»åŠ¨ç«¯å±•ç°ï¼‰ 12345678&lt;div class="box banner"&gt; &lt;div class="box-inner"&gt; &lt;img class="banner-img" src="http://gtms04.alicdn.com/tps/i4/TB1BHIGHFXXXXbHXFXXTYq7_VXX-240-347.jpg"&gt; &lt;/div&gt;&lt;/div&gt;&lt;div class="box item"&gt; &lt;div class="box-inner"&gt;&lt;/div&gt;&lt;/div&gt; 1234567891011121314151617181920212223242526272829303132333435363738394041@cellPadding: 10px;@cellRatio: percentage(275/160); //å›¾ç‰‡é«˜å®½æ¯”.box&#123; background: #fff; border: 1px solid #000; border-width: 0 1px 1px 0; border-radius: 0; box-sizing: border-box; float: left; position: relative; padding: @cellPadding; width: 50%;&#125;.box::before&#123; content: ' '; display: block; padding-top: @cellRatio;&#125;.box:nth-of-type(2n)&#123; border-right-color: transparent;&#125;.box:last-of-type,.box:nth-last-of-type(2)&#123; border-bottom-color: transparent;&#125;.box-inner&#123; position: absolute; top: 10px; left: 10px; bottom: 10px; right: 10px;&#125;.banner-img&#123; height: 100%; width: 100%;&#125;.item .box-inner&#123; background: #f35656;&#125; ç§»åŠ¨ç«¯å¸ƒå±€ç‰¹ç‚¹ï¼š ç»å¯¹å®šä½æ—¶ä¸è¦å†™æ­»pxï¼Œç”¨ç™¾åˆ†æ¯”ï¼Œæˆ–è€…åŒæ—¶è®¾ç½®top left bottom right è¦è€ƒè™‘åˆ°å±å¹•resizeå’Œæ—‹è½¬çš„æƒ…å†µ demoæ•ˆæœ]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹CSSå…¼å®¹æ€§]]></title>
    <url>%2Fblog%2F2016%2F10%2Fcode-patterns-of-css-hack.html</url>
    <content type="text"><![CDATA[ç»­å‰é¢çš„CSSå¸ƒå±€ç¯‡ï¼Œè¿™é‡Œæ•´ç†ä¸€äº›éœ€æ±‚ä¸‹çš„æµè§ˆå™¨å…¼å®¹æ€§å†™æ³•ã€‚ è‰²å½©æ»¤é•œopacity1234567891011121314/* IE 8 */-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)"; /* IE 5-7 */filter: alpha(opacity=50); /* Netscape */-moz-opacity: 0.5; /* Safari 1.x */-khtml-opacity: 0.5; /* Good browsers */opacity: 0.5; ç°ç™½æ»¤é•œ1234567891011.grayscale()&#123; filter: gray; /* For IE 6 - 9 */ filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); filter: url("data:image/svg+xml;utf8,&amp;lt;svg xmlns=\'http://www.w3.org/2000/svg\'&amp;gt;&amp;lt;filter id=\'grayscale\'&amp;gt;&amp;lt;feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/&amp;gt;&amp;lt;/filter&amp;gt;&amp;lt;/svg&amp;gt;#grayscale"); /* Firefox 10+, Firefox on Android */ filter: grayscale(100%); /* For Standard */ -webkit-filter: grayscale(100%); /* Chrome 19+, Safari 6+, Safari 6+ iOS */ -webkit-filter: grayscale(1); -moz-filter: grayscale(100%); -ms-filter: grayscale(100%); -o-filter: grayscale(100%);&#125; å±…ä¸­é—®é¢˜table-cell å‚ç›´å±…ä¸­123456789101112131415161718192021.table &#123; height: 300px;/*é«˜åº¦å€¼ä¸èƒ½å°‘*/ width: 300px;/*å®½åº¦å€¼ä¸èƒ½å°‘*/ display: table; position: relative; float:left;&#125;.tableCell &#123; display: table-cell; vertical-align: middle; text-align: center; padding: 10px; *position: absolute; *top: 50%; *left: 50%;&#125;.content &#123; *position:relative; *top: -50%; *left: -50%;&#125; è¡Œæ’åˆ—inline-block IE6/7 hack12*display: inline;*zoom: 1; æœªå®Œå¾…ç»­è¯·æŒç»­å…³æ³¨~]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹å…ƒç´ åç§»é‡]]></title>
    <url>%2Fblog%2F2016%2F10%2Fcode-patterns-of-dom-position.html</url>
    <content type="text"><![CDATA[è·å–å…ƒç´ ç›¸å¯¹äºé¡µé¢å·¦ä¸Šè§’çš„ä½ç½®ï¼Œæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„éœ€æ±‚ã€‚æ¯”å¦‚å°†ä¸€ä¸ªæµ®å±‚å…ƒç´ å®šä½åˆ°å½“å‰æ“ä½œçš„å…ƒç´ é™„è¿‘ï¼Œå°±éœ€è¦è®¡ç®—å½“å‰æ“ä½œçš„å…ƒç´ ç›¸å¯¹äºé¡µé¢å·¦ä¸Šè§’çš„ä½ç½®ï¼Œç„¶åå°†æµ®å±‚å…ƒç´ ä¹Ÿç»å¯¹å®šä½åˆ°è¯¥ä½ç½®é™„è¿‘ã€‚ offsetParent æ³•123456789101112function getOffset(el) &#123; let top = 0; let left = 0; let target = el; while (target.offsetParent) &#123; top += target.offsetTop; left += target.offsetLeft; target = target.offsetParent; &#125; return &#123; top: top, left: left &#125;;&#125; æ€è·¯å°±æ˜¯å–å…ƒç´ offsetTopå’ŒoffsetLeftï¼Œç„¶åä½¿ç”¨offsetParenté€å±‚å‘ä¸Šç›´åˆ°æ ¹å…ƒç´ ï¼Œè¿™æ ·å°±å–å‡ºäº†ç›¸å¯¹äºé¡µé¢å·¦ä¸Šè§’çš„åç§»ã€‚ clientRect æ³•getBoundingClientRect å–å‡ºçš„æ˜¯å…ƒç´ ç›¸å¯¹äºè§†çª—çš„è·ç¦»ï¼Œé‚£ä¹ˆå†åŠ ä¸Šé¡µé¢æ»šåŠ¨æ¡çš„åç§»ï¼Œå°±å¯ä»¥æ±‚å‡ºå…ƒç´ ç›¸å¯¹äºé¡µé¢å·¦ä¸Šè§’çš„è·ç¦»ã€‚ 1234567891011121314151617181920212223function getOffset(el) &#123; if (el === document.documentElement) &#123; return &#123; top: 0, left: 0 &#125;; &#125; const box = el.getBoundingClientRect(); let top = 0; let left = 0; if (window.pageYOffset !== undefined) &#123; top = Math.floor(box.top + window.pageYOffset); left = Math.floor(box.left + window.pageXOffset); &#125; else &#123; // æœ‰ä¸ª bad case å³å½“HTMLæˆ–è€…BODYå…ƒç´ æœ‰ border width æ—¶ï¼Œä¼šæœ‰åå·® top = Math.floor(box.top) + Math.max(doc.documentElement.scrollTop, doc.body.scrollTop); left = Math.floor(box.left) + Math.max(doc.documentElement.scrollLeft, doc.body.scrollLeft); top -= doc.documentElement.clientTop; left -= doc.documentElement.clientLeft; &#125; return &#123; top: top, left: left &#125;;&#125; å¯è§getBoundingClientRectæ–¹æ³•æ¯”å–offsetParentæ•ˆç‡è¦é«˜çš„å¤šï¼Œå¹¶ä¸”æ­é…window.pageYOffsetä»£ç æ›´ç®€å•ã€‚ jquery æ³•ä½¿ç”¨ jquery é‡Œçš„offset å’Œ positionï¼Œå¯åˆ†åˆ«è·å–ç›¸å¯¹äºé¡µé¢å·¦ä¸Šè§’å’Œç›¸å¯¹äºçˆ¶å…ƒç´ çš„åç§»ã€‚ æºç å‚è§https://github.com/jquery/jquery/blob/1.7.2/src/offset.js#L7ï¼Œè€Œåœ¨1.9ç‰ˆæœ¬ä¸­ç®€åŒ–äº†å…¶å®ç°https://github.com/jquery/jquery/blob/1.9.1/src/offset.js#L1 å¯¹æ¯”ä¸‹ baidu/tangram åº“ä¸­çš„ç›¸åº”å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051baidu.dom.extend(&#123; offset: function() &#123; function setOffset(ele, options, index) &#123; var tang = tang = baidu.dom(ele), position = tang.getCurrentStyle('position'); position === 'static' &amp;&amp; (ele.style.position = 'relative'); var currOffset = tang.offset(), currLeft = tang.getCurrentStyle('left'), currTop = tang.getCurrentStyle('top'), calculatePosition = (~'absolute|fixed'.indexOf(position)) &amp;&amp; ~ ('' + currLeft + currTop).indexOf('auto'), curPosition = calculatePosition &amp;&amp; tang.position(); currLeft = curPosition &amp;&amp; curPosition.left || parseFloat(currLeft) || 0; currTop = curPosition &amp;&amp; curPosition.top || parseFloat(currTop) || 0; baidu.type('options') === 'function' &amp;&amp; (options = options.call(ele, index, currOffset)); options.left != undefined &amp;&amp; (ele.style.left = options.left - currOffset.left + currLeft + 'px'); options.top != undefined &amp;&amp; (ele.style.top = options.top - currOffset.top + currTop + 'px'); &#125; return function(options) &#123; if (options) &#123; baidu.check('^(?:object|function)$', 'baidu.dom.offset'); for (var i = 0, item; item = this[i]; i++) &#123; setOffset(item, options, i); &#125; return this; &#125; var ele = this[0], doc = this.getDocument(), box = &#123; left: 0, top: 0 &#125;, win, docElement; if (!doc) &#123; return; &#125; docElement = doc.documentElement; if (!baidu._util_.contains(docElement, ele)) &#123; return box; &#125; (typeof ele.getBoundingClientRect) !== 'undefined' &amp;&amp; (box = ele.getBoundingClientRect()); win = this.getWindow(); return &#123; left: box.left + (win.pageXOffset || docElement.scrollLeft) - (docElement.clientLeft || 0), top: box.top + (win.pageYOffset || docElement.scrollTop) - (docElement.clientTop || 0) &#125;; &#125; &#125; ()&#125;);]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æµ…è°ˆHSVé¢œè‰²æ¨¡å‹]]></title>
    <url>%2Fblog%2F2016%2F09%2Fcolor-model-hsv.html</url>
    <content type="text"><![CDATA[é¢œè‰²æ¨¡å‹æ¥æºé¢œè‰²æ¨¡å‹æœ€æ—©æ¥è‡ªç¾æœ¯å’Œæ‰“å°é¢†åŸŸã€‚â€œä¸‰åŸè‰²â€å°±æ˜¯ä¸€ç§é¢œè‰²æ¨¡å‹ï¼Œå®ƒæ¥è‡ªç¾æœ¯ä¸Šçš„æ¦‚å¿µï¼ŒæŒ‡â€œçº¢/é»„/è“â€ï¼Œå› ä¸ºè¿™ä¸‰ç§é¢œè‰²çš„é…åˆå¯ä»¥è°ƒå‡ºé™¤äº†é»‘ç™½ä»¥å¤–çš„å‡ ä¹æ‰€æœ‰é¢œè‰²ï¼Œæ•…ç§°ä¸ºä¸‰åŸè‰²ã€‚ è€Œåœ¨è®¡ç®—æœº/å¤šåª’ä½“æ–¹é¢æ‰€è¯´çš„â€œR/G/Bâ€é¢œè‰²æ¨¡å‹å…¶å®æ˜¯â€œä¸‰åŸºè‰²â€ï¼Œæˆ–è€…æ•™ç§‘ä¹¦ä¸Šæ‰€è¯´çš„â€œå…‰çš„ä¸‰åŸè‰²â€ã€‚çº¢ã€ç»¿ã€è“ä¸‰ç§å…‰é€šè¿‡ä¸åŒçš„ç»„åˆï¼Œå¯ä»¥è·å¾—å„ç§ä¸åŒé¢œè‰²å…‰ã€‚è€Œçº¢ã€ç»¿ã€è“è¿™ä¸‰ç§å…‰æ˜¯æ— æ³•ç”¨å…¶ä»–è‰²å…‰æ··åˆè€Œæˆçš„ï¼Œæ‰€ä»¥è¿™ä¸‰ç§è‰²å…‰å«åšå…‰çš„â€œä¸‰åŸºè‰²â€ã€‚ ç‰©ç†è§£é‡Šç‰©ç†è¯¾ä¸Šå­¦è¿‡å…‰çš„è‰²æ•£ï¼Œè‚¯å®šè§è¿‡ä¸‹é¢è¿™ä¸ªå›¾ã€‚ å¯çŸ¥ç™½å…‰æ˜¯å„ç§é¢œè‰²çš„å…‰å åŠ è€Œæˆçš„ï¼Œæ˜¾ç„¶å…‰çš„ä¸‰åŸè‰²æ˜¯ä¸€ç§â€œåŠ æ³•â€é¢œè‰²æ¨¡å‹ã€‚ å…‰çš„é¢œè‰²æ˜¯ç›´æ¥è¿›å…¥äººçš„çœ¼ç›ï¼Œè€Œäººçœ‹åˆ°å„ç§ç‰©ä½“çš„é¢œè‰²ï¼Œå…¶å®æ˜¯ç‰©ä½“åå°„å‡ºçš„å…‰çš„é¢œè‰²ã€‚å³çº¢è‰²çš„ç‰©ä½“åªä¼šåå°„çº¢è‰²çš„å…‰ï¼Œå…¶ä»–é¢œè‰²çš„å…‰éƒ½è¢«å®ƒå¸æ”¶äº†ï¼›è€Œé»‘è‰²çš„ç‰©ä½“å¸æ”¶äº†æ‰€æœ‰é¢œè‰²çš„å…‰ï¼Œäººçœ‹ä¸åˆ°å®ƒçš„åå°„å…‰ï¼Œæ‰€ä»¥çœ‹åˆ°çš„æ˜¯é»‘è‰²ã€‚ å› æ­¤è¢«ç‰©ä½“å¸æ”¶çš„é¢œè‰²ï¼Œå…¶å®æ˜¯æ‰€æœ‰é¢œè‰² - ç‰©ä½“åå°„çš„é¢œè‰²ï¼Œå½“é¢œæ–™å åŠ æ—¶ï¼Œä¹Ÿéµä»äº†æ‰€æœ‰é¢œè‰² - Î£(åå°„çš„é¢œè‰²)ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ç§â€œå‡æ³•â€é¢œè‰²æ¨¡å‹ã€‚ å¸¸ç”¨é¢œè‰²æ¨¡å‹RGBå³å…‰çš„ä¸‰åŸè‰²ï¼Œå¦‚ä¸‹å›¾ã€‚ RGB é¢œè‰²æ¨¡å‹å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç«‹æ–¹ä½“çš„æ¨¡å‹ï¼ŒR/G/B åˆ†åˆ«ä»£è¡¨ä¸‰ç»´åæ ‡ç³»ä¸­çš„ x/y/z è½´ï¼Œè€ŒåŸç‚¹è¡¨ç¤ºä»€ä¹ˆé¢œè‰²éƒ½æ²¡æœ‰(å³é»‘è‰²) åœ¨è®¡ç®—æœºå¤šåª’ä½“é¢†åŸŸä¸­ï¼Œé€šå¸¸å°† R/G/B ä¸‰ä¸ªå€¼æ ‡å‡†åŒ–åˆ° 0~255 çš„æ•´æ•°åŒºé—´ä¸Šï¼Œå› ä¸ºè¿™æ ·ä¸€ä¸ªé¢œè‰²åˆ†é‡å…±æœ‰256ä¸ªå–å€¼ï¼Œæ­£å¥½å¯ä»¥ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚è¿™æ · R/G/B å…±å¯ç»„æˆ 2^24 ç§é¢œè‰²ï¼Œå½“ç„¶è¿œè¿œè¶…è¿‡äº†äººçœ¼èƒ½å¤Ÿåˆ†è¾¨çš„é¢œè‰²æ•°ç›®ã€‚ CMYç¬¬ä¸€èŠ‚ä¸­æåˆ°çš„ç¾æœ¯/å°åˆ·é¢†åŸŸç”¨çš„ä¸‰åŸè‰²ï¼Œå…¶å®å°±æ˜¯ CMY é¢œè‰²æ¨¡å‹ã€‚ åœ¨å°åˆ·é¢†åŸŸä¹Ÿä¼šç”¨ CMYK æ¨¡å‹ï¼Œè¡¨ç¤ºé’(Cyan)å“çº¢(Magenta)é»„(Yellow)é»‘(BlacK)å››ç§é¢œæ–™ï¼Œå°±æ˜¯åœ¨ CMY çš„åŸºç¡€ä¸Šä¹Ÿå°†é»‘è‰²ä½œä¸ºåŸºç¡€é¢œè‰²ï¼Œå› ä¸ºæ‰“å°æ—¶ç”±å“çº¢ã€é»„ã€é’åˆæˆçš„é»‘è‰²ä¸å¤Ÿçº¯ç²¹ã€‚ ä»ä¸Šé¢å¯ä»¥çœ‹åˆ° CMY å’Œ RGB çš„é¢œè‰²åˆæˆå›¾æœ‰ç‚¹ç±»ä¼¼ï¼ŒRå’ŒBå¯ä»¥æˆå“çº¢ã€‚è¿™é‡Œè¦è¯´æ˜ä¸‹ï¼ŒRGB é¢œè‰²æ˜¯è¶Šå åŠ è¶Šäº®(è¶Šæ¥è¿‘ç™½è‰²)ï¼Œè€Œ CMY é¢œè‰²æ˜¯è¶Šå åŠ è¶Šæš—(è¶Šæ¥è¿‘é»‘è‰²)ï¼Œè¿™å°±æ˜¯â€œåŠ æ³•æ··è‰²æ¨¡å‹â€å’Œâ€œå‡æ³•æ··è‰²æ¨¡å‹â€çš„åŒºåˆ«ã€‚ HSVHSV ä½¿ç”¨å…­è§’é”¥ä½“æ¨¡å‹æ¥è¡¨ç¤º è‰²è°ƒï¼ˆHueï¼‰ã€é¥±å’Œåº¦ï¼ˆSaturationï¼‰ã€æ˜åº¦ï¼ˆValueï¼‰ã€‚ ç”¨è§’åº¦æ¥è¡¨ç¤ºè‰²è°ƒHï¼Œå–å€¼èŒƒå›´ä¸º0Â°ï½360Â°ï¼Œä»çº¢è‰²å¼€å§‹æŒ‰é€†æ—¶é’ˆæ–¹å‘è®¡ç®—ï¼Œçº¢è‰²ä¸º0Â°ï¼Œç»¿è‰²ä¸º120Â°ï¼Œè“è‰²ä¸º240Â°ã€‚å®ƒä»¬çš„è¡¥è‰²æ˜¯ï¼šé»„è‰²ä¸º60Â°ï¼Œé’è‰²ä¸º180Â°ï¼Œå“çº¢ä¸º300Â°ã€‚ é¥±å’Œåº¦Sè¡¨ç¤ºé¢œè‰²æ¥è¿‘å…‰è°±è‰²çš„ç¨‹åº¦ï¼Œé€šå¸¸å–å€¼èŒƒå›´ä¸º0%ï½100%ï¼Œå€¼è¶Šå¤§ï¼Œé¢œè‰²è¶Šé¥±å’Œã€‚è€ŒS=0æ—¶ï¼Œåªæœ‰ç°åº¦ã€‚ æ˜åº¦Vè¡¨ç¤ºé¢œè‰²æ˜äº®çš„ç¨‹åº¦ï¼Œé€šå¸¸å–å€¼èŒƒå›´ä¸º 0%ï¼ˆé»‘ï¼‰åˆ° 100%ï¼ˆç™½ï¼‰ HSV æ¨¡å‹çš„ä¸‰ç»´è¡¨ç¤ºä» RGB ç«‹æ–¹ä½“æ¼”åŒ–è€Œæ¥ã€‚è®¾æƒ³ä» RGB æ²¿ç«‹æ–¹ä½“å¯¹è§’çº¿çš„ç™½è‰²é¡¶ç‚¹å‘é»‘è‰²é¡¶ç‚¹è§‚å¯Ÿï¼Œå°±å¯ä»¥çœ‹åˆ°ç«‹æ–¹ä½“çš„å…­è¾¹å½¢å¤–å½¢ã€‚å…­è¾¹å½¢è¾¹ç•Œè¡¨ç¤ºè‰²å½©ï¼Œæ°´å¹³è½´è¡¨ç¤ºçº¯åº¦ï¼Œæ˜åº¦æ²¿å‚ç›´è½´æµ‹é‡ã€‚ HSLHSL å’Œ HSV å¾ˆç›¸ä¼¼ï¼Œå®ƒä»¬éƒ½æ˜¯é¢å‘ç”¨æˆ·çš„é¢œè‰²æ¨¡å‹ï¼Œå®šä¹‰äº†ï¼šè‰²è°ƒ(è‰²ç›¸)ã€é¥±å’Œåº¦ã€æ˜åº¦(äº®åº¦)ã€‚ç›¸ä¿¡å¤§å®¶åœ¨è°ƒèŠ‚ç”µè§†æˆ–æ˜¾ç¤ºå™¨å±å¹•é¢œè‰²æ—¶éƒ½ä¼šçœ‹åˆ°è¿™å‡ ä¸ªåè¯å§ï¼ å…³äºæ›´å¤š HSL å’Œ HSV çš„åŒºåˆ«è¯·å‚è§ ç»´åŸºè¯æ¡ï¼šHSLå’ŒHSVè‰²å½©ç©ºé—´ é¢œè‰²æ¨¡å‹è½¬åŒ–RGB to HSVç”± RGB è½¬æ¢ä¸º HSV æ—¶ï¼Œè®¾maxä¸º r/g/b ä¸­çš„æœ€å¤§å€¼ï¼Œminä¸º r/g/b ä¸­çš„æœ€å°å€¼ã€‚è½¬æ¢å…¬å¼å¦‚ä¸‹ js å®ç°å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465rgb2hsv: function () &#123; // è¯»å– rgb var rgb = this.parseRgbArguments.apply(null, arguments); var r = rgb.r; var g = rgb.g; var b = rgb.b; // rgb åˆ†é‡çš„æœ€å¤§æœ€å°å€¼ var max; var min; if (r &gt; g) &#123; max = Math.max(r, b); min = Math.min(g, b); &#125; else &#123; max = Math.max(g, b); min = Math.min(r, b); &#125; var delta = max - min; // hsv åˆ†é‡ var v = max; var s = (v === 0.0) ? 0.0 : delta / v; var h; if (s === 0.0) &#123; h = 0.0; &#125; else &#123; if (r === max) &#123; h = 60.0 * (g - b) / delta; &#125; else if (g === max) &#123; h = 120 + 60.0 * (b - r) / delta; &#125; else &#123; h = 240 + 60.0 * (r - g) / delta; &#125; // ä¿®æ­£è‰²è°ƒ ( 0~360 åº¦) if (h &lt; 0.0) &#123; h += 360.0; &#125; if (h &gt; 360.0) &#123; h -= 360.0; &#125; &#125; h = Math.round(h); s = Math.round(s * 255.0); v = Math.round(v); // avoid the ambiguity of returning different values for the same color if (h === 360) &#123; h = 0; &#125; // æ³¨: s,v åˆ†é‡å€¼åŸŸä¸º 0~255 return &#123; h: h, s: s, v: v &#125;;&#125; æ³¨æ„ï¼šå› ä¸ºv = max(r,g,g)ï¼Œè¿™é‡Œæˆ‘å°†vå’Œsä¹Ÿè½¬åˆ°äº†0~255çš„åŒºé—´ä¸Šï¼Œè€Œhçš„å€¼åŸŸä¸º0~359ã€‚ HSV to RGBç”±HSVè½¬æ¢ä¸ºRGBæ—¶ï¼Œå¦‚æœé¥±å’Œåº¦s = 0ï¼Œåˆ™é¢œè‰²æ˜¯éå½©è‰²çš„ï¼Œè‰²è°ƒ(Hue)æ˜¯æ— æ„ä¹‰çš„ï¼Œæ­¤æ—¶r=g=b=v(äº®åº¦)ã€‚ å¦‚æœé¥±å’Œåº¦s â‰  0ï¼Œæœ‰å¦‚ä¸‹çš„è®¡ç®—æ–¹å¼ï¼š js å®ç°å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485hsv2rgb: function () &#123; // è¯»å– hsv var hsv = this.parseHsvArguments.apply(null, arguments); var h = hsv.h; var s = hsv.s; var v = hsv.v; // rgb åˆ†é‡ var r; var g; var b; // ç‰¹æ®Šå¤„ç† if (s === 0) &#123; r = v; g = v; b = v; &#125; else &#123; // åŸå§‹äº®åº¦ var value = v; // s,v åˆ†é‡å½’ä¸€åŒ– var s = s / 255.0; var v = v / 255.0; // ä¿®æ­£åçš„ h åˆ†é‡ var hFix = (h === 360) ? 0 : h / 60; var hIndex = Math.floor(hFix); var hLeft = hFix - hIndex; // v åˆ†é‡è½¬åŒ–çš„ä¸­é—´å˜é‡ var vs = v * s; var vLeft = value - value * s; switch (hIndex) &#123; case 0: var vTemp = v - vs * (1 - hLeft); r = Math.round(value); g = Math.round(vTemp * 255.0); b = Math.round(vLeft); break; case 1: var vTemp = v - vs * hLeft; r = Math.round(vTemp * 255.0); g = Math.round(value); b = Math.round(vLeft); break; case 2: var vTemp = v - vs * (1 - hLeft); r = Math.round(vLeft); g = Math.round(value); b = Math.round(vTemp * 255.0); break; case 3: var vTemp = v - vs * hLeft; r = Math.round(vLeft); g = Math.round(vTemp * 255.0); b = Math.round(value); break; case 4: var vTemp = v - vs * (1 - hLeft); r = Math.round(vTemp * 255.0); g = Math.round(vLeft); b = Math.round(value); break; case 5: var vTemp = v - vs * hLeft; r = Math.round(value); g = Math.round(vLeft); b = Math.round(vTemp * 255.0); break; &#125; &#125; return &#123; r: r, g: g, b: b &#125;;&#125; è¯¦è§ å®Œæ•´ä»£ç  å’Œ æµ‹è¯•ç”¨ä¾‹ å‚è€ƒ åœ¨çº¿è½¬åŒ–å·¥å…·ï¼šhttp://www.kmhpromo.com/rgbtopms/cmyktopantone.html æ›´å¤šé¢œè‰²æ¨¡å‹ï¼šhttp://blog.ibireme.com/2013/08/12/color-model/]]></content>
      <categories>
        <category>ç»˜å›¾</category>
      </categories>
      <tags>
        <tag>util</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨æ¨¡å¼ç‰‡æ®µä¹‹CSSå¸ƒå±€ç¯‡]]></title>
    <url>%2Fblog%2F2016%2F08%2Fcode-patterns-of-css-layout.html</url>
    <content type="text"><![CDATA[å»å¹´åœ¨æ­å·å®ä¹ çš„ä¸‰ä¸ªå¤šæœˆæ”¶è·é¢‡å¤šï¼Œä¸ç®¡æ˜¯ä»£ç å±‚é¢è¿˜æ˜¯æ€è€ƒå±‚é¢ï¼Œå‘ç°äº†è‡ªå·±å¾ˆå¤šä¸€çŸ¥åŠè§£çš„ç¼ºç‚¹ï¼Œæ­£åº”äº†å¢¨è²æ³•åˆ™ï¼Œä¼šå‡ºé”™çš„äº‹æ€»ä¼šå‡ºé”™ã€‚ç°åœ¨é‡æ–°æ•´ç†é‚£æ—¶çš„å­¦ä¹ ç¬”è®°ï¼Œä»¥å¤‡ä»Šåä¹‹éœ€ã€‚ æ³¨ï¼šæ­¤ä¸ºåˆç¨¿ç¬”è®°ï¼ŒæœªäºŒæ¬¡æç‚¼ã€‚ position æ‹‰ä¼¸æ’‘æ»¡æ•´ä¸ªæœªçŸ¥å®½é«˜å®¹å™¨12position: absolute;top: 0; bottom: 0; left: 0; right: 0; æ’‘æ»¡æ•´ä¸ªå±å¹•12position: fixed;top: 0; bottom: 0; left: 0; right: 0; æ³¨ï¼šæ˜¯å…ƒç´ æ’‘æ»¡ï¼Œå¦‚æœåªæ˜¯èƒŒæ™¯æ’‘æ»¡ï¼Œåªéœ€å¯¹æ ¹èŠ‚ç‚¹è®¾background å±…ä¸­æ°´å¹³å±…ä¸­å·²çŸ¥å…ƒç´ å®½åº¦ 123456789#parent &#123; position: relative;&#125;#content &#123; position: absolute; left: 50%; margin-left: -200px; // è´Ÿ (width/2) width: 400px;&#125; æœªçŸ¥å…ƒç´ å®½åº¦ 1234567891011121314#parentWrapper &#123; position: relative; overflow: hidden;&#125;#parent &#123; float: left; position: relative; left: 50%;&#125;#content &#123; float: left; position: relative; right: 50%;&#125; demoæ•ˆæœ æµ®åŠ¨å®Œå¤‡çš„clearfix1234567891011121314.clearfix() &#123; *zoom: 1; &amp;:before, &amp;:after &#123; display: table; content: ""; // Fixes Opera/contenteditable bug: // http://nicolasgallagher.com/micro-clearfix-hack/#comment-36952 line-height: 0; &#125; &amp;:after &#123; clear: both; &#125;&#125; å·¦ä¾§èœå• å³ä¾§ä¸»ä½“å·¦ä¾§å®šå®½ï¼Œå³ä¾§å…ƒç´ è‡ªé€‚åº”é“ºæ»¡ å·¦ä¾§å…ƒç´ å®šå®½ï¼Œå¹¶æµ®åŠ¨ å³ä¾§å…ƒç´ è®¾oerflow: hidden çˆ¶å®¹å™¨å¯å®šå®½ï¼Œä¹Ÿå¯100%é“ºæ»¡ BFC (Block Formatting Context)é¡µé¢ä¸Šä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥çœ‹æˆ boxï¼Œbox ç§ç±»æœ‰ï¼šBlock-levelï¼ŒInline-level å’ŒåŒ¿åbox BFC (Block Formatting Context) æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œåªæœ‰ Block-level box å‚ä¸ï¼Œ å®ƒè§„å®šäº†å†…éƒ¨çš„ Block-level box å¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªåŒºåŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²ã€‚ BFCå¸ƒå±€è§„åˆ™ å†…éƒ¨çš„ Box ä¼šåœ¨å‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½® Box å‚ç›´æ–¹å‘çš„è·ç¦»ç”± margin å†³å®šã€‚å±äºåŒä¸€ä¸ª BFC çš„ä¸¤ä¸ªç›¸é‚» Box çš„ margin ä¼šå‘ç”Ÿé‡å ï¼ˆmargin callapseï¼‰ å³ä½¿æ˜¯å­å…ƒç´ å’Œçˆ¶å…ƒç´ çš„å…³ç³»ï¼Œå¦‚æœå®ƒä»¬åœ¨åŒä¸€ä¸ª BFC Box ä¸‹ï¼Œä¹Ÿä¼šå‘ç”Ÿ margin callapse æ¯ä¸ªå…ƒç´ çš„ margin box çš„å·¦è¾¹ï¼Œ ä¸åŒ…å«å— border box çš„å·¦è¾¹ç›¸æ¥è§¦ï¼ˆå¯¹äºä»å·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸åï¼‰ å³ä½¿å­˜åœ¨æµ®åŠ¨å…ƒç´ ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå³åœ¨ä¸€ä¸ª BFC Box å†…éƒ¨ï¼Œæµ®åŠ¨æµå’Œæ–‡æ¡£æµä¼šå‘ç”Ÿé‡å  BFC çš„åŒºåŸŸä¸ä¼šä¸æµ®åŠ¨å…ƒç´ é‡å ï¼ˆåˆ©ç”¨å®ƒé‡æ–°æ„é€ ä¸ª BFC åŒºåŸŸï¼Œå°±å¯ä»¥æ¸…é™¤æµ®åŠ¨ï¼‰ è®¡ç®— BFC åŒºåŸŸçš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®— æ€»ç»“ BFCï¼Œå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´  å¦‚ä½•è§¦å‘BFC float å±æ€§ä¸ä¸º none ï¼ˆå³è„±ç¦»æ–‡æ¡£æµï¼Œåˆ°æµ®åŠ¨æµï¼‰ position ä¸º absolute æˆ– fixed ï¼ˆå³è„±ç¦»æ–‡æ¡£æµï¼Œåˆ°å®šä½æµï¼‰ overflow ä¸ä¸º visible ï¼ˆIE6/7 æ— æ•ˆæ—¶ï¼Œå¯ä»¥è®¾ zoom: 1 è§¦å‘ hasLayoutï¼‰ display ä¸º inline-block, table-cell, table-caption, flex, inline-flex å‚è€ƒèµ„æ–™ W3Cæ ‡å‡† Visual formatting model å‰ç«¯ç²¾é€‰æ–‡æ‘˜ï¼šBFC ç¥å¥‡èƒŒåçš„åŸç† è¡Œæ’åˆ—inline-block é—´éš™ inline-blockä¹‹é—´æ˜¯ä¼šæœ‰ä¸€ä¸ªé»˜è®¤é—´éš™çš„ï¼Œè·Ÿçˆ¶å…ƒç´ font-sizeæœ‰å…³ï¼Œè®¾ä¸º0å°±å¯ä»¥äº† è€safariä¸‹è¿˜éœ€è®¾letter-spacingã€word-spacingä¸€ä¸ªè´Ÿå€¼(0.25emå·¦å³)ï¼Œå­å…ƒç´ è®¾ä¸ºnormal blockä¹‹é—´æ²¡æœ‰é—´éš™ inline-block è¡Œé«˜ çˆ¶å…ƒç´ blockï¼Œå­å…ƒç´ inline-blockæ—¶ï¼Œå­å…ƒç´ ä¼šæœ‰ä¸€å®šè¡Œé«˜ï¼Œå¯¼è‡´çˆ¶å…ƒç´ çš„é«˜åº¦ä¸å­å…ƒç´ å®é™…å†…å®¹çš„é«˜åº¦ä¸ä¸€è‡´ çˆ¶å…ƒç´ è®¾font-size: 0ï¼ŒåŒæ—¶IEä¸‹å†è®¾line-height: 0 å­å…ƒç´ æ¨ªå‘æ’åˆ—è¾¹è· å­å…ƒç´ éƒ½è®¾ margin-rightï¼Œè€Œæœ€è¾¹ä¸Šçš„å…ƒç´ éœ€è¦ä¿®æ­£ï¼Œç”¨ nth-child ä¼šæœ‰å…¼å®¹æ€§é—®é¢˜ çˆ¶å…ƒç´ è®¾ä¸ª margin-right è´Ÿå€¼ï¼Œå¯å°†ä¸€è¡Œçš„å­å…ƒç´ å…¨åŒ…è¿›å» æ–‡å­—æ’åˆ—æ–‡å­—ç«–æ’ æ–‡æœ¬å…ƒç´ è®¾width: 1.5em å†å¯¹çˆ¶å®¹å™¨è®¾æ–‡æœ¬å±…ä¸­ æœ€å°å­—ä½“å®ç°10pxçš„æ–‡å­—å¤§å°ï¼Œè€Œéƒ¨åˆ†æµè§ˆå™¨æ¯”å¦‚chromeåªæ”¯æŒæœ€å°12pxçš„æ–‡å­—ã€‚ 12transform-origin: 0 50%;transform: scale(10/12); æ³¨ï¼šå…ƒç´ å æ®çš„ä½ç½®ä¸ä¼šç¼©å°ï¼Œä»…ä»…æ˜¯çœ‹ä¸Šå»ç¼©å°äº† æ–‡å­—overflow æ˜¾ç¤ºâ€™â€¦â€™å•è¡Œæ–‡å­— 12345.ui-text-overflow()&#123; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;&#125; å¤šè¡Œæ–‡å­—ï¼ˆä»…webkitæœ‰æ•ˆï¼‰ 12345678.ui-text-overflow-lines(@line: 2, @lineHeight: 1.5)&#123; display: -webkit-box; -webkit-line-clamp: @line; -webkit-box-orient: vertical; overflow: hidden; @height: @lineHeight * @line; max-height: ~'@&#123;height&#125;em';&#125; æ³¨ï¼šè¯¥å…ƒç´ æœ¬èº«ä¸è¦è®¾ä¸Šä¸‹paddingï¼Œè¦å‚ç›´å±…ä¸­è¯·åœ¨çˆ¶å…ƒç´ ä¸Šæ§åˆ¶ èƒŒæ™¯èƒŒæ™¯å›¾å›ºå®šä¸è·Ÿéšæ»šåŠ¨1background-attachment: fixed å…¶ä»–æ‰‹ç»˜iconè¿™æ˜¯ä¸€ä¸ªç±»ä¼¼âˆšç¬¦å·çš„iconï¼Œcssç»˜åˆ¶å‡ºæ¥ï¼Œæ”¯æŒç­‰æ¯”ç¼©æ”¾ã€‚ 12345678910111213141516171819202122232425262728293031.icon-get&#123; background-color: #59b726; border-radius: 50%; color: #fff; display: block; height: 18px; width: 18px; position: absolute; top: -10px; left: -10px; transform: rotate(-45deg); &amp;::before, &amp;::after&#123; content: ' '; display: block; position: absolute; &#125; &amp;::before&#123; border-top: 1px solid #fff; width: percentage(11/18); top: percentage(11/18); left: percentage(5/18); &#125; &amp;::after&#123; border-left: 1px solid #fff; height: percentage(7/18); top: percentage(4/18);; //before.top - after.height left: percentage(5/18); &#125;&#125; è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ç±»ä¼¼macä¸Šæ»šåŠ¨æ¡çš„æ„Ÿè§‰ 1234567891011121314151617.mac-scroll &#123; &amp;::-webkit-scrollbar &#123; width: 8px; &#125; /*å®šä¹‰æ»‘æ¡*/ &amp;::-webkit-scrollbar-thumb &#123; background-color: $gray-lightest; background-clip: content-box; border-top: 5px solid rgba(255,255,255,0); border-bottom: 5px solid rgba(255,255,255,0); border-right: 4px solid rgba(255,255,255,0); &#125; /*å®šä¹‰æ»šåŠ¨æ¡è½¨é“*/ &amp;::-webkit-scrollbar-track &#123; background-color: #fbfbfb; &#125;&#125;]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>å¸¸ç”¨ç‰‡æ®µ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‘çˆ¹çš„JPAä¸­çš„'ddl']]></title>
    <url>%2Fblog%2F2016%2F07%2Fjpa-ddl-trapped.html</url>
    <content type="text"><![CDATA[ä»¥å‰åšå­¦æ ¡é‡Œçš„é¡¹ç›®æ—¶å¼ºæ¨äº†ä¸€æŠŠ Play Frameworkï¼Œé¼“å¹å®ƒæœ‰å¤šä¹ˆå¤šä¹ˆè½»é‡ï¼Œå®ƒç”¨JPAåšORMæ˜¯å¤šä¹ˆæ–¹ä¾¿ï¼Œå¯å‚è€ƒä»¥å‰çš„æ–‡ç«  JPAæ³›å‹DAO å’Œ mooctesté¡¹ç›®æ€»ç»“ã€‚ç›´åˆ°ä»Šå¤©è¸©åˆ°äº†ä¸ªå‘ã€‚ã€‚ã€‚è®°å½•ä¸‹JPAä¸­å‘çˆ¹çš„ddlå‚æ•° JPAJPAå…¨ç§°ä¸ºï¼šJava Persistence APIã€‚JPAé€šè¿‡Javaä¸­çš„ Annotation æˆ– XML æ¥æè¿°â€œå¯¹è±¡ï¼å…³ç³»è¡¨â€çš„æ˜ å°„å…³ç³»ï¼Œå¹¶å°†è¿è¡ŒæœŸçš„å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ã€‚è¿™æ˜¯æŸ¥è‡ªç™¾åº¦çš„è§£é‡Šï¼Œå¯ç®€å•ç†è§£ä¸ºå°±æ˜¯Javaå°ç»„ä¸º ORM(Object Relational Mapping) å®šäº†ä¸€å¥—æ¥å£è§„èŒƒï¼Œæˆ‘ä»¬å¸¸è§çš„ Hibernate å’Œ Spring ä¸­çš„ORMéƒ½å¯ç†è§£ä¸ºæ˜¯ JPA çš„ä¸€ç§å…·ä½“å®ç°ã€‚ï¼ˆå„æ¡†æ¶å¯¹æ¥å£è§„èŒƒçš„å®ç°ç¨‹åº¦å’ŒåŒ¹é…åº¦å¯èƒ½å¹¶ä¸å®Œå…¨ã€‚ã€‚ã€‚ï¼‰ Playä¸­çš„JPAåœ¨Play Framework 1.2.7ä¸­ï¼Œå…¶JPAåº•å±‚é‡‡ç”¨çš„æ˜¯ Hibernate 3.6 çš„å®ç°ã€‚åœ¨Playçš„application.confæ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°æœ‰å¦‚ä¸‹ä¸€æ®µé…ç½®è¯´æ˜ï¼š 123# Specify the ddl generation pattern to use. Set to none to disable it # (default to update in DEV mode, and none in PROD mode):# jpa.default.ddl=update åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œjpa.default.ddlçš„é»˜è®¤å€¼å°±æ˜¯updateã€‚ã€‚ã€‚é‚£åˆ°åº•ä»€ä¹ˆæ˜¯ddlå‘¢ï¼Œå‘åˆæ˜¯å•¥ï¼Ÿ ddlDDLçš„å…¨ç§°ä¸ºï¼šData Definition Languageï¼Œå¤§æ¦‚æ˜¯å­¦æ•°æ®åº“è¯¾æˆ–é›†æˆè½¯ä»¶å¼€å‘çš„æ—¶å€™è§è¿‡è¿™ç±»çš„è¯æ±‡ï¼Œå¤§æ¦‚å°±æ˜¯æ•°æ®åº“ä¸­å®šä¹‰æ•°æ®ç»“æ„çš„æ–¹å¼ã€‚æˆ‘æŸ¥åˆ°ä¸€ä¸ªeclipseé‡Œçš„JPAå·¥å…·é‡Œæœ‰è¿™ä¹ˆä¸€æ®µï¼š Use eclipselink.ddl-generation to specify how EclipseLink generates DDL (Data Definition Language) for the database schema (tables and constraints) on deployment. EclipseLinkä¹Ÿæ˜¯ä¸€å¥—æ”¯æŒJPAçš„ORMæ–¹æ¡ˆï¼Œç„¶è€Œæˆ‘å¹¶æ²¡æœ‰ä½¿ç”¨è¿‡ã€‚ã€‚ã€‚çœ‹åå­—åº”è¯¥æ˜¯eclipseçš„å®˜æ–¹ç»„ç»‡æçš„ï¼Œä½†ç½‘ä¸Šè¯´ç”±äºæ–‡æ¡£è¾ƒå°‘ï¼Œå¹¶ä¸æ¨èã€‚ã€‚ å›åˆ°ä¸Šé¢é‚£æ®µå®šä¹‰ï¼Œæˆ‘ç†è§£çš„JPAä¸­ddlçš„è¿‡ç¨‹å¦‚ä¸‹ è¯»å–å®ä½“å¯¹è±¡ç±»ä¸­ Java Annotation å¯¹å±æ€§çš„å®šä¹‰ ç”Ÿæˆ DDL çš„æè¿°æ–‡ä»¶ æ ¹æ®å…·ä½“æ•°æ®åº“çš„dialectï¼Œç”Ÿæˆ schema çš„SQLè¯­å¥ åœ¨æ•°æ®åº“ä¸­ç”Ÿæˆå¯¹åº”çš„schema æ‰€ä»¥å‘æ˜¯ä¸Šè¿° ddl çš„å¥½å¤„åœ¨äºï¼Œå½“é¡¹ç›®åˆšæ„å»ºæ—¶ï¼Œæˆ–åœ¨æœ¬åœ°å¼€å‘æ–°æ¨¡å—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå®šä¹‰å®ä½“å¯¹è±¡çš„ç±»ï¼Œé€šè¿‡ Java Annotation é…ç½®å­—æ®µå’Œå®ä½“å¯¹è±¡å…³ç³»ï¼Œddl å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„æ•°æ®åº“è¡¨ã€‚è¿™æ˜¯éå¸¸ä¾¿æ·çš„ï¼Œå› ä¸ºåˆšå¼€å‘æ—¶å®ä½“å¯¹è±¡çš„å±æ€§å¯èƒ½ä¼šç»å¸¸è°ƒæ•´ï¼Œddl å¯ä»¥åœ¨æ¯æ¬¡è¿è¡Œé¡¹ç›®æ—¶è‡ªåŠ¨å°†è¿™äº›å˜åŒ–åŒæ­¥åˆ°æ•°æ®åº“ä¸­ã€‚ æ‰€ä»¥å›è¿‡å¤´å†çœ‹Playä¸­çš„é‚£æ®µé…ç½® 123# Specify the ddl generation pattern to use. Set to none to disable it # (default to update in DEV mode, and none in PROD mode):# jpa.default.ddl=update æ‰€ä»¥åœ¨å¼€å‘çŠ¶æ€ä¸‹ï¼Œddlå¯ä»¥é»˜è®¤å¼€å¯ï¼Œä»¥çœå»æˆ‘ä»¬æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“å­—æ®µçš„æ´»å„¿ã€‚ã€‚è€Œå½“ç”Ÿäº§çŠ¶æ€ä¸‹ï¼Œæœ€å¥½ä¸è¦å¼€å¯è¯¥ ddl generation åŠŸèƒ½ï¼ ä¸‹é¢æ˜¯é‡ç‚¹ï¼Œæˆ‘çš„å‘åœ¨äºï¼Œæˆ‘åœ¨æœ¬åœ°å¼€å‘çŠ¶æ€ä¸‹ï¼Œå›¾çœäº‹ç›´æ¥è®©é¡¹ç›®è¿æ¥äº†æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“ ç»“æœå°±æ˜¯æˆ‘è¿˜å¤„äº DEV çŠ¶æ€ï¼Œç„¶è€Œé»˜è®¤jpa.default.ddl=updateï¼Œå½“æˆ‘å¢åŠ å®ä½“å¯¹è±¡ç±»ä¸­çš„å±æ€§æ—¶ï¼Œå°±ä¼šå¸®æˆ‘é‡æ–° build ä¸€é schemaï¼ŒæœåŠ¡å™¨ä¸Šæˆ‘äº²æ‰‹å»ºçš„æ•°æ®è¡¨é‡Œçš„å­—æ®µç±»å‹å’Œå¤–é”®ç´¢å¼•éƒ½ä¹±äº†ã€‚ã€‚ã€‚æœ€åæˆ‘æŠŠjpa.default.ddl=noneåŠ ä¸Šäº† æ•™è®­ æœ¬åœ°å¼€å‘æ—¶ç¦æ­¢è¿æ¥æœåŠ¡å™¨æ•°æ®åº“ ä¸è¦ä½¿ç”¨ ddl ç”Ÿæˆçš„æ•°æ®åº“è¡¨ï¼Œå­—æ®µç±»å‹å’Œå¤–é”®åå¾ˆä¸‘ï¼Œåæ­£æœ€åè¿˜å¾—æ‰‹åŠ¨è°ƒ å¸Œæœ›æ˜¯å…ˆæ‰‹åŠ¨å»ºè¡¨ï¼Œç„¶åå¯ä»¥ä½¿ç”¨ç±»ä¼¼ hibernate ä¸­é€†å‘å·¥ç¨‹çš„é‚£ç§å·¥å…·å°†è¡¨ç»“æ„åå°„åˆ°å¯¹è±¡class]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>JPA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»é›¶å¼€å§‹é…ç½®ä¸€å°æœåŠ¡å™¨]]></title>
    <url>%2Fblog%2F2016%2F04%2Flinux-server-startup.html</url>
    <content type="text"><![CDATA[æœ€è¿‘é¡¹ç›®è¦è¿ç§»ï¼Œä»¥å‰æ˜¯å’Œå…¶ä»–é¡¹ç›®å…±ç”¨ä¸€å°æœåŠ¡å™¨çš„ï¼Œç°åœ¨è¦è¿ç§»åˆ°ç‹¬ç«‹æœåŠ¡å™¨ã€‚æœ¬äººlinuxç”¨çš„æ¯”è¾ƒæ™šï¼Œä»¥å‰æ˜¯winç‹—ï¼Œè‹¦äºå„ç§è«åé”™è¯¯ï¼Œæ”¹ç”¨macå¼€å‘ä¹Ÿæ‰1å¹´æ—¶é—´ã€‚ç¬¬ä¸€æ¬¡ä»é›¶å¼€å§‹é…ç½®æœåŠ¡å™¨ï¼Œæ•…è®°å½•ä»¥å¤‡å¿˜ã€‚ æœåŠ¡å™¨èµ·æ­¥Hello Worldè´­ä¹°æœåŠ¡å™¨ï¼Œé€‰å¥½é…ç½® 40Gç³»ç»Ÿç›˜ï¼Œ500Gæ•°æ®ç›˜ï¼Œæ­£å¸¸é¡¹ç›®å¤Ÿç”¨äº† å†…å­˜å’Œå¸¦å®½çœ‹å…·ä½“åº”ç”¨åœºæ™¯ï¼Œ4Gå†…å­˜å¸¦64ä½ç³»ç»Ÿæ¯”è¾ƒåˆé€‚ï¼ŒPS.å¸¦å®½å¾ˆè´µ æ“ä½œç³»ç»Ÿæˆ‘ä¸å¤ªæ‡‚ï¼Œå¬è¯´CentOSæ¯”è¾ƒç¨³å®šï¼Œç›®å‰é˜¿é‡Œäº‘ä¸Šå¯é€‰çš„ç‰ˆæœ¬æœ‰5.8ã€6.5ã€7.0ã€‚æ ¹æ®ç‰ˆæœ¬å·a.b.cçš„è§„åˆ™ï¼Œæˆ‘ä¸€èˆ¬ä¸å¤ªæ„¿æ„å°è¯•bä½ç‰ˆæœ¬å·è¾ƒä½çš„ç‰ˆæœ¬ï¼Œ7.0è‚¯å®šæ–°ç‰¹æ€§å¤šï¼Œä½†æ˜¯é—®é¢˜ä¹Ÿä¼šå­˜åœ¨ã€‚åƒ5.8è‚¯å®šç»´æŠ¤çš„å¾ˆç¨³å®šäº†ï¼Œé™¤éå®˜æ–¹æ”¾å¼ƒç»´æŠ¤ã€‚æœ€åæˆ‘æƒè¡¡é€‰æ‹©äº†6.5 =_= ä½¿ç”¨rootè´¦å·ç™»å½• OK. Welcome to Elastic Compute Service! åˆ›å»ºç”¨æˆ·ä¸€ç›´ä½¿ç”¨rootç™»å½•æ˜¯ä¸åˆç†ä¸å®‰å…¨çš„ï¼Œæ‰€ä»¥å¼€å§‹æ“ä½œå‰å…ˆæ·»åŠ ç”¨æˆ·ï¼š 1useradd fuxiaode æ–°åˆ›å»ºçš„ç”¨æˆ·homeç›®å½•é»˜è®¤åœ¨/home/fuxiaodeï¼Œè€Œrootç”¨æˆ·çš„homeç›®å½•åœ¨/rootã€‚ç„¶åä¸ºç”¨æˆ·è®¾ç½®ç™»å½•å¯†ç ï¼š 1passwd fuxiaode å¯ä»¥åœ¨/etc/passwdæ–‡ä»¶ä¸­æŸ¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„ç”¨æˆ·ï¼š 123nscd:x:28:28:NSCD Daemon:/:/sbin/nologinfuxiaode:500:500::/home/fuxiaode:/bin/bashguest:x:501:501::/home/guest:/bin/bash è¿™é‡Œæˆ‘åˆ›å»ºäº†ä¸¤ä¸ªç”¨æˆ·fuxiaodeå’Œguestï¼Œæ³¨æ„å…¶æœ«å°¾énologin ä¸‹é¢ä¸ºfuxiaodeç”¨æˆ·æ·»åŠ rootæƒé™ï¼š æ‰“å¼€/etc/sudoers æ‰¾åˆ°Allow root to run any commands anywhereè¿™ä¸€è¡Œ æ·»åŠ fuxiaode ALL=(ALL) ALL æµ‹è¯•ç”¨æˆ·æƒé™åˆ‡æ¢åˆ°guestç”¨æˆ·ï¼ˆä¸Šé¢æœªèµ‹äºˆå…¶rootæƒé™ï¼‰ 12su guestsudo vim /etc/passwd å‡ºç°ä¸€æ®µè¯ 12345678We trust you have received the usual lecture from the local SystemAdministrator. It usually boils down to these three things: #1) Respect the privacy of others. #2) Think before you type. #3) With great power comes great responsibility.[sudo] password for guest: è¾“å®Œå¯†ç ï¼Œç„¶åå¹¶æ²¡é¸Ÿç”¨ï¼Œå› ä¸ºguestä¸åœ¨/etc/sudoersæ–‡ä»¶ä¸­ï¼ åˆ‡æ¢fuxiaodeç”¨æˆ·ï¼Œé‡æ–°è¯•ä¸‹sudoï¼Œå¦¥å¦¥çš„ï¼ åŸºç¡€ç¯å¢ƒåŒ…ç®¡ç†ç³»ç»Ÿä¸­ä¸€èˆ¬ä¼šè‡ªå¸¦ä¸€äº›å¼€å‘åŒ…ï¼Œä½†æ˜¯ç»å¸¸éœ€è¦å‡çº§åˆ°æˆ‘ä»¬éœ€è¦çš„ç‰ˆæœ¬ã€‚CentOSä¸­ä½¿ç”¨yumæ¥ç®¡ç†rpmåŒ…ï¼š 1sudo yum list yumçš„å…·ä½“ä½¿ç”¨å‘½ä»¤è¯¦è§ http://blog.chinaunix.net/uid-346158-id-2131252.html pythonCentOS 6.5è‡ªå¸¦çš„æ˜¯Python 2.6.6ï¼Œè€Œç¼–è¯‘llvméœ€è¦Python 2.7ä»¥ä¸Šã€‚è€Œyumä¸­æœ€æ–°çš„ä¹Ÿæ˜¯Python 2.6.6ï¼Œåªèƒ½ä¸‹è½½Python 2.7.10çš„æºä»£ç è‡ªå·±ç¼–è¯‘å®‰è£…ã€‚ é¦–å…ˆè¦å®‰è£…ç¼–è¯‘pythonéœ€è¦çš„åŒ…ï¼Œåˆ‡æ¢åˆ°rootç”¨æˆ·çœçš„æƒé™éº»çƒ¦ 1234567sudo suyum groupinstall "Development tools"yum install zlib-develyum install bzip2-develyum install openssl-develyum install ncurses-develyum install sqlite-devel æ‰‹åŠ¨ä¸‹è½½python 12wget http://python.org/ftp/python/2.7.10/Python-2.7.10.tar.xztar -xf Python-2.7.10.tar.xz ç¼–è¯‘å’Œå®‰è£… 123./configure --prefix=/usr/local# éœ€è¦sudomake &amp;&amp; make altinstall åˆ›å»ºè½¯é“¾ï¼ˆ-bè¡¨ç¤ºè¦†ç›–ä¹‹å‰çš„ï¼‰ 1ln -sb /usr/local/bin/python2.7 /usr/bin/python æŸ¥çœ‹ç‰ˆæœ¬ 12which pythonpython --version è‡³æ­¤æˆåŠŸï¼ä»¥ä¸Šè¿‡ç¨‹å‚è€ƒ Installing python 2.7 on centos 6.3 pipUbuntuä¸‹å¯ä»¥ç”¨apt-getå¾ˆæ–¹ä¾¿çš„å®‰è£… 12apt-get install pythonapt-get install python-pip ä½†åœ¨yumä¸­æ˜¯ä¸è¡Œçš„ï¼Œè¯•è¿‡å®‰è£…easy_installåå†è£…pipï¼Œä½†æ˜¯æˆ‘éƒ½è«åå¤±è´¥äº†ã€‚ã€‚ã€‚FUCK ç°åœ¨ä½¿ç”¨æºç å®‰è£… 123wget https://pypi.python.org/packages/d3/16/21cf5dc6974280197e42d57bf7d372380562ec69aef9bb796b5e2dbbed6e/setuptools-20.10.1.tar.gzwget --no-check-certificate https://pypi.python.org/packages/41/27/9a8d24e1b55bd8c85e4d022da2922cb206f183e2d18fee4e320c9547e751/pip-8.1.1.tar.gz ç„¶ååœ¨è§£å‹åçš„ç›®å½•é‡Œä¾æ¬¡ä½¿ç”¨pythonå‘½ä»¤å®‰è£… 1sudo python setup.py install ä½†æ˜¯å°¼ç›ï¼Œè¿™æ—¶è¯•ä¸‹pipä¼šæç¤ºsudoï¼špipï¼šæ‰¾ä¸åˆ°å‘½ä»¤ï¼Œè¿™æ—¶å› ä¸ºå‰é¢å®‰è£…pythonæ—¶æˆ‘ä»¬è®¾ç½®è£…åˆ°äº†/usr/localä¸‹ï¼Œå®‰è£…çš„å‘½ä»¤å®é™…åœ¨/usr/local/binä¸‹ï¼Œå› æ­¤è¿™é‡Œéœ€è¦åŒpythonä¸€æ ·å»ºä¸ªè½¯é“¾ã€‚ 1ln -s /usr/local/bin/pip /usr/bin/pip ç°åœ¨æœæ–­å¯ä»¥ä½¿ç”¨pipäº†ï¼ŒæŸ¥çœ‹å·²ç»å®‰è£…è¿‡å“ªäº›pythonåŒ… 1pip list å¯èƒ½ä¼šæç¤ºpipéœ€è¦å‡çº§ 12# éœ€è¦sudopip install --upgrade pip nodejsnodeä¸ç”¨yumæˆ–æºç å®‰è£…ï¼Œnodeä½¿ç”¨è‡ªå·±çš„npmè¿›è¡ŒåŒ…ç®¡ç†ï¼Œæ¨èä½¿ç”¨nvmå®‰è£…ã€‚ 1curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash è¿™æ¡å‘½ä»¤å®‰è£…å®Œåï¼Œä¼šåœ¨homeä¸‹ç”Ÿæˆ~/.nvmç›®å½•ï¼Œéœ€è¦åœ¨~/.bash_profileä¸­æ·»åŠ ä¸€è¡Œï¼š 1source ~/.nvm/nvm.sh ç„¶åä½¿ä¹‹ç”Ÿæ•ˆ 1source ~/.bash_profile ç°åœ¨å°±å¯ä»¥ä½¿ç”¨nvmå‘½ä»¤å®‰è£…nodeç‰ˆæœ¬äº† 12nvm install 0.12nvm alias default 0.12 åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨npmå‘½ä»¤äº† 1npm install -g koa é€šè¿‡npmå…¨å±€å®‰è£…çš„åŒ…ä¼šå­˜åœ¨~/.nvm/versions/node/v0.12.13/lib/node_modulesç›®å½•ä¸‹ã€‚ æ•°æ®åº“mongodbå®‰è£… 12wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.6.11.tgztar -xzf mongodb-linux-x86_64-2.6.11.tgz /var/lib/mongodb åˆ›å»ºæ•°æ®åº“æ–‡ä»¶å¤¹ä¸æ—¥å¿—æ–‡ä»¶ï¼ˆå› ä¸ºä»Šåæ•°æ®å’Œæ—¥å¿—ä¼šå¢é•¿å¾ˆå¿«ï¼Œæœ€å¥½æ”¾åœ¨å¦ä¸€å—ç¡¬ç›˜ä¸Šï¼‰ 12mkdir /mnt/lib/mongodb/datatouch /mnt/lib/mongodb/logs é¦–æ¬¡å¯åŠ¨ï¼ˆæ— èº«ä»½è®¤è¯æ¨¡å¼ï¼‰ 1/var/lib/mongodb$ mongod --dbpath=/var/lib/mongodb/data --logpath=/var/lib/mongodb/logs --logappend --port=27017 --fork è¿›å…¥mongodbï¼Œè®¾ç½®ç”¨æˆ·å’Œæƒé™ 123$ mongo&gt; use admin&gt; db.addUser(&apos;yourAdminUser&apos;, &apos;password&apos;) å…³é—­mongodæœåŠ¡ 123&gt; use admin&gt; db.shutdownServer()&gt; exit å†æ¬¡å¯åŠ¨ï¼ˆèº«ä»½è®¤è¯æ¨¡å¼ï¼‰ 1/var/lib/mongodb$ mongod --dbpath=/var/lib/mongodb/data --logpath=/var/lib/mongodb/logs --logappend --auth --port=27017 --fork è¿›å…¥mongodbï¼Œè¿™æ—¶use databaseæ—¶éœ€è¦è®¤è¯ 12use admindb.auth(&apos;yourAdminUser&apos;,&apos;password&apos;) åˆ›å»ºæ•°æ®åº“ï¼Œæ·»åŠ æˆæƒç”¨æˆ· 12use yourDatabaseNamedb.addUser(&apos;databaseUser&apos;,&apos;password&apos;) æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ· 12use admindb.system.users.find() éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒmongodæœåŠ¡èµ·æ¥åï¼Œå°½é‡ä¸è¦ç”¨killè¿›ç¨‹çš„æ–¹å¼æ¥å…³é—­æœåŠ¡ï¼Œå°½é‡ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥å…³é—­ 12use admindb.shutdownServer() mongodä¹Ÿå¯ä»¥ä»é…ç½®æ–‡ä»¶å¯åŠ¨ï¼ˆå¯åŠ¨å‚æ•°ä½äºé…ç½®æ–‡ä»¶ä¸­ï¼‰ 1mongod --config /var/lib/mongodb/mongodb.conf é…ç½®å†…å®¹å¦‚ä¸‹ 123456dbpath=/mnt/lib/mongodb/datalogpath=/mnt/lib/mongodb/logslogappend=trueauth=trueport=27017fork=true mongodb journalæ—¥å¿—æ–‡ä»¶ä¼šæŒç»­å¢é•¿ï¼Œå ç”¨å¤§é‡ç£ç›˜ç©ºé—´ï¼Œå¦‚éœ€å…³é—­æ—¥å¿—ï¼Œå¯æ·»åŠ å¯åŠ¨å‚æ•°--nojournalã€‚ mysqlæˆ‘ç›´æ¥çœ‹å®˜æ–¹çš„guideï¼Œæ·»åŠ yum repoæ¥å®‰è£…æœ€æ–°çš„mysqlï¼Œè¯¦è§http://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/ TODOä¹‹åæœ‰ç©ºå†è®°å½•nginxé¡¹ç›®éƒ¨ç½²ï¼Œä»¥åŠè„šæœ¬æ„å»ºæ–¹é¢çš„å†…å®¹ã€‚]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nodejsçˆ¬è™«å®ç°ä¸­é‡åˆ°çš„å‘]]></title>
    <url>%2Fblog%2F2016%2F03%2Fblackholes-in-node-crawler.html</url>
    <content type="text"><![CDATA[è®°å½•ä¸€äº›å…·ä½“ä»£ç debugæ—¶é‡åˆ°çš„é—®é¢˜ï¼ˆæœªå®Œå¾…ç»­ï¼‰ å¼‚æ­¥æ§åˆ¶æµæ¶‰åŠåˆ°çš„åº“ Q in Github PromiseåŒ–çš„ä¸€ç§å®ç°ï¼Œpromiseä¸æ˜¯ä¸‡èƒ½ï¼Œæ”¹é€ å¤æ‚çš„åŠ¨æ€å†³å®šçš„æ‰§è¡Œé“¾æ˜¯ä»¶æ¯”è¾ƒåƒåŠ›çš„äº‹æƒ… async ç‚¹èµæ•°å¾ˆé«˜çš„åº“ï¼Œæœ‰äººè¯´æœ‰æ¯’ï¼Œæˆ‘è§‰ç€å¾ˆå¥½ç”¨ eventproxy @æœ´çµçš„åŸºäºäº‹ä»¶çš„æµç¨‹æ§åˆ¶ï¼Œæˆ‘è§‰ç€å’Œpromiseæˆ–asyncæ­é…ç€ä½¿ç”¨å¾ˆå¥½ç”¨ è¦æ³¨æ„çš„ç‚¹ é¿å… async ä¸­é—´åœ¨ if-else æ—¶å¤šæ¬¡è°ƒç”¨callback()ï¼Œå»ºè®®éƒ½åŠ ä¸Šreturn callback() æ•´ä½“ä¸²è¡Œï¼Œä½†å…¶ä¸­æŸæ­¥ä¸­åˆæœ‰å¾ªç¯å¼‚æ­¥ï¼Œå»ºè®®å†…å±‚ç”¨ asyncï¼Œæ•´ä½“ç”¨ eventproxy å»æ§åˆ¶ Promise åŒ–æ–¹æ³•æ”¹é€  é¡µé¢è¯·æ±‚æ¶‰åŠåˆ°çš„åº“ superagent å¤„ç†è¯·æ±‚çš„æ¨¡å— request å¦ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¨¡å—ï¼Œæ¯”èµ· superagentï¼Œè¯­æ³•é…ç½®é¡¹æ›´å¤šä¸€äº›ã€‚å¦‚æœè¯´ superagent æ˜¯ $.post()ï¼Œé‚£ request å°±æ˜¯ $.ajax() cheerio ç”¨äºDOMè§£æï¼Œæä¾›ä¸ jquery é€‰æ‹©å™¨ç±»ä¼¼çš„æ¥å£ ä¸­æ–‡ç¼–ç é—®é¢˜å½“è¯·æ±‚é uft ç¼–ç çš„é¡µé¢æ—¶ï¼Œä½¿ç”¨ superagent è¯·æ±‚åç”¨ cheerio è§£æï¼Œä¼šå‘ç°å–ä¸åˆ°æƒ³è¦çš„ä¸­æ–‡å­—ç¬¦ã€‚ç½‘ä¸ŠæŸ¥äº†åçŸ¥é“æœ‰ä¸ªå« iconv-lite çš„ä¸œè¥¿å¯ä»¥ç”¨æ¥åšè½¬ç ï¼Œå…·ä½“åšæ³•å°±å¯¹ superagent æ‰©å±•ä¸€ä¸ªå¤„ç†è¿‡ç¨‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950var superagent = require('superagent');var Request = superagent.Request;var iconv = require('iconv-lite');var jschardet = require('jschardet');/* superagentæ‰©å±•: ä½¿ç”¨iconvè½¬ç ï¼Œç»Ÿä¸€è½¬æˆ UTF-8 ç”¨æ³•: superagent.get(url).parse().end(...)*/Request.prototype.parse = function() &#123; // set the parser this._parser = function(res, cb) &#123; // res not instanceof http.IncomingMessage var buffers = []; res.on('data', function(chunk) &#123; buffers.push(chunk); &#125;); res.on('end', function(err) &#123; var text, err; try &#123; var buf = Buffer.concat(buffers); var enc = jschardet.detect(buf).encoding; // æ³¨ï¼šåœ¨æœåŠ¡å™¨ä¸Šå®‰è£… iconv ä¸€ç›´å‡ºé”™ï¼Œåœ¨æœ¬åœ°æµ‹è¯•æ˜¯å¯ä»¥ç”¨ä¸‹é¢ä¸¤è¡Œè½¬ç çš„ // var converted = new (require('iconv').Iconv)(enc, 'UTF-8//TRANSLIT//IGNORE').convert(buf); // text = converted.toString(); // å¦ä¸€ç§åšæ³•ï¼šå…ˆç”¨ iconv-lite è½¬ text = iconv.decode(buf, enc); if(enc !== 'UTF-8')&#123; buf = iconv.encode(text, 'UTF-8'); text = iconv.decode(buf, 'UTF-8'); // FUCK å¥½åƒå­˜ä¸‹æ¥çš„htmlæ–‡ä»¶é‡Œè¿˜æ˜¯å¸¦&amp;#ç¼–ç çš„ &#125; &#125; catch (e) &#123; err = e; &#125; finally &#123; res.text = text; cb(err); &#125; &#125;); &#125;; return this;&#125;;module.exports = superagent; ç„¶åä½¿ç”¨ superagent æ—¶å°±å¼•ç”¨è¿™ä¸ªæ‰©å±•æ¨¡å—çš„è·¯å¾„ 123456789var superagent = require('./extension/superagent-charset');superagent.get(url) .set('User-Agent', Settings.USER_AGENT) .timeout(Settings.REQUEST_TIMEOUT) .parse() // ç¼–ç ç»Ÿä¸€è½¬åŒ– utf-8 .end(function (err, res) &#123; &#125;); é¡µé¢é‡å®šå‘é—®é¢˜å¦‚æœæ˜¯åœ¨æœåŠ¡ç«¯çš„é‡å®šå‘ï¼Œsuperagent æ˜¯å¯ä»¥æ•æ‰åˆ°çš„ï¼Œè€Œä¸”å®ƒæœ¬èº«å°±æœ‰å¯¹ redirect() çš„é…ç½®æ¥å£ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯åœ¨æµè§ˆå™¨ç«¯çš„é‡å®šå‘ï¼Œæˆ‘é‡åˆ°è¿‡ä»¥ä¸‹ä¸¤ç§æƒ…å†µ 1ã€é€šè¿‡è®¾ç½® meta æ ‡ç­¾æ¥è§¦å‘æµè§ˆå™¨ refresh ä¾‹å¦‚ï¼šhttp://www.jscz.gov.cnï¼Œåœ¨é¦–é¡µè®¾ç½®äº† &lt;meta http-equiv=&quot;Refresh&quot; content=&quot;3;url=http://www.haishui.net&quot;&gt; 2ã€jsè„šæœ¬çš„é¡µé¢è·³è½¬ ä¾‹å¦‚ï¼šhttp://www.jsrm.gov.cnï¼Œåœ¨é¦–é¡µæœ‰ä¸€è¡Œè„šæœ¬ self.location=&quot;/?WebShieldSessionVerify=HtUMyhjlcREk8TaXCDHa&quot; ä»¥ä¸Šçš„é¡µé¢è·³è½¬éƒ½å‘ç”Ÿåœ¨é¦–é¡µï¼Œä¼šå¯¼è‡´ superagent æŠ“æ¥çš„é¡µé¢å†…å®¹æ˜¯ç©ºçš„ï¼Œé™¤äº†å»åˆ¤æ–­ç±»ä¼¼çš„ä»£ç æ¨¡å¼ï¼Œç„¶åé‡æ–°è¯·æ±‚æ–°çš„åœ°å€ï¼Œæš‚æ—¶ä¹Ÿæ²¡æƒ³å‡ºæ™ºèƒ½çš„åŠæ³•ã€‚ã€‚ã€‚ æ•°æ®åº“è¯»å†™äº‹åŠ¡rollbackTBD æ•°æ®åº“åŒæ­¥writeé—®é¢˜TBD å†…å­˜é”™è¯¯process out of memory1FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - process out of memory call stack size exceeded1RangeError: Maximum call stack size exceeded å…¶ä»–é”™è¯¯double callback!TBD ECONNRESET123456events.js:85 throw er; // Unhandled &apos;error&apos; event ^ Error: read ECONNRESET at exports._errnoException (util.js:746:11) at TCP.onread (net.js:561:26)]]></content>
      <categories>
        <category>node</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mooctesté¡¹ç›®æ€»ç»“]]></title>
    <url>%2Fblog%2F2016%2F01%2Fproject-guideline-of-mooctest.html</url>
    <content type="text"><![CDATA[æ…•æµ‹å¹³å°ï¼ˆç®€ç§°mooctestï¼‰ï¼Œè¿™ä¸ªé¡¹ç›®è‡´åŠ›äºç¼–ç¨‹ç±»è€ƒè¯•å’Œç»ƒä¹ çš„æœåŠ¡å¹³å°ï¼Œæ•™å¸ˆå¯ä»¥è½»æ¾ç›‘ç®¡è€ƒè¯•æµç¨‹ï¼Œå­¦ç”Ÿå¯ä»¥è‡ªç”±ç»ƒä¹ ç¼–ç¨‹ã€‚ç³»ç»Ÿè´Ÿè´£ç¼–ç¨‹ç»ƒä¹ çš„è‡ªåŠ¨åŒ–è¯„ä¼°åŠå¯è§†åŒ–å±•ç°ï¼Œé…åˆå½“ä¸‹çº¢ç«çš„MOOCæ…•è¯¾è¯¾ç¨‹ï¼Œæ…•æµ‹å¹³å°å°†æ˜¯å­¦ç”Ÿè‡ªå­¦ç¼–ç¨‹çš„å¥½å¸®æ‰‹ã€‚ç›®å‰å·²æ”¯æŒçš„ç¼–ç¨‹ç±»å‹æœ‰ï¼šJavaè¦†ç›–æµ‹è¯•ï¼ŒJavaæµ‹è¯•é©±åŠ¨ç¼–ç¨‹ï¼ŒPythonç»Ÿè®¡ç¼–ç¨‹ï¼ŒC++ç¼–ç¨‹ï¼ŒJmeteræ€§èƒ½æµ‹è¯•ï¼Œä»¥åŠAndroidåº”ç”¨æµ‹è¯•ã€‚ä¹‹æ‰€ä»¥å«â€œmooctestâ€æ˜¯å› ä¸ºâ€œæµ‹è¯•â€æ˜¯æˆ‘ä»¬çš„ä¸»æ‰“äº§å“ï¼Œå…¶ä¸­Javaè¦†ç›–æµ‹è¯•ã€Java Debugåˆ†æï¼Œä»¥åŠAndroidåº”ç”¨æµ‹è¯•æ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒæœåŠ¡ã€‚æˆ‘ä»¬å¸®åŠ©é«˜æ ¡çš„æ•™â€œè½¯ä»¶æµ‹è¯•â€çš„è€å¸ˆä¾¿æ·åœ°ç»„ç»‡åœ¨çº¿è€ƒè¯•ï¼Œå¸®åŠ©é«˜æ ¡çš„å­¦ç”Ÿæ¥è§¦åˆ°å·¥ä¸šç•ŒçœŸå®çš„appæ¡ˆä¾‹ï¼Œä»¥æé«˜å­¦ç”Ÿçš„testingèƒ½åŠ›ã€‚ é¡¹ç›®æ¦‚å†µ mooctestäº2014.8æœˆä¸‹æ—¬å¼€å§‹å¯åŠ¨é¡¹ç›®ï¼Œæœ€åˆå¼€å‘è€…åªæœ‰2ä½ 2014.11æœˆï¼Œå®Œæˆè€ƒè¯•ç®¡ç†å¹³å°çš„åŸºç¡€å»ºè®¾ï¼Œä»¥åŠJavaè¦†ç›–æµ‹è¯•çš„å®¢æˆ·ç«¯ï¼Œå¼€å§‹ç¬¬ä¸€è½®å†…æµ‹ 2014.12æœˆï¼Œå‚åŠ é¡¹ç›®åŸå‹å±•ç¤ºï¼Œæ”¶é›†ç¬¬äºŒè½®å†…æµ‹ 2015.1æœˆï¼Œæ·»åŠ å¯¹Javaè¦†ç›–æµ‹è¯•çš„è€ƒé¢˜åˆ†æåŠŸèƒ½ 2015.3æœˆï¼Œæ­£å¼ä¸Šçº¿ï¼Œä¸ç½‘æ˜“äº‘è¯¾å ‚åˆä½œï¼Œå¼€è®¾ã€Šæ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ã€‹æ…•è¯¾è¯¾ç¨‹ï¼Œç”±mooctestç³»ç»Ÿæä¾›â€œPythonç»Ÿè®¡ç¼–ç¨‹â€ç»ƒä¹  2015.5æœˆï¼Œé¡¹ç›®æ‰©å¼ ï¼Œä¸æ–­æ·»åŠ æ–°ç§‘ç›®ï¼ŒJavaæµ‹è¯•é©±åŠ¨ç¼–ç¨‹ï¼ŒJmeteræ€§èƒ½æµ‹è¯•ï¼Œä»¥åŠAndroidåº”ç”¨æµ‹è¯•ä¹Ÿæœ‰äº†é›å½¢ 2015.7æœˆï¼ŒAndroidåº”ç”¨æµ‹è¯•ç‹¬ç«‹æˆKikbugç³»ç»Ÿï¼Œå®Œæˆå’Œmooctestç³»ç»Ÿçš„å¯¹æ¥ 2015.9æœˆï¼ŒAndroidåº”ç”¨æµ‹è¯•ä¸â€œé˜¿é‡Œâ€è¾¾æˆåˆä½œï¼Œè·å¾—ä¼ä¸šå†…æµ‹çš„çœŸå®app 2015.10æœˆï¼Œæ­£å¼åœ¨å—äº¬å¤§å­¦ã€ä¸œå—å¤§å­¦ã€å—äº¬é‚®ç”µå¤§å­¦ã€å—é€šå¤§å­¦ã€å¤§è¿ç†å·¥ç­‰é‡ç‚¹é«˜æ ¡è¯•ç‚¹ï¼Œä½œä¸ºå…¶â€œè½¯ä»¶æµ‹è¯•â€è¯¾ç¨‹çš„ç™½ç›’æµ‹è¯•ï¼ˆä»¥Javaè¦†ç›–æµ‹è¯•ä¸ºä¾‹ï¼‰å’Œé»‘ç›’æµ‹è¯•ï¼ˆä»¥Androidåº”ç”¨æµ‹è¯•ä¸ºä¾‹ï¼‰çš„ç»ƒä¹ å’Œè€ƒè¯•å¹³å° 2015.11æœˆï¼Œå†æ¬¡ä¸ç½‘æ˜“äº‘è¯¾å ‚åˆä½œï¼Œå¼€è®¾ã€Šå¼€å‘è€…æµ‹è¯•ã€‹å¾®ä¸“ä¸šè¯¾ç¨‹ï¼Œç”±mooctestç³»ç»Ÿæä¾›â€œJavaè¦†ç›–æµ‹è¯•â€å’Œâ€œDebugè°ƒè¯•â€çš„ç»ƒä¹  2015.12æœˆï¼Œè”åˆâ€œé˜¿é‡Œäº‘æµ‹â€ä»¥åŠTesterHomeä¸¾åŠé˜¿é‡Œäº‘æµ‹æ‰¾ bug å¤§èµ›ï¼Œåœ†æ»¡è½å¹•ï¼ æˆªè‡³ç›®å‰ï¼Œmooctestå¹³å°ä¸Šå·²æœ‰è¿‘1ä¸‡åå­¦ç”Ÿå’Œ400åè€å¸ˆï¼Œæ¥è‡ªå…¨å›½å„åœ°500å¤šä¸ªé«˜æ ¡ï¼ é¡¹ç›®ç»“æ„æˆ‘ä½œä¸ºâ€œç å†œâ€ï¼Œè¿˜æ˜¯æ¥è¯´è¯´æˆ‘æ›´æ“…é•¿çš„äº‹ï¼Œæ€»ç»“ä¸‹è¿™ä¸ªé¡¹ç›®çš„æŠ€æœ¯é€‰å‹ä»¥åŠç»„ç»‡ç»“æ„ï¼Œä»¥ä¾¿ä¸ºä»Šåçš„é¡¹ç›®ä½œå‚è€ƒã€‚ æ•´ä½“ä¸Šæˆ‘ä»¬å°±é‡‡ç”¨äº†åŸºäºJavaçš„Play Framework 1.2.7çš„ç‰ˆæœ¬ï¼Œä¹‹åå‡ºçš„2.0.xä»¥ä¸Šçš„ç‰ˆæœ¬æ˜¯åŸºäºSCALAçš„ï¼Œå’Œ1.x.xå®Œå…¨ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚è€ŒPlayæ¡†æ¶å¯¹â€œä»Javaå­¦èµ·çš„è½¯é™¢å­¦ç”Ÿâ€æ¥è¯´éå¸¸å‹å¥½ï¼Œæ¯”èµ· Struts å’Œ Spring çœå»äº†å¾ˆå¤šç¹ççš„xmlé…ç½®å’ŒAnnotationé…ç½®ã€‚ç»¼åˆå­¦ä¹ æˆæœ¬å’Œé¡¹ç›®å®šä½ï¼ŒPlayæ¡†æ¶æ˜¯æ€§ä»·æ¯”å¾ˆé«˜çš„é€‰æ‹©ã€‚ ç›®å½•ç»“æ„åå°éƒ¨åˆ† lib/ å­˜æ”¾å„ç§å¤–éƒ¨jaråŒ… conf/ Playæ¡†æ¶é…ç½®æ–‡ä»¶çš„ç›®å½• application.conf é¡¹ç›®ç³»ç»Ÿè®¾ç½®ï¼šdebugè®¾ç½®ã€sessionè®¾ç½®ã€serverè®¾ç½®ã€æ•°æ®åº“è®¾ç½®ç­‰ï¼Œä¹Ÿå¯å­˜æ”¾è‡ªå®šä¹‰çš„ç³»ç»Ÿçº§å˜é‡è®¾ç½® routes è·¯ç”±(url)é…ç½® messages.en å¤šè¯­è¨€æ”¯æŒçš„å­—å…¸æ–‡ä»¶(è‹±æ–‡) messages.zh_CN å¤šè¯­è¨€æ”¯æŒçš„å­—å…¸æ–‡ä»¶(ä¸­æ–‡) app/ Playé‡Œå«è¿™ä¸ªï¼Œç›¸å½“äºæ™®é€šprojecté‡Œçš„srcç›®å½• common/ å­˜æ”¾ä¸€äº›é¡¹ç›®ä¸­ç”¨åˆ°çš„å®šä¹‰çš„å¸¸é‡æˆ–æšä¸¾é‡ Constants.java é€šç”¨å¸¸é‡ ExamType.java æŸä¸ªè‡ªå®šä¹‰ç±»å‹çš„å¸¸é‡ controllers/ MVCä¸­çš„æ§åˆ¶å™¨å±‚ï¼Œä»¥è§’è‰²åå¼€å¤´ï¼Œå‘½ååŒºåˆ†ï¼›æ³¨ï¼šåªè´Ÿè´£requestå’Œresonpseï¼Œä¸è´Ÿè´£å…·ä½“ä¸šåŠ¡é€»è¾‘ AdmAccountController.java ç®¡ç†å‘˜è§’è‰²çš„Accountæ¨¡å— TeaExamController.java æ•™å¸ˆè§’è‰²çš„Examæ¨¡å— StuExamController.java å­¦ç”Ÿè§’è‰²çš„Examæ¨¡å— managers/ å…·ä½“ä¸šåŠ¡é€»è¾‘çš„åŒ…è£…ï¼Œä¾›controllerè°ƒç”¨ admin/ ä¾›ç®¡ç†å‘˜è§’è‰²çš„ student/ ä¾›å­¦ç”Ÿè§’è‰²çš„ teacher/ ä¾›æ•™å¸ˆè§’è‰²çš„ application/ ä¾›ç³»ç»Ÿé€šç”¨çš„ interfaces/ ä¾›å¯¹å¤–APIçš„ models/ ä¸æ•°æ®åº“å¯¹åº”çš„Modelï¼Œç”¨æ¥åšORM(Object Relational Mapping) dao/ å°è£…å¯¹æ•°æ®åº“modelçš„åŸå­æ“ä½œï¼Œå…¶ä¸­æ¯ä¸ªå…·ä½“modelçš„DAOç±»éƒ½ç»§æ‰¿GenericDao GenericDao.java æ³›å‹DAOï¼Œæä¾›é€šç”¨çš„å¢åˆ æ”¹æŸ¥æ“ä½œ ExamDao.java å…·ä½“çš„è·ŸExamç›¸å…³çš„DAO data.structure/ è·Ÿå‰å°äº¤äº’çº¦å®šçš„éæ•°æ®åº“modelçš„æ•°æ®ç±»å‹ Pagination.java è·Ÿåˆ†é¡µç›¸å…³çš„æ•°æ®ç±»å‹ WrappedExam.java å¯¹Examç»“æœçš„åŒ…è£…ï¼Œæ–¹ä¾¿å‰å°äº¤äº’ utils/ helperæ–¹æ³• application/ è·Ÿåº”ç”¨ç›¸å…³çš„util DataUtil.java è·Ÿåº”ç”¨å’Œæ¨¡å—ç›¸å…³çš„æ•°æ®ç»“æ„è½¬æ¢æ–¹æ³• ParamUtil.java è´Ÿè´£å¤„ç†requestçš„å‚æ•°è½¬æ¢æ–¹æ³• ResponseUtil.java è´Ÿè´£å¯¹responseç»“æœçš„è½¬æ¢æ–¹æ³• SessionUtil.java å°è£…å¯¹sessionçš„æ“ä½œå’Œè½¬æ¢æ–¹æ³• VcodeUtil.java å°è£…å¯¹éªŒè¯ç çš„æ“ä½œæ–¹æ³• data/ è·Ÿé€šç”¨æ•°æ®ç›¸å…³çš„util EncryptionUtil.java åŠ è§£å¯†å¤„ç†çš„è½¬æ¢æ–¹æ³• ExcelUtil.java å°è£…å¯¹excelæ ¼å¼è½¬æ¢çš„æ–¹æ³• file/ è·Ÿæ–‡ä»¶æ“ä½œç›¸å…³çš„util mail/ è·Ÿæ”¶å‘é‚®ä»¶ç›¸å…³çš„util jobs/ å®šæ—¶ä»»åŠ¡ç›¸å…³ extensions/ å¯¹é¡µé¢æ¨¡æ¿è¯­æ³•çš„æ‰©å±• views/ å‰å°é¡µé¢æ¨¡æ¿ï¼Œè§ä¸‹é¢ å‰å°éƒ¨åˆ† app/views/ Base/ é¡µé¢ç»§æ‰¿çš„çˆ¶é¡µé¢æ¨¡æ¿ base_outer.html ä¸éœ€è¦ç™»å½•çš„é¡µé¢çˆ¶æ¨¡æ¿ base_inner.html éœ€è¦ç™»å½•çš„é¡µé¢çˆ¶æ¨¡æ¿ base_admin.html ç®¡ç†å‘˜è§’è‰²çš„é¡µé¢çˆ¶æ¨¡æ¿ï¼Œç»§æ‰¿è‡ªbase_inner.html base_teacher.html æ•™å¸ˆè§’è‰²çš„é¡µé¢çˆ¶æ¨¡æ¿ï¼Œç»§æ‰¿è‡ªbase_inner.html Application/ å­˜æ”¾ä¸éœ€è¦ç™»å½•çš„é¡µé¢ classã€examã€exercise ç­‰å…·ä½“åŠŸèƒ½åŒ…çš„é¡µé¢ tags/ è‡ªå®šä¹‰é¡µé¢æ ‡ç­¾çš„æ¨¡æ¿ï¼Œç›¸å½“äºéœ€è¦è¢«includeçš„é¡µé¢å­å— examView.html ç®¡ç†å‘˜å’Œæ•™å¸ˆéƒ½éœ€è¦ç”¨åˆ°æ­¤é¡µé¢å—ï¼Œä¾›å¤ç”¨ passwordView.html ä¸ªäººèµ„æ–™é¡µé¢å’Œå¿˜è®°å¯†ç é¡µé¢éƒ½éœ€è¦ç”¨åˆ°æ­¤é¡µé¢å— public/ å­˜æ”¾å‰ç«¯èµ„æºçš„ç›®å½• css/ common/ å­˜æ”¾åº”ç”¨æ‰€æœ‰é¡µé¢é€šç”¨çš„css bootstrap/ ä¸»é¢˜åº“ç›¸å…³ jquery-ui/ ä¸»é¢˜åº“ç›¸å…³ tablesorter/ æ’ä»¶ç›¸å…³ others/ å…¶ä»–å°æ’ä»¶çš„css classã€exam ç­‰å…·ä½“åŠŸèƒ½åŒ…çš„css file/ å­˜æ”¾é¡µé¢ä¸Šä¾›ä¸‹è½½çš„é™æ€æ–‡ä»¶ svg/ å­˜æ”¾ç¼–ç¨‹é¢˜ç›®æºç¨‹åºæ§åˆ¶æµå›¾çš„svgæ–‡ä»¶ images/ å­˜æ”¾cssçš„å›¾ç‰‡ bootstrap/ ä¸»é¢˜åº“ç›¸å…³çš„å›¾ç‰‡ jquery-ui/ ä¸»é¢˜åº“ç›¸å…³çš„å›¾ç‰‡ others/ å…¶ä»–å°æ’ä»¶çš„å›¾ç‰‡ js/ common/ å­˜æ”¾é¡µé¢é€šç”¨çš„jsï¼Œæˆ–è€…å¯å¤ç”¨çš„js bootstrap/ ä¸»é¢˜åº“çš„js jquery-ui/ ä¸»é¢˜åº“çš„js tablesorter/ æ’ä»¶çš„js others/ å…¶ä»–å°æ’ä»¶çš„js classã€exam ç­‰å…·ä½“åŠŸèƒ½åŒ…çš„js æ•°æ®åº“ä¸ORMæœ¬ç³»ç»Ÿä¸­ä½¿ç”¨ MySQL æ•°æ®åº“ï¼ŒPlayæ¡†æ¶ä¸­ä½¿ç”¨JPAæä¾›ORM(Object Relational Mapping)çš„åŠŸèƒ½ã€‚ ä¸€ä¸ªç®€å•çš„Modelç±»å®šä¹‰å¦‚ä¸‹ 123456789101112131415161718192021222324252627import javax.persistence.*;import play.db.jpa.Model;@Entity@Table(name="exam")public class Exam extends Model &#123; @Column(name="exam_name") private String examName; @ManyToOne @JoinColumn(name="tea_id", referencedColumnName="id") private Teacher teacher; public String getExamName() &#123; return examName; &#125; public void setExamName(String examName) &#123; this.examName = examName; &#125; public Teacher getTeacher() &#123; return teacher; &#125; public void setTeacher(Teacher teacher) &#123; this.teacher = teacher; &#125;&#125; ä¹Ÿæ˜¯é€šè¿‡ç®€å•çš„Annotationæ¥é…ç½®æ•°æ®åº“å­—æ®µå’Œæˆå‘˜å˜é‡çš„å¯¹åº”å…³ç³»ï¼Œä»¥åŠä¸€å¯¹å¤š/å¤šå¯¹å¤šçš„å…³ç³»ã€‚æ³¨æ„ï¼Œè¿™é‡Œä¸éœ€è¦ç»™Examæ·»åŠ é¢å¤–çš„idå­—æ®µäº†ï¼Œå› ä¸ºåœ¨Modelçˆ¶ç±»ä¸­å·²ç»ç”±JPAè‡ªå¸¦äº†idå­—æ®µï¼Œæ ¼å¼ä¸ºLongï¼Œæ‰€ä»¥æ•°æ®åº“è¡¨é‡Œå®šä¹‰idå­—æ®µæ—¶è¦æ³¨æ„è®¾ç½®â€œè‡ªå¢â€å’Œint(32)ã€‚ DAOäº‹åŠ¡ä¸æ³›å‹ç¼–ç¨‹å¦‚ä¸Šé¢å®šä¹‰äº†Examç±»åï¼Œè¯¥Modelå°±è¢«æ³¨å…¥äº†JPAæä¾›çš„å¢åˆ æ”¹æŸ¥æ“ä½œäº†ï¼Œä¸ºäº†é˜²æ­¢èŒè´£ä¹±ç”¨ï¼Œæˆ‘ä»¬ç»Ÿä¸€çº¦å®šç”±DAOå±‚æ¥å°è£…æ•°æ®åº“äº‹åŠ¡ã€‚è¿™æ ·Examå°±ä¼šæœ‰ä¸ªExamDaoï¼ŒTeacherå°±ä¼šæœ‰ä¸ªTeacherDaoï¼Œæˆ‘ä»¬ä¼šå‘ç°ç®€å•çš„å¢åˆ æ”¹æŸ¥å¯¹æ‰€æœ‰Modeléƒ½é€‚ç”¨çš„ï¼Œä¸ºäº†é¿å…ç®€å•æ“ä½œæ–¹æ³•çš„é‡å¤ï¼Œæˆ‘ä»¬å¼•å…¥â€œæ³›å‹Daoâ€çš„æ¦‚å¿µã€‚ æˆ‘åœ¨ä»¥å‰çš„æ–‡ç« ä¸­å†™è¿‡å…³äºJPAæ³›å‹DAOï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªæ³›å‹çš„GenericDaoç±»ï¼Œæä¾›é€šç”¨çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚ 1234567891011121314151617181920212223242526272829303132333435public abstract class GenericDao&lt;T, PK extends Serializable&gt; &#123; private Class&lt;T&gt; clazz; public GenericDao()&#123; // åå°„è·å–T.classï¼Œå®å‚ç±»å‹ clazz = (Class&lt;T&gt;)((ParameterizedType)getClass().getGenericSuperclass()).getActualTypeArguments()[0]; &#125; public T findById(PK id)&#123; return (T) JPA.em().find(clazz, id); &#125; public List&lt;T&gt; findByColumn(String columnName , Object value)&#123; String[] columnNames = new String[1]; Object[] values = new Object[1]; columnNames[0] = columnName; values[0] = value; return findByColumns(columnNames , values); &#125; public List&lt;T&gt; findByColumns(String[] columnNames , Object[] value)&#123; String sqlPart = ""; for (int columnIdx = 0 ; columnIdx &lt; columnNames.length ; columnIdx++)&#123; sqlPart += "e." + columnNames[columnIdx] + " = '" + value[columnIdx].toString() + "'"; if (columnIdx &lt; columnNames.length - 1)&#123; sqlPart += " and "; &#125; &#125; return (List&lt;T&gt;) JPA.em().createQuery("select e from " + clazz.getName() + " e where " + sqlPart).getResultList(); &#125;&#125; è€Œå…·ä½“Modeléƒ½æœ‰å…·ä½“çš„Daoå»ç»§æ‰¿å®ƒ 1234567891011121314151617public class ExamDao extends GenericDao&lt;Exam, Long&gt; &#123; public Exam findByTeaIdAndExamName(long teaId, String examName) &#123; String[] columns = &#123;"teacher.id" , "examName"&#125;; Object[] values = &#123;teaId , examName&#125;; List&lt;Exam&gt; list = this.findByColumns(columns, values); if (list != null &amp;&amp; list.size() &gt; 0)&#123; return list.get(0); &#125; return null; &#125; public List&lt;Exam&gt; findByTeaOpenid(String teaOpenid) &#123; return this.findByColumn("teacher.teaOpenid", teaOpenid); &#125;&#125; å…³äºGenericDaoçš„æ›´å¤šç»†èŠ‚è¯·çœ‹JPAæ³›å‹DAO åç«¯MVCæ¡†æ¶ä»ä¸Šé¢çš„é¡¹ç›®ç»“æ„ä¸­å·²ç»çœ‹åˆ°ï¼Œåç«¯è°ƒç”¨å±‚æ¬¡ç»“æ„ä¸º Controller-&gt;Manager-&gt;Dao-&gt;Modelï¼ŒControlleræœ€ç»ˆæ‹¿åˆ°Modelæ•°æ®ä¼ ç»™å‰ç«¯é¡µé¢ï¼Œå¯è§è¿™æ˜¯ä¼ªMVCã€‚æ›´å‡†ç¡®æ¥è¯´æ˜¯â€œåˆ†å±‚â€ç»“æ„ï¼šä¸Šå±‚å¯ä»¥è°ƒç”¨ä¸‹å±‚ï¼Œä¸‹å±‚ä¸èƒ½è°ƒç”¨ä¸Šå±‚ï¼›åŒæ—¶ä¸Šå±‚ä¹Ÿä¸èƒ½è·¨å±‚è°ƒç”¨ã€‚ æˆ‘ä»¬è¿™é‡Œè¯´æ¡†æ¶çš„MVCï¼Œæ›´ç€é‡äºControlleræ€ä¹ˆå’Œé¡µé¢ViewæŒ‚é’©èµ·æ¥ï¼Œå¹¶ä¸å¤ªæ¶‰åŠModelçš„äº‹ï¼Œè¿™é‡Œå°±éœ€è¦è·¯ç”±(url)é…ç½®ã€‚ routeé…ç½®è§„èŒƒ12345678910111213# éç™»å½•çš„é¡µé¢GET / Application.indexGET /faq/&#123;category&#125;/&#123;sub&#125; Application.&#123;category&#125;&#123;sub&#125;FAQ# ç™»å½•å’Œæ³¨å†ŒPOST /login LoginController.login# è§’è‰²çš„åŠŸèƒ½æ¨¡å—* /tea/&#123;action&#125; TeacherController.&#123;action&#125;* /tea/exam/&#123;action&#125; TeaExamController.&#123;action&#125;# Map static resources from the /app/public folder to the /public pathGET /public/ staticDir:public è·¯ç”±é…ç½®æ”¯æŒå®šä¹‰è¯·æ±‚æ–¹å¼GET or POSTï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œæ³¨æ„å¯¹äºâ€œæ›´æ”¹â€æ“ä½œä¸€å®šè¦ä½¿ç”¨POSTï¼Œè¿™æ˜¯httpçš„è§„èŒƒã€‚urlå’ŒControllerä¸­çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œå¹¶ä¸”æ”¯æŒå˜é‡æ›¿ä»£ï¼Œå‡å°‘ç›¸ä¼¼çš„é…ç½®æ¡ç›®ã€‚ å‰ç«¯é¡µé¢ç»§æ‰¿ä¸å¤ç”¨å¯¹äºå‰ç«¯é¡µé¢æ¨¡æ¿ï¼ŒPlayæ¡†æ¶é‡ŒåŒæ ·æ”¯æŒé¡µé¢ç»§æ‰¿ï¼ŒPlayä¸­ä½¿ç”¨Groovyæ¨¡æ¿å¼•æ“ã€‚å…³äºé¡µé¢ç»§æ‰¿ç»†èŠ‚å¯çœ‹è¿™ç¯‡æ–‡ç« å‰ç«¯è¦ç»™åŠ› â€” å¹³å‡¡ä¹‹è·¯ï¼Œè™½ç„¶é‡Œé¢æ˜¯ä»¥Djangoæ¡†æ¶çš„æ¨¡æ¿å¼•æ“ä¸ºä¾‹ï¼Œä½†æ˜¯åŸç†ç›¸åŒï¼Œæ¨¡æ¿è¯­æ³•ç•¥æœ‰ä¸åŒè€Œå·²ã€‚ å‰ç«¯UIç»„ä»¶çš„æ²‰æ·€åœ¨mooctestè¿™ä¸ªé¡¹ç›®ä¸­ï¼Œå‰ç«¯æ€»ä½“ä¸Šç”¨é¡µé¢ç»§æ‰¿å’Œè‡ªå®šä¹‰é¡µé¢tagsæ¥ç»„ç»‡ã€‚è™½ç„¶é¡¹ç›®èµ·æ­¥æ—¶å·æ‡’æ²¡æœ‰å¼•å…¥RequireJSæ¥ç»„ç»‡jsï¼Œä½†æœ€ç»ˆè¿˜æ˜¯æ‹å‡ºäº†ä¸å°‘jsç»„ä»¶ï¼Œä½¿ç”¨æœ€æœ´ç´ çš„jsç±»å®šä¹‰å’Œjqueryæ’ä»¶çš„å†™æ³•æ¥å°è£…ä»£ç ã€‚ 1ã€åŠ¨æ€å›¾è¡¨ ä½¿ç”¨Highchartsä½œå›¾è¡¨åº“ï¼Œç”±äºé¡¹ç›®ä¸­å¤§éƒ¨åˆ†å›¾è¡¨éƒ½æ˜¯åŠ¨æ€ä»åç«¯å–æ•°æ®çš„ï¼Œæ‰€ä»¥åœ¨Highchartsä¸Šé¢å°è£…äº†ä¸€å±‚ajaxè¿‡ç¨‹ï¼Œå¹¶ä¸”å°†å„å›¾è¡¨é…ç½®optionsåšäº†å‰¥ç¦»ã€‚å…·ä½“ç»†èŠ‚å¯è§ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š ä¸ºHighchartsåšåŒ…è£… 2ã€åˆ†é¡µæ’ä»¶ è¿™æ˜¯ä¸€ä¸ªjqueryæ’ä»¶ï¼Œå¯è‡ªåŠ¨ç”Ÿæˆå¸¦â€œæ»‘åŠ¨çª—å£â€çš„åˆ†é¡µæ•°ç›®ï¼Œå¯æ”¯æŒåˆ†é¡µç›´æ¥åˆ·æ–°é¡µé¢ï¼Œæˆ–è€…å¯è‡ªè¡Œé…ç½®ajaxåˆ†é¡µæ›¿æ¢å‡½æ•°ã€‚å…·ä½“ç»†èŠ‚å¯è§ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š è‡ªå·±å†™çš„jqueryåˆ†é¡µæ’ä»¶ 3ã€å­¦æ ¡é€‰æ‹©å™¨ è¿™æ˜¯mooctesté¡¹ç›®ä¸­æœ€å¤æ‚çš„ä¸€ä¸ªå‰ç«¯åŠŸèƒ½ï¼Œå¹¶ä¸”æœ‰å¤šå¤„åœ°æ–¹éœ€è¦ç¼–è¾‘å­¦æ ¡ï¼Œéœ€è¦æä¾›æœç´¢å’Œè‡ªå®šä¹‰æ·»åŠ å­¦æ ¡çš„åŠŸèƒ½ã€‚å…·ä½“å®ç°ç»†èŠ‚å¯è§ä¸‹é¢è¿™ä¸ªç³»åˆ—æ–‡ç« ï¼š ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(ç³»åˆ—) è¿™æ˜¯ç³»åˆ—é•¿æ–‡ï¼Œè®²è¿°äº†å¦‚ä½•æŠŠä¸€æ®µç”Ÿç¡¬å®ç°çš„ä»£ç ä¸€æ­¥ä¸€æ­¥å°è£…å’Œæ‰©å±•æˆä¸ºä¸€ä¸ªå¯é…ç½®çš„UIç»„ä»¶ï¼ å¤šè¯­è¨€çš„æ”¯æŒå‰ç«¯éƒ¨åˆ†è®²å®Œäº†ï¼Œæˆ‘ä»¬æœ€åå†çœ‹ä¸ªå’Œå‰ç«¯ç•¥æœ‰æŒ‚é’©çš„éœ€æ±‚ï¼Œå°±æ˜¯å¤šè¯­è¨€æ”¯æŒã€‚è¦åœ¨é¦–é¡µæä¾›ä¸­æ–‡å’Œè‹±æ–‡çš„é€‰é¡¹ï¼Œå¹¶ä¸”é»˜è®¤ä½¿ç”¨ç³»ç»Ÿè¯­è¨€ã€‚ ç³»ç»Ÿè¯­è¨€åˆ¤æ–­123456789101112131415161718192021222324252627282930public class Application extends Controller &#123; static final String DEFAULT_LANGUAGE = "zh_CN"; @Before static void setGlobalLang()&#123; // langActionä¼šå°†langå­˜å…¥session String lang = SessionUtil.getLang(session); if(lang == null)&#123; // è·å–æµè§ˆå™¨ç³»ç»Ÿè¯­è¨€ List&lt;String&gt; langs = request.acceptLanguage(); for(String temp : langs)&#123; // æµè§ˆå™¨å‘é€çš„ä¸º zh-CN if(temp.contains("zh"))&#123; temp = DEFAULT_LANGUAGE; &#125; if(Play.langs.contains(temp))&#123; lang = temp; break; &#125; &#125; if(lang == null)&#123; lang = DEFAULT_LANGUAGE; &#125; // æ›´æ–°åˆ°session SessionUtil.putLang(session, lang); &#125; Lang.set(lang); &#125;&#125; è¿™é‡Œä½¿ç”¨Playæ¡†æ¶é‡Œçš„æ‹¦æˆªå™¨çš„æ¦‚å¿µï¼Œå³ä¸Šé¢Annotationçš„@Beforeï¼Œä½¿å¾—æ¯ä¸ªé¡µé¢çš„actionéƒ½ä¼šå…ˆæ‰§è¡ŒsetGlobalLangã€‚è¯­è¨€çš„åˆ¤æ–­é¡ºåºä¸ºï¼šå…ˆå–sessioné‡Œå­˜çš„è¯­è¨€ï¼Œå†å–æµè§ˆå™¨requestå¤´é‡Œä¼ æ¥çš„ç³»ç»Ÿæ”¯æŒè¯­è¨€ï¼Œéƒ½å–ä¸åˆ°æ—¶å†æä¾›ä¸ªé»˜è®¤è¯­è¨€ã€‚ æ­¤å¤–ï¼Œè¿˜éœ€ä¸ºé¦–é¡µçš„ä¸­è‹±æ–‡åˆ‡æ¢å†æä¾›ä¸ªé¢å¤–çš„action 123456789101112131415161718public class Application extends Controller &#123; /** å¤šè¯­è¨€ */ public static void langAction()&#123; String lang = params.get("lang"); setLang(lang); index(""); &#125; static void setLang(String lang)&#123; if(lang == null || !Play.langs.contains(lang))&#123; lang = DEFAULT_LANGUAGE; &#125; // æ›´æ–°åˆ°session SessionUtil.putLang(session, lang); Lang.set(lang); &#125;&#125; è¯­è¨€å­—å…¸åœ¨æœ¬æ–‡æœ€åˆæåˆ°çš„é¡¹ç›®ç›®å½•ç»“æ„ä¸­å°±æœ‰å…³äºmessagesçš„æ–‡ä»¶ï¼Œmessages.zh_CNå’Œmessages.enå°±æ˜¯ä¸­è‹±æ–‡çš„å­—å…¸æ–‡ä»¶ã€‚ Playæ¡†æ¶åœ¨è¿™ä¸€ç‚¹æ–¹é¢åšçš„æ¯”è¾ƒç®€é™‹ï¼Œå¥½åƒä¸€ä¸ªè¯­è¨€åªèƒ½æœ‰ä¸€ä¸ªå­—å…¸æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨â€œå‘½åç©ºé—´â€çš„æ¦‚å¿µè¿›è¡Œåˆ†ç»„ç®¡ç†ã€‚ 1234567#keyæ ¼å¼ï¼šé¡µé¢å.[groupName].xxx#é€šç”¨é¡µé¢ common.[groupName].xxx#é¦–é¡µ################################index.links.guide = GUIDEindex.links.download = DOWNLOADS è¿™é‡Œé…ç½®äº†è‹±æ–‡æ–‡æ¡ˆï¼ŒåŒæ ·ä¹Ÿè¦åœ¨messages.zh_CNæ–‡ä»¶é‡Œé…ç½®ç›¸åŒkeyçš„ä¸­æ–‡æ–‡æ¡ˆã€‚ åç«¯è¿”å›æ–‡æ¡ˆå¦‚æœè¦åœ¨åç«¯çš„Controlleré‡Œå‘å‰ç«¯è¿”å›é”™è¯¯æ–‡æ¡ˆï¼Œå¤šè¯­è¨€çš„æ”¯æŒå¾—ä½¿ç”¨ play.i18n.Messages 1234// import play.i18n.Messages;// è¿™é‡Œçš„æ–‡æ¡ˆkeyä¸ä¸Šé¢çš„è¯­è¨€å­—å…¸ä¸­ä¿æŒä¸€è‡´Messages.get("LoginController.accountNotExist") å‰ç«¯çš„æ–‡æ¡ˆåœ¨å‰ç«¯çš„é¡µé¢æ¨¡æ¿ä¸­ï¼Œç›´æ¥ä½¿ç”¨ &amp;{&#39;common.browserTitles.mooctest&#39;} å°±å¯ä½¿ç”¨è¯­è¨€å­—å…¸ä¸­çš„key ä½†æ˜¯Playæ¡†æ¶åªä¼šå¯¹æ¨¡æ¿æ–‡ä»¶åšå¤„ç†ï¼Œå¯¹å…¶æ³¨å…¥é€šç”¨å˜é‡å’Œåç«¯æ•°æ®ï¼Œæ¨¡æ¿æ–‡ä»¶å…¶å®æ˜¯ç”±åç«¯è´Ÿè´£æ¸²æŸ“(è½¬æˆæ ‡å‡†html)çš„ã€‚ç”±åç«¯å¤„ç†çš„é¡µé¢æ¨¡æ¿ä¸­å¯ä»¥ä»»æ„ä½¿ç”¨ &amp;{&#39;your_text_key&#39;} è¯­è¨€æ ‡è®°ï¼Œä½†æ˜¯è¿™åœ¨.jsæ–‡ä»¶ä¸­æ˜¯ä¸è¢«æ”¯æŒçš„ã€‚ æˆ‘ä»¬éœ€è¦åœ¨æ‰€æœ‰é¡µé¢çš„baseçˆ¶é¡µé¢ä¸­å®šä¹‰ä¸€ä¸ªå†…è”scriptï¼Œäº‹å…ˆå®šä¹‰å¥½æ‰€æœ‰.jsä¸­éœ€è¦ä½¿ç”¨åˆ°çš„æ–‡æ¡ˆã€‚ 12345678&lt;!-- å…¨å±€å¤šè¯­è¨€æ–‡æ¡ˆï¼Œä¾›é€šç”¨jsä½¿ç”¨ --&gt;&lt;script type="text/javascript"&gt;window.LANG_TEXT = &#123; OK: "&amp;&#123;'common.btn.ok'&#125;", CANCEL: "&amp;&#123;'common.btn.cancel'&#125;", DONE: "&amp;&#123;'common.btn.done'&#125;"&#125;;&lt;/script&gt; å†…è”scriptæ˜¯åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­çš„ï¼Œå¯ä»¥è¢«Playæ¡†æ¶å¤„ç†ï¼Œäºæ˜¯è¯­è¨€æ–‡æ¡ˆå°±è¢«å­˜åœ¨äº†å…¨å±€windowé‡Œã€‚åœ¨å…·ä½“åŠŸèƒ½çš„.jsæ–‡ä»¶ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨window.LANG_TEXTå˜é‡ã€‚ é‚®ä»¶é˜Ÿåˆ—ä¸å®šæ—¶ä»»åŠ¡æœ€åæˆ‘å†æ¥è¯´ä¸€ä¸ªåç«¯é¢å¤–çš„å°åŠŸèƒ½ï¼Œå‘é€é‚®ä»¶ï¼Œç”±ç¬¬ä¸‰æ–¹EDM(Email Direct Marketing)å•†æä¾›æœåŠ¡ã€‚ EDMæœåŠ¡è´­ä¹°å¯ä»¥åœ¨ç½‘ä¸Šæ‰¾åˆ°å¾ˆå¤šè¿™æ ·çš„EDMæœåŠ¡å•†ï¼Œæœ‰çš„æ˜¯ä¸“é—¨åšä¼ä¸šçŸ­ä¿¡å’Œé‚®ä»¶è¥é”€çš„ï¼Œä¹Ÿæœ‰çš„æ˜¯åŸŸåä¸»æœºå’ŒæœåŠ¡éƒ½åšçš„ã€‚æˆ‘è¿™å„¿å°±ä¸æ‰“å¹¿å‘Šäº†ï¼Œè‡ªè¡Œæ‰¾ä¸€å®¶æœ‰ç‚¹è§„æ¨¡çš„ç¨³å®šä¸€ç‚¹çš„EDMæœåŠ¡å•†å³å¯ã€‚ åŸŸåé…ç½®ä¹°å¥½EDMè´¦å·åï¼Œåœ¨EDMç®¡ç†å¹³å°ä¸Šå°±å¯å‘é‚®ä»¶äº†ï¼Œä½†æ˜¯å®ƒä»¬é»˜è®¤ä¼šç»™ä½ åˆ†é…ä¸€ä¸ªå¸¦ `edm04621@service.xxx.com` ç±»ä¼¼è¿™æ ·çš„é‚®ç®±ã€‚è¿™ç§é‚®ç®±å‘å‡ºæ¥çš„é‚®ä»¶åæœ‰å…«ä¹ä¼šè¢«æ‰”è¿›åƒåœ¾ç®±æˆ–è€…è¢«æ‹¦æˆªæ‰ï¼Œå› æ­¤æˆ‘ä»¬è¦é…ç½®è‡ªå·±åŸŸåçš„é‚®ç®±ã€‚ è®¾ç½®ä¸€ä¸ªåŸŸåçš„mxã€txtå’Œcnameè®°å½•ï¼Œä»¥example.comåŸŸä¸ºä¾‹ï¼š 123edm.example.com CNAME edm.edmcn.cnedm.example.com MX sender.f.wsztest.comedm.example.com TXT v=spf1 include:spf.ezcdn.cn ~all åŸŸåè§£ææˆåŠŸåï¼Œå°±å¯åœ¨EDMç®¡ç†å¹³å°ä½¿ç”¨è‡ªå·±åŸŸåéªŒè¯è¿‡çš„é‚®ç®±åœ°å€äº†ï¼Œæ¯”å¦‚å«`service@edm.mooctest.net`ï¼Œå°±å¯ä»¥å¤§å¤§å‡å°‘é‚®ä»¶è¢«æ‰”è¿›åƒåœ¾ç®±çš„æ¦‚ç‡ã€‚ SMTPæ¥å£ä¸Šé¢çš„é…ç½®éƒ½å®Œæˆåï¼Œç¡®ä¿åœ¨EDMç®¡ç†å¹³å°ä¸Šå¯ä»¥æˆåŠŸå‘é‚®ä»¶åï¼Œå°±å¯ä»¥å»ç”³è¯·å¼€é€šEDM-SMTPæœåŠ¡ã€‚åœ¨ç¨‹åºä¸­å¯ä»¥é€šè¿‡javax.mailåº“å»å»ºç«‹é‚®ä»¶Transportåè®®ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778import java.io.UnsupportedEncodingException;import java.util.List;import java.util.Properties;import javax.mail.MessagingException;import javax.mail.Session;import javax.mail.Transport;import javax.mail.internet.AddressException;import javax.mail.internet.InternetAddress;import javax.mail.internet.MimeMessage;import javax.mail.internet.MimeMessage.RecipientType;import common.Constants;public class SimpleMailSender &#123; private static final String SMTP_EDM = "smtp.trigger.edmcn.cn"; private final transient Properties props = System.getProperties(); private transient MailAuthenticator authenticator; private transient Session session; public SimpleMailSender(final String smtpHostName, final String username, final String password) &#123; init(username, password, smtpHostName); &#125; public SimpleMailSender(final String username, final String password) &#123; String smtpHost; // EDMå¸å· if(isEDM(username))&#123; smtpHost = SMTP_EDM; &#125; else&#123; smtpHost = "smtp." + username.split("@")[1]; &#125; init(username, password, smtpHost); &#125; private void init(String username, String password, String smtpHostName) &#123; props.put("mail.smtp.auth", "true"); props.put("mail.smtp.host", smtpHostName); authenticator = new MailAuthenticator(username, password); session = Session.getInstance(props, authenticator); &#125; private boolean isEDM(String account)&#123; if(account.startsWith("edmc") &amp;&amp; !account.contains("@"))&#123; return true; &#125; return false; &#125; private InternetAddress getSenderAddress() throws AddressException, UnsupportedEncodingException&#123; if(isEDM(authenticator.getUsername()))&#123; return new InternetAddress(Constants.EDM_SENDER_ADDRESS, Constants.EDM_SENDER_NAME); &#125; return new InternetAddress(authenticator.getUsername(), Constants.DEFAULT_SENDER_NAME); &#125; public void send(List&lt;String&gt; recipients, String subject, Object content) throws AddressException, MessagingException, UnsupportedEncodingException &#123; final MimeMessage message = new MimeMessage(session); message.setFrom(getSenderAddress()); final int num = recipients.size(); InternetAddress[] addresses = new InternetAddress[num]; for (int i = 0; i &lt; num; i++) &#123; addresses[i] = new InternetAddress(recipients.get(i)); &#125; message.setRecipients(RecipientType.TO, addresses); message.setSubject(subject); message.setContent(content.toString(), "text/html;charset=utf-8"); Transport.send(message); &#125;&#125; é˜Ÿåˆ—è®¾è®¡ä½¿ç”¨è¿‡EDMå‘é€é‚®ä»¶çš„äººä¼šçŸ¥é“ï¼Œå°±ç®—æˆ‘ä»¬é…ç½®äº†è‡ªå·±åŸŸåçš„é‚®ç®±åœ°å€ï¼Œåœ¨ä½¿ç”¨SMTPåè®®å‘é€æ—¶ï¼Œä¹Ÿä¼šé‡åˆ°é¢‘ç‡è¿‡å¿«ï¼Œæˆ–è€…å¯¹æ–¹é‚®ç®±æ‹’æ”¶ï¼Œç­‰å¤±è´¥æƒ…å†µã€‚å› æ­¤æˆ‘ä»¬è¦è®¾è®¡ä¸€å¥—å®¹é”™å’Œé‡è¯•çš„æœºåˆ¶ã€‚ 123456789101112131415161718192021222324import javax.persistence.*;import play.db.jpa.Model;@Entity@Table(name="email_task")public class EmailTask extends Model &#123; @Column(name="receiver") private String receiver; @Column(name="subject") private String subject; @Column(name="content") private String content; @Column(name="try_times") private Integer tryTimes; public EmailTask()&#123; // default this.tryTimes = 0; &#125; // çœç•¥getterå’Œsetter&#125; å¦‚æœ¬æ–‡ä¸Šé¢æåˆ°çš„æ•°æ®åº“ä¸ORMæ‰€è¿°ï¼Œè¿™é‡Œè®¾è®¡ä¸€ä¸ªEmailTaskçš„Modelï¼Œè®°å½•ä¸‹æ”¶ä»¶äººã€ä¸»é¢˜å’Œæ­£æ–‡å†…å®¹ï¼Œå†é¢å¤–å­˜ä¸ªtryTimeså­—æ®µã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥è§„å®šï¼Œå½“é‡è¯•3æ¬¡ä»å¤±è´¥åï¼Œå°±å¿½ç•¥è¯¥é‚®ä»¶ä»»åŠ¡ã€‚ å½“å‘é€ç«‹å³é‚®ä»¶æ—¶ï¼Œæ¯”å¦‚â€œå¿˜è®°å¯†ç â€çš„é‚®ä»¶ï¼Œç›´æ¥ä½¿ç”¨ä¸Šé¢çš„SimpleMailSenderå‘é€é‚®ä»¶ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å°†é‚®ä»¶ä¿¡æ¯å­˜æˆEmailTaskå­˜åˆ°æ•°æ®åº“ã€‚è€Œå½“å‘é€éç«‹å³çš„é‚®ä»¶æ—¶ï¼Œæ¯”å¦‚é€šçŸ¥ç±»çš„é‚®ä»¶ï¼Œåªéœ€å°†é‚®ä»¶å†…å®¹ç”ŸæˆEmailTaskå¯¹è±¡å­˜åˆ°æ•°æ®åº“ï¼Œä¾›å®šæ—¶ä»»åŠ¡æ¥è°ƒåº¦ã€‚ ç«‹å³ä»»åŠ¡ä¸å®šæ—¶ä»»åŠ¡ä¸Šé¢çš„é‚®ä»¶é˜Ÿåˆ—è®¾è®¡ä¸­æ‰€è¯´çš„â€œç«‹å³é‚®ä»¶â€å’Œâ€œéç«‹å³é‚®ä»¶â€ï¼Œå…¶å®å°±æ˜¯â€œç«‹å³ä»»åŠ¡â€å’Œâ€œå®šæ—¶ä»»åŠ¡â€ã€‚åœ¨Playæ¡†æ¶ä¸­æœ‰Jobsæ¥å®ç°ä»»åŠ¡è°ƒåº¦ã€‚ 123456789101112131415161718192021222324252627282930313233343536import play.jobs.Job;public class InstantMailJob extends Job &#123; private static EmailTaskDao taskDao = new EmailTaskDao(); private String receiver; private String subject; private String content; public InstantMailJob(String receiver, String subject, String content)&#123; this.receiver = receiver; this.subject = subject; this.content = content; &#125; public void doJob()&#123; try &#123; MailJobUtil.sendMail(receiver, subject, content); &#125; catch (Exception e) &#123; e.printStackTrace(); System.out.println("Send mail error for receiver " + receiver); // å‘é€å¤±è´¥ï¼ŒåŠ å…¥taskï¼Œå¾…ä¸‹æ¬¡å†å‘ EmailTask task = new EmailTask(); task.setReceiver(receiver); task.setSubject(subject); task.setContent(content); // å·²å¤±è´¥1æ¬¡ task.setTryTimes(1); taskDao.save(task); &#125; &#125;&#125; è¿™å°±æ˜¯â€œç«‹å³é‚®ä»¶â€ä»»åŠ¡çš„Jobï¼Œå¾— override doJobæ–¹æ³•ï¼Œé‚®ä»¶å‘é€å¤±è´¥çš„è¯å°±åŠ å…¥EmailTaskã€‚ä½¿ç”¨æ—¶å¦‚ä¸‹è°ƒç”¨å³å¯ 1new InstantMailJob(receiver, subject, content).now(); è€Œå¯¹äºâ€œéç«‹å³é‚®ä»¶â€ä»»åŠ¡ï¼Œè¦ä½¿ç”¨Playæ¡†æ¶çš„å®šæ—¶ä»»åŠ¡Jobï¼Œå¹¶ä¸”è®¾ç½®é—´éš”æ—¶é—´ã€‚ 123456789101112131415161718192021222324252627282930313233343536import play.jobs.Every;import play.jobs.Job;@Every("1mn")public class BackgroundMailJob extends Job &#123; private static EmailTaskDao taskDao = new EmailTaskDao(); public void doJob()&#123; // é¿å…é‚®ä»¶æœåŠ¡å™¨å¼‚å¸¸ï¼Œä¸€æ¬¡åªå‘å‰10ä¸ª List&lt;EmailTask&gt; tasks = taskDao.getTopTasks(); for(EmailTask task : tasks)&#123; try &#123; MailJobUtil.sendMail(task.getReceiver(), task.getSubject(), task.getContent()); &#125; catch (Exception e) &#123; e.printStackTrace(); System.out.println("Send mail error for receiver " + task.getReceiver()); // æŠŠå½“å‰ä»»åŠ¡åŠ åˆ°é˜Ÿå°¾ EmailTask failedTask = new EmailTask(); failedTask.setReceiver(task.getReceiver()); failedTask.setSubject(task.getSubject()); failedTask.setContent(task.getContent()); // ç´¯è®¡å¤±è´¥æ¬¡æ•° failedTask.setTryTimes(task.getTryTimes() + 1); taskDao.save(failedTask); &#125; // åˆ é™¤æˆåŠŸçš„ä»»åŠ¡ taskDao.remove(task); &#125; &#125;&#125; åŒæ ·ä¹Ÿè¦ override doJobæ–¹æ³•ï¼Œä½†è¿™é‡Œè¿˜å¾—è®¾ç½®ä»»åŠ¡å‘¨æœŸ @Every(&quot;1mn&quot;)ï¼Œè¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼linuxä¸­çš„crontabã€‚æˆ‘è¿™é‡Œè®¾ç½®äº†æ¯1åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œä¸ºäº†é¿å…é‚®ä»¶SMTPè°ƒç”¨é¢‘ç‡å¤ªå¿«è€Œå¤±è´¥ï¼Œæ¯æ¬¡æ‰§è¡ŒJobæ—¶åªå–é˜Ÿåˆ—ä¸­å‰å‡ ä¸ªEmailTaskã€‚ é‚®ä»¶ç»Ÿè®¡æ•°æ®è¿™æ˜¯ä¸€å¼€å§‹åœ¨EDMç®¡ç†å¹³å°ä¸Šæ‰¹é‡å‘é€é‚®ä»¶çš„ç»Ÿè®¡æ•°æ®ï¼Œå‘ç°è½¯é€€ç‡ä¸ä½ï¼ŒæŸ¥çœ‹é‚®å±€ç»Ÿè®¡åå‘ç°æ˜¯QQé‚®ç®±æ™®éç½‘å…³æ‹¦æˆªã€‚ è€Œä¸‹é¢æ˜¯ä½¿ç”¨äº†EDM-SMTPåè®®å’Œé‚®ä»¶é˜Ÿåˆ—å‘é€çš„ç»“æœç»Ÿè®¡ï¼Œå¯è§æˆåŠŸç‡ç¨å¾®é«˜ä¸€ç‚¹ã€‚å€’æ•°ç¬¬äºŒæ¡è®°å½•è½¯é€€å¾ˆé«˜ï¼Œæ˜¯å› ä¸ºå‡ ä¹éƒ½æ˜¯QQé‚®ç®±ï¼ åè®°é¡¹ç›®èƒ½åšæŒåšä¸‹å»ä¸å®¹æ˜“ï¼Œå†™æ–‡ç« æ›´ä¸å®¹æ˜“ï¼Œå¯¹è‡ªå·±æ˜¯ä¸ªæ€»ç»“ï¼Œä¹Ÿå¸Œæœ›å¯ä»¥å¸®åˆ°æ›´å¤šçš„äººã€‚]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>æ³›å‹ç¼–ç¨‹</tag>
        <tag>Mooctest</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šä»“åº“gité…ç½®]]></title>
    <url>%2Fblog%2F2016%2F01%2Fmulti-git-repo-config.html</url>
    <content type="text"><![CDATA[æœ€æ—©è‡ªå·±åœ¨githubä¸Šå†™åšå®¢ï¼Œç„¶åå®ä¹ çš„æ—¶å€™ç”¨å…¬å¸å†…éƒ¨çš„gitlabï¼Œå›å­¦æ ¡åå®éªŒå®¤åˆè¦æè‡ªå·±çš„gitlabï¼Œæäº¤çš„æ—¶å€™å‘ç°æäº¤ä¿¡æ¯è¿˜æ˜¯ä»¥å‰å…¬å¸çš„ï¼Œäºæ˜¯æç„¶å¤§æ‚Ÿï¼Œä¸Šgithubä¸€çœ‹ï¼Œæœç„¶éƒ½æ˜¯è¿™æ ·ã€‚ã€‚ã€‚ ä¸¥é‡å½±å“æ´»è·ƒåº¦å•Šæœ‰æœ¨æœ‰ (â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”» äºæ˜¯æˆ‘ç ”ç©¶äº†ä¸‹gitå¤šä»“åº“é…ç½®çš„åŸç†ï¼ˆæœ¬æ–‡åªä»‹ç»ç±»Unixç¯å¢ƒä¸‹çš„é…ç½®ï¼‰ gité€šç”¨é…ç½®ç”Ÿæˆ ssh key1ssh-keygen -t rsa -C "your_email@example.com" ä¼šæœ‰æç¤ºï¼Œä¸€è·¯ç©ºæ ¼å³å¯ï¼Œä¼šåœ¨ ~/.ssh/ ä¸‹ç”Ÿæˆ id_rsa å’Œ id_rsa.pub ä¸¤ä¸ªæ–‡ä»¶ï¼Œéœ€è¦å°†å…¬é’¥ï¼ˆå³id_rsa.pubï¼‰çš„å†…å®¹æ·»åŠ åˆ° github/gitlab çš„è´¦æˆ·ssh keyè®¾ç½®é‡Œã€‚ 1cat ~/.ssh/id_rsa.pub ç»“æœä¸ºï¼šssh-rsa AAAAçœç•¥å‡ ç™¾ä¸ªå­—ç¬¦+yMS5Nl4F â€œyour_email@example.comâ€ å¯ä»¥çœ‹åˆ°æœ«å°¾å°±æ˜¯ä½ çš„é‚®ç®±ã€‚å¦‚æœè¿™æ˜¯ä½ çš„gitlabè´¦å·ï¼Œé‚£å°±æŠŠå®ƒåŠ åˆ°gitlabçš„ssh key settingé‡Œã€‚ä½†å¦‚æœä½ åˆæƒ³ç”¨githubï¼Œåˆä¸å¹¸çš„æ˜¯ä½ githubè´¦å·ä¸æ˜¯è¿™ä¸ªé‚®ç®±ï¼Œé‚£ä¹ˆsorryï¼Œä½ å¾—é‡æ–°æŠŠè¿™ä¸ªæ–°çš„id_rsa.pubæ·»åŠ åˆ°account settingé‡Œã€‚ æ³¨æ„ï¼Œæˆ‘è¿™é‡Œçš„åšæ³•æ˜¯ä¸€ä¸ªhomeç›®å½•ä¸‹ï¼Œåªä¿ç•™ä¸€ä»½ id_rsa å’Œ id_rsa.pubï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªgitlabï¼Œéƒ½è¦æŠŠå½“å‰æœºå™¨ä¸Šæœ€æ–°çš„å…¬é’¥æ·»åŠ è¿›å»ã€‚ç½‘ä¸Šè¿˜æŸ¥åˆ°ä¸€ç§åŠæ³•ï¼Œgithub/gitlab ç®¡ç†å¤šä¸ªssh keyï¼Œæˆ‘è§‰å¾—ä¸€ä¸ª ssh key ä¹Ÿèƒ½ç”¨äº†ï¼Œå°±æ‡’å¾—æŠ˜è…¾äº†ã€‚ æ–°åŠ ä»“åº“å¦‚æœä½ è¦ä»é›¶å¼€å§‹æ­ä¸€ä¸ªprojectï¼Œå¹¶ä¸”æŠŠä»£ç ä¼ åˆ°gitä¸Šï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼Œå…ˆå» github/gitlab ä¸Šå»ºä¸ªä»“åº“ã€‚ 123456git clone git@your_git_repo.gitcd your_git_repotouch README.mdgit add README.mdgit commit -m "add README"git push -u origin master å·²æœ‰ä»“åº“å¦‚æœä½ å·²ç»æœ‰projectäº†ï¼Œå¦‚æœåŸæ¥æ˜¯ç”¨svnç®¡ç†ä»£ç çš„ï¼Œé‚£éœ€è¦å…ˆæŠŠ .svn è¿™æ ·çš„ç›®å½•åˆ æ‰ã€‚è¿™æ˜¯svnè‡ªå·±ç”Ÿæˆçš„æ–‡ä»¶ï¼Œç”¨æ¥æ¯”å¯¹æ›´æ”¹çš„ï¼Œå…¶å®æ–‡ä»¶æŒºå¤§çš„ï¼Œä¸€èˆ¬è‡³å°‘å projectç›®å½•æ€»å¤§å°çš„1/3 1find . -type d -name '.svn' | xargs rm -rf ä¸Šé¢å‘½ä»¤çš„æ„æ€æ˜¯ï¼šå…ˆ(é€’å½’)æ‰¾åˆ°å½“å‰è·¯å¾„ä¸‹å«æœ‰.svnçš„æ–‡ä»¶ç›®å½•ï¼Œå†ç»xargsé€ä¸ªåˆ é™¤ã€‚ç°åœ¨ç»ˆäºå¯ä»¥å°†projectè¿ç§»åˆ°gitäº†ï¼ 123456cd your_projectgit initgit remote add origin git@your_git_repo.gitgit add .git commitgit push -u origin master å¤šä»“åº“useré…ç½®å›åˆ°ä¸€å¼€å§‹é‚£å¼ å›¾ä¸Šçš„é—®é¢˜ï¼šæˆ‘githubä¸Šçš„æäº¤ä¿¡æ¯æ˜¯å…¬å¸gitlabä¸Šçš„ä¿¡æ¯å’Œé‚®ç®±ï¼Œå¯¼è‡´æˆ‘æ´»è·ƒåº¦ä¸¢äº†ã€‚ã€‚ã€‚ ç ”ç©¶åå‘ç°æ˜¯ git config çš„é—®é¢˜ï¼Œåœ¨å…¬å¸å®ä¹ çš„æ—¶å€™è¯¯ç”¨äº†ä¸‹é¢ä¸¤æ¡å‘½ä»¤ 12git config --global user.name "Your Name"git config --global user.email "your_email@example.com" --globalé€‰é¡¹æ˜¯ä¼šè¦†ç›–å…¨å±€çš„ï¼Œå°±æ˜¯è¯´ä½ åœ¨homeä¸‹çš„ä»»ä½•ç›®å½•ä¸ç®¡ä½¿ç”¨ github è¿˜æ˜¯ gitlabï¼Œåªè¦ä½ ç”¨ git commit æäº¤ï¼Œéƒ½ä¼šé»˜è®¤å…ˆå– global user ä½œä¸º contributorï¼Œå¯èƒ½ä¼šå¯¼è‡´å’Œä½  github/gitlab è´¦å·ä¸ç¬¦ï¼ è§£å†³åŠæ³• å…ˆç¡®å®šè‡ªå·±å“ªä¸ª github/gitlab è´¦å·ç”¨çš„æœ€å¤šï¼ŒæŠŠç”¨çš„æœ€å¤šçš„å·ä½œä¸º global user ï¼ˆåˆ«å¿˜äº†å‰ææ˜¯id_rsa.pubéƒ½å¾—æ·»åŠ åˆ°å„å¹³å°ä¸Šï¼‰ å‡è®¾æˆ‘ç°åœ¨gitlabç”¨çš„æœ€å¤š 123cd your_gitlab_repogit config --global user.name "Your Name"git config --global user.email "your_email@gitlab.com" ç„¶åè¦å»githubé‡Œæ”¹å›githubçš„è´¦å·ï¼Œé˜²æ­¢è¢«å½“æˆå…¶ä»–contributor 123cd your_github_repogit config --local user.name "Your Name"git config --local user.email "your_email@github.com" æ³¨æ„è¿™é‡Œç”¨çš„æ˜¯ `--local` é€‰é¡¹ï¼Œä¸ä¼šè¦†ç›–å…¨å±€ï¼Œåªåœ¨å½“å‰ç›®å½•ç”Ÿæ•ˆ åœ¨githubçš„ä»“åº“çš„é‡ŒæŸ¥çœ‹ 1git config --list å¯ä»¥çœ‹åˆ°æœ€ä¸Šé¢æ˜¯global userï¼Œæœ€ä¸‹é¢æ˜¯é‡å†™çš„local user 123456789push.default=matchinguser.name=Global Nameuser.email=your_email@gitlab.comçœç•¥...remote.origin.url=git@your_github_repo.gitbranch.master.remote=originbranch.master.merge=refs/heads/masteruser.name=Local Nameuser.email=your_email@github.com ç»ˆäºç»è¿‡ä¸€ç•ªæ›´æ”¹åï¼Œå†çœ‹githubï¼Œå°±æ¢å¤æ­£å¸¸å•¦ï¼ gitignoreæœ€åå†è¡¥å……ä¸€ç‚¹å…³äºgitignoreçš„é…ç½®ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªåŠŸèƒ½æ¯”svnå¥½ç”¨å¤šäº†ï¼ 12cd your_git_repotouch .gitignore é…ç½®è¯­æ³•ï¼š ä»¥æ–œæ  / å¼€å¤´è¡¨ç¤ºç›®å½• ä»¥æ˜Ÿå· * é€šé…å¤šä¸ªå­—ç¬¦ ä»¥é—®å· ? é€šé…å•ä¸ªå­—ç¬¦ ä»¥æ–¹æ‹¬å· [] åŒ…å«å•ä¸ªå­—ç¬¦çš„åŒ¹é…åˆ—è¡¨ ä»¥å¹å· ! è¡¨ç¤ºä¸å¿½ç•¥(è·Ÿè¸ª)åŒ¹é…åˆ°çš„æ–‡ä»¶æˆ–ç›®å½• æ­¤å¤–ï¼Œgit å¯¹äº.gitignoreé…ç½®æ–‡ä»¶æ˜¯æŒ‰è¡Œä»ä¸Šåˆ°ä¸‹è¿›è¡Œè§„åˆ™åŒ¹é…çš„ï¼Œæ„å‘³ç€å¦‚æœå‰é¢çš„è§„åˆ™åŒ¹é…çš„èŒƒå›´æ›´å¤§ï¼Œåˆ™åé¢çš„è§„åˆ™å°†ä¸ä¼šç”Ÿæ•ˆã€‚ å‚è€ƒgithub/gitlab ç®¡ç†å¤šä¸ªssh key]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯è¦ç»™åŠ› â€” å¹³å‡¡ä¹‹è·¯]]></title>
    <url>%2Fblog%2F2015%2F12%2Ftwisted-way-to-awesome-fe.html</url>
    <content type="text"><![CDATA[ä¸€ç›´æƒ³æ€»ç»“ä¸‹è‡ªå·±æ‘¸æ‰“æ»šçˆ¬çš„å‰ç«¯ç»å†ï¼Œ3å¹´ï¼Œä»ä¸€ä¸ªæè®¨åŒå‰ç«¯çš„äººï¼Œå˜æˆä¸€ä¸ªåƒå‰ç«¯é¥­ç¢—çš„äººã€‚æ²¡æœ‰äººå¸¦è¿‡æˆ‘ï¼Œè·Œè·Œæ’æ’çš„ç¼“æ…¢å‰è¿›ï¼Œä½†æˆ‘å¾ˆå–œæ¬¢åˆ†äº«ï¼Œå–œæ¬¢ä¸€èµ·è¿›æ­¥ï¼Œè¿™ä¼šæ˜¯æˆ‘ä»¥åä¸€ç›´ä¹æ„åšçš„äº‹æƒ…ã€‚ ç»¼è¿°å¨ƒå¨ƒå­¦æ­¥ w3cschoolä¸Šçš„ html / css / javascript / ä»¥åŠjqueryæ•™ç¨‹ï¼Œä¸‡äº‹å¼€å¤´çš„ç¬¬ä¸€æ­¥ Say hello to the world! å°è·‘ä¸Šè·¯ jquery è½»æ¾ç©è€DOMå’Œevent jquery-ui å¢å¼ºçš„UIç»„ä»¶ Bootstrap ä»æ­¤å‚»ç“œå¼æ’ç‰ˆå°±èƒ½æå®š Bootstrap ä¸»é¢˜æ¨¡æ¿ and ç®¡ç†ç³»ç»Ÿæ¨¡æ¿ å¿«é€Ÿæ­å»ºé¡¹ç›®ï¼Œç®€å•ï¼Œå¥½çœ‹ é‡ä¸Šå¹³è¡¡æœ¨åœ¨å°è·‘ä¸Šè·¯çš„è¿‡ç¨‹ä¸­ï¼Œåšå‡ºæ¥çš„ä¸œè¥¿çœ‹èµ·æ¥å¾ˆä¸“ä¸šï¼Œæ³¨æ„æ˜¯â€œçœ‹èµ·æ¥â€ã€‚å¦‚æœä¸ç†è§£çœŸæ­£çš„å‰ç«¯æŠ€èƒ½ï¼Œé‚£åªèƒ½æ˜¯çœ‹èµ·æ¥ä¸“ä¸šï¼Œå†…éƒ¨ç»“æ„è¿˜æ˜¯ä¹±ç³Ÿç³Ÿçš„ï¼Œæˆ–è€…æ˜¯é‡åˆ°bugä¸çŸ¥é“æ€ä¹ˆè°ƒï¼Œä¸œä¸€å¥è¥¿ä¸€å¥ï¼Œæ‹†äº†ä¸œå¢™è¡¥è¥¿å¢™ã€‚è¿™è¿‡ç¨‹å°±åƒèµ°åœ¨å¹³è¡¡æœ¨ä¸Šï¼Œç¨ä¸ç•™ç¥å°±ä¼šæ‘”ä¸‹å»ã€‚ é¦–å…ˆè¦äº†è§£cssçš„å¸ƒå±€åŸç† ç›’æ¨¡å‹ å®šä½æ¨¡å‹ æœ‰äº†å¸ƒå±€çš„åŸºæœ¬ç†è®ºåï¼Œå°è¯•å»ç†è§£Boostrapé‡Œçš„æ …æ ¼ç³»ç»Ÿ row col span2 èƒŒåçš„style jsæœ€é‡è¦çš„ä¸‰ç‚¹: é—­åŒ…ã€åŸå‹ã€ä½œç”¨åŸŸ JSä¸­çš„é—­åŒ…åŠä½¿ç”¨åœºåˆ ä½¿ç”¨é—­åŒ…è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ é—­åŒ…ã€åŸå‹ã€ä½œç”¨åŸŸ é¢è¯•æ•´ç† å…³äºjsçš„åŸå‹å’Œä½œç”¨åŸŸï¼Œæˆ‘æ²¡ä¸“é—¨å†™è¿‡æ–‡ç« ï¼Œå»ºè®®å»åšå®¢å›­æœä¸‹ã€‚å¦‚æœæƒ³è¦å®Œæ•´çš„ç†è§£jsè¯­è¨€æœºåˆ¶ï¼Œå¯ä»¥å»çœ‹ã€ŠJavascriptæ¨¡å¼ã€‹è¿™æœ¬ä¹¦ï¼Œæˆ–è€…çœ‹æˆ‘æ•´ç†çš„è¯»ä¹¦ç¬”è®° ã€ŠJavaScriptæ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ— åä¸½è·³è·ƒè°¢å¹•åªæœ‰æŠŠå¹³è¡¡æœ¨ä¸Šçš„æŠ€èƒ½ç£¨ç†Ÿç»ƒåï¼Œæˆ‘ä»¬æ‰èƒ½çœŸæ­£çš„æ¸¸åˆƒæœ‰ä½™ï¼Œä¿è¯ä¸ä»å¹³è¡¡æœ¨ä¸Šæ‘”ä¸‹æ¥çš„å‰æä¸‹ï¼Œå†æœ‰ä½™åŠ›å»è®¾è®¡å¦‚ä½•åä¸½çš„è·³è·ƒå’Œè°¢å¹•ã€‚ ç»„ä»¶å°è£…è¿˜æ²¡äº†è§£jså¯¹ç±»(æˆ–æ¨¡å—)çš„å°è£…å‰ï¼Œæˆ‘ä»¬çš„ä»£ç å¯èƒ½æ˜¯è¿™æ ·çš„ 1234567891011121314151617181920212223var getData = function()&#123; // ......&#125;;function editFunc()&#123; // ......&#125;;$('.refresh-btn').on('click', function()&#123; var data = getData(); var $target = $($(this).attr('data-target')); $target.empty(); for(var i=0; i&lt;data.length; i++)&#123; var $child = $('&lt;tr&gt;&lt;/tr&gt;'); $child.append('&lt;td&gt;' + data[i]['name'] + '&lt;/td&gt;'); // ...... $child.append('&lt;td&gt;&lt;a class="edit-link"&gt;ç¼–è¾‘&lt;/a&gt;&lt;/td&gt;'); $target.append($child); &#125; $target.find('.edit-link').on('click', editFunc);&#125;); ä¸€ä¸ªç‚¹å‡»å°±è·å–æ•°æ®ï¼Œç„¶ååˆ·æ–°è¡¨æ ¼çš„åŠŸèƒ½ã€‚å¦‚æœä¸€ä¸ªé¡µé¢ä¸­æœ‰å¤šä¸ªç±»ä¼¼çš„å¼‚æ­¥åˆ·æ–°çš„è¡¨æ ¼ï¼Œä¸”æ¯ä¸ªè¡¨æ ¼çš„å­—æ®µåˆå„ä¸ç›¸åŒï¼Œé‚£ä¹ˆæœ€å·æ‡’çš„åšæ³•å°±æ˜¯æ‹·è´å¤§æ®µä»£ç ï¼Œç„¶åå†è°ƒæ•´&lt;td&gt;çš„å­—æ®µã€‚è¿™æ ·çš„ä»£ç ç®€ç›´äº†ï¼Œå¤ªéš¾ç»´æŠ¤äº†ï¼ 123456var table1 = new AjaxTable(&#123; el: '#dataTable', dataUrl: '/path/to/action/'&#125;);table1.refresh(); å¦‚æœä»£ç å˜æˆè¿™æ ·ï¼Œé‚£å°±çˆ½å¤šäº†ï¼Œè·å–æ•°æ®å’Œåˆ·æ–°è¡¨æ ¼çš„è¿‡ç¨‹éƒ½å°åœ¨äº†AjaxTableä¸­ï¼Œå„ä¸ªä½¿ç”¨ä¹‹å¤„åªéœ€è¦ä¼ ä¸ªå‚æ•°è°ƒç”¨ä¸‹refresh()å³å¯ï¼Œå‡å°‘äº†å¤§é‡é‡å¤(ç›¸ä¼¼çš„)ä»£ç ã€‚è¿™å°±æ˜¯å¯¹UIç»„ä»¶/åŠŸèƒ½ç»„ä»¶çš„å°è£…ã€‚ ä»¥å‰ä¸ºäº†å‡†å¤‡é¢è¯•æ—¶çš„â€œæ‰‹æ’•ä»£ç â€ï¼Œå†™è¿‡ä¸€ä¸ªç®€å•çš„è½®æ’­ç»„ä»¶ï¼Œä¸ç”¨jqueryï¼ˆé¢è¯•ç»å¸¸ä¸å…è®¸ä½¿ç”¨ä»»ä½•åº“ï¼‰ åŸç”Ÿjsçš„Sliderç»„ä»¶ è¿˜å†™è¿‡ä¸‹é¢ä¸€äº›æ–‡ç«  è‡ªå·±å†™çš„jqueryåˆ†é¡µæ’ä»¶ ä¸ºHighchartsåšåŒ…è£… ï¼ˆæœ‰ç‚¹ç±»ä¼¼ä¸Šé¢ç¤ºä¾‹ä¸­çš„AjaxTableï¼‰ ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(ç³»åˆ—) ï¼ˆç³»åˆ—é•¿æ–‡ï¼Œå¦‚ä½•æŠŠä¸€æ®µç”Ÿç¡¬å®ç°çš„ä»£ç ä¸€æ­¥ä¸€æ­¥å°è£…å’Œæ‰©å±•æˆä¸ºä¸€ä¸ªå¯é…ç½®çš„UIç»„ä»¶ï¼‰ æ¨¡å—åŒ–å¼€å‘å¦‚æœè¦åœ¨é¡µé¢ä¸Šå¼•å…¥å¤–éƒ¨çš„jsåº“ï¼Œæœ€åˆå­¦ä¹ çš„æ—¶å€™æ˜¯è¿™æ ·å¼•å…¥çš„ 1234&lt;script type="text/javascript" src="jquery-1.7.2.min.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="jquery-ui/jquery-ui-1.8.24.min.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="jquery-ui/jquery-ui-datepicker-zh-CN.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="bootstrap-2.3.2.min.js"&gt;&lt;/script&gt; ç”±äºæµè§ˆå™¨ä¸­jsçš„æ‰§è¡Œ(éåŠ è½½)è¿‡ç¨‹æ˜¯åœ¨å•çº¿ç¨‹ä¸­çš„ï¼Œè€Œå„jsæ–‡ä»¶åˆä¼šå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚ jquery-ui ä¾èµ– jqueryï¼Œbootstrap ä¹Ÿä¾èµ– jqueryï¼Œæ‰€ä»¥&lt;script&gt;æ ‡ç­¾çš„å¼•å…¥å¾—æ»¡è¶³ä¾èµ–é¡ºåºã€‚å½“ä¸€ä¸ªé¡¹ç›®è¶Šåšé¡µé¢è¶Šå¤šæ—¶ï¼Œè¿™ä¹ˆå¤šé¡µé¢ä¸­ä¼šå­˜åœ¨ä¸€å †&lt;script&gt;æ ‡ç­¾ï¼Œå¦‚æœè¦å°†æŸä¸ªjsæ–‡ä»¶å‡çº§ç‰ˆæœ¬ï¼Œæˆ–è€…ä¿®æ”¹scriptçš„ä¾èµ–å…³ç³»æ—¶ï¼Œè¿™å°±ä¼šæˆä¸ºä¸€ä¸ªå¾ˆç¹ççš„å·¥ä½œï¼Œç‰¹åˆ«æ˜¯&lt;script&gt;åˆ†æ•£åœ¨é¡¹ç›®çš„å„ä¸ªæ–‡ä»¶ä¸­æ—¶ã€‚ RequireJSå°±æ˜¯å‡ºæ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼ˆç®€å•æ¥è¯´å°±æ˜¯ç”¨jså»ç®¡ç†jsï¼‰ï¼Œè¿˜æœ‰SeaJSï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨ç€AMDå’ŒCMDä¸¤ç§é£æ ¼ï¼Œå…³äºæ¨¡å—åŒ–å’Œä¸¤è€…çš„åŒºåˆ«å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€‚ å®æˆ˜æ¡ˆä¾‹ ç”¨RequireJSåŒ…è£…AjaxChart å‰ç«¯æ¨¡å—åŒ–å¼€å‘demoä¹‹æ”»å‡»åœ°å›¾ é¡µé¢ç»§æ‰¿é¡µé¢ç»§æ‰¿ è¿™å—è·Ÿä¸Šé¢çš„å„ç§å…·ä½“çš„æŠ€æœ¯æ²¡å¤ªå¤§å…³ç³»ï¼Œé¡µé¢ç»§æ‰¿ä¸»è¦æ˜¯ç”¨æ¥ç»„ç»‡é¡¹ç›®æ–‡ä»¶ç»“æ„ï¼ˆæˆ–é¡µé¢ç»“æ„ï¼‰çš„ä¸€äº›ç»éªŒè§„åˆ™ã€‚å‡è®¾åœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œï¼Œæ¯ä¸ªé¡µé¢éƒ½æœ‰ç›¸åŒçš„å¤´å’Œå°¾ï¼Œè¿˜æœ‰navï¼Œé‚£æ ¹æ®ä¸Šé¢å°è£…å’Œåˆ†ç¦»çš„æ€æƒ³ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·å†™ 1234567891011121314151617181920212223242526272829&lt;html&gt;&lt;body&gt; %&#123; include header.html &#125;% &lt;div class="container"&gt; &lt;div class="left"&gt; %&#123; include nav.html &#125;% &lt;/div&gt; &lt;div class="main"&gt; &lt;!-- å…·ä½“ä¸šåŠ¡... --&gt; &lt;/div&gt; &lt;/div&gt; %&#123; include footer.html &#125;% &lt;script src="require.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; requirejs.config(&#123; // å…¨å±€é…ç½®... &#125;); &lt;/script&gt; &lt;script type="text/javascript"&gt; require(['jquery'], function($)&#123; // å…·ä½“ä¸šåŠ¡... &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸€æ®µä½œä¸ºä¸€ä¸ªbaseçš„çˆ¶é¡µé¢ï¼Œå‘½åä¸ºbase.htmlï¼Œæ¯ä¸ªâ€œå…·ä½“ä¸šåŠ¡â€çš„é¡µé¢éƒ½ç»§æ‰¿è‡ªå®ƒã€‚ 12345678910111213141516171819%&#123; extends 'base.html' &#125;%%&#123; block styles &#125;%&lt;style type="text/css"&gt;&lt;/style&gt;%&#123; endblock &#125;%%&#123; block content &#125;%&lt;div&gt;å…·ä½“ä¸šåŠ¡...&lt;/div&gt;%&#123; endblock &#125;%%&#123; block scripts &#125;%&lt;script type="text/javascript"require(['jquery'], function($)&#123; // å…·ä½“ä¸šåŠ¡...&#125;);&lt;/script&gt;%&#123; endblock &#125;% æŠŠè¿™ä¸ªé¡µé¢å«åšfunc1.htmlï¼Œå…·ä½“ä¸šåŠ¡çš„é¡µé¢ä¸­åªä¼šåŒ…å«è‡ªèº«ä¸šåŠ¡åŠŸèƒ½éœ€è¦å…³å¿ƒ(ç”¨åˆ°)çš„ä¸œè¥¿ï¼Œä¸å»å¤šç®¡baseé¡µé¢çš„é—²äº‹ã€‚å¯ä»¥çœ‹åˆ°å­é¡µé¢ä¸­æœ‰å¾ˆå¤šblockä¹‹ç±»çš„é”šç‚¹ï¼Œä¼šå°†ä¸endblockä¹‹é—´çš„å†…å®¹æ’å…¥åˆ°çˆ¶é¡µé¢ä¸­çš„ç›¸åº”ä½ç½®ï¼Œæ‰€ä»¥è¦å…ˆåœ¨base.htmlä¸­â€œæŒ–å¥½å‘â€ã€‚ 123%&#123; block styles &#125;% %&#123; endblock &#125;%%&#123; block content &#125;% %&#123; endblock &#125;%%&#123; block scripts &#125;% %&#123; endblock &#125;% å…·ä½“åšæ³•å¯ä»¥å»çœ‹å¸¸è§çš„æ¨¡æ¿ç³»ç»Ÿï¼Œæœ¬ä¾‹ä¸­å‚è€ƒçš„æ˜¯Djangoä¸­çš„æ¨¡æ¿å®šä¹‰ã€‚ é¡µé¢ç»„ä»¶åŒ–é¡µé¢ç»„ä»¶åŒ– ä¹Ÿæ˜¯å’Œå…·ä½“æŠ€æœ¯æ²¡æœ‰å…³ç³»ï¼Œå®ƒæ˜¯é¡ºç€ é¡µé¢ç»§æ‰¿ çš„æ€è·¯ï¼ŒæŠŠé¡µé¢æˆ–æ–‡ä»¶ç»“æ„åšæ›´å°ç²’åº¦çš„æ‹†åˆ†ï¼Œé¡µé¢ç”±ä¸€ä¸ªä¸ªé¡µé¢ç»„ä»¶æ„æˆã€‚ 12345678910111213141516171819202122232425%&#123; include sectionA.css &#125;%%&#123; include sectionB.css &#125;%&lt;div class="row"&gt; %&#123; include sectionA.tpl &#125;%&lt;/div&gt;&lt;div class="row"&gt; %&#123; include sectionB.tpl &#125;%&lt;/div&gt;&lt;script type="text/javascript"&gt;require(['sectionA', 'sectionB'], function(A, B)&#123; var App = Base.extend(&#123; _init: function()&#123; var that = this; var mods = [A, B]; this.modules = []; mods.forEach(function(Module)&#123; that.modules.push(new Module(App)); &#125;); &#125; &#125;);&#125;);&lt;/script&gt; ä¸Šé¢ç›¸å½“äºä¸€ä¸ªä¸šåŠ¡é¡µé¢ï¼Œå®ƒç”±sectionAå’ŒsectionBä¸¤ä¸ªé¡µé¢ç»„ä»¶ç»„æˆï¼ŒsectionA.tplå’ŒsectionB.tplæ˜¯htmlæ¨¡æ¿ã€‚åœ¨åº”ç”¨å±‚(å³ä¸šåŠ¡)é¡µé¢ä¸­åˆå§‹åŒ–ä¸¤ä¸ªjsæ¨¡å—Aå’ŒBï¼Œå¹¶ä¸”æŠŠè‡ªèº«çš„Appå˜é‡ä¼ é€’ç»™æ¨¡å—ï¼ˆnew Module(App)ï¼‰ï¼Œå¯ä»¥å®ç°å­æ¨¡å—ä¸åº”ç”¨å±‚é¡µé¢çš„é€šä¿¡ï¼Œç”šè‡³æ˜¯æ¨¡å—ä¹‹é—´çš„é€šä¿¡ã€‚ è¿™æ ·æŠŠé¡µé¢æ‹†æˆç²’åº¦æ›´ç»†çš„ç»“æ„ï¼Œå¥½å¤„æ˜¯é¡µé¢æ¨¡å—å¯ä»¥å¤ç”¨ï¼Œä¹Ÿä¾¿äºç®¡ç†ï¼Œæ”¹åŠ¨é¡µé¢ä¸­çš„ä¸€å°å—æ—¶åªéœ€åœ¨æ‰€å¤„çš„æ¨¡å—ä¸­ï¼Œç¼©å°æ”¹åŠ¨çš„å½±å“èŒƒå›´ã€‚ è¿˜çœ‹è¿‡ä¸€ç§æ€æƒ³æ˜¯ï¼ŒæŠŠcssæ–‡ä»¶ä¹Ÿå½“åšèµ„æºç”±requireJSåŠ¨æ€åŠ è½½ï¼Œè¿™æ ·ä¸Šé¢ç¤ºä¾‹ä¸­çš„include xxx.csséƒ½ä¸éœ€è¦äº†ï¼Œé¡µé¢æ¨¡å—çš„cssèµ„æºä½œä¸ºè¯¥æ¨¡å—çš„ä¾èµ–ï¼Œå†™åœ¨jsæ¨¡å—çš„defineçš„ä¾èµ–ä¸­ã€‚ 123define(['jquery', 'sectionA.css'], function($)&#123; // ä¸šåŠ¡æ¨¡å—...&#125;); è¿™æ ·æŠŠcsså’Œjséƒ½æŠ½è±¡æˆâ€œèµ„æºâ€ï¼Œç›¸å½“äº ç»„ä»¶ = æ¨¡æ¿ + èµ„æº ä¸€ä¸ªé¡µé¢æ•´ä½“çš„æ¨¡æ¿ï¼Œç›¸å½“äºå¤šä¸ªé¡µé¢ç»„ä»¶çš„æ‹¼è£…è€Œæˆã€‚æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœèƒ½è®©é¡µé¢ç»„ä»¶åšåˆ°å¼‚æ­¥æ¸²æŸ“çš„è¯ï¼ˆå³å¯ä»¥ç”±jså»è§£ææ¨¡æ¿è¯­æ³•å’Œå˜é‡ï¼Œè€Œä¸æ˜¯äº¤ç»™webæ¡†æ¶ï¼‰ï¼Œæ‰èƒ½çœŸæ­£åšåˆ°é¡µé¢æ¸²æŸ“çš„æœ¬è´¨ï¼š å‘ˆç°ç»™ç”¨æˆ·çš„é¡µé¢ = é¡µé¢æ¨¡æ¿ (åŒ…æ‹¬ç»„ä»¶çš„æ¨¡æ¿) + æ•°æ® â€œæ¸²æŸ“â€å°±æ˜¯å°†å¸¦æ•°æ®å˜é‡çš„é¡µé¢æ¨¡æ¿è¾“å‡ºæˆæ ‡å‡†çš„htmlï¼ŒåŒæ­¥æ¸²æŸ“æ˜¯æŒ‡åœ¨æœåŠ¡ç«¯è§£ææ¨¡æ¿å¹¶è¾“å‡ºå®Œæ•´htmlåˆ°æµè§ˆå™¨ä¸­ï¼Œè€Œå¼‚æ­¥æ¸²æŸ“æŒ‡ç›´æ¥åœ¨æµè§ˆå™¨ä¸­é€šè¿‡javascript æ ¹æ®ä¼ å…¥çš„æ•°æ®å°†æ¨¡æ¿è¾“å‡ºæˆæ ‡å‡†htmlã€‚ åŒä¸€æ¨¡æ¿å¦‚æœæ—¢èƒ½åœ¨æœåŠ¡ç«¯åŒæ­¥æ¸²æŸ“ï¼Œåˆèƒ½åœ¨æµè§ˆå™¨ç«¯å¼‚æ­¥æ¸²æŸ“çš„è¯ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å…³å¿ƒâ€œæ•°æ®â€æ˜¯åç«¯æ¡†æ¶ç›´æ¥è¾“å‡ºåˆ°é¡µé¢çš„ï¼Œè¿˜æ˜¯ajaxåŠ¨æ€å–æ¥çš„ã€‚å¯¹æ¨¡æ¿æ¥è¯´ï¼Œæ•°æ®å°±æ˜¯ä¸ªâ€œæ¥å£â€ï¼Œè€Œ æ¨¡æ¿ + æ•°æ® = æ¸²æŸ“ã€‚è¿™æ ·æˆ‘ä»¬ä½œä¸ºå‰ç«¯ï¼Œæ‰èƒ½æŠŠæ›´å¤šç²¾åŠ›æ”¾åœ¨æ¨¡æ¿å’Œäº¤äº’ä¸Šï¼Œä¸ç”¨ç®¡æ•°æ®çš„ä¼ é€’æ–¹å¼ã€‚ å¹³å‡¡ä¹‹è·¯å‰ç«¯å‘å±•äº†åå‡ å¹´ï¼Œç°åœ¨å‡ ä¹åˆ°è¾¾é¡¶å³°çš„é€Ÿåº¦äº†ï¼Œè¿‘ä¸¤å¹´æ¨å‡ºçš„æ¡†æ¶å±‚å‡ºä¸ç©·ï¼Œjqueryæ—©å·²ä¸æ˜¯ä¸€ç»Ÿæ±Ÿæ¹–äº†ã€‚æ¯ä¸ªäººçš„ç²¾åŠ›éƒ½æœ‰é™ï¼Œä¸å¯èƒ½ä¸€ä¸ªä¸ªéƒ½å­¦è¿‡æ¥ï¼Œä½†æ˜¯å¿…é¡»æ‰¿è®¤ï¼Œå‰ç«¯æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä½“ç³»ï¼ˆæˆ‘ä¹‹å‰æ•´ç†çš„çŸ¥è¯†ä½“ç³»ï¼‰ï¼Œæœ‰å®ƒç‹¬ç‰¹å’Œé­…åŠ›ä¹‹å¤„ã€‚ä¸ä»…æ˜¯æ¡†æ¶ï¼Œè¿˜æœ‰æ›´å¤šçš„å·¥ç¨‹åŒ–é—®é¢˜ï¼Œæ¡†æ¶éƒ½æ˜¯ä¸ºäº†è§£å†³æŸç±»ç›¸é€šçš„é—®é¢˜è€Œç”Ÿã€‚æ¨¡æ¿å’Œæ•°æ®åˆ†ç¦»ä¹Ÿå¥½ï¼Œâ€œçŠ¶æ€â€å’Œâ€œè¡¨ç°â€åˆ†ç¦»ä¹Ÿå¥½ï¼Œæˆ‘è¶Šæ¥è¶Šä½“ä¼šåˆ° â€œåˆ†â€æ˜¯ä¸ºäº†â€œåˆâ€ è¿™æ¡å¹³å‡¡ä¹‹è·¯ï¼Œè¿˜ä¼šâ€œé¢‘ç¹â€çš„å‘å±•å’Œèåˆä¸‹å»ã€‚]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯æ¨¡å—åŒ–å¼€å‘demoä¹‹æ”»å‡»åœ°å›¾]]></title>
    <url>%2Fblog%2F2015%2F12%2Fattack-map-with-amd.html</url>
    <content type="text"><![CDATA[å¾ˆæ—©ä»¥å‰å†™è¿‡ä¸€ç¯‡ç”¨RequireJSåŒ…è£…AjaxChartï¼Œå½“æ—¶ç”¨Highchartsåšå›¾è¡¨ï¼Œåœ¨å…¶ä¸Šå°è£…äº†ä¸€å±‚ajaxï¼Œæœ€ååªæ˜¯ç®€å•å¥—ç”¨äº†ä¸€ä¸‹requireJSã€‚ç”±äºå½“æ—¶è‡ªå·±æ‰æ¥è§¦æ¨¡å—åŒ–ï¼Œç†è§£å±‚é¢è¿˜å¤ªæµ…ï¼Œåæ¥ç»è¿‡å…¶ä»–é¡¹ç›®çš„ç£¨ç»ƒä»¥åŠå®ä¹ è·å¾—çš„è§è¯†ï¼Œæƒ³é‡æ–°ç»“åˆä¸€ä¸ªç¤ºä¾‹æ¥å†™ç‚¹å‰ç«¯æ¨¡å—åŒ–çš„å¼€å‘æ–¹å¼ã€‚ é¡¹ç›®èƒŒæ™¯æœ€è¿‘åœ¨åšä¸€ä¸ªå®‰å…¨è¿ç»´ç›‘æ§çš„é¡¹ç›®ï¼Œå…¶ä¸­æœ‰ä¸€æ¡æ˜¯æ ¹æ®è®¾å¤‡è·å–åˆ°çš„æ”»å‡»æ•°æ®ï¼Œåœ¨åœ°å›¾ä¸Šåšå¯è§†åŒ–ã€‚å¯¹æ¯”äº†Highchartså’ŒECharts EChartså¯¹å›½å†…åœ°å›¾çš„æ”¯æŒæ›´å¤š EChartsåœ¨æ¨¡å—åŒ–å’Œæ‰©å±•æ–¹é¢åšçš„æ¯”Highchartsæ›´å¥½ æ‰€ä»¥æœ€åæˆ‘é€‰æ‹©äº†åŸºäºEChartså»å°è£…ã€‚ç±»ä¼¼çš„ç½‘ç»œæ”»å‡»çš„ç›‘æ§åœ°å›¾å¯çœ‹å›½å¤–çš„Norse Attack Mapï¼Œä¹Ÿç®—æ˜¯åŒç±»çš„å‚ç…§ã€‚ éœ€æ±‚æ•´ç†æ•°æ®è¦æ±‚ æä¾›çš„æ•°æ®åªæœ‰IPåˆ°IPçš„æ”»å‡»ï¼ŒåŒ…æ‹¬æ”»å‡»æ—¶é—´ã€æ”»å‡»ç±»å‹ç­‰ï¼Œéœ€è¦è‡ªè¡Œæ ¹æ®IPå®šä½åˆ°ç›¸åº”çš„ç»çº¬åº¦ã€‚ å±•ç°è¦æ±‚ åœ°å›¾æä¾›ä¸–ç•Œã€ä¸­å›½ã€çœä»½ï¼Œè¿™ä¸‰ç§ç»´åº¦ï¼ˆåªé’ˆå¯¹ä¸­å›½ï¼‰ è¦åœ¨åœ°å›¾ä¸Šè¡¨ç°å‡ºæ”»å‡»çš„æ¥æºä¸ç›®æ ‡ä¹‹é—´çš„åŠ¨ç”» éœ€è¦å¼ºè°ƒå‡ºæ”»å‡»å—ç¾åœ°åŒºï¼Œå¯ä¸€çœ¼çœ‹å‡ºå“ªé‡Œæ˜¯é‡ç¾åŒº å¯ä»¥å¾ªç¯è¡¨ç°æ”»å‡»ï¼Œä¹Ÿå¯å®æ—¶åˆ·æ–°æ”»å‡»æ•°æ® ç›®å½•ç»“æ„1234567891011121314151617181920- index.html ä¸»é¡µé¢- assets - css - normalize.css æµè§ˆå™¨åˆå§‹åŒ–æ ·å¼ - common.css ä»bootstrapé‡Œæ‰’äº†ä¸€äº›åŸºç¡€æ ·å¼ - img/ - js - app - mainMap.js indexé¡µé¢çš„ä¸»æ‰§è¡Œjs - lib - echarts/ ç”¨äº†æºç åŒ… - zrender/ åŒæ ·æºç åŒ…ï¼Œå…·ä½“çœ‹echartså®˜æ–¹è¯´æ˜ - geo ä¸€äº›åœ°ç†æ•°æ®çš„å®šä¹‰ - china/ - world/ - mods - attackMap/ å¯¹echarts mapçš„å°è£… - util.js ç­‰ç­‰å…¶ä»–å¸®åŠ©æˆ–æ’ä»¶æ¨¡å—çš„å°è£… - xxxx.js - config.js requireJSçš„configé…ç½®12345678910111213141516171819requirejs.config(&#123; baseUrl: 'js/lib', paths: &#123; jquery: 'http://cdn.staticfile.org/jquery/1.7.2/jquery.min', underscore: 'http://cdn.staticfile.org/underscore.js/1.7.0/underscore-min' &#125;, packages: [ &#123; name: 'echarts', location: 'echarts/src', main: 'echarts' &#125;, &#123; name: 'zrender', location: 'zrender/src', main: 'zrender' &#125; ]&#125;); mapå°è£…è¿‡ç¨‹åˆæ­¥å°è£… mods/attackMap/main.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175define(function(require)&#123; var U = require('underscore'); var EC = require('echarts/echarts'); var ecMap = require('echarts/chart/map'); var ecMapParams = require('echarts/util/mapData/params').params; var EVENT = require('echarts/config').EVENT; var MAP_TYPE_WORLD = 'world'; var MAP_TYPE_CHINA = 'china'; var AttackMap = function(config)&#123; this.config = U.extend(&#123; view: MAP_TYPE_WORLD &#125;, config); this.el = document.getElementById(this.config.id); // åˆå§‹åŒ–echarts this._init(); &#125;; // ä¸å¸¦ä¸‹åˆ’çº¿çš„ä¸ºå¯¹å¤–æš´éœ²çš„æ–¹æ³• AttackMap.prototype = &#123; _init: function()&#123; // _chartå¯¹è±¡ç§æœ‰ this._chart = EC.init(this.el); // default view var mapOption = U.extend(&#123;&#125;, require('mods/attackMap/mapOption')); // åˆå¹¶option U.extend(mapOption.series[0], this._getViewOption(this.config.view)); // render this._chart.setOption(mapOption); // äº¤äº’ this._bindEvents(); &#125;, _bindEvents: function()&#123; var that = this; this._chart.on(EVENT.CLICK, function(e, chart)&#123; // ä»…å¯¹ä¸­å›½é’»å– if(e.data.name === 'ä¸­å›½' || e.data.name === 'China')&#123; that.setView(MAP_TYPE_CHINA); &#125; // andä¸­å›½çœä»½é’»å– else if(e.data.name in ecMapParams)&#123; that.setView(e.data.name); &#125; &#125;); &#125;, // viewæ¶‰åŠåˆ°çš„seriesé‡Œéœ€è¦è®¾ç½®çš„å±æ€§ _getViewOption: function(viewType)&#123; if(viewType === MAP_TYPE_WORLD)&#123; return &#123; mapType: MAP_TYPE_WORLD, nameMap: require('geo/world/countryName') &#125; &#125; else if(viewType === MAP_TYPE_CHINA)&#123; return &#123; mapType: MAP_TYPE_CHINA &#125;; &#125; else if(viewType in ecMapParams)&#123; return &#123; mapType: viewType &#125;; &#125; return &#123;&#125;; &#125;, _setOtherOption: function(viewType)&#123; if(viewType === MAP_TYPE_WORLD)&#123; this._chart.chart.map.series[0].itemStyle.normal.label.show = false; this._chart.chart.map.series[0].markLine.effect.period = 15; &#125; else if(viewType === MAP_TYPE_CHINA)&#123; this._chart.chart.map.series[0].itemStyle.normal.label.show = false; this._chart.chart.map.series[0].markLine.effect.period = 8; &#125; else&#123; this._chart.chart.map.series[0].itemStyle.normal.label.show = true; this._chart.chart.map.series[0].markLine.effect.period = 4; &#125; &#125;, // è®¾ç½®åœ°å›¾è§†å›¾ setView: function(viewType)&#123; // ä¸Šä¸€æ¬¡çš„view (typeof this._lastView === 'undefined') &amp;&amp; (this._lastView = this.config.view); // é˜²æ­¢é‡å¤set if(viewType === this._lastView)&#123; return false; &#125; this._lastView = viewType; // å†å²å¼€è¿‡çš„viewï¼ˆstringé€—å·åˆ†éš”ï¼‰ (typeof this._historyViews === 'undefined') &amp;&amp; (this._historyViews = this.config.view); // ç”¨æ¥åˆ¤æ–­æ˜¯å¦åŠ è½½è¿‡ if(this._historyViews.indexOf(viewType) === -1)&#123; this._historyViews += (',' + viewType); // loading this._chart.showLoading(); // å‡loading var that = this; setTimeout(function()&#123; that._chart.hideLoading(); &#125;, 350); &#125; // è¦å…ˆresetå†draw this.reset(); var viewOption = this._getViewOption(viewType); this._chart.setSeries([viewOption]); // å¤šçº§çš„optionæ²¡æ³•mergeåŸæ¥çš„ï¼Œæ‰€ä»¥å¾—æ‰‹åŠ¨è®¾ç½® this._setOtherOption(viewType); &#125;, // æ”»å‡»çº¿ setAttacks: function(data, isLoop)&#123; // æ˜¯å¦å¾ªç¯æ˜¾ç¤ºmarklineï¼ˆæš‚æœªç”¨åˆ°ï¼‰ isLoop = isLoop || true; // ç•™ä¸ªdataå¤‡ä»½ï¼ˆæš‚æœªç”¨åˆ°ï¼‰ this._mData = data; // TODO: è¦å¯¹IPèšåˆ // å›½å†…æœ€å°å®šä½åˆ°å¸‚çº§ï¼Œå›½å¤–åªèƒ½å®šä½åˆ°å›½å®¶ // è€Œmarklineåªèƒ½é€šè¿‡ name-name æ¥æ ‡è¯† // èšåˆåç›¸åŒ name-name çš„æ”»å‡»ç´¯è®¡æ¬¡æ•°è§†ä¸ºå¼ºåº¦ var lineData = U.map(data, function(v)&#123; return [ &#123;name: v['srcName'], geoCoord: [v['srcLocX'], v['srcLocY']]&#125;, &#123;name: v['destName'], geoCoord: [v['destLocX'], v['destLocY']]&#125; ] &#125;); var pointData = U.map(data, function(v)&#123; return &#123; name: v['destName'], geoCoord: [v['destLocX'], v['destLocY']] &#125; &#125;); // EChartså†…éƒ¨çš„æ ¸å¿ƒå˜é‡ var _map = this._chart.chart.map; // é˜²æ­¢addMarkLineæŠ›å¼‚å¸¸ seriesIndex 0 // _map.buildMark(0); try&#123; this._chart.addMarkLine(0, &#123;data: lineData&#125;); &#125;catch(e)&#123; // console.error(e); &#125; try&#123; this._chart.addMarkPoint(0, &#123;data: pointData&#125;); &#125;catch(e)&#123; // console.error(e); &#125; &#125;, // é€šç”¨æ–¹æ³• refresh: function()&#123; this._chart.refresh(); &#125;, reset: function()&#123; this._chart.restore(); &#125; &#125;; return AttackMap;&#125;); è¿™é‡Œæˆ‘ç”¨echartsä¸­çš„MarkLineä½œä¸ºæ”»å‡»çº¿ï¼ŒMarkPointä½œä¸ºå—å®³åœ°ç‚¹ï¼ŒAttackMapå°è£…äº†å¯¹echartsçš„æ“ä½œè¿‡ç¨‹ï¼Œå¯¹å¤–åªæš´éœ²setViewå’ŒsetAttacksä¸¤ä¸ªæ–¹æ³•ï¼Œä»¥å®ç°åœ°å›¾ç»´åº¦çš„ç¼©æ”¾ä»¥åŠæ”»å‡»çº¿çš„è¡¨ç°ã€‚å…¶ä¸­echarts mapçš„é€šç”¨é…ç½®é¡¹éƒ½æ‹åˆ°äº†mods/attactMap/mapOption.jsä¸­ï¼Œè¿™é‡ŒAttackMapåªæ‰‹å·¥æ“ä½œéƒ¨åˆ†optionï¼Œæ¯”å¦‚æ ¹æ®åœ°å›¾çš„ç»´åº¦ä¿®æ”¹MarkLineåŠ¨ç”»çš„é€Ÿç‡ã€‚ åº”ç”¨å±‚ js/app/mainMap.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778require([ 'jquery', 'mods/attackMap/main', 'mods/attackMap/mock'], function($, AttackMap, Mock)&#123; var View = &#123; // ä½œä¸ºä¸€ä¸ªè§†å›¾æ¨¡ç‰ˆæ¥åˆå§‹åŒ– init: function()&#123; // æ­¤Viewç‰‡æ®µçš„rootå…ƒç´  // this.$el = $('body'); // åˆå§‹åŒ–æˆå‘˜ this.aMap = new AttackMap(&#123; id: 'mapChart', view: 'world' &#125;); // ç»‘å®šäº‹ä»¶ this._bindEvents(); &#125;, _bindEvents: function()&#123; var that = this; // è§†å›¾åˆ‡æ¢ this._bindMapViewEvents(); // å…¶ä»–binding $(window).on('resize', function()&#123; that.aMap.resize(); &#125;); &#125;, // è§†å›¾åˆ‡æ¢äº‹ä»¶ _bindMapViewEvents: function()&#123; var that = this; // NOTE: ä¼šæœ‰åŠ¨æ€ç”Ÿæˆçš„å…ƒç´  $('.J_changeView').live('click', function()&#123; that.aMap.setView($(this).attr('data-type')); &#125;); &#125;, // æ”»å‡»æ•°æ®å±•ç° _renderAttacks: function(data)&#123; // render map this.aMap.setAttacks(data); // render table var $tbody = $('#attacksTable').find('tbody'); // var $frags = []; $.each(data, function(i, v)&#123; var $tr = $('&lt;tr&gt;&lt;td&gt;'+v['srcIp']+'&lt;/td&gt;&lt;td&gt;'+v['srcName']+'&lt;/td&gt;&lt;td&gt;'+v['destIp']+'&lt;/td&gt;&lt;td&gt;'+v['destName']+'&lt;/td&gt;&lt;td&gt;'+v['type']+'&lt;/td&gt;&lt;td&gt;'+v['time']+'&lt;/td&gt;&lt;/tr&gt;'); $tbody.append($tr); &#125;); &#125;, // è·å–æ”»å‡»æ•°æ® getAttacks: function()&#123; var that = this; // ajax TODO // æœ¬åœ°mockæ•°æ® that.attacksData = Mock.data; that._renderAttacks(that.attacksData); &#125; &#125;; // execution View.init(); // lazy load setTimeout(function()&#123; View.getAttacks(); &#125;, 16);&#125;); è‡³æ­¤ï¼Œåœ¨åº”ç”¨å±‚é¡µé¢ä¸Šï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡».J_changeViewæŒ‰é’®æ¥åˆ‡æ¢åœ°å›¾çš„ç»´åº¦(ä¸–ç•Œ/ä¸­å›½/çœä»½)ï¼Œæ”»å‡»æ•°æ®çš„å±•ç°æš‚æ—¶æ²¡æœ‰ajaxè°ƒç”¨ï¼Œåªæ˜¯ç®€å•ç”¨äº†mockæ•°æ®æ¥åšï¼Œå¤§ä½“æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ æœ€ç»ˆdemo è‡ªå®šä¹‰äº‹ä»¶å°è£…åœ¨ä¸Šé¢çš„demoé“¾æ¥ä¸­çœ‹åˆ°ï¼Œä¸ä»…åº”ç”¨å±‚é¡µé¢çš„æŒ‰é’®å¯ä»¥åˆ‡æ¢åœ°å›¾ç»´åº¦ï¼Œç›´æ¥ç‚¹å‡»åœ°å›¾é‡Œçš„â€ä¸­å›½â€åŒºåŸŸä¹Ÿèƒ½åˆ‡æ¢åœ°å›¾ï¼ŒåŒæ—¶åˆèƒ½é€šçŸ¥åˆ°åº”ç”¨å±‚é¡µé¢çš„æŒ‰é’®æ”¹å˜çŠ¶æ€ã€‚å› æ­¤åº”ç”¨å±‚é¡µé¢æ˜¯éœ€è¦å…³å¿ƒAttackMapçš„çŠ¶æ€(äº‹ä»¶)çš„ï¼ŒåŒæ ·å°†é¼ æ ‡æ”¾åœ¨æ”»å‡»çº¿ä¸Šå‡ºç°çš„æ”»å‡»è¯¦æƒ…ï¼Œä¹Ÿæ˜¯é€šè¿‡ç›‘å¬AttackMapçš„äº‹ä»¶å®ç°çš„ã€‚ 1ã€åœ¨ mods/attackMap/main.js ä¸­å®šä¹‰äº‹ä»¶ç±»å‹ 123456// å¯¹å¤–äº‹ä»¶AttackMap.EVENTS = &#123; VIEW_CHANGED: 'viewChanged', LINE_HOVERED: 'marklineHovered', LINE_BLURED: 'marklineBlured'&#125;; 2ã€åœ¨AttackMapä¸­å®ç°äº‹ä»¶è§¦å‘å™¨ 12345678910111213141516171819202122232425AttackMap.prototype = &#123; on: function(type, fn)&#123; (typeof this._handlers === 'undefined') &amp;&amp; (this._handlers = &#123;&#125;); (typeof this._handlers[type] === 'undefined') &amp;&amp; (this._handlers[type] = []); this._handlers[type].push(fn); &#125;, fire: function(type, data, event)&#123; if(typeof this._handlers === 'undefined' || typeof this._handlers[type] === 'undefined')&#123; return false; &#125; var that = this; var eventObj = &#123; type: type, data: data &#125;; // åŸç”Ÿeventå¯¹è±¡ (typeof event !== 'undefined') &amp;&amp; (eventObj.event = event); U.each(this._handlers[type], function(fn)&#123; fn(eventObj, that); &#125;); &#125;&#125;; 3ã€åœ¨AttackMapå†…éƒ¨é€‚å½“çš„æ–¹æ³•ä¸­fireè‡ªå®šä¹‰äº‹ä»¶ 1234567891011121314151617181920212223242526272829303132333435AttackMap.prototype = &#123; _bindEvents: function()&#123; var that = this; // çœç•¥... this._chart.on(EVENT.HOVER, function(e, chart)&#123; // æ˜¯markline if(e.name.indexOf('&gt;') !== -1)&#123; // é˜»æ­¢æ­¤æ—¶çš„tooltip that._chart.chart.map.component.tooltip.hideTip(); // ç”±å¤–éƒ¨å»æ¸²æŸ“ that.fire( AttackMap.EVENTS.LINE_HOVERED, &#123; name: e.name &#125;, e.event ); &#125; // ä¸æ˜¯marklineï¼Œå‘Šè¯‰å¤–éƒ¨ else&#123; // æ•ˆç‡æœ‰ç‚¹ä½ æ¯æ¬¡hoveréƒ½ä¼šè§¦å‘ that.fire(AttackMap.EVENTS.LINE_BLURED); &#125; &#125;); &#125;, setView: function(viewType)&#123; // çœç•¥... // å¯¹å¤–fireäº‹ä»¶ this.fire( AttackMap.EVENTS.VIEW_CHANGED, &#123; viewType: viewType &#125; ); &#125;&#125;; å½“è§¦å‘AttackMap.EVENTS.LINE_HOVEREDäº‹ä»¶æ—¶ï¼Œç”±äºåº”ç”¨å±‚é¡µé¢è¦ç»˜åˆ¶æ”»å‡»è¯¦æƒ…çš„æµ®å±‚ï¼Œéœ€è¦çŸ¥é“é¼ æ ‡ä½ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œfireæ—¶å°†åŸç”Ÿçš„eventå¯¹è±¡ä¹Ÿä¼ äº†è¿›å»ã€‚ï¼ˆæ³¨æ„fireæ–¹æ³•çš„å®ç°ä¸­ï¼Œä¼ ç»™å›è°ƒå‡½æ•°çš„eventObjå¯¹è±¡ä¸­ï¼Œæœ‰äº‹ä»¶ç±»å‹typeï¼Œè‡ªå®šä¹‰dataï¼Œä»¥åŠåŸç”Ÿeventå¯¹è±¡ï¼‰ 4ã€åœ¨åº”ç”¨å±‚jsä¸­ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// åˆ«åvar MAP_EVENTS = AttackMap.EVENTS;var View = &#123; // è§†å›¾åˆ‡æ¢äº‹ä»¶ _bindMapViewEvents: function()&#123; var that = this; // AttackMapç›‘å¬ this.aMap.on(MAP_EVENTS.VIEW_CHANGED, function(e)&#123; var type = e.data.viewType; // æ¸…ç©ºå½“å‰ $current = $('.view-nav.active'); $current.removeClass('active'); // ç›®æ ‡ var $target = $('.view-nav[data-type="' + type + '"]'); if($target.length == 0)&#123; // å¦èµ·ä¸€ä¸ª var $copy = $current.clone(); $copy.addClass('active').attr('data-type', type).text(type); $('#dynamicNav').empty().append($copy); &#125; else&#123; $target.addClass('active'); &#125; &#125;); // çœç•¥... &#125;, // æ”»å‡»çº¿(åœ°å›¾markline)äº‹ä»¶ _bindMapLineEvents: function()&#123; var that = this; this.aMap.on(MAP_EVENTS.LINE_HOVERED, function(e)&#123; // å‰æï¼šsrcName-destName å¿…é¡»èƒ½å”¯ä¸€åŒºåˆ† // å›½å¤–IPç›®å‰åªèƒ½å®šä½åˆ°å›½å®¶ var temps = (e.data.name).split(' &gt; '); var source = temps[0]; var dest = temps[1]; var attacks = that.attacksData; // éå†data for(var i=0; i&lt;attacks.length; i++)&#123; if(attacks[i]['srcName'] === source &amp;&amp; attacks[i]['destName'] === dest)&#123; that._drawMapLineDetail(attacks[i], e.event.pageX, e.event.pageY); break; &#125; &#125; &#125;); this.aMap.on(MAP_EVENTS.LINE_BLURED, function(e)&#123; that._hideMapLineDetail(); &#125;); &#125;, // ç”»æ”»å‡»çº¿è¯¦æƒ… _drawMapLineDetail: function()&#123; // ç»†èŠ‚çœç•¥... &#125;, _hideMapLineDetail: function()&#123; // ç»†èŠ‚çœç•¥... &#125;&#125;; å†çœ‹ä¸€édemo ç‚¹ç¼€çš„åŠ¨ç”»æ•ˆæœæ—¶é’Ÿæ¨¡å—æ¯”è¾ƒç®€å•ï¼Œæºç åœ¨ js/lib/mods/clock.js ä¸­ï¼Œä¸‹é¢åªåˆ—å‡ºå¤§ä½“ç»“æ„ã€‚ 12345678910111213141516171819202122232425262728293031define(['jquery'], function($)&#123; var Clock = function(config)&#123; this.$el = $('#' + this.config.id); this._init(); &#125;; Clock.prototype = &#123; _init: function()&#123; // ç»†èŠ‚çœç•¥... this.start(); &#125;, _update: function()&#123; // ç»†èŠ‚çœç•¥... &#125;, start: function()&#123; // å…ˆåˆå§‹åŒ–æ—¶é—´ this._update(); var that = this; this.timer = setInterval(function()&#123; that._update(); &#125;, 1000); &#125;, stop: function()&#123; clearInterval(this.timer); this.timer = null; &#125; &#125;; return Clock;&#125;); moveåŠ¨ç”»å°è£…åŸç†æ˜¯é‡‡ç”¨çš„cssä¸­transformåŠ¨ç”»ï¼Œæˆ‘ä»¬åŸæœ¬çš„åšæ³•ä¼šæ˜¯å…ˆå®šä¹‰ä¸¤ä¸ªcss classï¼Œä¸€ä¸ªæ·»åŠ transformçš„å„ç§cssè§„åˆ™ï¼Œå¦ä¸€ä¸ªclassæ·»åŠ ä¸å‰ä¸€é¡¹ç›¸å(æˆ–æ¸…é™¤åŠ¨ç”»)çš„cssè§„åˆ™ï¼Œç„¶åé€šè¿‡jsæ“æ§DOMå…ƒç´ ï¼Œåœ¨ä¸¤ä¸ªclassä¹‹é—´åˆ‡æ¢ã€‚ä½†æˆ‘è§‰å¾—è¿™ç§åšæ³•å¤ªæŒ«äº†ï¼Œå¯ä»¥æŠŠç›¸åŒæ•ˆæœçš„transformå°è£…èµ·æ¥ï¼ˆé¿å…å†™å¤§åŒå°å¼‚çš„css classï¼‰ï¼Œäºæ˜¯æˆ‘å°è£…äº†ä¸€ä¸ªåªåšmoveç§»åŠ¨çš„åŠ¨ç”»utilæ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283define(['jquery', 'underscore'], function($, U)&#123; return &#123; /* ç§»åŠ¨åŠ¨ç”» @param el &#123;HTMLElement&#125; @param x1 &#123;number&#125; @param y1 &#123;number&#125; @param x2 &#123;number&#125; @param y2 &#123;number&#125; @param config &#123;Object&#125; @param duration &#123;number&#125; @param ease &#123;string&#125; @param isShowEl &#123;boolean&#125; åŠ¨ç”»ç»“æŸåæ˜¯å¦ç»§ç»­æ˜¾ç¤ºå…ƒç´  @param isClear &#123;boolean&#125; åŠ¨ç”»ç»“æŸåæ˜¯å¦æ¸…é™¤åŠ¨ç”»å±æ€§ @param beforeAnim &#123;Function&#125; @param afterAnim &#123;Function&#125; */ moveAnim: function(el, x1, y1, x2, y2, config) &#123; if(!el)&#123; return; &#125; if(!el.tagName &amp;&amp; el.length)&#123; // jqueryèŠ‚ç‚¹ el = el[0]; &#125; var style = el.style; config = U.extend(&#123; duration: 400, ease: 'ease', isShowEl: true, isClear: false &#125;, config); style.display = 'block'; style.transform = 'translate3d(' + x1 + 'px, ' + y1 + 'px, 0px)'; style.transitionDuration = '0ms'; style.webkitTransform = 'translate3d(' + x1 + 'px, ' + y1 + 'px, 0px)'; style.webkitTransitionDuration = '0ms'; // before animation config.beforeAnim &amp;&amp; config.beforeAnim(); setTimeout(function() &#123; style.transform = 'translate3d(' + x2 + 'px, ' + y2 + 'px, 0px)'; style.transitionDuration = config.duration + 'ms'; style.transitionTimingFunction = config.ease; style.webkitTransform = 'translate3d(' + x2 + 'px, ' + y2 + 'px, 0px)'; style.webkitTransitionDuration = config.duration + 'ms'; style.webkitTransitionTimingFunction = config.ease; // ä¸‹é¢ä¸ä¼šæœ‰ç¬¬äºŒæ¬¡setTimeout if(config.isShowEl &amp;&amp; !config.isClear)&#123; // after animation config.afterAnim &amp;&amp; config.afterAnim(); &#125; &#125;, 0); // åŠ¨ç”»ç»“æŸåä¸æ˜¾ç¤ºå…ƒç´  if(!config.isShowEl)&#123; style.display = 'none'; &#125; // æ¸…ç©ºåŠ¨ç”»å±æ€§ï¼ˆä¸‹æ¬¡showæ—¶æ˜¾ç¤ºåœ¨æœ€åˆçš„ä½ç½®ï¼‰ if(!config.isShowEl || config.isClear)&#123; var that = this; setTimeout(function() &#123; that._clearTransform(el); // after animation config.afterAnim &amp;&amp; config.afterAnim(); &#125;, config.duration + 10); &#125; &#125;, _clearTransform: function(el)&#123; var style = el.style; style.transform = null; style.transitionDuration = null; style.transitionTimingFunction = null; style.webkitTransform = null; style.webkitTransitionDuration = null; style.webkitTransitionTimingFunction = null; &#125; &#125;&#125;); åŸºäºmoveåŠ¨ç”»çš„æ»šåŠ¨è¡¨æ ¼åœ¨demoä¸­å¯ä»¥çœ‹åˆ°å±å¹•ä¸‹æ–¹çš„æ”»å‡»æ•°æ®çš„è¡¨æ ¼ä¸€ç›´åœ¨æ»šåŠ¨æ’­æ”¾ï¼Œç°åœ¨å·²ç»å¾ˆå°‘äººè¿˜åœ¨ç”¨&lt;marquee&gt;è¿™ç§ä¸œè¥¿äº†ï¼Œå¥½æ¯”å·²ç»æ·˜æ±°çš„ç”¨&lt;table&gt;åšé¡µé¢å¸ƒå±€ã€‚æˆ‘è¿™é‡ŒåŸºäºä¸Šé¢çš„åŠ¨ç”»utilæ–¹æ³•ï¼Œå®ç°äº†ä¸€ä¸ªæ»šåŠ¨æ’­æ”¾çš„tableç»„ä»¶ã€‚ å®ç°æ€è·¯æ˜¯ï¼Œå…ˆè¦å¯¹tableå…ƒç´ åšé¢„å¤„ç†ï¼Œå°†theadæ‹·è´ä¸€ä»½ï¼Œå› ä¸ºè¡¨æ ¼æ»šåŠ¨æ—¶theadæ˜¯ä¸åŠ¨çš„(ç›¸å½“äºsticky)ã€‚ä»£ç ç»“æ„ç±»ä¼¼ä¸Šé¢çš„Clockç±»ï¼Œä¸»åŠ¨ç”»é€»è¾‘åŒ…åœ¨setIntervalä¸­ã€‚æ¯æ¬¡åŠ¨ç”»å¾ªç¯åˆ°æ¥æ—¶ï¼Œå–å‡ºtbodyçš„ç¬¬ä¸€ä¸ªtrå…ƒç´ çš„é«˜åº¦hï¼Œç„¶åå°†tableæ•´ä½“å‘ä¸Šmoveè¿™æ®µé«˜åº¦hï¼Œmoveç»“æŸåå°†ç¬¬ä¸€ä¸ªtrè¿½åŠ åˆ°tbodyçš„é˜Ÿå°¾ã€‚å…·ä½“å®ç°ä»£ç è§ js/lib/mods/animTable.js è¿˜æœ‰ä»€ä¹ˆæ¬ ç¼ºçš„æœ€åˆçš„å±•ç°éœ€æ±‚éƒ½å·²å®ç°äº†ï¼Œåœ¨è¿™è¿‡ç¨‹ä¸­å°è£…äº†AttackMapï¼Œå¹¶è‡ªå·±å®ç°äº†è‡ªå®šä¹‰äº‹ä»¶ï¼Œå®Œå…¨å°†echartså¯¹å¤–é€æ˜äº†ã€‚åŒæ—¶è¿˜äº§å‡ºäº†å‡ ä¸ªéä¸»è¦çš„jså°ç»„ä»¶ï¼Œè¿‡ç¨‹çœ‹ä¼¼æ‹‰çš„å¾ˆé•¿ï¼Œä½†éƒ½æ˜¯ä¸€æ­¥æ­¥è‡ªç„¶è€Œç„¶ä¼šäº§ç”Ÿçš„æƒ³æ³•ã€‚è¿™é‡Œè¿˜é—ç•™ç€ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•å°†htmlæ¨¡æ¿ã€æ ·å¼å’Œjsæ¨¡å—æ†ç»‘èµ·æ¥ï¼Œå³åªéœ€reuqireä¸€ä¸‹æ¨¡å—ï¼Œæ¨¡å—ç›¸åº”çš„cssä¼šä¸€å¹¶è½½å…¥ã€‚ 1234567891011&lt;!-- ä¸éœ€è¦ &lt;link rel="stylesheet" href="moduleA.css"&gt; --&gt;&lt;div&gt; &lt;!-- å¼•å…¥ç»„ä»¶çš„htmlæ¨¡æ¿ --&gt; %&#123; require moduleA &#125;%&lt;/div&gt;&lt;script&gt;require(['mods/moduleA'], function(A)&#123; // something...&#125;);&lt;/script&gt; æˆ‘æƒ³è¾¾åˆ°çš„æ•ˆæœå°±åƒä¸Šé¢ï¼Œåº”ç”¨å±‚é¡µé¢ä¸éœ€è¦å¼•ç»„ä»¶æ¨¡å—çš„cssï¼Œåªè¦inclueä¸€ä»½htmlæ¨¡æ¿ï¼Œrequireä¸€ä¸‹å¯¹åº”çš„jsæ¨¡å—ã€‚æœ‰çŸ¥é“å…·ä½“åšæ³•çš„å—ï¼Œæˆ‘æƒ³è¿›ä¸€æ­¥äº¤æµã€‚ demo åœ¨çº¿demo demoæºç  æ„Ÿæƒ³ åœ¨ç¹å¿™çš„é¡¹ç›®ä¸­æŠ½å‡ºæ—¶é—´åšäº›æ•´ç†å’Œæ€»ç»“ï¼Œæ˜¯ä»¶é‡è¦ä½†ä¸ç´§æ€¥çš„äº‹æƒ…ã€‚ å’Œä»¥å‰å†™çš„æ–‡ç« ä¸€å¯¹æ¯”ï¼Œæ˜æ˜¾æ„Ÿè§‰åˆ°è‡ªå·±è¿™åŠå¹´å¤šçš„æˆé•¿ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>AMD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iWebå—äº¬2015å³°ä¼šç¬”è®°]]></title>
    <url>%2Fblog%2F2015%2F11%2Fiweb-nanjing-notes.html</url>
    <content type="text"><![CDATA[è§¦å±ç‰ˆå‰ç«¯é‡æ„åŒ–ä¹‹è·¯è‹å® - æœ±æµ·æº H5æ³›æŒ‡è§¦å±ç‰ˆï¼Ÿï¼ˆæˆ‘è§‰å¾—æ˜¯ä¸€ç§äº¤äº’å’Œè·¨ç»ˆç«¯çš„ç†å¿µï¼‰ åŸç”Ÿå®ç°çš„åŒå‘ç»‘å®š Object.defineProperty å‰åç«¯ç—›ç‚¹ å‰åç«¯äº¤å‰å¼€å‘ï¼Œåç«¯ä¼šè§¦ç¢°åˆ°å‰ç«¯çš„jsæ–‡ä»¶ å‰ç«¯æä¾›çš„é™æ€èµ„æºè¢«åç«¯éšæ„æ”¾ç½® åŒæ–¹è”è°ƒä¸¥é‡ä¾èµ–åç«¯ç¯å¢ƒ åç«¯å¼€å‘ä¸çˆ±æ´—å¤´å‘ å°è¯•åŠæ³• jsæ§åˆ¶æƒç§»äº¤å‰ç«¯ï¼Œå‰ç«¯æ‰¿æ¥jsä¸šåŠ¡é€»è¾‘ é™æ€èµ„æºç®¡ç†æƒå®Œå…¨ç§»äº¤å‰ç«¯ æ­å»ºå‰ç«¯é¢„è§ˆç¯å¢ƒ ï¼ˆä»–ä»¬åªéœ€è£…ä¸ªtomcatï¼‰ é‡æ„ä¹‹è·¯ å…¬ç”¨ view.js view.css â€“&gt; çš®è‚¤ æ•°æ®æ¥å£åŒ– â€“&gt; å‰åç«¯åˆæ­¥åˆ†ç¦» æ ¸å¿ƒé¡µé¢å…¼é¡¾SEO â€“&gt; å…³é”®æ•°æ®æºç è¾“å‡º å¯æŒç»­ç»´æŠ¤çš„å‰ç«¯ç”Ÿæ€åœˆç„¦ç‚¹ç½‘ - æ²ˆé˜³ é¡¹ç›®æ¼”åŒ– åˆ†ä¸ºCommonå’ŒApp ç»„ä»¶ä»£ç å’Œç¬¬ä¸‰æ–¹ä»£ç å…¨éƒ¨ç§»åˆ°Commonä¸­ CommonåŒ…å«ï¼šç»„ä»¶ä»£ç ã€ç¬¬ä¸‰æ–¹ä»£ç ã€å…¨ç«™å…±ç”¨ä»£ç ã€å…¨ç«™å…±ç”¨ä¸šåŠ¡ä»£ç  AppåªåŒ…å«ä¸šåŠ¡ä»£ç å’Œåº”ç”¨ç§æœ‰å…±ç”¨ä»£ç  Appä¸Appä¹‹é—´ä¸èƒ½å­˜åœ¨ä»£ç ä¾èµ–å…³ç³»ï¼ å¥½çš„ä¹ æƒ¯ åœ¨æ¯ä¸ªå°è£…çš„ä¸€å¼€å§‹å†™ä¸€æ®µç©ºç™½çš„å‡½æ•°ï¼Œä½œä¸ºæ³¨é‡Š å¼€å‘å·¥å…· webstorm sublime intellij F5/browser-sync, markman webå‰åç«¯å®è·µå’Œæ¢ç´¢ï¼šèåˆoråˆ†ç¦»YOHO - å‘¨å¥‡çª webå¼€å‘ç—›ç‚¹ é¢‘ç¹çš„å˜æ›´éœ€æ±‚ ä»£ç è´¨é‡æŠŠæ§ æ— å¤„ä¸åœ¨çš„ä¸šåŠ¡é€»è¾‘ å„ç§å…¼å®¹ é‡å¤çš„éƒ¨åˆ† åº”å¯¹æ–¹æ³• ç•Œå®šå‰åç«¯åˆ‡é¢ï¼ˆæ¥å£æ ‡å‡†åŒ–ï¼‰ å‰åç«¯èŒè´£åˆ†ç¦»ï¼ˆèŒèƒ½ä¸“ä¸šåŒ–ï¼‰ ç»„ä»¶åŒ–ï¼ŒæœåŠ¡åŒ–ï¼Œæ¨¡å—åŒ– ä¾èµ–ç®¡ç†ï¼Œåˆ‡é¢æ²»ç†ï¼ˆJavaæœ‰AOPï¼Œå‰ç«¯ä¹Ÿèƒ½å®ç°ç±»ä¼¼çš„æ¦‚å¿µï¼‰ å®è·µæ–¹å¼ æœåŠ¡æ¥å£å®šä¹‰ é¡µé¢æµè®¾è®¡ï¼ˆè·¯ç”±ï¼‰ ç»„ä»¶åŒ–å¼€å‘å’Œä½¿ç”¨ é›†æˆæœåŠ¡ ç”¨äº†å“ªäº›è½®å­ spm sea.js handlebars gulp nodejs compass yo framework åˆ†ç¦»ä»€ä¹ˆ å‰ç«¯èƒ½åŠ›å°è£… æ ‡å‡†åŒ–çš„ç»„ä»¶ é€šç”¨å¼€å‘æ¨¡å¼ å¼€ç®±å³ç”¨çš„æµç¨‹åŒ–å·¥å…·ï¼ˆæ¡©æœåŠ¡ç”Ÿæˆï¼‰ å‰ç«¯åˆ‡é¢çš„åˆ†ç¦»ï¼ˆæ•°æ®ï¼Œç»“æ„ï¼Œæ ·å¼ï¼Œè¡Œä¸ºï¼‰ å•å…ƒæµ‹è¯•ï¼Œç«¯å¯¹ç«¯æµ‹è¯• åç«¯æœåŠ¡å°è£… æ ‡å‡†çš„æ•°æ®æºï¼ˆåŸºäºèµ„æºï¼ŒåŸºäºæœåŠ¡ï¼‰ æ ‡å‡†çš„å¢åˆ æ”¹æŸ¥çš„è¡Œä¸ºå°è£…ï¼ˆRESTfulï¼‰ æµç¨‹åŒ–çš„å®¢æˆ·ç«¯å·¥å…·ï¼ˆæœåŠ¡è°ƒè¯•ï¼ŒéªŒè¯ï¼ŒæœåŠ¡æ–‡æ¡£ç”Ÿæˆï¼‰ å·²æœ‰çš„é¡¹ç›® ç»„ä»¶åŒ–ï¼šReactï¼ŒPolymerï¼ŒWebComponents å¼€å‘æ¨¡å¼ï¼šMVCï¼ŒMVVMï¼ŒFLUX åº”ç”¨æ¡†æ¶ï¼šangularï¼Œvuejsï¼ŒEmber.js æœåŠ¡æ ‡å‡†ï¼šRESTfulï¼ŒGraphQLï¼ŒJSON APIï¼Œjson-schema å¼€ç®±å³ç”¨å·¥å…·ï¼šGulpï¼ŒYeomanï¼Œmochaï¼Œjsmineï¼Œwebpackï¼Œswaggerï¼Œjslintï¼Œbabelï¼ŒdomJS èåˆä»€ä¹ˆ å¯¹å‰åç«¯æ ‡å‡†çš„å…±è¯†ï¼ˆæœåŠ¡ï¼Œç»„ä»¶ï¼Œåˆ‡é¢ï¼‰ ä¸šåŠ¡å¼€å‘çš„èåˆï¼ˆä¸šåŠ¡ç†è§£æ›´é€å½»ï¼‰ å·¥ç¨‹åŒ–çš„èåˆï¼ˆå¼€å‘è¿‡ç¨‹ï¼Œå¼€å‘å·¥å…·ï¼Œç³»ç»Ÿè§„èŒƒï¼‰ Androidæ’ä»¶æ¶æ„åŸç†é€”ç‰› - æ±ªäº®äº® é—®é¢˜ï¼šæ–¹æ³•æ•°çˆ†æ£š 65535 è§£æ³•ï¼šæ‹†åˆ†classes.dexæ–‡ä»¶ æ’ä»¶åŸç† ä¸»appæ˜¯ä¸€ä¸ªapk æ¯ä¸ªæ¨¡å—éƒ½ä½œä¸ºä¸€ä¸ªå­appï¼Œéƒ½æœ‰å•ç‹¬çš„apk æ¯ä¸ªå›¢é˜Ÿå¼€å‘è‡ªå·±çš„å­apk ä¸»apké‡Œå®ç°æŒ‰éœ€åŠ è½½ï¼Œç¼©å°è‡ªèº«ä½“ç§¯ canvasèŠ±å¼ç©æ³•åŒç¨‹ - å¼ æ‰¬ canvasç©æ³• ç”»å›¾åƒ drawImage å›¾åƒå¤„ç†ï¼Œå¦‚é«˜æ–¯æ¨¡ç³Šï¼Œæ»¤é•œ canvasä¸€æ ·å¯ç»˜åˆ¶DOMç»“æ„ï¼Œæ ·å¼ã€äº‹ä»¶ã€DOMæ“ä½œ è§†é¢‘ä¸­äººç‰©å’ŒèƒŒæ™¯çš„å åŠ  èå…¥é¡µé¢èƒŒæ™¯çš„å¤æ‚åŠ¨ç”»ï¼ˆæ— æ³•ç”¨csså®ç°ï¼‰ videoæ ‡ç­¾ä¸€å®šä¼šæœ‰è‡ªå·±çš„èƒŒæ™¯åŒºåŸŸï¼Œæ— æ³•å°†èƒŒæ™¯é€æ˜ åˆ¶ä½œä¸€ä¸ªåŠ¨ç”»çš„è§†é¢‘ å†æå–å¸¦Î±é€šé“çš„åŠ¨ç”»è§†é¢‘ ä¸¤è€…å åŠ ï¼Œè¿ç”¨PSä¸­è’™ç‰ˆçš„æ¦‚å¿µï¼Œå°†è’™ç‰ˆä¸­éç™½è‰²çš„åŒºåŸŸå åŠ æˆé€æ˜ ç±»ä¼¼cssä¸­çš„mask canvasä¼˜åŠ¿ åªæ¶ˆè€—CPUç»˜åˆ¶è¿‡ç¨‹ï¼Œä½†é¡µé¢ä¸­åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯”èµ·SVGæœ‰ä¸€å †èŠ‚ç‚¹ï¼Œä¼šèŠ‚çº¦å†…å­˜ æ¯”èµ·svgé‡Œçš„pathï¼Œcanvasç»˜åˆ¶ä¸ä¼šæœ‰æ¯›è¾¹ï¼Œæ”¾å¤§æ—¶ å¯ä»¥æœ‰æ•ˆåˆ©ç”¨GPUåŠ é€Ÿ ç°åœ¨åœ°å›¾ç±»çš„ç»˜åˆ¶éƒ½æ”¹æˆcanvasäº† Reacté­”æ–¹-å¯è§†åŒ–å»ºç«™åƒç±³ç½‘ - æ¨æ™“ä¸œ ä¸šåŠ¡ç—›ç‚¹ åŒæ ·çš„åŠŸèƒ½ ä¸åŒçš„DOM UED + å‰ç«¯ å¼€å‘åè°ƒé—®é¢˜ï¼ˆä¸»è¦å› ä¸ºæœ‰äº›å…¬å¸UEDåšé™æ€é¡µé¢ï¼Œå‰ç«¯åšjsåŠ¨æ€éƒ¨åˆ†ï¼Œæœ‰å¯èƒ½æŠŠDOMç»“æ„æ”¹äº†ï¼‰ åšé‡å¤åŠŸèƒ½æ—¶ï¼Œä¹ æƒ¯æ€§ Ctrl+C Ctrl+V è·¨é¡¹ç›®é‡ç”¨ ä¸šåŠ¡å¤æ‚é¡µé¢ä»£ç è‡ƒè‚¿ åˆå¹¶ä»£ç è¿‡ç¨‹ç—›è‹¦ ä¸Šçº¿åå†å¤„ç†é—®é¢˜ Reactä¼˜åŠ¿ Reactçš„å¼ºé¡¹æ˜¯viewï¼Œå¼ºè°ƒç»„ä»¶åŒ–ï¼ˆé¡µé¢ä¸­çš„æ¯å—éƒ½å¯ä»¥å°è£…æˆè‡ªå·±çš„æ ‡ç­¾ï¼Œå¦‚ &lt;ItemList&gt; &lt;Item&gt;ï¼‰ Reactä¸ºä»€ä¹ˆæ¸²æŸ“å¿« virtual DOMå’Œdiffç®—æ³• ä½†æ˜¯ç»„ä»¶ä¸Šä½åç»„ä»¶ä¹‹é—´çš„é€šä¿¡æˆä¸ºç“¶é¢ˆ æ•°æ®æ€ä¹ˆåœ¨ç»„ä»¶ä¹‹é—´æµè½¬ï¼Œæ€ä¹ˆå¤„ç†çŠ¶æ€ Reactæœ¬èº«æ— çŠ¶æ€ï¼Œæ‰€ä»¥æ›´ç®€å• æ ¹æ®ä¼ å…¥çš„çŠ¶æ€ï¼Œæ˜¾ç¤ºç›¸åº”çš„æ¸²æŸ“ å‰åä¸¤æ¬¡ä¼ å…¥çš„çŠ¶æ€ç›¸åŒæ—¶ï¼Œä¸ä¼šå†æ¬¡æ¸²æŸ“ shouldComponentUpdate å¯è‡ªå·±æ§åˆ¶ æ¨èå·¥å…· flux å•å‘ç»‘å®šçš„æ€æƒ³ immutable iflux æ¢ç´¢å°†immutable.jså’Œreact.jsæ›´å¥½ç²˜åˆçš„ä¸€ç§æ–¹æ¡ˆ æ€»ç»“è¿™æ¬¡æœ‰å¹¸å‚åŠ å…è´¹çš„iWeb HTML5å³°ä¼šï¼Œæ€»ä½“ä¸Šå’Œä¹‹å‰QConä¸Šçš„å‰ç«¯ä¸»é¢˜ç±»ä¼¼ï¼Œå„å…¬å¸éƒ½åœ¨åšç§»åŠ¨ç«¯ä»¥åŠå·¥ç¨‹åŒ–æ–¹é¢çš„æ¢ç´¢å’Œèåˆã€‚è®©æˆ‘éœ‡æ’¼çš„æ˜¯å¾ˆå¤šå°å…¬å¸ä¸€æ ·æœ‰å‰å®³çš„äººå’Œå›¢é˜Ÿï¼Œå¤§å…¬å¸åœ¨åšçš„æ–°æŠ€æœ¯çš„å°è¯•å’Œåº”ç”¨ï¼Œå°å…¬å¸åŒæ ·ä¹Ÿåœ¨åšï¼Œæ¯”å¦‚Reactå’ŒNativeçš„èåˆï¼Œä»¥åŠReactåœ¨CMSç±»æ­å»ºç³»ç»Ÿä¸­çš„åº”ç”¨ã€‚ä½†æ˜¯å°å…¬å¸ç”±äºäººå‘˜æ°´å¹³å±‚æ¬¡ä¸é½ï¼Œè€ƒè™‘åˆ°åæœŸç»´æŠ¤çš„å­¦ä¹ æˆæœ¬ï¼Œå¾ˆå¤šæŠ€æœ¯æ²¡æ³•åœ¨å®é™…çš„ä¸šåŠ¡ä¸­æ¨åŠ¨èµ·æ¥ã€‚]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”±å¼¹å‡ºå±‚å¼•å‘å¯¹æ»šåŠ¨åŸç†çš„è®¨è®º]]></title>
    <url>%2Fblog%2F2015%2F10%2Fpopup-scroll-tricks.html</url>
    <content type="text"><![CDATA[ä¸Šä¸€ç¯‡ä¸ºäº†è§£é‡Šç§»åŠ¨ç«¯webçš„äº‹ä»¶å’Œç‚¹å‡»ç©¿é€é—®é¢˜ï¼Œæˆ‘åšäº†ä¸€ä¸ªå¼¹å‡ºæ¡†åšä¾‹å­ï¼Œè§demoã€‚ç°åœ¨è¯·æŠŠå…³æ³¨ç‚¹è½¬ç§»åˆ°å¼¹å‡ºå±‚æœ¬èº«ä¸Šæ¥ï¼Œæˆ‘ä½¿ç”¨fixå®šä½å°†å®ƒå®šåœ¨å±å¹•ä¸­é—´ï¼Œæ»šåŠ¨å±å¹•æ—¶å‘ç°é—®é¢˜æ²¡æœ‰ï¼Œåº•å±‚å…ƒç´ è¿˜æ˜¯åœ¨æ»šåŠ¨ï¼Œåªæ˜¯å¼¹å‡ºå±‚åœ¨å±å¹•æ­£ä¸­é—´è€Œä¸”å‘¨å›´æœ‰é®ç½©ã€‚æ‰€ä»¥æˆ‘ä»¬å°±â€œæ»šåŠ¨â€è¿™ä»¶äº‹è¯¦ç»†è¯´è¯´ï¼Œå¯èƒ½å­˜åœ¨å“ªäº›æ»šåŠ¨éœ€æ±‚ã€‚ é¡µé¢æ»šåŠ¨åŸç†åœ¨PCä¸Šç½‘é¡µæ»šåŠ¨ä¸»è¦é é¼ æ ‡æ»šè½®ï¼Œå…¶æ¬¡æŒ‰â€œä¸Šâ€â€œä¸‹â€é”®ä¹Ÿèƒ½æ»šåŠ¨é¡µé¢ï¼Œè¿˜å¯ä»¥æŒ‰â€œç©ºæ ¼â€â€œPage Down/Upâ€ä»¥åŠâ€œHOMEâ€é”®ï¼Œæˆ–è€…ç›´æ¥ç‚¹å‡»æˆ–æ‹–åŠ¨æ»šåŠ¨æ¡ä¹Ÿèƒ½æ»šåŠ¨é¡µé¢ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥åšä¸ªå®éªŒï¼Œçœ‹è¿™äº›äº‹ä»¶çš„å‘ç”Ÿé¡ºåºæ˜¯æ€æ ·çš„ã€‚ 1234567891011121314151617document.addEventListener('scroll', function()&#123; alert('document scroll');&#125;);window.addEventListener('scroll', function()&#123; alert('window scroll');&#125;);window.addEventListener('mousewheel', function()&#123; alert('window mousewheel');&#125;);window.addEventListener('keydown', function(e)&#123; if(37 &lt;= e.keyCode &amp;&amp; e.keyCode &lt;= 40 || e.keyCode == 32)&#123; alert('keydown ' + e.keyCode); &#125;&#125;); å¯ä»¥å¾—çŸ¥ï¼Œå½“é€šè¿‡é¼ æ ‡æ»šè½®æ—¶ï¼Œmousewheeläº‹ä»¶ä¼šå…ˆè§¦å‘ï¼Œç„¶åæ‰æ˜¯scrollã€‚è€Œäº‹ä»¶çš„listeneré»˜è®¤æ˜¯éµå¾ªå†’æ³¡çš„ï¼Œæ‰€ä»¥ç»‘åœ¨documentä¸Šçš„å‡½æ•°ä¼šå…ˆè§¦å‘ï¼Œç„¶åæ‰æ˜¯windowä¸Šçš„ã€‚åŒç†ï¼Œå½“é€šè¿‡æŒ‰ç‰¹å®šçš„é”®å»æ»šåŠ¨é¡µé¢æ—¶ï¼Œkeydownäº‹ä»¶ä¼šå…ˆè§¦å‘ï¼Œç„¶åä¹Ÿæ˜¯scrollã€‚ PCä¸Šæ²¡å•¥é—®é¢˜ï¼Œé‚£æ¥çœ‹çœ‹æ‰‹æœºç«¯çš„è¡¨ç°ã€‚ 123456789101112131415document.addEventListener('scroll', function()&#123; alert('document scroll');&#125;);document.addEventListener('touchstart', function()&#123; alert('document touchstart');&#125;);document.addEventListener('touchmove', function()&#123; alert('document touchmove');&#125;);document.addEventListener('touchend', function()&#123; alert('document touchend');&#125;); æŒ‰ç…§PCä¸Šç±»ä¼¼çš„é€»è¾‘ï¼Œä»¥åŠå‰ä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„touchäº‹ä»¶åŸç†ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çŒœå‡ºalerté¡ºåºæ˜¯ï¼štouchstart -&gt; touchmove -&gt; scroll -&gt; touchend ä½†è¿™æ˜¯äº‹ä»¶å‘ç”Ÿçš„é¡ºåºï¼Œå¹¶ä¸æ˜¯alertç»“æœçš„é¡ºåºã€‚å¯ä»¥æ‰«äºŒç»´ç çœ‹çœ‹ï¼Œè¿™ä¸ªalertå¾ˆè¯¡å¼‚çš„ã€‚ å½“æ…¢æ…¢æ»‘æ—¶ï¼Œåªä¼š alert touchstartï¼Œç„¶åå°±æ²¡æœ‰äº†ã€‚è€Œå¿«é€Ÿæ»‘æ—¶ï¼Œalert touchstart ç„¶å alert scrollã€‚è¿™æ˜¯å› ä¸ºalertæ¡†ä¼šé˜»å¡äº‹ä»¶å“åº”ï¼Œå½“touchstartåè¿˜æ²¡æ¥çš„åŠæ»‘åŠ¨å°±å·²ç»å¼¹å‡ºalertäº†ï¼Œæ•´ä¸ªäº‹ä»¶çº¿ç¨‹å°±è¢«ä¸­æ–­äº†ï¼Œæ‰€ä»¥å°±ä¸ä¼šå“åº”scrolläº†ã€‚è€Œå½“å¼¹å‡ºalertåç»§ç»­æ»‘åŠ¨ï¼ˆä»å¼€å§‹åˆ°ç°åœ¨æ‰‹æŒ‡å§‹ç»ˆä¸æ¾å¼€ï¼‰ï¼Œç„¶åå†æ¾å¼€æ‰‹æŒ‡ï¼Œæˆ‘ä»¬ä¼šå‘ç° alert touchstart ååˆ alert scrollã€‚ä¸ºä»€ä¹ˆalertåˆæ²¡ä¸­æ–­äº‹ä»¶çº¿ç¨‹å‘¢ï¼Ÿ æˆ‘ä»¬çŸ¥é“PCä¸Šçš„alertæ¡†æ˜¯ä¼šä¸­æ–­æ•´ä¸ªé¡µé¢çš„ï¼Œå³é™¤éä½ å…ˆç‚¹â€œç¡®å®šâ€ï¼Œå¦åˆ™é¡µé¢ä¸Šçš„ä»»ä½•æ“ä½œéƒ½æ˜¯æ— æ•ˆçš„ï¼Œå³æ•´ä¸ªç”¨æˆ·ç•Œé¢è¢«â€œå¡ä½â€äº†ã€‚è€Œåœ¨æ‰‹æœºä¸Šï¼Œç”±äºè§¦æ‘¸äº‹ä»¶çš„è¿è´¯æ€§ï¼Œæˆ‘çŒœæµ‹æ˜¯è¿™æ ·çš„ã€‚å½“æ‰‹æœºä¸Šå¼¹å‡ºalertæ—¶æ˜¯é˜»å¡å…¶ä»–äº‹ä»¶çš„ï¼Œä½†ç”±äºæ‰‹æŒ‡å§‹ç»ˆæ²¡æ¾å¼€ï¼Œæ‰€ä»¥æ•´ä¸ªè§¦æ‘¸è¿‡ç¨‹è¿˜åœ¨ç»§ç»­ã€‚ä¸€è¾¹æ˜¯alertçš„é˜»å¡æ€§ï¼Œä¸€è¾¹æ˜¯å‰ä¸€è½®çš„è§¦æ‘¸è¿‡ç¨‹è¿˜æœªç»“æŸï¼Œç”±äºjså•çº¿ç¨‹çš„ç‰¹æ€§ï¼Œæ‰€æœ‰äº‹ä»¶åœ¨ç”¨æˆ·ç•Œé¢ä¸Šçš„å“åº”éƒ½æ˜¯è¦è¿›å…¥é˜Ÿåˆ—å¤„ç†çš„ï¼Œç„¶åæ‰ä¼šåœ¨ç•Œé¢ä¸Šä½“ç°å‡ºæ¥ã€‚å› ä¸ºè§¦æ‘¸è¿‡ç¨‹æ˜¯å…ˆå‘ç”Ÿçš„ï¼Œå®ƒä»æœªç»“æŸï¼Œè€Œalertæ˜¯åå‘ç”Ÿçš„ï¼Œæ‰€ä»¥alertå¹¶ä¸èƒ½é˜»å¡å½“å‰è¿˜æœªç»“æŸçš„è§¦æ‘¸è¿‡ç¨‹ã€‚å› æ­¤åªè¦ä¸æ¾å¼€æ‰‹æŒ‡ï¼Œç»§ç»­æ»‘åŠ¨ï¼Œæœ€åå†æ¾å¼€æ‰‹æŒ‡ï¼Œalert touchstart åè¿˜ä¼š alert scrollã€‚ é‚£ä¹ˆè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¸ä¼š alert touchmove å’Œ alert touchend å‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­åšå®éªŒï¼Œä¾æ¬¡æŠŠ touchstart å’Œ touchmove çš„ alert è¯­å¥æ³¨é‡Šæ‰ï¼Œçœ‹çœ‹è¡¨ç°ç»“æœã€‚ 1234567891011document.addEventListener('touchstart', function()&#123; // alert('document touchstart');&#125;);document.addEventListener('touchmove', function()&#123; alert('document touchmove');&#125;);document.addEventListener('touchend', function()&#123; alert('document touchend');&#125;); å»æ‰ alert touchstart åå‘ç°åªå¼¹å‡º alert touchmoveï¼Œæˆ‘çŒœæµ‹æ˜¯å› ä¸º touchstart / touchmove / touchend éƒ½æ˜¯åœ¨åŒä¸€è½®è§¦æ‘¸è¿‡ç¨‹ä¸­çš„ï¼Œç”±äºalertçš„é˜»å¡æ€§ï¼Œå‰é¢è§£é‡Šäº†å®ƒå…è®¸å…ˆå‘ç”Ÿçš„è§¦æ‘¸ï¼ˆè¿˜æœªæ¾å¼€çš„æ‰‹æŒ‡ï¼‰ç»§ç»­touchï¼Œä½†æ˜¯ alert ä¼šé˜»å¡åŒä¸€è½®è§¦æ‘¸è¿‡ç¨‹çš„å…¶ä»–äº‹ä»¶çš„å“åº”å‡½æ•°ã€‚è€Œä¹‹æ‰€ä»¥alertå¼¹å‡ºåç»§ç»­æ»‘åŠ¨æ‰‹æŒ‡ï¼ˆå§‹ç»ˆä¸æ¾å¼€ï¼‰ï¼Œä»èƒ½çœ‹åˆ°é¡µé¢åœ¨æ»šåŠ¨ï¼Œè¿™æ˜¯å› ä¸ºè¿™æ˜¯æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œå¹¶ä¸”touchè¿‡ç¨‹çš„å‘ç”Ÿæ—¶åˆ»æ—©äºalertï¼Œæ‰€ä»¥åœ¨é˜Ÿåˆ—ä¸­alertæ²¡æ³•é˜»å¡å®ƒã€‚ ä»¥ä¸Šåªæ˜¯æˆ‘çš„çŒœæµ‹ï¼Œæœ‰è°çŸ¥é“å…·ä½“ç»†èŠ‚çš„è¯·å‘Šè¯‰æˆ‘~ æ‰‹æŒ‡ä¸æ¾å¼€æ—¶ï¼Œè¿™ä¸ªalertæ¡†çš„åº•å±‚æ»šåŠ¨é—®é¢˜æ­£å¥½ä¹Ÿè¿åˆäº†æœ¬æ–‡ä¸€å¼€å§‹è¯´çš„å¼¹å‡ºæ¡†demoï¼Œå¦‚æœæœ‰éœ€æ±‚è¯´å¼¹å‡ºæ¡†å‡ºç°æ—¶å¿…é¡»è®©å¤–éƒ¨ä¸èƒ½æ»šåŠ¨ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ æ»šåŠ¨ç¦ç”¨overflowæˆ‘ä»¬ç»å¸¸ä¼šå†™overflow: hiddenè¿™æ ·çš„csså»è®©å›ºå®šå°ºå¯¸çš„å…ƒç´ å†™æ­»ï¼Œè¿™æ ·å°±ç®—å®ƒçš„å­å…ƒç´ è¶…å‡ºäº†çˆ¶å®¹å™¨çš„å°ºå¯¸èŒƒå›´ï¼Œä¹Ÿä¸ä¼šâ€œæº¢å‡ºæ¥â€ã€‚å€Ÿè¿™ä¸ªé“ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨rootå…ƒç´ ä¸Šå†™æ­»ï¼Œè¿™æ ·bodyé‡Œé¢å°±ä¸ä¼šæº¢å‡ºå±å¹•äº†ï¼Œå°±ä¸ä¼šå‡ºç°æ»šåŠ¨æ¡äº†ã€‚ 123html, body&#123; overflow: hidden;&#125; ä½†éšä¹‹åˆå‡ºç°äº†å¦ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœé¡µé¢åŸæ¥æ˜¯æœ‰æ»šåŠ¨æ¡çš„ï¼Œåœ¨windowsä¸‹çš„æµè§ˆå™¨ä¸­æ»šåŠ¨æ¡æ˜¯ä¼šå æ®ä¸€å®šå®½åº¦çš„ï¼ˆchromeä¸‹æ˜¯17pxï¼Œfirefoxä¸‹å¯èƒ½æ˜¯13pxï¼‰ï¼Œä¼šè®©æ•´ä¸ªviewportçš„å®½åº¦å‡å°ä¸€æ®µï¼Œçœ‹èµ·å°±åƒé¡µé¢é‡Œçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å¾€å·¦åç§»ä¸€å°æ®µã€‚è€Œmacä¸‹æµè§ˆå™¨çš„æ»šåŠ¨æ¡æ˜¯æ‚¬æµ®åœ¨ä¸Šé¢çš„ï¼Œæ‰€ä»¥ä¸ä¼šå æ®é¡µé¢ä¸Šçš„ç©ºé—´ã€‚ è¿™æ ·çš„è¯ï¼Œwindowså°±å“­äº†ã€‚å‡è®¾é¡µé¢åŸæœ¬å°±æ˜¯æœ‰æ»šåŠ¨æ¡çš„ï¼Œå½“æˆ‘ä»¬æ‰“å¼€å¼¹å‡ºæ¡†æ—¶ï¼Œä¸ºäº†ç¦æ­¢æ»šåŠ¨ï¼Œrootå…ƒç´ è¢«åŠ ä¸Šoverflow: hiddenï¼Œæ»šåŠ¨æ¡æ¶ˆå¤±ï¼Œåº•å±‚æ‰€æœ‰å…ƒç´ å°±å‘å³åç§»ä¸€å°æ®µã€‚å…³é—­å¼¹å‡ºæ¡†æ—¶ï¼Œè¦è®©é¡µé¢æ¢å¤æ»šåŠ¨ï¼Œrootå…ƒç´ æ”¹æˆoverflow: autoï¼Œæ»šåŠ¨æ¡åˆå‡ºç°äº†ï¼Œåº•å±‚æ‰€æœ‰å…ƒç´ åˆå‘å·¦åç§»ä¸€å°æ®µã€‚æ•´ä¸ªä½“éªŒå¾ˆç³Ÿç³•ï¼ åŠæ³•å°±æ˜¯åœ¨overflow: hiddençš„åŒæ—¶é€šè¿‡padding-rightæŠŠæ»šåŠ¨æ¡çš„ç©ºé—´é¢„ç•™å‡ºæ¥ã€‚é‚£ä¹ˆå¦‚ä½•çŸ¥é“ä¸åŒæµè§ˆå™¨ä¸­æ»šåŠ¨æ¡åˆ°åº•å å¤šå®½å‘¢ï¼Ÿé€šå¸¸ç±»ä¼¼åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒæŸä¸ªcsså±æ€§æˆ–è€…æŸäº›å–å€¼ï¼Œè¿™ç§è·Ÿæµè§ˆå™¨ç¯å¢ƒç›¸å…³çš„é—®é¢˜ï¼ŒåŠæ³•å°±æ˜¯è¯•æ¢ã€‚ç”¨jsåŠ¨æ€ç”Ÿæˆä¸€ä¸ªå…ƒç´ ï¼ŒæŠŠä½ æƒ³æµ‹è¯•çš„å±æ€§æˆ–å€¼èµ‹åœ¨è¿™ä¸ªå…ƒç´ ä¸Šï¼Œç„¶åæŠŠå…ƒç´ appendåˆ°documentä¸­å»ï¼Œæœ€åå†é€šè¿‡jså»å–ç›¸åº”çš„å€¼ï¼Œçœ‹å®ƒåˆ°åº•è¡¨ç°å‡ºæ¥æ˜¯å•¥ã€‚ å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå¯ä»¥çŸ¥é“ æ»šåŠ¨æ¡å®½åº¦ = å…ƒç´ çš„offsetWidth - å…ƒç´ borderå æ®çš„2å€å®½ - å…ƒç´ çš„clientWidth ä¸Šé¢å…¬å¼çš„å‰ææ˜¯ï¼Œå…ƒç´ å…·å¤‡yè½´æ»šåŠ¨æ¡ã€‚è¿˜æœ‰ç§ç±»ä¼¼åŠæ³•æ˜¯ æ»šåŠ¨æ¡å®½åº¦ = ä¸å¸¦æ»šåŠ¨æ¡çš„å…ƒç´ çš„clientWidth - ä¸ºè¯¥å…ƒç´ åŠ ä¸Šyè½´æ»šåŠ¨æ¡åçš„clientWidth 123456789101112131415var getScrollbarWidth = function()&#123; if(typeof getScrollbarWidth.value === 'undefined')&#123; var $test = $('&lt;div&gt;&lt;/div&gt;'); $test.css(&#123; width: '100px', height: '1px', 'overflow-y': 'scroll' &#125;); $('body').append($test); getScrollbarWidth.value = $test[0].offsetWidth - $test[0].clientWidth; $test.remove(); &#125; return getScrollbarWidth.value;&#125;; è¿™æ˜¯æ ¹æ®ç¬¬ä¸€ç§è®¡ç®—æ–¹å¼å†™å‡ºçš„æ–¹æ³•ï¼Œæœ‰äº†è¿™ä¸ªå†é…åˆoverflowå°±èƒ½å®ç°é¡µé¢æ»šåŠ¨çš„ç¦ç”¨ä¸æ¢å¤äº†ã€‚è¯¦ç»†ä»£ç è§demo 1234567891011121314var disableScroll = function()&#123; // bodyä¸Šç¦ç”¨ $('body, html').css(&#123; 'overflow': 'hidden', 'padding-right': getScrollbarWidth() + 'px' &#125;);&#125;;var enableScroll = function()&#123; $('body, html').css(&#123; 'overflow': 'auto', 'padding-right': '0' &#125;);&#125;; æˆ‘ä»¬çœ‹çœ‹è¡¨ç°ç»“æœï¼šPCä¸Šå¾ˆOKï¼Œç®€å•æœ‰æ•ˆï¼›æ‰‹æœºä¸Šå®Œå…¨æ²¡åµç”¨ï¼ï¼ˆæˆ‘æ˜¯å®‰å“æœºï¼Œæ³¨æ„æ˜¯çœŸæœºä¸Šæ— æ•ˆï¼Œè€Œéchromeæ‰‹æœºæ¨¡æ‹Ÿå™¨ï¼‰ ç¦ç”¨äº‹ä»¶æ ¹æ®ä¸Šé¢é¡µé¢æ»šåŠ¨åŸç†æˆ‘ä»¬åšçš„å®éªŒï¼Œå¾ˆæ˜æ˜¾å¯ä»¥æŠŠæ»šåŠ¨æ¶‰åŠåˆ°çš„äº‹ä»¶å¹²æ‰ï¼Œè¿™æ ·å½“ç„¶ä¸ä¼šæ»šåŠ¨äº†ã€‚ 1234567891011121314151617181920212223242526272829303132// è®°å½•åŸæ¥çš„äº‹ä»¶å‡½æ•°ï¼Œä»¥ä¾¿æ¢å¤var oldonwheel, oldonmousewheel, oldonkeydown, oldontouchmove;var isDisabled;var disableScroll = function()&#123; oldonwheel = window.onwheel; window.onwheel = preventDefault; oldonmousewheel = window.onmousewheel; window.onmousewheel = preventDefault; oldonkeydown = document.onkeydown; document.onkeydown = preventDefaultForScrollKeys; oldontouchmove = window.ontouchmove; window.ontouchmove = preventDefault; isDisabled = true;&#125;;var enableScroll = function()&#123; if(!isDisabled)&#123; return; &#125; window.onwheel = oldonwheel; window.onmousewheel = oldonmousewheel; document.onkeydown = oldonkeydown; window.ontouchmove = oldontouchmove; isDisabled = false;&#125;; è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒæµè§ˆå™¨ä¸Šäº‹ä»¶åˆ°åº•åœ¨windowè¿˜æ˜¯documentä¸Šï¼ŒPCä¸Šä¼šæœ‰ä¸€äº›æµè§ˆå™¨å…¼å®¹å¤„ç†ã€‚è¯¦ç»†ä»£ç è§demo åŒæ ·çœ‹çœ‹è¡¨ç°ç»“æœï¼šPCä¸Šå¾ˆç²—æš´çš„è§£å†³äº†ï¼›æ‰‹æœºä¸Šä¹ŸOK å¼¹å‡ºå±‚æ»šåŠ¨éœ€æ±‚è‡³æ­¤æˆ‘ä»¬çœ‹åˆ°ï¼Œä½¿ç”¨overflowèƒ½å¤Ÿè§£å†³PCä¸Šçš„æ»šåŠ¨ç¦ç”¨é—®é¢˜ï¼Œè€Œç¦ç”¨ä¸æ»šåŠ¨ç›¸å…³çš„äº‹ä»¶èƒ½å¤Ÿå½»åº•è§£å†³PCå’Œæ‰‹æœºçš„é—®é¢˜ã€‚é‚£ä¹ˆæœ‰å¼¹å‡ºå±‚çš„è¯ï¼Œå°±åº”è¯¥ç¦ç”¨æ•´ä¸ªé¡µé¢çš„æ»šåŠ¨å—ï¼Œå¦‚æœå¼¹å‡ºå±‚å†…éƒ¨éœ€è¦æ»šåŠ¨æ€ä¹ˆåŠï¼Ÿå³æˆ‘ä»¬æœ‰å¯èƒ½é¢ä¸´è¿™æ ·çš„éœ€æ±‚ï¼šå¼¹å‡ºæ¡†çš„å†…éƒ¨æ˜¯å¯ä»¥æ»šåŠ¨çš„ï¼Œè€Œå¼¹å‡ºå±‚å¤–éƒ¨å’Œåº•å±‚å…ƒç´ æ˜¯ä¸èƒ½æ»šåŠ¨çš„ã€‚ å…ˆçœ‹overflowå‰é¢è¯´åˆ°ç»™rootå…ƒç´ å†™ä¸Šoverflow: hiddenå°±å¯ä»¥ç¦ç”¨æ»šåŠ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹å¼¹å‡ºå±‚è¿™ä¸ªå®¹å™¨é‡æ–°å†™ä¸ªoverflow: scrollå°±å¯ä»¥äº†ã€‚ 123#popupLayer&#123; overflow: scroll;&#125; PCä¸Šç®€å•æœ‰æ•ˆï¼Œä½†æ˜¯åŒæ ·æ‰‹æœºä¸Šä¸é¸Ÿè¿™äº›ã€‚è§demo äº‹ä»¶ç¦ç”¨ä¸æ¢å¤æˆ‘ä»¬æŠŠdocumentä¸Šçš„mousewheeläº‹ä»¶ç¦ç”¨äº†ï¼Œå³ç»™å®ƒç»‘ä¸Šäº†ä¸€ä¸ªäº‹ä»¶å‡½æ•°ï¼Œåªä¸è¿‡äº‹ä»¶å‡½æ•°é‡Œå°†äº‹ä»¶å‘ç”Ÿåçš„æµè§ˆå™¨é»˜è®¤è¡Œä¸ºé˜»æ­¢äº†ã€‚ 12345678910function preventDefault(e) &#123; e = e || window.event; e.preventDefault &amp;&amp; e.preventDefault(); e.returnValue = false;&#125;var disableScroll = function()&#123; $(document).on('mousewheel', preventDefault); $(document).on('touchmove', preventDefault);&#125;; äºæ˜¯æ€è·¯å°±æ¥äº†ï¼Œæˆ‘ä»¬çŸ¥é“æµè§ˆå™¨é‡Œçš„äº‹ä»¶æ˜¯éµå¾ªå†’æ³¡æœºåˆ¶çš„ï¼ˆå‡†ç¡®æ¥è¯´æ˜¯å…ˆä»rootèŠ‚ç‚¹ç”±å¤–å‘å†…â€œæ•è·â€ï¼Œç„¶ååˆ°è¾¾ç›®æ ‡å…ƒç´ åï¼Œäº‹ä»¶å†ç”±å†…å‘å¤–é€å±‚å†’æ³¡ï¼Œå…³äºè¿™ä¸ªæœºåˆ¶è¯·çœ‹è¿™ç¯‡æ–‡ç« çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä¸ºå¼¹å‡ºå±‚çš„å…ƒç´ å†ç»‘ä¸ªåŒæ ·çš„äº‹ä»¶ï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡åˆ°documentä¸Šï¼Œè¿™æ ·å°±ä¸ä¼šè°ƒç”¨åˆ°e.preventDefault()å°±ä¸ä¼šé˜»æ­¢æµè§ˆå™¨é»˜è®¤çš„æ»šåŠ¨è¡Œä¸ºäº†ã€‚ 123456789function preventDefault(e) &#123; e = e || window.event; e.preventDefault &amp;&amp; e.preventDefault(); e.returnValue = false;&#125;// å†…éƒ¨å¯æ»š$('#popupLayer').on('mousewheel', stopPropagation);$('#popupLayer').on('touchmove', stopPropagation); æ¥çœ‹ä¸‹demoï¼Œæ‰‹æœºä¸Šè¯·çœ‹ èƒŒæ™¯å±‚æ˜¯ä¸èƒ½æ»šåŠ¨çš„ï¼Œè€Œå¼¹å‡ºå±‚å¦¥å¦¥çš„å¯ä»¥æ»šåŠ¨äº†ï¼ä½†æ˜¯å‘ç°é—®é¢˜äº†ä¸ï¼Œå¼¹å‡ºå±‚å†…éƒ¨æ»šåŠ¨åˆ°åº•éƒ¨å†ç»§ç»­æ»šæ—¶ï¼Œä¼šå°†èƒŒæ™¯åº•å±‚çš„å…ƒç´ ä¸€èµ·æ»šä¸‹å»äº†ï¼Œè¿™å°¼ç›FUCK æ”¹è¿›çš„å†…éƒ¨æ»šåŠ¨è§£å†³é—®é¢˜çš„æ€è·¯å¾ˆæ¸…æ™°ï¼Œå°±æ˜¯åˆ¤æ–­æ»šåŠ¨è¾¹ç•Œï¼Œå½“æ»šåŠ¨åˆ°è¾¾bottomå’Œtopæ—¶ï¼Œå°±é˜»æ­¢æ»šåŠ¨å°±å¥½å•¦ã€‚ 12345678910111213141516171819202122232425function innerScroll(e)&#123; // é˜»æ­¢å†’æ³¡åˆ°document // documentä¸Šå·²ç»preventDefault stopPropagation(e); var delta = e.wheelDelta || e.detail || 0; var box = $(this).get(0); if($(box).height() + box.scrollTop &gt;= box.scrollHeight)&#123; if(delta &lt; 0) &#123; preventDefault(e); return false; &#125; &#125; if(box.scrollTop === 0)&#123; if(delta &gt; 0) &#123; preventDefault(e); return false; &#125; &#125; // ä¼šé˜»æ­¢åŸç”Ÿæ»šåŠ¨ // return false;&#125;$('#popupLayer').on('mousewheel', innerScroll); ä»£ç å¾ˆç®€å•ï¼Œå…³äºscrollTop scrollHeightç­‰è§£é‡Šè¯·çœ‹è¿™ç¯‡æ–‡ç« ã€‚è¿™é‡Œå”¯ä¸€è¦æ³¨æ„çš„æ˜¯å¯¹é¼ æ ‡æ»šåŠ¨å€¼wheelDeltaçš„è·å–å¯èƒ½è¦åšå…¼å®¹æ€§å¤„ç†ï¼Œå®åœ¨æœ‰é—®é¢˜çš„è¯å¯ä»¥ä½¿ç”¨jquery-mousewheelå»è·å–é¼ æ ‡çš„æ»šåŠ¨é‡ã€‚ ä¸Šé¢è¿™æ®µä»£ç æ˜¯PCä¸Šçš„åˆ¤æ–­æ»šåŠ¨è¾¹ç•Œçš„å¤„ç†ï¼Œé‚£æ‰‹æœºä¸Šåˆè¯¥æ€ä¹ˆåšçš„ï¼Œæ‰‹æœºä¸Šæ²¡æœ‰é¼ æ ‡ï¼Œå¦‚ä½•è·å–åˆ°æ»šåŠ¨é‡deltaï¼Ÿ IScrollçš„å¯å‘æˆ‘æƒ³èµ·â€œå±€éƒ¨æ»šåŠ¨â€ç•Œçš„å¤§ä½¬â€”â€”IScrollï¼Œå¯ä»¥å»çœ‹ä¸‹æºç ï¼Œç»†èŠ‚å¾ˆå¤æ‚ä½†æ˜¯å¤§ä½“ç»“æ„æ˜¯å¾ˆæ¸…æ™°çš„ã€‚ 12345678910111213141516171819202122_start: function (e) &#123; this.startX = this.x; this.startY = this.y; this.absStartX = this.x; this.absStartY = this.y; this.pointX = point.pageX; this.pointY = point.pageY; this._execEvent('beforeScrollStart');&#125;,_move: function (e) &#123; var point = e.touches ? e.touches[0] : e, deltaX = point.pageX - this.pointX, deltaY = point.pageY - this.pointY; this.pointX = point.pageX; this.pointY = point.pageY;&#125;, è¿™æ˜¯iscrollä¸­çš„ä¸€å°æ®µä»£ç ï¼Œè¿™å°±æ˜¯è·å–touchmoveæ»šåŠ¨é‡çš„åŠæ³•ã€‚äºæ˜¯æˆ‘ä»¬å°±èƒ½å†™å‡ºç±»ä¼¼ä¸Šé¢innerScrollé€‚ç”¨äºæ‰‹æœºä¸Šçš„åˆ¤æ–­æ»šåŠ¨è¾¹ç•Œçš„åŠæ³•äº†ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738// ç§»åŠ¨ç«¯touché‡å†™var startX, startY;$('#popupLayer').on('touchstart', function(e)&#123; startX = e.changedTouches[0].pageX; startY = e.changedTouches[0].pageY;&#125;);// ä»¿innerScrollæ–¹æ³•$('#popupLayer').on('touchmove', function(e)&#123; e.stopPropagation(); var deltaX = e.changedTouches[0].pageX - startX; var deltaY = e.changedTouches[0].pageY - startY; // åªèƒ½çºµå‘æ»š if(Math.abs(deltaY) &lt; Math.abs(deltaX))&#123; e.preventDefault(); return false; &#125; var box = $(this).get(0); if($(box).height() + box.scrollTop &gt;= box.scrollHeight)&#123; if(deltaY &lt; 0) &#123; e.preventDefault(); return false; &#125; &#125; if(box.scrollTop === 0)&#123; if(deltaY &gt; 0) &#123; e.preventDefault(); return false; &#125; &#125; // ä¼šé˜»æ­¢åŸç”Ÿæ»šåŠ¨ // return false;&#125;); è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘åŠ äº†ä¸€æ¡åˆ¤æ–­ï¼Œå¼¹å‡ºå±‚å†…éƒ¨çš„æ»šåŠ¨åªèƒ½çºµå‘æ»šï¼Œå³ deltaY è¦å¤§äº deltaXã€‚å› ä¸ºæˆ‘å‘ç°ä¸ªbugï¼Œå½“æ²¡æœ‰è¿™æ¡åˆ¤æ–­æ—¶ï¼Œå¼¹å‡ºå±‚å†…éƒ¨å¯ä»¥æ¨ªå‘æ»šï¼Œæ»šå‡ºçš„éƒ½æ˜¯ç©ºç™½ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•ä¸‹ã€‚è¿˜æœ‰è¿™é‡Œåˆ°åº•ä½¿ç”¨e.changedTouches[0]è¿˜æ˜¯åƒiscrollé‡Œçš„e.touches[0]è·å–å½“å‰æ»šåŠ¨çš„æ‰‹æŒ‡ï¼Œå…¶å®éƒ½OKï¼Œå¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç«  æœ€åè¯·çœ‹demoï¼Œæ‰‹æœºè¯·æ‰«äºŒç»´ç ï¼Œæ•ˆæœæ£’æ£’çš„ï¼ æ³¨ï¼šä¸€å¹´å‰åšè¿™ä¸ªdemoæ—¶ï¼Œæˆ‘æ‰‹æœº ( Meizu Android 4.4.2 ) ä¸Šæ•ˆæœæ˜¯OKçš„ï¼Œåœ¨ SegmentFault è®ºå›ä¸Šä¸æ­¢ä¸€ä¸ªäººå›å¤è¯´ä¸Šé¢çš„æ–¹æ¡ˆæœ‰é—®é¢˜ï¼Œæœ‰ä¸€åŠæœºç‡æ˜¯ä¸è¡Œçš„ï¼Œå¿«é€Ÿæ»‘çš„æ—¶å€™è‚¯å®šä¸è¡Œã€‚ æ¥è‡ªSFç½‘å‹çš„æ–¹æ¡ˆç½‘å‹ jiehwa çš„æåˆ°ä¸éœ€è¦é‡å†™äº‹ä»¶é‚£ä¹ˆéº»çƒ¦ï¼Œé€šè¿‡å‡ ä¸ª csså±æ€§ æ§åˆ¶å³å¯ã€‚ å¼¹å‡ºå±‚çˆ¶å…ƒç´ è®¾ç½®å±æ€§ overflow-y: scroll å¼¹çª—å¼¹å‡ºæ—¶ï¼Œç”¨jsæ§åˆ¶åº•å±‚å…ƒç´ çš„ position å±æ€§ç½®ä¸º fixed å¼¹çª—å…³é—­æ—¶ï¼Œç”¨jsæ§åˆ¶åº•å±‚å…ƒç´ çš„ position å±æ€§ç½®ä¸º static åœ¨ iOS ç«¯ï¼Œä¸ºäº†å¼¹çª—é‡Œé¢çš„æ»šåŠ¨æ•ˆæœçœ‹èµ·æ¥é¡ºæ»‘ï¼Œéœ€è¦è®¾ç½®å¼¹çª—å±‚çš„åŒ…è£¹å…ƒç´ å±æ€§ï¼š-webkit-overflow-scrolling: touch cssæ–¹æ¡ˆçš„demoï¼ˆæ„Ÿè°¢ SegmentFault ç½‘å‹ï¼‰ å¯ä»¥çœ‹åˆ°æœ‰ç‘•ç–µï¼Œå½“å¼ºè¡Œå°†åº•å±‚å…ƒç´ ç½®ä¸º fixed åï¼Œç”±äº fixed å®šä½ä¼šè®©å…ƒç´ è„±ç¦»æ­£å¸¸çš„DOMæ–‡æ¡£æµï¼Œæ‰€ä»¥åŸæœ¬ä½äºé¡µé¢åº•éƒ¨çš„å…ƒç´ å°±ä¸€ä¸‹å­é¡¶ä¸Šæ¥äº†ã€‚è¿˜æœ‰å½“åº•å±‚å…ƒç´ æ»‘åŠ¨ä¸€æ®µè·ç¦»åå†æ‰“å¼€å¼¹å‡ºå±‚ï¼Œåº•å±‚å…ƒç´ åˆè¢« fixed å®šä½é‡ç½®äº†ï¼Œçœ‹ç€ä¹Ÿå¾ˆåˆ«æ‰­ã€‚ ä»”ç»†é˜…è¯»åå‘ç°æˆ‘è¯¯è§£äº†ï¼Œæ§åˆ¶åº•å±‚å…ƒç´ çš„ fixed å®šä½åº”è¯¥ä½œç”¨åœ¨ &lt;body&gt; çš„ä¸€çº§å­å…ƒç´ ï¼Œè€Œå¼¹å‡ºå±‚çš„åŒ…è£¹å…ƒç´ ä¹Ÿæ˜¯ &lt;body&gt; çš„ä¸€çº§å­å…ƒç´ ï¼Œäºæ˜¯ æ”¹è¿›åçš„ demo å¦‚ä¸‹ ç°åœ¨â€œé¡µé¢åº•éƒ¨â€è¿™å‡ ä¸ªå­—ä¸ä¼šé¡¶ä¸Šæ¥äº†ï¼Œä½†æ˜¯æ»‘åŠ¨ä¸€æ®µè·ç¦»åå†æ‰“å¼€å¼¹å‡ºå±‚æ—¶çš„é¡µé¢åº•å±‚è¿˜æ˜¯ä¼šæŠ–åŠ¨ï¼Œè¿™ä¸ªæš‚æ—¶ä¹Ÿæƒ³ä¸å‡ºå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆ æœ€åæ„Ÿè°¢å¶å°é’—ï¼Œæœ€è¿‘ä¸€ç›´åœ¨çœ‹ä»–å…³äºç§»åŠ¨ç«¯äº‹ä»¶åŸç†çš„åšå®¢ï¼Œæœ‰ç‚¹å­¦ä¼šäº†ä»–é‚£ç§ ä»£ç å®éªŒ -&gt; çŒœæµ‹è§£é‡Š -&gt; éªŒè¯åŸç† -&gt; æ”¹è¿›é—®é¢˜ è¿™æ ·çš„å­¦ä¹ æ–¹æ³•ã€‚æœ¬æ–‡ä¹ŸèŠ±äº†å¾ˆå¤§åŠ›æ°”å†™ä»£ç å®éªŒï¼Œç–æ¼ä¹‹å¤„æœ›å¤šå¤šæŒ‡æ­£ï¼Œè°¢è°¢è€å¿ƒçš„çœ‹å®Œ å‚è€ƒèµ„æ–™çŸ¥ä¹ä¸Šçš„ä¸€ä¸ªè®¨è®º]]></content>
      <categories>
        <category>mobile</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>css</tag>
        <tag>mobile</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¹Ÿæ¥è¯´è¯´touchäº‹ä»¶ä¸ç‚¹å‡»ç©¿é€é—®é¢˜]]></title>
    <url>%2Fblog%2F2015%2F10%2Ftouch-event-and-defect.html</url>
    <content type="text"><![CDATA[åšè¿‡ç§»åŠ¨ç«¯H5é¡µé¢çš„åŒå­¦è‚¯å®šçŸ¥é“ï¼Œç§»åŠ¨ç«¯webçš„äº‹ä»¶æ¨¡å‹ä¸åŒäºPCé¡µé¢çš„äº‹ä»¶ã€‚çœ‹äº†ä¸€äº›å…³äºtouchäº‹ä»¶çš„æ–‡ç« ï¼Œæˆ‘æƒ³å†æ¥å›é¡¾ä¸‹touchäº‹ä»¶çš„åŸç†ï¼Œä¸ºä»€ä¹ˆé€šè¿‡touchå¯ä»¥è§¦å‘clickäº‹ä»¶ï¼Œtouchäº‹ä»¶æ˜¯ä¸æ˜¯ä¸‡èƒ½çš„ä»¥åŠå®ƒå¯èƒ½å­˜åœ¨çš„é—®é¢˜ã€‚ touchäº‹ä»¶çš„æ¥æºPCç½‘é¡µä¸Šçš„å¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯ç”¨é¼ æ ‡çš„ï¼Œå³å“åº”çš„æ˜¯é¼ æ ‡äº‹ä»¶ï¼ŒåŒ…æ‹¬mousedownã€mouseupã€mousemoveå’Œclickäº‹ä»¶ã€‚ä¸€æ¬¡ç‚¹å‡»è¡Œä¸ºï¼Œäº‹ä»¶è§¦å‘è¿‡ç¨‹ä¸ºï¼šmousedown -&gt; mouseup -&gt; click ä¸‰æ­¥ã€‚ æ‰‹æœºä¸Šæ²¡æœ‰é¼ æ ‡ï¼Œæ‰€ä»¥å°±ç”¨è§¦æ‘¸äº‹ä»¶å»å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚touchäº‹ä»¶åŒ…å«touchstartã€touchmoveã€touchendï¼Œæ³¨æ„æ‰‹æœºä¸Šå¹¶æ²¡æœ‰tapäº‹ä»¶ã€‚æ‰‹æŒ‡è§¦å‘è§¦æ‘¸äº‹ä»¶çš„è¿‡ç¨‹ä¸ºï¼štouchstart -&gt; touchmove -&gt; touchendã€‚ æ‰‹æœºä¸Šæ²¡æœ‰é¼ æ ‡ï¼Œä½†ä¸ä»£è¡¨æ‰‹æœºä¸èƒ½å“åº”mouseäº‹ä»¶ï¼ˆå…¶å®æ˜¯å€ŸåŠ©touchå»è§¦å‘mouseäº‹ä»¶ï¼‰ã€‚æœ‰äººåœ¨PCå’Œæ‰‹æœºä¸Šå¯¹äº‹ä»¶åšäº†å¯¹æ¯”å®éªŒï¼Œä»¥è¯´æ˜æ‰‹æœºå¯¹touchäº‹ä»¶ç›¸åº”é€Ÿåº¦å¿«äºmouseäº‹ä»¶ã€‚ å¯ä»¥çœ‹åˆ°åœ¨æ‰‹æœºä¸Šï¼Œå½“æˆ‘ä»¬æ‰‹è§¦ç¢°å±å¹•æ—¶ï¼Œè¦è¿‡300mså·¦å³æ‰ä¼šè§¦å‘mousedownäº‹ä»¶ï¼Œæ‰€ä»¥clickäº‹ä»¶åœ¨æ‰‹æœºä¸Šçœ‹èµ·æ¥å°±åƒæ…¢åŠæ‹ä¸€æ ·ã€‚ touchäº‹ä»¶ä¸­å¯ä»¥è·å–ä»¥ä¸‹å‚æ•° å‚æ•° å«ä¹‰ touches å±å¹•ä¸­æ¯æ ¹æ‰‹æŒ‡ä¿¡æ¯åˆ—è¡¨ targetTouches å’Œtouchesç±»ä¼¼ï¼ŒæŠŠåŒä¸€èŠ‚ç‚¹çš„æ‰‹æŒ‡ä¿¡æ¯è¿‡æ»¤æ‰ changedTouches å“åº”å½“å‰äº‹ä»¶çš„æ¯æ ¹æ‰‹æŒ‡çš„ä¿¡æ¯åˆ—è¡¨ tapæ˜¯æ€ä¹ˆæ¥çš„ç”¨è¿‡Zeptoæˆ–KISSYç­‰ç§»åŠ¨ç«¯jsåº“çš„äººè‚¯å®šå¯¹tapäº‹ä»¶ä¸é™Œç”Ÿï¼Œæˆ‘ä»¬åšPCé¡µé¢æ—¶ç»‘å®šclickï¼Œç›¸åº”åœ°æ‰‹æœºé¡µé¢å°±ç»‘å®štapã€‚ä½†åŸç”Ÿçš„touchäº‹ä»¶æœ¬èº«æ˜¯æ²¡æœ‰tapçš„ï¼Œjsåº“é‡Œæä¾›çš„tapäº‹ä»¶éƒ½æ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„ã€‚ æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°ï¼Œæ‰‹æœºä¸Šå“åº” click äº‹ä»¶ä¼šæœ‰300msçš„å»¶è¿Ÿï¼Œé‚£ä¹ˆè¿™300msåˆ°åº•æ˜¯å¹²å˜›äº†ï¼Ÿæµè§ˆå™¨åœ¨ touchend åä¼šç­‰å¾…çº¦300msï¼ŒåŸå› æ˜¯åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰åŒå‡»ï¼ˆdouble tapï¼‰è¡Œä¸ºã€‚å¦‚æœæ²¡æœ‰ tap è¡Œä¸ºï¼Œåˆ™è§¦å‘ click äº‹ä»¶ï¼Œè€ŒåŒå‡»è¿‡ç¨‹ä¸­å°±ä¸é€‚åˆè§¦å‘ click äº‹ä»¶äº†ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡º click äº‹ä»¶è§¦å‘ä»£è¡¨ä¸€è½®è§¦æ‘¸äº‹ä»¶çš„ç»“æŸã€‚ æ—¢ç„¶è¯´tapäº‹ä»¶æ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹Zeptoå¯¹ singleTap äº‹ä»¶çš„å¤„ç†ã€‚è§æºç  136-143 è¡Œï¼Œå¯ä»¥çœ‹å‡ºåœ¨ touchend å“åº” 250ms æ— æ“ä½œåï¼Œåˆ™è§¦å‘singleTapã€‚ ç‚¹å‡»ç©¿é€çš„åœºæ™¯æœ‰äº†ä»¥ä¸Šçš„åŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºç°ç‚¹å‡»ç©¿é€ç°è±¡äº†ã€‚æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°â€œå¼¹çª—/æµ®å±‚â€è¿™ç§ä¸œè¥¿ï¼Œæˆ‘åšä¸ªäº†ä¸ªdemoã€‚ æ•´ä¸ªå®¹å™¨é‡Œæœ‰ä¸€ä¸ªåº•å±‚å…ƒç´ çš„divï¼Œå’Œä¸€ä¸ªå¼¹å‡ºå±‚divï¼Œä¸ºäº†è®©å¼¹å‡ºå±‚æœ‰æ¨¡æ€æ¡†çš„æ•ˆæœï¼Œæˆ‘åˆåŠ äº†ä¸€ä¸ªé®ç½©å±‚ã€‚ 1234567891011&lt;div class="container"&gt; &lt;div id="underLayer"&gt;åº•å±‚å…ƒç´ &lt;/div&gt; &lt;div id="popupLayer"&gt; &lt;div class="layer-title"&gt;å¼¹å‡ºå±‚&lt;/div&gt; &lt;div class="layer-action"&gt; &lt;button class="btn" id="closePopup"&gt;å…³é—­&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;div id="bgMask"&gt;&lt;/div&gt; ç„¶åä¸ºåº•å±‚å…ƒç´ ç»‘å®š click äº‹ä»¶ï¼Œè€Œå¼¹å‡ºå±‚çš„å…³é—­æŒ‰é’®ç»‘å®š tap äº‹ä»¶ã€‚ 12345678$('#closePopup').on('tap', function(e)&#123; $('#popupLayer').hide(); $('#bgMask').hide();&#125;);$('#underLayer').on('click', function()&#123; alert('underLayer clicked');&#125;); ç‚¹å‡»å…³é—­æŒ‰é’®ï¼Œtouchendé¦–å…ˆè§¦å‘tapï¼Œå¼¹å‡ºå±‚å’Œé®ç½©å°±è¢«éšè—äº†ã€‚touchendåç»§ç»­ç­‰å¾…300mså‘ç°æ²¡æœ‰å…¶ä»–è¡Œä¸ºäº†ï¼Œåˆ™ç»§ç»­è§¦å‘clickï¼Œç”±äºè¿™æ—¶å¼¹å‡ºå±‚å·²ç»æ¶ˆå¤±ï¼Œæ‰€ä»¥å½“å‰clickäº‹ä»¶çš„targetå°±åœ¨åº•å±‚å…ƒç´ ä¸Šï¼Œäºæ˜¯å°±alertå†…å®¹ã€‚æ•´ä¸ªäº‹ä»¶è§¦å‘è¿‡ç¨‹ä¸º touchend -&gt; tap -&gt; clickã€‚ è€Œç”±äºclickäº‹ä»¶çš„æ»åæ€§ï¼ˆ300msï¼‰ï¼Œåœ¨è¿™300mså†…ä¸Šå±‚å…ƒç´ éšè—æˆ–æ¶ˆå¤±äº†ï¼Œä¸‹å±‚åŒæ ·ä½ç½®çš„DOMå…ƒç´ è§¦å‘äº†clickäº‹ä»¶ï¼ˆå¦‚æœæ˜¯inputæ¡†åˆ™ä¼šè§¦å‘focusäº‹ä»¶ï¼‰ï¼Œçœ‹èµ·æ¥å°±åƒç‚¹å‡»çš„targetâ€œç©¿é€â€åˆ°ä¸‹å±‚å»äº†ã€‚ å®Œæ•´demoè¯·ç”¨chromeæ‰‹æœºæ¨¡æ‹Ÿå™¨æŸ¥çœ‹ï¼Œæˆ–ç›´æ¥æ‰«æäºŒç»´ç åœ¨æ‰‹æœºä¸ŠæŸ¥çœ‹ã€‚ ç»“åˆZeptoæºç çš„è§£é‡Šzeptoä¸­çš„ tap é€šè¿‡å…¼å¬ç»‘å®šåœ¨ document ä¸Šçš„ touch äº‹ä»¶æ¥å®Œæˆ tap äº‹ä»¶çš„æ¨¡æ‹Ÿçš„ï¼Œæ˜¯é€šè¿‡äº‹ä»¶å†’æ³¡å®ç°çš„ã€‚åœ¨ç‚¹å‡»å®Œæˆæ—¶ï¼ˆtouchstart / touchendï¼‰çš„ tap äº‹ä»¶éœ€è¦å†’æ³¡åˆ° document ä¸Šæ‰ä¼šè§¦å‘ã€‚è€Œåœ¨å†’æ³¡åˆ° document ä¹‹å‰ï¼Œæ‰‹æŒ‡æ¥è§¦å’Œç¦»å¼€å±å¹•ï¼ˆtouchstart / touchendï¼‰æ˜¯ä¼šè§¦å‘ click äº‹ä»¶çš„ã€‚ å› ä¸º click äº‹ä»¶æœ‰å»¶è¿Ÿï¼ˆå¤§æ¦‚æ˜¯300msï¼Œä¸ºäº†å®ç°safariçš„åŒå‡»äº‹ä»¶çš„è®¾è®¡ï¼‰ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œå®Œ tap äº‹ä»¶ä¹‹åï¼Œå¼¹å‡ºå±‚ç«‹é©¬å°±éšè—äº†ï¼Œæ­¤æ—¶ click äº‹ä»¶è¿˜åœ¨å»¶è¿Ÿçš„ 300ms ä¹‹ä¸­ã€‚å½“ 300ms åˆ°æ¥çš„æ—¶å€™ï¼Œclick åˆ°çš„å…¶å®æ˜¯éšè—å…ƒç´ ä¸‹æ–¹çš„å…ƒç´ ã€‚ å¦‚æœæ­£ä¸‹æ–¹çš„å…ƒç´ æœ‰ç»‘å®š click äº‹ä»¶ï¼Œæ­¤æ—¶ä¾¿ä¼šè§¦å‘ï¼Œå¦‚æœæ²¡æœ‰ç»‘å®š click äº‹ä»¶çš„è¯å°±å½“æ²¡å‘ç”Ÿã€‚å¦‚æœæ­£ä¸‹æ–¹çš„æ˜¯ input è¾“å…¥æ¡†ï¼ˆæˆ–æ˜¯ select / radio / checkboxï¼‰ï¼Œç‚¹å‡»é»˜è®¤ focus è€Œå¼¹å‡ºè¾“å…¥é”®ç›˜ï¼Œä¹Ÿå°±å‡ºç°äº†ä¸Šé¢çš„â€œç‚¹é€â€ç°è±¡ã€‚ ç©¿é€çš„è§£å†³åŠæ³•1. é®æŒ¡ç”±äº click äº‹ä»¶çš„æ»åæ€§ï¼Œåœ¨è¿™æ®µæ—¶é—´å†…åŸæ¥ç‚¹å‡»çš„å…ƒç´ æ¶ˆå¤±äº†ï¼Œäºæ˜¯ä¾¿â€œç©¿é€â€äº†ã€‚å› æ­¤æˆ‘ä»¬é¡ºç€è¿™ä¸ªæ€è·¯å°±æƒ³åˆ°ï¼Œå¯ä»¥ç»™å…ƒç´ çš„æ¶ˆå¤±åšä¸€ä¸ªfadeæ•ˆæœï¼Œç±»ä¼¼jQueryé‡Œçš„fadeOutï¼Œå¹¶è®¾ç½®åŠ¨ç”»durationå¤§äº300msï¼Œè¿™æ ·å½“å»¶è¿Ÿçš„ click è§¦å‘æ—¶ï¼Œå°±ä¸ä¼šâ€œç©¿é€â€åˆ°ä¸‹æ–¹çš„å…ƒç´ äº†ã€‚ åŒæ ·çš„é“ç†ï¼Œä¸ç”¨å»¶æ—¶åŠ¨ç”»ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŠ¨æ€åœ°åœ¨è§¦æ‘¸ä½ç½®ç”Ÿæˆä¸€ä¸ªé€æ˜çš„å…ƒç´ ï¼Œè¿™æ ·å½“ä¸Šå±‚å…ƒç´ æ¶ˆå¤±è€Œå»¶è¿Ÿçš„clickæ¥åˆ°æ—¶ï¼Œå®ƒç‚¹å‡»åˆ°çš„æ˜¯é‚£ä¸ªé€æ˜çš„å…ƒç´ ï¼Œä¹Ÿä¸ä¼šâ€œç©¿é€â€åˆ°åº•ä¸‹ã€‚åœ¨ä¸€å®šçš„timeoutåå†å°†ç”Ÿæˆçš„é€æ˜å…ƒç´ ç§»é™¤ã€‚å…·ä½“å¯è§demo 2. pointer-eventspointer-eventsæ˜¯CSS3ä¸­çš„å±æ€§ï¼Œå®ƒæœ‰å¾ˆå¤šå–å€¼ï¼Œæœ‰ç”¨çš„ä¸»è¦æ˜¯autoå’Œnoneï¼Œå…¶ä»–å±æ€§å€¼ä¸ºSVGæœåŠ¡ã€‚ å–å€¼ å«ä¹‰ auto æ•ˆæœå’Œæ²¡æœ‰å®šä¹‰ pointer-events å±æ€§ç›¸åŒï¼Œé¼ æ ‡ä¸ä¼šç©¿é€å½“å‰å±‚ã€‚ none å…ƒç´ ä¸å†æ˜¯é¼ æ ‡äº‹ä»¶çš„ç›®æ ‡ï¼Œé¼ æ ‡ä¸å†ç›‘å¬å½“å‰å±‚è€Œå»ç›‘å¬ä¸‹é¢çš„å±‚ä¸­çš„å…ƒç´ ã€‚ä½†æ˜¯å¦‚æœå®ƒçš„å­å…ƒç´ è®¾ç½®äº†pointer-eventsä¸ºå…¶å®ƒå€¼ï¼Œæ¯”å¦‚autoï¼Œé¼ æ ‡è¿˜æ˜¯ä¼šç›‘å¬è¿™ä¸ªå­å…ƒç´ çš„ã€‚ å…³äºä½¿ç”¨ pointer-events åçš„äº‹ä»¶å†’æ³¡ï¼Œæœ‰äººåšäº†ä¸ªå®éªŒï¼Œè§ä»£ç  å› æ­¤è§£å†³â€œç©¿é€â€çš„åŠæ³•å°±å¾ˆç®€å•ï¼Œdemoå¦‚ä¸‹ 12345678910$('#closePopup').on('tap', function(e)&#123; $('#popupLayer').hide(); $('#bgMask').hide(); $('#underLayer').css('pointer-events', 'none'); setTimeout(function()&#123; $('#underLayer').css('pointer-events', 'auto'); &#125;, 400);&#125;); 3. fastclickä½¿ç”¨fastclickåº“ï¼Œå…¶å®ç°æ€è·¯æ˜¯ï¼Œå–æ¶ˆ click äº‹ä»¶ï¼ˆå‚çœ‹æºç  164-173 è¡Œï¼‰ï¼Œç”¨ touchend æ¨¡æ‹Ÿå¿«é€Ÿç‚¹å‡»è¡Œä¸ºï¼ˆå‚çœ‹æºç  521-610 è¡Œï¼‰ã€‚ 1FastClick.attach(document.body); ä»æ­¤æ‰€æœ‰ç‚¹å‡»äº‹ä»¶éƒ½ä½¿ç”¨clickï¼Œä¸ä¼šå‡ºç°â€œç©¿é€â€çš„é—®é¢˜ï¼Œå¹¶ä¸”æ²¡æœ‰300msçš„å»¶è¿Ÿã€‚è§£å†³ç©¿é€çš„demo æœ‰äººï¼ˆå¶å°é’—ï¼‰å¯¹äº‹ä»¶æœºåˆ¶åšäº†è¯¦ç»†çš„å‰–æï¼Œå¾ªå¾ªå–„è¯±ï¼Œå¹¶å‰–æäº†fastclickçš„æºç ä»¥è‡ªå·±æ¨¡æ‹Ÿäº‹ä»¶çš„åˆ›å»ºã€‚è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼Œçœ‹å®Œåä¸€å®šä¼šå¯¹ç§»åŠ¨ç«¯çš„äº‹ä»¶æœ‰æ›´æ·±çš„äº†è§£ å‚è€ƒèµ„æ–™æ‰‹æŒè®¾å¤‡ç‚¹å‡»å“åº”é€Ÿåº¦ï¼Œé¼ æ ‡äº‹ä»¶ä¸touchäº‹ä»¶çš„é‚£äº›äº‹ ç‚¹å‡»ç©¿é€ fastclick å½»åº•è§£å†³tapâ€œç‚¹é€â€ï¼Œæå‡ç§»åŠ¨ç«¯ç‚¹å‡»å“åº”é€Ÿåº¦]]></content>
      <categories>
        <category>mobile</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>mobile</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯çŸ¥è¯†ä½“ç³»ä»¥åŠé¢è¯•ç‚¹]]></title>
    <url>%2Fblog%2F2015%2F09%2Ffe-review-points.html</url>
    <content type="text"><![CDATA[ä¹‹å‰ä¸€ç›´åœ¨å¿™ï¼Œä¹Ÿæ²¡æ¥å¾—åŠç®¡è¿™ä¸ªåšå®¢ã€‚å®ä¹ ä»5æœˆå¹²åˆ°äº†8æœˆåº•ï¼ŒåŠç¦»èŒé‚£å¤©ï¼Œäº¤äº†å·¥ç‰Œå½’è¿˜ç”µè„‘åï¼Œè¿˜è¢«è¿è¥æ‹–ç€è§£ç­”é—®é¢˜ï¼Œåˆè¢«é€šçŸ¥çº¿ä¸Šä»·æ ¼é—®é¢˜ï¼Œå€Ÿç€åŒäº‹çš„ç”µè„‘æŠŠbugä¿®äº†ï¼Œä¹Ÿæ˜¯å› ä¸ºå‡çº§ä»£ç æ—¶è‡ªå·±çš„ç–å¿½å¯¼è‡´çš„ã€‚è™½ç„¶åœ¨å›¢é˜Ÿé‡Œè‡ªå·±åªæ˜¯ä¸€ä¸ªæ‰“æ‚çš„å°å‰ç«¯ï¼Œä½†æ˜¯ä¸å¥½å¤šåŒäº‹åˆä½œè¿‡ï¼Œå¯¹æ¥è¿‡å¥½å¤šè¿è¥åŒå­¦ã€‚èµ°çš„æ—¶å€™å’Œå›¢é˜Ÿé‡Œä¸€ä¸€é“åˆ«ï¼Œå¬åˆ°æœ€å¤šçš„ä¸€å¥è¯å°±æ˜¯â€œæ—©ç‚¹å›æ¥â€ã€‚ä½†æ˜¯å¾ˆé—æ†¾ï¼Œæˆ‘å›ä¸æ¥äº†ã€‚æ²¡æœ‰æ¥å¾—åŠå®Œæˆå¸ˆå…„å¯¹æˆ‘çš„æœŸæœ›ï¼Œæ²¡æœ‰æ¥å¾—åŠå’Œä»–å¥½å¥½é“åˆ«ï¼Œæ²¡æœ‰æ¥å¾—åŠå’Œä¸»ç®¡æŒ‘ç›˜å°çƒï¼Œæ²¡æœ‰æ¥å¾—åŠåƒéé£Ÿå ‚çš„æ‰€æœ‰èœç‚¹ã€‚é‚£å¤©æ™šä¸ŠJarvenåŒå­¦é€æˆ‘å‡ºå»ï¼Œè¯´ä½ èµ°äº†æˆ‘ä»¥ååƒé¥­åˆä¸è®¤è¯†è·¯äº†ã€‚åªå¥½ç›¸æœ›äºæ±Ÿæ¹–ï¼Œç­‰åˆ°è‡ªå·±æˆé•¿ä¸ºå¤§å‰ç«¯æ—¶ï¼Œå¯ä»¥é¼“è¶³å‹‡æ°”è¯´â€œIâ€™m back.â€ çŸ«æƒ…å®Œäº†ã€‚ã€‚ã€‚å›æ ¡åå¥½å¥½å›é¡¾äº†ä¸‹å‰ç«¯çŸ¥è¯†ç‚¹ï¼Œç»“åˆå®ä¹ ç»éªŒä½“ä¼šæ›´æ·±ï¼Œäºæ˜¯æƒ³æ•´ç†ä¸‹ã€‚ åŸºç¡€ç¯‡CSSå¸ƒå±€é¦–å…ˆæ˜¯æ¨¡å‹çš„ç†è§£ ç›’æ¨¡å‹ å®šä½æ¨¡å‹ Flexboxæ¨¡å‹ ç†è§£ç±»ä¼¼Boostrapé‡Œçš„æ …æ ¼ç³»ç»Ÿ ç„¶åæ¥å‡ ä¸ªå®é™…çš„å¸ƒå±€ç»ƒæ‰‹ ç›¸å¯¹æ•´ä¸ªå±å¹•çš„æ°´å¹³å‚ç›´å±…ä¸­ ä¸­é—´å®šå®½ï¼Œä¸¤è¾¹é“ºæ»¡å®¹å™¨ï¼Œè¿™æ ·çš„ä¸‰åˆ—å¸ƒå±€ å·¦è¾¹å®šå®½ï¼Œå³è¾¹è‡ªé€‚åº”å®½åº¦ï¼Œä¸¤åˆ—çš„ç­‰é«˜å¸ƒå±€ ä¸‰åˆ—å›ºå®šå®½åº¦çš„ç­‰é«˜å¸ƒå±€ è¿™äº›éƒ½èƒ½æƒ³å‡º1ç§æˆ–ä¸¤ä¸‰ç§å®ç°çš„è¯ï¼ŒCSSå¸ƒå±€ä¸ä¼šå†éš¾äº†ï¼Œäºæ˜¯å¯ä»¥å†çœ‹ä¸‹ç§»åŠ¨ç«¯webçš„é€‚é…ã€‚ å“åº”å¼çš„å›¾ç‰‡ï¼Œå¹¶ä¸”æ˜¯å»¶è¿ŸåŠ è½½çš„ï¼Œè¦é¢„å…ˆä¸ºå›¾ç‰‡å æ®ç©ºé—´ï¼Œé¿å…æ–‡æ¡£é«˜åº¦ä¹±è·³ å±å¹•ä¸æ–­å˜å¤§æ—¶ï¼ŒåŒä¸€è¡Œçš„å…ƒç´ å®¹å™¨é‡Œåº”è¯¥å¯ä»¥çœ‹åˆ°æ›´å¤šçš„å†…å®¹ï¼Œè€Œä¸æ˜¯å°†æ–‡å­—æ”¾å¤§ åˆ©ç”¨Flexboxåšç§»åŠ¨ç«¯çš„å¼¹æ€§å¸ƒå±€ å¤§ä½“çš„è·¯çº¿å›¾å°±æ˜¯è¿™æ ·ï¼Œå¦‚æœå†æ·±å…¥çš„è¯ï¼Œå¯èƒ½å°±æ˜¯å¯¹ä¸€äº›ç‰¹åˆ«çš„å±æ€§æˆ–å…¼å®¹æ€§çš„ç†è§£äº†ï¼Œæ¯”å¦‚ IE6çš„ç›’æ¨¡å‹æ˜¯ç±»ä¼¼äºbox-sizing: border-box zoom: 1ä¸hasLayout BFCï¼ˆBlock Formatting Contextï¼‰ CSSåˆ°æ­¤æ‰“ä½äº†ï¼Œä¸æ˜¯å¤ªåˆéš¾çš„è®¾è®¡ç¨¿éƒ½èƒ½holdä½äº†ï¼ Javascriptè¯­è¨€æœºåˆ¶JSé‡Œæœ€é‡è¦çš„3ç‚¹ ä½œç”¨åŸŸ é—­åŒ… åŸå‹ ç†è§£äº†è¿™ä¸ªåï¼Œå°±æ˜¯è¿ç”¨è¿™äº›ç‰¹æ€§åšçš„ä¸€äº›å…·ä½“æ–¹æ¡ˆï¼Œå»è§£å†³å®é™…é—®é¢˜ å‡½æ•°ä½œç”¨åŸŸçš„ç»‘å®šï¼ŒFunction.prototype.bindçš„å®ç° æ¨¡æ‹Ÿâ€œç±»/æ¨¡å—â€çš„å®ç° ç±»å¼ç»§æ‰¿çš„å®ç° å¸¸ç”¨è®¾è®¡æ¨¡å¼çš„å®ç°ï¼Œæ¯”å¦‚å•ä¾‹æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ å…¶ä¸­è¿˜æ¶‰åŠåˆ°ä¸€äº›jså˜é‡ç¯å¢ƒå’Œå•çº¿ç¨‹çš„çŸ¥è¯†ç‚¹ï¼Œè¯¦è§æˆ‘ä»¥å‰æ•´ç†çš„æ–‡ç«  ã€ŠJavaScriptæ¨¡å¼ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ— ä¸€é“è…¾è®¯ç¬”è¯•é¢˜æƒ³åˆ°çš„JSä¸­çš„ä¸€äº›ç‰¹æ€§ å½“ç„¶å…‰çœ‹ç†è®ºä¸è¡Œï¼Œå¾—æ‹¿ä¸œè¥¿ç»ƒæ‰‹ å®ç°ä¸€ä¸ªSliderè½®æ’­ç»„ä»¶ å®ç°ä¸€ä¸ªå¸¦è‡ªåŠ¨æç¤ºåŠŸèƒ½çš„è¾“å…¥æ¡†ç»„ä»¶ è¦æ³¨æ„ä»£ç çš„å°è£…ä»¥åŠAPIçš„è®¾è®¡ï¼Œæä¾›ä¸€äº›äº‹ä»¶åŠæ‰©å±•æ€§çš„æ¥å£ï¼Œå°½é‡ä¼˜é›…çš„å»å®ç°ï¼Œå¹¶ä¸”å°½é‡ä½¿ç”¨åŸç”Ÿjavascriptã€‚è¿™é‡Œæä¾›ä¸€ä¸ªå‚è€ƒï¼šé˜¿å½“å¤§è¯è¥¿æ¸¸ä¹‹WEBç»„ä»¶ HTML5æ–°ç‰¹æ€§HTML5æ¨åŠ¨äº†å¾ˆä¹…äº†ï¼Œæ ‡å‡†å®šç¨¿æ„å‘³ç€Web 2.0æ—¶ä»£å·²è·¨å…¥Web 3.0æ—¶ä»£ã€‚HTML5æ˜¯å¦å°±ç›´æ¥ç®€ç§°H5ï¼Œè¿™ä¸ªä¸€ç›´å­˜åœ¨äº‰è®®ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹HTML5åˆ°åº•æœ‰å“ªäº›æ–°ç‰¹æ€§ã€‚ è¯­ä¹‰åŒ–DOMç»“æ„ å¤šåª’ä½“æ”¯æŒ æœ¬åœ°å­˜å‚¨ï¼Œçªç ´cookieå¤§å°é™åˆ¶ åœ°ç†å®šä½æ”¯æŒ web workers æœåŠ¡ç«¯äº‹ä»¶ä¸»åŠ¨æ¨é€ ä¸ªäººæ„Ÿè§‰HTML5å¹¶ä¸åªæ˜¯ä¸€äº›æ–°æ ‡ç­¾ã€æ–°å±æ€§ã€æ–°APIï¼Œå®ƒä»£è¡¨ç€ä¸€ç§æ–°çš„ç†å¿µå’Œè¶‹åŠ¿ï¼Œå³webé¡µé¢çš„ä¸°å¯Œäº¤äº’æ€§å·²ç»å¯ä»¥åšåˆ°å’ŒAPPç±»ä¼¼çš„ä½“éªŒäº†ã€‚HTML5å¹¶ä¸æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯è·¨ç»ˆç«¯ã€é‡è§†ç”¨æˆ·ä½“éªŒçš„ç†å¿µï¼Œè¿™ä¹Ÿæ˜¯Web 3.0æ—¶ä»£æ‰€è¦æ±‚çš„ã€‚ è¿›é˜¶ç¯‡è™½ç„¶ä¸Šé¢å†™çš„å«â€œåŸºç¡€ç¯‡â€ï¼Œè¦åšå¥½çš„è¯å·²ç»å¾ˆè¿›é˜¶äº†ï¼Œå·²ç»å¯ä»¥åšå‡ºè·¨ç»ˆç«¯ã€äº¤äº’ä¸°å¯Œã€ä»£ç ä¼˜é›…çš„webé¡µé¢æˆ–è€…æ˜¯web appäº†ã€‚è¿™é‡Œå†™è¿›é˜¶ç¯‡ä¸»è¦æ˜¯æŒ‡è§„æ¨¡è¾ƒå¤§çš„é¡¹ç›®é‡Œä¼šæ¶‰åŠåˆ°çš„ä¸€äº›ä¸œè¥¿ï¼Œä»¥åŠå‰ç«¯å·¥ç¨‹åŒ–çš„æ€æƒ³ã€‚ å‰ç«¯èµ„æºæ¨¡å—åŒ–CSSé‡Œè¡ç”Ÿå‡ºæ¥SASSå’ŒLESSï¼Œç›¸å½“äºåŠ å¼ºç‰ˆçš„CSSã€‚è€Œjsæ¨¡å—åŒ–è¡ç”Ÿå‡ºæ¥äº†CMDå’ŒAMDè§„èŒƒã€‚æˆ‘æœ€åˆè§‰å¾—åšæ¨¡å—åŒ–ä¸»è¦æ˜¯ä¸ºäº†å¤ç”¨ï¼Œcsså’Œjséƒ½å¯ä»¥ä¸€å®šç¨‹åº¦åœ°å¤ç”¨ã€‚åæ¥çœ‹äº†@å‰ç«¯å†œæ°‘å·¥çš„æ–‡ç« ï¼Œè¯´æ¨¡å—åŒ–æ›´å¤šçš„æ˜¯ä¸ºäº†â€œåˆ†æ²»â€ï¼Œå³åˆ†è€Œæ²»ä¹‹ï¼Œè§‰å¾—å¾ˆæœ‰é“ç†ï¼Œå°¤å…¶æ˜¯åœ¨è§„æ¨¡è¾ƒå¤§çš„é¡¹ç›®ä¸­ã€‚ å¦‚æœè¦è¯´é¢è¯•ç‚¹çš„è¯ï¼Œè¿™é‡Œå¯èƒ½ä¼šæ¶‰åŠåˆ° AMDå’ŒCMDçš„åŒºåˆ« æ¨¡å—Loaderçš„å¤§ä½“å®ç°æ€è·¯ æ—¢ç„¶æœ‰äº†æ¨¡å—åŒ–ï¼Œè¿›è¡Œäº†â€œåˆ†æ²»â€ï¼Œé‚£æ¥ä¸‹æ¥è‡ªç„¶å°±ä¼šé‡åˆ°ä¾èµ–ç®¡ç†çš„é—®é¢˜ï¼Œæ¯”å¦‚ ä¾èµ–å»é‡ã€‚aä¾èµ–[b, c]ï¼Œbä¾èµ–[c, d]ï¼Œå¦‚ä½•æ±‚å‡ºaçš„æ‰€æœ‰ä¾èµ–ï¼ˆç®—æ³•å®ç°ï¼‰ å¾ªç¯ä¾èµ–ã€‚aä¾èµ–[b]ï¼Œbä¾èµ–[c, d]ï¼Œcä¾èµ–[a]ï¼Œå¦‚ä½•æ±‚å‡ºaçš„ä¾èµ–ï¼ˆé¿å…ç®—æ³•æ­»å¾ªç¯ï¼‰ è¿™åªæ˜¯ä¾èµ–ç®¡ç†é‡Œçš„å°æ‰“å°é—¹ï¼Œå†è¿›ä¸€æ­¥çš„è¯ï¼Œæ•´ä¸ªé™æ€èµ„æºå¦‚ä½•ç®¡ç† ç¼“å­˜VSæ›´æ–° æŒ‰éœ€åŠ è½½VSèµ„æºåˆå¹¶ï¼ˆé™æ€èµ„æºçš„comboæœºåˆ¶ï¼‰ è¿™é‡Œæ¶‰åŠåˆ°çš„çŸ¥è¯†ç›¸å½“å¤šï¼Œè¦æ·±å…¥çš„è¯æ¯ä¸€ç‚¹éƒ½èƒ½æŒ–çš„å¾ˆæ·±ï¼Œä½†æˆ‘ä»¬éœ€è¦ä»æ•´ä½“ä¸Šæœ‰ä¸ªå¤§ä½“çš„äº†è§£ã€‚å¯å‚è€ƒä»¥ä¸‹èµ„æ–™ï¼š å‰ç«¯å·¥ç¨‹â€”â€”åŸºç¡€ç¯‡ å‰ç«¯å·¥ç¨‹ç²¾ç²¹ï¼šé™æ€èµ„æºç®¡ç†ä¸æ¨¡æ¿æ¡†æ¶ KISSYä¸­å¼€å¯combo äº†è§£æœåŠ¡ç«¯åœ¨åšé¡µé¢çº§çš„å¼€å‘æ—¶ï¼Œæˆ‘ä»¬è‚¯å®šä¼šæ¥è§¦ä¸€ç‚¹webåŸç†æ–¹é¢çš„çŸ¥è¯† httpä¸https sessionä¸cookie è¯·æ±‚ä¸è·¨åŸŸ é‚£ä¹ˆå†ä¸Šå‡ä¸€å±‚ï¼Œå°±æ˜¯æ•´ä¸ªweb serverï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£ä¸€äº› nodejs serverä¸ngnix DNSä¸CDN å¦‚ä½•åšè´Ÿè½½å‡è¡¡ å¦‚ä»Šç”¨nodejsæ¥åšweb controlleræ˜¯è¶‹åŠ¿ï¼Œä½¿å‰ç«¯äººå‘˜æ‹¥æœ‰å…¨æ ˆçš„å¯èƒ½æ€§ï¼Œä¸ä¸€å®šè¦æ ·æ ·ç²¾é€šï¼Œä½†æ˜¯äº†è§£ä¸€äº›åŸºæœ¬çš„ç½‘ç»œçŸ¥è¯†æ˜¯å¿…è¦çš„ã€‚ webå®‰å…¨ä¼ä¸šçº§é¡¹ç›®é‡Œwebå®‰å…¨ä¹Ÿä¸å¯å¿½è§†ï¼Œæœ€å¸¸è§çš„å°±æ˜¯XSSæ¼æ´å’ŒCSRFæ”»å‡»ï¼Œäº†è§£ä¸€ç‚¹å®ƒä»¬è¢«æ”»å‡»çš„åŸå› ï¼Œä»¥åŠå¸¸ç”¨çš„ä¸€äº›æ”»é˜²æ‰‹æ®µã€‚æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ï¼ŒåªçŸ¥é“ä¸€äº›æ¦‚å¿µã€‚è¿™ä¸ªæ–¹å‘æ·±å…¥ä¸‹å»çš„è¯ï¼Œå¯ä»¥è€ƒè™‘åšè¿ç»´å’Œå®‰å…¨äººå‘˜ã€‚ é«˜çº§ç¯‡åªæ˜¯éšä¾¿å–ä¸ªæ ‡é¢˜ç”¨äºåˆ’åˆ†ï¼Œä¸Šé¢æ¯ä¸ªpointæ·±å…¥ä¸‹å»çš„è¯éƒ½å¯ä»¥æ˜¯é«˜çº§ç¯‡ï¼Œè¿™é‡Œæ›´å¤šæƒ³æ‰¯äº›æŠ½è±¡åŸåˆ™çš„ä¸œè¥¿ã€‚ çŸ¥å…¶æ‰€ä»¥ç„¶æ‰èƒ½åšå¥½æ€§èƒ½ä¼˜åŒ–æ€§èƒ½ä¼˜åŒ–æ¶µç›–çš„åšæ³•æ•°ä¸å°½æ•°ï¼Œä½†æ˜¯ä¸ç®¡ä»€ä¹ˆæ‰‹æ®µï¼Œå…¶ç›®çš„æˆ‘å½’ç»“æˆä¸‰å¤§æ–¹é¢ï¼š å‡å°‘è¯·æ±‚ã€‚å¾ˆå¤šåšæ³•æœ€åéƒ½æ˜¯ä¸ºäº†å‡å°‘è¯·æ±‚ï¼Œæˆ–æ˜¯åˆå¹¶è¯·æ±‚ã€‚ æœåŠ¡ç«¯ä¼˜åŒ–ã€‚ä¼˜åŒ–å“åº”é€Ÿåº¦ï¼Œæˆ–è€…å‡å°‘ä¼ è¾“é‡ã€‚ æµè§ˆå™¨æ¸²æŸ“åŸç† æœ€éš¾çš„ä¹Ÿæ˜¯æ¸²æŸ“åŸç†ï¼Œå¿…é¡»çŸ¥é“å…¶åŸç†ï¼Œæ‰èƒ½å»ä¼˜åŒ–äº‹ä»¶ï¼Œä¼˜åŒ–åŠ¨ç”»ã€‚ å‰åç«¯åˆ†ç¦»æ˜¯å‰ç«¯å·¥ç¨‹çš„æ ¸å¿ƒä¸Šé¢å†™çš„å‰ç«¯å·¥ç¨‹åŒ–éƒ½æ˜¯åœ¨è¯´èµ„æºç®¡ç†ï¼Œä»¥åŠå’ŒæœåŠ¡ç«¯çš„é…åˆï¼Œç„¶è€Œå‰åç«¯åˆ†ç¦»æ‰æ˜¯å·¥ç¨‹åŒ–ä¸­æœ€é‡è¦çš„ã€‚è¿™æ–¹é¢å¯ä»¥çœ‹ä¸‹@ä¸å››çš„åˆ†äº«æ¢ä¸ªè§’åº¦çœ‹å‰åç«¯åˆ†ç¦»ã€‚ æœ€åè¦è¾¾åˆ°çš„å·¥ç¨‹åŒ–æ•ˆæœæ˜¯ï¼š å‰ç«¯ä¸æ˜¯åˆ‡å›¾ä»” åç«¯ä¹Ÿä¸æ˜¯å¥—é¡µé¢ å‰åç«¯çº¦å®šå¥½åï¼Œå‰ç«¯å¯ä»¥åŸºäºmockæ•°æ®å¼€å‘ ä»€ä¹ˆæ˜¯å‰ç«¯æœ€åè¦å›å½’ä¸€ä¸ªæœ¬è´¨é—®é¢˜ï¼Œåˆ°åº•ä»€ä¹ˆæ˜¯å‰ç«¯ï¼Ÿè¿™ä¸ªé—®é¢˜æ˜¯å®ä¹ å‰@ä¸‰ä¸ƒç»ˆé¢æ—¶é—®çš„ï¼Œæˆ‘ä¸€ä¸‹å­è¢«å”¬ä½äº†ã€‚ å‰ç«¯ = ç”¨æˆ·ç«¯ = æ‰‹æœº + å¹³æ¿ + PC ä¸‰ç«¯ä¸€è‡´ä¸”è‰¯å¥½çš„ä½“éªŒ è¿™æ˜¯æˆ‘åæ¥å‚åŠ äº†2015çš„QConè§äº†ä¸–é¢åçš„ç¬¬ä¸€å°è±¡ï¼Œå½“æ—¶å‰ç«¯ä¸“æ çš„ä¸»é¢˜å°±æ˜¯è·¨ç»ˆç«¯ã€‚ å‰ç«¯æ˜¯è¿˜åŸè®¾è®¡çš„åŒæ—¶ï¼Œä»¥å·¥ç¨‹å¸ˆçš„è§’åº¦å»ä¼˜é›…åœ°å®ç°ã€‚ è¿™æ˜¯æˆ‘å®ä¹ é˜¶æ®µçš„æ„Ÿå—ï¼Œè¿™é‡Œâ€œä¼˜é›…åœ°â€å®ç°å¹¶éæŒ‡ä»£ç è¦å†™çš„å¤šä¹ˆå¤šä¹ˆç‰›ï¼Œå¾—çœ‹å…·ä½“ä¸šåŠ¡åœºæ™¯ä»¥åŠéœ€æ±‚æ’æœŸï¼Œéœ€è¦å·¥ç¨‹å¸ˆåœ¨è®¾è®¡å’Œæ’æœŸä»¥åŠéœ€æ±‚ä¼˜å…ˆçº§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ï¼Œä»¥æœ€æƒè¡¡çš„æ–¹å¼å»è¿˜åŸè®¾è®¡ã€‚å¦‚æœæ˜¯å¯å¤ç”¨çš„åœºæ™¯ï¼Œæœ€ç»ˆå¯æ²‰æ·€å‡ºä¸€å¥—ä¼˜é›…çš„å¯æ‰©å±•çš„å®ç°æ–¹æ¡ˆã€‚ å‰ç«¯è¦ç‰¢ç‰¢æŠŠæ§Viewå±‚ï¼Œä»¥æœ€é€‚åˆç”¨æˆ·çš„æ–¹å¼å»å±•ç°ã€‚ è¿™æ˜¯å®ä¹ æ—¶å›¢é˜Ÿçš„ä¸»ç®¡æ‰€æå€¡çš„ï¼Œç”±äºç°åœ¨nativeå’ŒhybridæŠ€æœ¯çš„æ™®åŠï¼Œä¸åº”è¯¥æŠŠwebå‰ç«¯å’Œnativeå‰ç«¯ç•Œé™åˆ’åˆ†å¾—å¤ªæ¸…æ¥šï¼Œwebå’Œnativeæœ¬éƒ½æ˜¯Viewå±‚æŠŠæ§è€…ã€‚å‰ç«¯äººå‘˜åº”è¯¥æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯ï¼Œå»é€‰æ‹©æœ€åˆé€‚çš„å®ç°æ–¹å¼ï¼Œè€Œä¸æ˜¯æ ¹æ®è‡ªå·±çš„æŠ€èƒ½å»é€‰æ‹©å±•ç°æ–¹å¼ã€‚ åˆ°åº•ä»€ä¹ˆæ˜¯å‰ç«¯ï¼Ÿè¿™ç±»æŠ½è±¡é—®é¢˜æœ¬å°±ä¸è¯¥æœ‰æ˜ç¡®ç­”æ¡ˆï¼Œå°±åƒä¸€ç™¾ä¸ªäººçœ¼ä¸­æœ‰ä¸€ç™¾ä¸ªå“ˆå§†é›·ç‰¹ã€‚æ¯ä¸ªäººçš„èƒŒæ™¯ä¸åŒï¼Œéšç€ç»éªŒå’Œè§†é‡çš„å¢é•¿ï¼Œè‡ªç„¶ä¼šæ²‰æ·€å‡ºæœ€é€‚åˆè‡ªå·±çš„ç­”æ¡ˆã€‚]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®ä¹ å°æƒ³]]></title>
    <url>%2Fblog%2F2015%2F06%2Finfected-by-intership-work.html</url>
    <content type="text"><![CDATA[æ¥å®ä¹ æœ‰ä¸€ä¸ªåŠæœˆäº†ï¼Œæ—¶é—´è¿‡çš„å¾ˆå¿«ï¼Œæ¯å¤©éƒ½æŒºå¿™ï¼Œä¸€æ™ƒçœ¼æ‰å‘ç°è‡ªå·±çš„åšå®¢è¿˜åœç•™åœ¨2ä¸ªæœˆå‰ã€‚æƒ³å½“åˆæ‰¾å®ä¹ æ—¶è¿™ä¸ªåšå®¢å¯¹æˆ‘èµ·äº†å¾ˆå¤§ä½œç”¨ï¼Œè¿˜æ˜¯æƒ³èƒ½ç»§ç»­æŠŠä¸€ä»¶äº‹æ¨åŠ¨ä¸‹å»ï¼Œè®©å®ƒå‘æŒ¥æ›´å¤§çš„ä»·å€¼ã€‚ å…³äºå¸ˆå…„å¾ˆå¹¸è¿èƒ½æ¥åˆ°è¿™ä¹ˆå¥½çš„ç¯å¢ƒä¸‹å®ä¹ ï¼Œæ›´å¹¸è¿è‡ªå·±é‡åˆ°äº†ä¸€ä¸ªæå¥½çš„å¸ˆå…„ã€‚è‡ªä»ä¸Šå¤§å­¦åˆ°ç°åœ¨ï¼Œ6å¹´æ—¶é—´ï¼Œå¥½åƒä¸€ç›´åœ¨è‡ªå·±æ‘¸çˆ¬æ»šæ‰“ï¼Œä»æ¥æ²¡æœ‰äººå¸¦è¿‡ã€‚åªæœ‰å¤§ä¸€ç¬¬ä¸€æ¬¡ç¼–ç¨‹ä½œä¸šï¼Œé—®å½“æ—¶çš„é«˜ä¸€å±Šçš„æ ¡å‹è¦äº†ä»½ä»£ç ï¼Œç„¶åå‚ç…§ç€å®Œæˆäº†ã€‚åæ¥å°±å†æ²¡å‘å­¦é•¿å­¦å§å’¨è¯¢è¿‡ï¼Œåªæœ‰ç»™å­¦å¦¹æŒ‡å¯¼ä½œä¸šç»™å­¦å¼Ÿç­”ç–‘è§£æƒ‘çš„ä»½å„¿ï¼Œæˆ‘å½“æ—¶æƒ³ï¼Œæˆ‘ä»¬é‚£æ—¶æ²¡äººå¸¦ï¼Œä¸ä¹Ÿéƒ½èµ°è¿‡æ¥äº†å˜›ã€‚åˆ°äº†ç ”ç©¶ç”Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç”±äºè‡ªå·±å¯¹ç§‘ç ”æ— çˆ±ï¼Œåœ¨å®éªŒå®¤è‡ªæˆä¸€æ´¾ï¼Œå½“æ—¶å†™è¿‡ä¸€å¥è¯â€œåœ¨å‰ç«¯çš„é“è·¯ä¸Šå­¤ç‹¬å‰è¿›â€ï¼ŒçœŸçš„å¾ˆå­¤ç‹¬ï¼Œä½†è²Œä¼¼æˆ‘å·²ç»ä¹ æƒ¯äº†ã€‚ è‡ªä»é‡åˆ°äº†ç°åœ¨çš„å¸ˆå…„ï¼ŒçœŸæ­£çš„å¸ˆå…„ï¼Œæˆ‘æ·±æ„Ÿè¦æ˜¯èƒ½æ—©ä¸¤å¹´é‡åˆ°è¿™æ ·çš„å¸ˆå…„ï¼Œä¹Ÿè®¸æˆ‘èƒ½æˆé•¿çš„æ›´å¤šã€‚è‡ªå·±ä»¥å‰ç›®æ ‡æ‚ä¹±ï¼Œæ‘¸çˆ¬æ»šæ‰“çš„è¿‡ç¨‹ä¸­å¾ˆå¤šéƒ½æ˜¯æ— ç”¨çš„æ—¶é—´ã€‚è™½ç„¶æ¥è§¦å‰ç«¯æœ‰2å¹´æ—¶é—´ï¼Œä½†å’Œæœ¬ç§‘æ¯•ä¸šå°±ç›´æ¥å·¥ä½œäº†1å¹´çš„åŒå­¦æ¯”çœŸç›¸å·®ç”šè¿œã€‚å¸ˆå…„æ•™æˆ‘çš„ä¸ä»…ä»…æ˜¯é‡åˆ°é—®é¢˜å¸®æˆ‘æ’æŸ¥ï¼Œæ›´é‡è¦çš„æ˜¯ä»–æŠŠè‡ªå·±è§†ä¸ºé¡¹ç›®çš„ownerè€Œä¸æ˜¯ä»…ä»…æ˜¯ä¸ªäººåŠ›ï¼Œä¼šå¸¦æˆ‘ä¸€èµ·è®¨è®ºæ€ä¹ˆè®©ä¸œè¥¿åšçš„æ›´å¥½ã€‚æœ‰ä¸€æ¬¡å¸ˆå…„è‡ªå·±åœ¨ç ”ç©¶ä¸€ä»½æ–‡æ¡£ï¼Œç„¶åå’Œæˆ‘è¯´äº†ä¸€ä¸ªæƒ³æ³•ï¼Œç„¶åæˆ‘å°±ç…§ç€æ–‡æ¡£å’Œä»–çš„æƒ³æ³•å»åšäº†ä¸€ç•ªï¼Œæœ€åè¾¾åˆ°äº†æœŸæœ›ï¼Œå¸ˆå…„æ·±å¤œå‘é‚®ä»¶è®©åˆ«äººè¯•ç”¨ï¼Œè¿˜æ¨äº†æˆ‘åå­—ã€‚è¿™ç§ä½“éªŒçœŸæ˜¯å¤ªçˆ½äº†ï¼ æŠ€æœ¯æ°›å›´å¾ˆå–œæ¬¢è¿™é‡Œçš„æŠ€æœ¯æ°›å›´ï¼ŒåšæŠ€æœ¯çš„äººå¤§å®¶éƒ½å¾ˆçº¯ç²¹ï¼Œéƒ½ä¸ºäº†èƒ½æŠŠäº‹æƒ…åšçš„æ›´å¥½ï¼Œèƒ½è®©æ›´å¤šäººç®€åŒ–å·¥ä½œã€‚åˆšæ¥çš„æ—¶å€™è£…ä¸€ä¸ªå†…éƒ¨è½¯ä»¶æœ‰ä¸ªåŠŸèƒ½ç”¨ä¸èµ·æ¥ï¼Œäºæ˜¯å°±æ‰¾ä½œè€…æ±‚åŠ©ï¼Œæˆ‘å½“æ—¶è¿˜åœ¨å¿™å…¶ä»–çš„ï¼Œä¹Ÿæ²¡æœ‰å¾ˆåœ¨æ„é‚£ä¸ªæš‚æ—¶ç”¨ä¸åˆ°çš„åŠŸèƒ½ã€‚ä½†æ˜¯å¦ä¸€ä¸ªå¤´çš„ä½œè€…ç€æ€¥äº†ï¼Œä»–ç›´æ¥æ‰“æˆ‘æ‰‹æœºé—®æƒ…å†µï¼Œæˆ‘éƒ½è¢«è¿™ç§çƒ­æƒ…æƒŠåˆ°äº†ã€‚ç¨‹åºå‘˜éƒ½æ˜¯å–„è‰¯åˆè´Ÿè´£çš„äººï¼Œè¯·å–„å¾…ä»–ä»¬~ è¿˜æœ‰æ¬¡æˆ‘å‘å¤§ç‰›è¯·æ•™é—®é¢˜ï¼Œä»–ä»¬éƒ½ä¼šçƒ­æƒ…çš„è®¨è®ºï¼Œæå‡ºæ›´åŠ å¥½æ›´åŠ é€‚åˆçš„åŠæ³•ï¼ŒçœŸèƒ½æ„Ÿå—åˆ°å¤§å®¶æ¯«æ— åŠŸåˆ©å¿ƒçš„åªæƒ³æŠŠäº‹æƒ…åšçš„æ›´æ¼‚äº®ã€‚ äººä¹‹æƒ°æ€§å¬åˆ°æœ‰ä¸ªåŒäº‹è¯´ä»–åˆšå·¥ä½œçš„æ—¶å€™é—²ç€è¿˜ä¼šè‡ªå·±æäº›æ–°æ½®çš„å¥½ç©çš„ä¸œè¥¿ï¼Œè€Œç°åœ¨ä¸€ç‚¹éƒ½æä¸èµ·åŠ²äº†ï¼Œæ¯å¤©éƒ½çƒ¦å„ç§éœ€æ±‚ã€‚ä½†åŒæ ·ä¹Ÿæœ‰äººä¹Ÿå·¥ä½œäº†æŒºä¹…ï¼Œä¾æ—§å……æ»¡ç€å¯¹ä¸–ç•Œçš„å¥½å¥‡å¿ƒï¼Œå‡ºäº†ä»€ä¹ˆæ–°æŠ€æœ¯ä¼šæ„¿æ„å»å°è¯•å»æŠ˜è…¾ã€‚åæ­£æˆ‘çœ‹åˆ°çš„è¶Šç‰›çš„äººè¶Šå‹¤å¥‹ï¼Œè¶Šå‹¤å¥‹çš„äººè¶Šæœ‰æƒ³æ³•ã€‚æ¯ä¸ªäººéƒ½æœ‰æƒ°æ€§ï¼Œä½†çœ‹åˆ°å‘¨å›´é‚£ä¹ˆå¤šæ¯”è‡ªå·±èªæ˜çš„äººè¿˜æ¯”è‡ªå·±å‹¤å¥‹ï¼ŒçœŸçš„ä¼šä¸è‡ªè§‰å¾—è¢«å¸¦èµ·æ¥ã€‚æœ‰ä¸€æ¬¡æˆ‘åªæ˜¯æœä¸€æ¡CSSçš„ä½¿ç”¨åœºæ™¯ï¼Œçœ‹åˆ°ä¸€ç¯‡æ–‡ç« æ€»ç»“çš„æŒºå¥½ï¼Œäºæ˜¯æˆ‘æŠŠå®ƒåŠ åˆ°è‡ªå·±çš„ç¬”è®°ä¸­äº†ï¼Œåæ¥æ‰çŸ¥é“é‚£å°±æ˜¯ç»„é‡Œçš„å¤§ç‰›å†™çš„ã€‚å¤§ç‰›ä¸ä»…è´Ÿè´£è‡ªå·±éƒ¨é—¨çš„ä¸šåŠ¡ï¼Œè¿˜è¦å‘èµ·è·¨å›¢é˜Ÿçš„æ”¹è¿›ï¼Œè¿˜å’Œå…¶ä»–å›¢é˜Ÿä¸€èµ·ææ–°æŠ€æœ¯ï¼ŒåŒæ—¶è¿˜ç»´æŠ¤ç€è‡ªå·±çš„åšå®¢ï¼Œç‰›çš„è®©ä½ å¿ƒæœå£æœã€‚ æˆä¹‹äºˆæ¸”çœ‹è¿‡é‚£ä¹ˆå¤šä»£ç ä¹Ÿä¸ä¸€å®šå†™çš„å¥½ä»£ç ï¼Œè¯»è¿‡é‚£ä¹ˆå¤šé“ç†ä¹Ÿä¸ä¸€å®šè¿‡çš„å¥½è¿™ä¸€ç”Ÿã€‚å¸ˆå…„æ›¾å†™åˆ°ï¼Œè¦è®©æ–°äººå­¦ä¼šæ‰¿æ‹…æ›´å¤šçš„è´£ä»»ã€‚å¤šè°¢å¸ˆå…„ï¼Œæ•™æˆ‘å¦‚ä½•ä»¥ä¸€ä¸ªownerçš„è§’åº¦å»å‘ç°é—®é¢˜è§£å†³é—®é¢˜ã€‚è‡ªå·±å¾ˆå¹¸è¿ï¼Œé‡åˆ°äº†å¥½å¤šè‰¯å¸ˆç›Šå‹ï¼Œæœ€é‡è¦çš„æ˜¯æˆ‘æ›¾ç»çš„é«˜ä¸­ç­ä¸»ä»»ï¼Œæ•™ä¼šäº†æˆ‘å¦‚ä½•å»å…‹æœè‡ªå·±æœ€å¼±çš„ä¸€é¢ã€‚æ›¾ç»æˆ‘è¯­æ–‡å¾ˆå·®ï¼Œä½†æ˜¯é«˜ä¸‰ä¸€å¹´å…‹æœäº†æé«˜äº†20åˆ†ã€‚æ›¾ç»æˆ‘æœ€å®³æ€•ç¢°å‰ç«¯ï¼Œä¸€ç¢°å°±çƒ¦å°±ä¼šæ‹–è¿›åº¦ï¼Œè€Œç°åœ¨å·²ç»å†³å®šåƒå‰ç«¯çš„é¥­ç¢—äº†ã€‚è¿˜æœ‰å°±æ˜¯æˆ‘çš„ç ”ç©¶ç”Ÿå¯¼å¸ˆï¼Œè™½ç„¶æˆ‘ä»¬éƒ½è§‰å¾—ä»–æ˜¯å·¥ä½œç‹‚ï¼Œä½†æ˜¯ä»–çœŸæ˜¯ä¸ºè‡ªå·±è€Œå·¥ä½œçš„äººï¼Œä»–è®©æˆ‘æ‡‚å¾—äº† ä½ å¯ä»¥é€‰æ‹©åšä½ å–œæ¬¢çš„äº‹ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©åšä½ æ“…é•¿çš„äº‹ï¼Œä½†æ˜¯ä½ ä¸èƒ½ä»€ä¹ˆéƒ½ä¸åš é©¬äº‘è¯´ï¼Œ20å²å‰be a good studentï¼Œ30å²å‰follow a good bossï¼Œ30-40å²work for your selfï¼Œ40-50å²be prefessionalï¼Œ50å²åwork for young people æ¢¦æƒ³è¿˜æ˜¯è¦æœ‰çš„ï¼Œæ²¡ä»€ä¹ˆä¸å¥½]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[QCon2015æ„Ÿæƒ³]]></title>
    <url>%2Fblog%2F2015%2F04%2Ftrivial-thoughts-after-qcon.html</url>
    <content type="text"><![CDATA[æ­¤æ—¶åˆæ˜¯åœ¨ç«è½¦ä¸Šï¼Œå¾…äº†4å¤©æœ‰ç‚¹ç´¯ï¼ŒQCon 2015ï¼Œç¬¬ä¸€æ¬¡å‚åŠ è¿™ä¹ˆä¸Šæ¡£æ¬¡çš„ä¼ä¸šçº§çš„åˆ†äº«ä¼šã€‚æ”¶è·æ€æƒ³çš„åŒæ—¶ï¼Œè¦æ„Ÿè°¢æˆ‘çš„ç ”ç©¶ç”Ÿå¯¼å¸ˆï¼Œé¼“åŠ±æ•´ä¸ªå®éªŒå®¤çš„äººéƒ½å»å‚åŠ å„ç§ä¼šè®®ï¼ŒåŒæ—¶ä¹Ÿè®¤åŒæˆ‘æƒ³å¾€å·¥ç¨‹æ–¹å‘å‘å±•çš„æƒ³æ³•ï¼Œå¹¶æ‰¹å‡†æˆ‘å‡ºå»å®ä¹ ä¸€æ®µæ—¶é—´ã€‚ æ—©å°±åœ¨æµè§ˆå™¨é‡ŒåŠ è¿‡å„ç§è®ºå›ç¤¾åŒºçš„ä¹¦ç­¾ï¼Œä¸è¿‡è‡ªå·±èŠ±çš„æ—¶é—´è¿˜ä¸å¤Ÿï¼Œåªæ˜¯å¶å°”çœ‹çœ‹ä¸€äº›æŠ€æœ¯è®ºå›çš„é‡‡è®¿æŠ¥é“ï¼Œæˆ–è€…æ˜¯åœ¨è®¢é˜…çš„é‚®ä»¶é‡Œç²—ç•¥æ‰«ä¸€ä¸‹é‚£äº›å¤§ç‰›éƒ½åœ¨å¹²å˜›ã€‚è¿™å›äº²èº«ç»å†ï¼Œå¾ˆæ˜¯æ¿€åŠ¨ï¼Œå¤§å¼€äº†çœ¼ç•Œã€‚è§åˆ°äº†èŒèŒå“’@æœ´çµå¤§å¤§ï¼Œæ¡åˆ°äº†æ‰‹~ è¿˜çœ‹åˆ°äº†ä¼ è¯´ä¸­çš„@ç‰ä¼¯ï¼Œè‡ªç§°é»‘ä¾ ï¼Œä½†æˆ‘è§‰å¾—ä¹Ÿæ²¡æœ‰å¾ˆé»‘ã€‚è¿˜æœ‰å†·é…·çš„@é¬¼é“ï¼Œå’Œä»–é‚£å¼ é»‘å®¢å¸å›½çš„å¤´åƒç…§ç‰‡å¾ˆä¸€è‡´ã€‚ ä»€ä¹ˆæ˜¯å‰ç«¯ï¼Ÿè¿™ä¸ªé—®é¢˜æ˜¯æˆ‘ä¹‹å‰é¢è¯•æ—¶è¢«é—®åˆ°çš„ï¼Œå›ç­”çš„å¤ªlowäº†ï¼Œä¹Ÿæ€ªæˆ‘è‡ªå·±ä¹Ÿä»æ²¡æƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œåªæ˜¯ä»ä¸€ä¸ªç½‘ç«™æ„å»ºçš„æµç¨‹ä¸Šå¤§ä½“è¯´äº†ä¸‹å‰ç«¯åŒ…å«å“ªäº›å·¥ä½œã€‚åæ¥æ‰çŸ¥é“é¢è¯•å®˜æ˜¯@ä¸‰ä¸ƒï¼Œå¹¸äºæˆ‘é¢è¯•å‰å‡ å¤©æ­£å¥½çœ‹è¿‡ä»–åœ¨QCon 2014ä¸Šçš„é‡‡è®¿æŠ¥é“ï¼ŒçŸ¥é“äº†Nativeå’ŒHybridè¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œè®©æˆ‘ä¾¥å¹¸è¿‡å…³äº†ã€‚ è¿™æ¬¡çš„QConä¸ŠHybridè¿™ä¸ªè¯è¢«æåˆ°å¾ˆå¤šï¼Œä¸ä»…åœ¨å‰ç«¯ä¸»é¢˜ï¼Œè¿˜åœ¨ç§»åŠ¨å¼€å‘å’Œç§»åŠ¨å¹³å°å·¥å…·ä¸»é¢˜ä¸Šéƒ½æœ‰ã€‚å› æ­¤ä»å¤§çš„èŒƒå›´ä¸Šæ¥è®²ï¼Œå‰ç«¯å·²ç»æ¶µç›–äº†ç§»åŠ¨ç«¯çš„å‰ç«¯ï¼Œè€ŒReactçš„å‡ºç°ï¼Œæ›´åŠ ç¼©å°äº†Webå‰ç«¯å’ŒNativeå‰ç«¯ä¹‹é—´çš„ä»£æ²Ÿã€‚ ä»¥å‰æˆ‘çŠ¯äº†ä¸€ä¸ªä¸¥é‡çš„é”™è¯¯ï¼Œæˆ‘è¯´æˆ‘åªåšWebç«¯ï¼Œå¹¶æ„¿æ„å­¦ä¹ ç§»åŠ¨Webç«¯ï¼Œä½†æˆ‘ç»ä¸ä¼šå»ç¢°Appå¼€å‘ã€‚å½“æ—¶æˆ‘çš„ç†ç”±æ˜¯ï¼ŒAndroidå’ŒIOSæ˜¯å¸­å·è€Œæ¥çš„ï¼ŒæŠŠSymbianæ‰“å®äº†ï¼Œä½†è¯´ä¸å®šå“ªå¤©å®ƒä»¬ä¹Ÿä¼šè¢«åˆ«çš„ç³»ç»Ÿæ‰€å–ä»£ã€‚è€ŒHTMLåŠ JSæ˜¯ç»è¿‡äº†åå‡ å¹´çš„å†å²è¯æ˜çš„ï¼Œè™½ç„¶JSåˆšå¼€å§‹è¢«å†·å˜²çƒ­è®½ï¼Œä½†æ˜¯ç»è¿‡ä¸æ–­å‘å±•å®ƒå·²å˜å¾—è¶Šæ¥è¶Šå¥½ã€‚æ‰€ä»¥å½“æ—¶æˆ‘è§‰å¾—åªä¼šå­˜åœ¨æµè§ˆå™¨å‚å•†ä¹‹é—´çš„æˆ˜äº‰ï¼Œè€ŒWebå¹³å°æœ¬èº«ä¸ä¼šè¢«å…¶ä»–ä¸œè¥¿å–ä»£ï¼Œå·²ç»å­˜åœ¨äº†åå‡ å¹´ï¼Œé‚£ä¹ˆè‡³å°‘è¿˜èƒ½å­˜åœ¨åå‡ å¹´ã€‚ è¿™ç»å¯¹æ˜¯æˆ‘too young too naiveï¼æŠ€æœ¯å­˜åœ¨çš„æœ¬èº«æ˜¯ä¸ºäº†æœåŠ¡ï¼ŒæŠ€æœ¯å‘å±•çš„é©±åŠ¨åŠ›è¦ä¹ˆæ˜¯æ›´å¥½åœ°æœåŠ¡ç”Ÿæ´»ï¼Œè¦ä¹ˆå°±æ˜¯è®©å¼€å‘æ›´ç®€å•ä»¥é™ä½æˆæœ¬æé«˜ç”Ÿäº§åŠ›ã€‚è½¯ä»¶æŠ€æœ¯å‡ºè‡ªå·¥ä¸šæŠ€æœ¯ï¼Œè‚¯å®šæœ‰å…¶ç›¸ä¼¼ä¹‹å¤„ã€‚æ‰€ä»¥JSçš„å‘å±•æ˜¯ä¸ºäº†æé«˜Webç«¯çš„ç”¨æˆ·ä½“éªŒï¼ŒAndroidå’ŒIOSçš„å‡ºç°é¢ è¦†äº†ä¼ ç»Ÿæ‰‹æœºç«¯çš„ç”¨æˆ·ä½“éªŒã€‚è€Œç°åœ¨å¤§ç½‘ç«™ï¼Œåƒå¾®åšã€ç¾å›¢ã€å¤§ä¼—ç‚¹è¯„ä¹‹ç±»ï¼Œç§»åŠ¨ç«¯çš„æµé‡å·²ç»è¿œè¶…PCç«¯ï¼Œæ‰€ä»¥æŠ€æœ¯å‘å±•çš„è¶‹åŠ¿å°±åº”è¯¥æ˜¯æ›´å¥½åœ°æœåŠ¡æ‰‹æœºç”¨æˆ·ã€‚é‚£åšAppçš„è¯ï¼ŒAndroidå’ŒIOSå¾—åˆ†ä¸¤ä¸ªå›¢é˜Ÿï¼Œè€Œä¸”è¿™æ ·WinPhoneç”¨æˆ·è¿˜ä¼šä¸é«˜å…´ã€‚æ‰€ä»¥æ»¡è¶³æ‰€æœ‰ç”¨æˆ·çš„Appæˆæœ¬å¾ˆå¤§ï¼Œäºæ˜¯ç§»åŠ¨ç«¯Webï¼ˆä¸»è¦æ˜¯HTML5ï¼‰çš„å‡ºç°å°±é™ä½äº†Appçš„å¼€å‘æˆæœ¬ï¼Œèƒ½è®©ä¸€ä¸ªHTML5é¡µé¢è‡³å°‘çœ‹èµ·æ¥åƒä¸€ä¸ªAppã€‚ HTML5åƒAppç»ˆç©¶æ˜¯â€œåƒâ€å•Šï¼Œè¦å®ç°ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½çš„è¯ç”¨èµ·æ¥è¿˜æ˜¯æœ‰å·®åˆ«çš„ã€‚äºæ˜¯Reactç«™å‡ºæ¥è¯´â€œæˆ‘èƒ½è®©Appå¼€å‘é—¨æ§›æ›´ä½â€ï¼ŒHTML5æ˜¯å†™ä¸€ä»½ä»£ç ç„¶åäº¤ç»™ä¸åŒç»ˆç«¯çš„æµè§ˆå™¨ï¼Œè€ŒReactä¹Ÿæ˜¯å†™ä¸€ä»½ä»£ç ï¼Œä½†å®ƒèƒ½ç¼–è¯‘å‡ºIOSå’ŒAndroidä¸¤ä¸ªç‰ˆæœ¬ï¼ˆAndroidç‰ˆå¹´åº•æ”¾å‡ºï¼ŒWPæœªçŸ¥ï¼‰ã€‚æ‰€ä»¥æˆ‘è§‰å¾—è¿™äº›æŠ€æœ¯éƒ½æ˜¯æ®Šé€”åŒå½’çš„ï¼Œæœ€ç»ˆéƒ½æ˜¯ä¸ºäº†è®©ç§»åŠ¨ç«¯æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚è€ŒHybridå°±å‡ºæ¥å¯¹Nativeå’ŒWebè¯´ï¼Œä½ ä»¬åˆ«åµå•¦ï¼Œéƒ½æ˜¯ä¸ºäº†åŒä¸€ä¸ªå­©å­ï¼Œå°±ç»“åˆä¸‹å§ã€‚ å‰ç«¯ = ç”¨æˆ·ç«¯ = æ‰‹æœº + å¹³æ¿ + PC ä¸‰ç«¯ä¸€è‡´ä¸”è‰¯å¥½çš„ä½“éªŒ äº§å“å·¥ç¨‹å¸ˆè¿™ä¸ªå®Œæ•´çš„åè¯æ˜¯åœ¨å¬â€œç½‘æ˜“äº‘éŸ³ä¹â€çš„æŠ€æœ¯æ€»ç›‘æŠ¥å‘Šæ—¶å¬åˆ°çš„ï¼Œè€Œâ€œé’äº‘â€çš„å·¥ç¨‹å¸ˆæŠ¥å‘Šä¸­ä¹Ÿæåˆ°äº†ä»–ä»¬å…¬å¸çš„å‰ç«¯å·¥ç¨‹å¸ˆå¯ä»¥ç‹¬å½“ä¸€é¢ï¼Œä¸éœ€è¦äº§å“å’Œç¾æœ¯ã€‚å‰è€…çš„å‰ç«¯æ˜¯ä¸€ä¸ªå¯Œäº¤äº’çš„Appï¼Œè€Œåè€…çš„å‰ç«¯åªæ˜¯ä¸€ä¸ªç»™å·¥ç¨‹å¸ˆç”¨çš„ç®¡ç†å¹³å°ï¼Œæ‰€ä»¥åè€…å¯ä»¥ä¸éœ€è¦äº§å“ç‹—ã€‚ä½†ä»–ä»¬éƒ½æåˆ°äº†ä¸€å¥è¯ï¼š è¦æŠŠäº§å“å½“åšè‡ªå·±çš„å­©å­ æ‰€ä»¥å‰ç«¯å·¥ç¨‹å¸ˆè¿›è¡Œå‡çº§ï¼Œæ›´å¤šä¸€ç‚¹äº§å“senseï¼Œä¸ºäº†ä¸€ç‚¹ç‚¹äº§å“ä½“éªŒçš„æå‡å¯ä»¥ä»˜å‡ºæ›´å¤šçš„åŠªåŠ›ï¼Œä¹Ÿè®¸æ˜¯å‰ç«¯ç å†œçš„ä¸€ä¸ªå¯ä»¥å‘å±•çš„æ–¹å‘ã€‚ åˆ«äººçœ¼ä¸­çš„å¹²è´§ä½œä¸ºå­¦ç”Ÿï¼Œå¯èƒ½è®¤ä¸ºâ€œå¹²è´§â€å°±æ˜¯å¯ä»¥ç›´æ¥â€œå¹²â€çš„è´§ï¼Œæˆ‘æ›´å¸Œæœ›èƒ½æœ‰å…·ä½“çš„åšæ³•ã€‚ä½†æ˜¯æˆ‘åˆtoo naiveäº†ï¼Œä½œä¸ºä¼ä¸šï¼Œæ€ä¹ˆå¯èƒ½æŠŠæœ€æ ¸å¿ƒçš„å…·ä½“åšæ³•æš´éœ²ç»™ç«äº‰å¯¹æ‰‹ï¼Œè¿™å¯æ˜¯ä¸€ä¸ªæŠ€æœ¯å‹ä¼ä¸šçš„æ ¸å¿ƒç«äº‰åŠ›ã€‚å› æ­¤è¿™æ¬¡QConä¸Šï¼Œåˆ«äººçœ¼ä¸­çš„å¹²è´§å…¶å®æ˜¯è¿™æ ·çš„ã€‚ å¹²è´§ = åˆ«äººå·²ç»â€œå¹²â€å‡ºæ¥çš„è´§ æˆ‘åˆæƒ³èµ·æ¥ä¸€å¹…å›¾ï¼Œå¾ˆå½¢è±¡ æœ‰äº›ä¼ä¸šåªä¼šå‘Šè¯‰ä½ ç¬¬1æ­¥ï¼Œæœ‰äº›å¯èƒ½ä¼šè¯´åˆ°ç¬¬3ç¬¬4æ­¥ï¼Œä½†ç»ä¸ä¼šå‘Šè¯‰ä½ æœ€åä¸€æ­¥ã€‚åˆ«äººåªä¼šå‘Šè¯‰ä½ ä»–ä»¬åšè¿‡å“ªäº›å°è¯•ï¼Œåšæˆäº†ä»€ä¹ˆï¼Œåªä¼šå‘Šè¯‰ä½ å¤§ä½“çš„æ–¹å‘å’Œæœ€åçš„å¯¹æ¯”ç»“æœã€‚æ‰€è°“æˆä¹‹ä»¥é±¼ä¸å¦‚æˆä¹‹ä»¥æ¸”ã€‚ å¹²è´§ = è‡ªå·±ä»Šåå¯ä»¥â€œå¹²â€çš„è´§ å¤§å®¶éƒ½åœ¨é€ è½®å­â€œé€ è½®å­â€è¿™ä¸ªæ„Ÿå—éå¸¸å¼ºçƒˆï¼ŒåŒä¸€ä»¶äº‹æƒ…ï¼Œå¯èƒ½å¤§å®¶éƒ½åœ¨åšï¼Œåªæ˜¯å…·ä½“åšæ³•ä¸ä¸€æ ·ï¼Œä»¥åŠèƒŒåçš„ç†å¿µä¹Ÿä¸ä¸€æ ·ã€‚ è¿˜æ‹¿Reactä½œä¸ºä¾‹å­ï¼ŒFacebookå°†å®ƒå¼€æºäº†ï¼Œå¹¶é¢„è®¡åœ¨ä»Šå¹´11æœˆreleaseå‡ºAndroidç‰ˆã€‚åœ¨è¿™æ¬¡ä¼šä¸Šå¾—çŸ¥ï¼Œæœ‰å®¶å«Geek Zoo Studioçš„åˆ›ä¸šå…¬å¸ä¹Ÿåšäº†ç±»ä¼¼çš„äº‹æƒ…ï¼Œå¹¶ä¸”èµ¶åœ¨è¿™æ¬¡å¤§ä¼šå‰ä¸€å‘¨ä¹Ÿå¼€æºäº†ï¼Œå®ƒå«SAMURAIã€‚React Nativeæ—¨åœ¨å¸®åŠ©Webç¨‹åºå‘˜ä¹Ÿèƒ½å¼€å‘IOSåº”ç”¨ï¼Œç”¨JSXçš„æ–¹å¼ï¼Œé™ä½IOSçš„å¼€å‘é—¨æ§›ã€‚è€ŒSamurai Nativeæ—¨åœ¨è®©IOSå¼€å‘è€…èƒ½å¤Ÿç”¨ç±»ä¼¼HTMLæ ‡ç­¾çš„æ–¹å¼æ¥å¼€å‘ï¼ˆå°†ç±»åå†™æˆHTMLæ ‡ç­¾åï¼‰ã€‚è€Œåœ¨æ­¤ä¹‹å‰å·²ç»æœ‰PhoneGapï¼Œä½†å®ƒæ˜¯ç”¨WebViewåµŒå¥—HTML5çš„ä¼ªNativeï¼ˆæˆ–è€…å«Hybrid Nativeï¼‰ã€‚è€ŒSamurai Nativeå†…éƒ¨å®ç°äº†web-coreï¼Œæ˜¯çº¯åŸç”Ÿçš„ï¼Œæ‰€ä»¥å®ƒçš„åˆ›å§‹äººç§°ä¹‹ä¸ºSemi-Hybridã€‚å¹¶ä¸”ä»–ç§°ä¹Ÿå°†åœ¨ä»Šå¹´å¹´åº•å‡ºAndroidç‰ˆã€‚ è¿˜æœ‰ä¸€äº›å…¬å¸åœ¨åšç§»åŠ¨å¼€å‘çš„å®Œæ•´æµç¨‹æœåŠ¡ï¼ŒåŒ…æ‹¬ç¯å¢ƒã€è‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²ï¼Œä¹ŸåŒ…æ‹¬äº†é‡‡ç”¨ç±»ä¼¼Webçš„æ–¹å¼æ¥å¼€å‘ï¼Œæœ€åæ˜ å°„æˆæ‰‹æœº/å¹³æ¿/PCä¸‰ç«¯ã€‚ å°½ç®¡ä¸Šé¢çš„å†å²å‘å±•é”™ç»¼å¤æ‚ï¼Œä½†å®ƒä»¬æœ¬è´¨ä¸Šéƒ½åœ¨ä¸ºåŒä¸€ä»¶äº‹æƒ…åŠªåŠ›ï¼Œé‚£å°±æ˜¯è®©Nativeå¼€å‘æ›´ç®€å•ã€‚è€Œäº‰ç›¸é€ è½®å­çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†æé«˜ä¼ä¸šæ ¸å¿ƒæŠ€æœ¯ç«äº‰åŠ›ã€‚ å‹¿å¿˜åˆå¿ƒè¿™æ˜¯èš‚èšé‡‘æœçš„å·¥ç¨‹å¸ˆç»™æˆ‘çš„æ„Ÿå—ã€‚ä»–ä»¬åšäº†ä¸€æ¬¾å†…éƒ¨ä½¿ç”¨çš„äº§å“ï¼Œç»“æœå“åº”äº†å¤ªå¤šéœ€æ±‚ï¼Œåšæˆäº†ä¸€ä¸ªåºç„¶å¤§ç‰©ï¼Œä»¥è‡´äºç”¨æˆ·ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨ã€‚æœ€åä»–ä»¬2.0ç‰ˆæœ¬çš„äº§å“ç æ‰äº†1.0ç‰ˆæœ¬çš„å¾ˆå¤šåŠŸèƒ½ã€‚ è®¤æ¸…ä¸åšä»€ä¹ˆæ›´é‡è¦ æ‰€ä»¥åšä¸€ä»¶äº‹æƒ…ä¸€å®šè¦å®šä½æ¸…æ™°ï¼Œåªä¸ºä¸€ç±»äººæœåŠ¡ã€‚ä¸€æ—¦æ˜ç¡®äº†åšä»€ä¹ˆï¼Œæœ€ç»ˆç›®æ ‡å°±æ˜¯åšâ€œæ­»â€ï¼Œåªåšå¥½ä¸€ä»¶äº‹ã€‚ å‹¿å¿˜åˆå¿ƒ è¿œæ–¹çš„è·¯ æ°¸ä¸æ­¢æ­¥]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‡ é“JSé¢è¯•é¢˜-å‰ç¥¥ä¸‰å®]]></title>
    <url>%2Fblog%2F2015%2F04%2Fsome-interview-questions-of-javascript-2.html</url>
    <content type="text"><![CDATA[ç°åœ¨ååœ¨å»åŒ—äº¬çš„é«˜é“ä¸Šï¼Œåˆšæ‰ç©äº†ä¸¤æŠŠæå“é£è½¦ï¼Œé…ç€åˆ—è½¦çš„åº§ä½å’Œé¢ ç°¸ï¼Œå¾ˆå¸¦æ„Ÿï¼çœ¼ç›ç´¯äº†ï¼Œæœ€è¿‘ç¡®å®æ¯”è¾ƒå¿™ï¼Œåˆæ˜¯æ‹–äº†å¥½ä¹…å°±æƒ³å†™çš„åšå®¢ï¼Œåœ¨è¿™ä¸ªç‰¹æ®Šçš„åœ°æ–¹ï¼Œå¼ºçƒˆæŠµåˆ¶è‡ªå·±çš„æ‹–å»¶ç—‡ï¼ ä¸Šä¸€ç¯‡JSé¢è¯•é¢˜éƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒåŒä¸€ä¸ªäººé¢è¯•çš„è¯ä¸ä¼šé—®å¤ªå¤šï¼Œè€ŒJSä¸­çš„åŸå‹ã€ä½œç”¨åŸŸå’Œé—­åŒ…æ˜¯é¢è¯•å®˜é—®çš„æœ€å¤šçš„ï¼Œæˆ‘ç§°ä¹‹ä¸ºâ€œå‰ç¥¥ä¸‰å®â€ã€‚ ä½œç”¨åŸŸè¯´ç™½äº†å°±æ˜¯æŸä¸ªå‡½æ•°æ‰§è¡Œæ—¶thisæŒ‡å‘è°çš„é—®é¢˜ã€‚ é—®é¢˜1ï¼š 12345678var obj = &#123; run: function()&#123; function test()&#123; alert(this); &#125; test(); &#125;&#125;;obj.run(); obj.run()è¿›å…¥å‡½æ•°ä¸»ä½“æ—¶ï¼Œå› ä¸ºè°ƒç”¨è€…æ˜¯objï¼Œå› æ­¤run()å†…éƒ¨thisæ˜¯æŒ‡å‘objçš„ã€‚ä½†æ˜¯run()å†…éƒ¨åˆå®šä¹‰äº†ä¸€ä¸ªfunctionï¼Œç›´æ¥æ‰§è¡Œäº†test()ï¼Œå› æ­¤test()å†…éƒ¨çš„thisæœªæ˜¾å¼æŒ‡å®šï¼Œthisé»˜è®¤æŒ‡å‘å°±æ˜¯windowã€‚ é—®é¢˜2ï¼š 1234567891011121314151617var name = 'window';var obj = &#123; name: 'obj', child: &#123; // name: 'child', getName: function () &#123; return this.name; &#125; &#125;&#125;;var getName = obj.child.getName;alert(getName());alert(obj.child.getName()); å› ä¸ºç›´æ¥æŠŠobj.child.getNameèµ‹ç»™äº†getNameå˜é‡ï¼Œå› æ­¤getNameå°±æ˜¯ä¸ªfunctionï¼Œç›´æ¥è°ƒç”¨getName()æ—¶å…¶å†…éƒ¨thisæŒ‡å‘çš„æ˜¯é»˜è®¤å€¼windowï¼Œå› æ­¤alertç»“æœæ˜¯windowã€‚ è€Œè°ƒç”¨obj.child.getName()æ—¶ï¼ŒæŒ‡å®šäº†è°ƒç”¨è€…å¯¹è±¡ï¼Œå› æ­¤å‡½æ•°å†…éƒ¨çš„thisæŒ‡å‘obj.childå¯¹è±¡ã€‚ç”±äºchildé‡Œé¢çš„nameç»™æˆ‘æ³¨é‡Šæ‰äº†ï¼Œå› æ­¤obj.child.getName()é‡Œè®¿é—®ä¸åˆ°this.nameï¼Œå°±alertå‡ºundefinedï¼ˆobj.nameæ˜¯ç”¨æ¥è¿·æƒ‘çš„ï¼‰ã€‚å¦‚æœå°†æ­¤æ³¨é‡Šå»æ‰çš„è¯ï¼Œalertç»“æœå°±æ˜¯childã€‚ é—®é¢˜3ï¼š 12345678910111213function a(x, y)&#123; y = function()&#123; x = 2; &#125;; return function()&#123; var x = 3; y(); console.log(x); &#125;.apply(this, arguments);&#125;a(); è¿™é¢˜æ˜¯åœ¨ruanyfè€å¸ˆçš„å¾®åšä¸Šçœ‹åˆ°çš„ï¼Œæ„æ€æ˜¯å¾ˆéš¾çš„ä¸€é“é¢è¯•é¢˜ï¼Œåœ¨consoleé‡Œè¯•äº†ä¸‹æ‰æƒ³é€šäº†ç»“æœã€‚ æ‰§è¡Œa()æœªä¼ å…¥å®é™…å‚æ•°ï¼Œæ‰€ä»¥a()åˆšè¿›å…¥æ—¶ï¼Œx`yéƒ½æ˜¯undefinedã€‚ç„¶åå¯¹yå˜é‡èµ‹å€¼æˆä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨å°†æ”¹å˜xçš„å€¼ï¼Œè¿™é‡Œçš„xå°±æ˜¯aå‡½æ•°å®šä¹‰æ—¶çš„å½¢å¼å‚æ•°x`ã€‚ å‡½æ•°å®šä¹‰æ—¶æ‹¬å·é‡Œçš„å«å½¢å¼å‚æ•°ï¼ŒJSä¸­å‡½æ•°è°ƒç”¨æ—¶ä¼ å…¥çš„å®é™…å‚æ•°å¯ä¸å½¢å¼å‚æ•°æ•°ç›®ä¸ä¸€è‡´ã€‚è€ŒargumentsæŒ‡çš„æ˜¯å®é™…å‚æ•°ï¼Œå› æ­¤a()é‡Œé¢thisæŒ‡å‘windowï¼Œè€Œargumentså°±æ˜¯ç©ºæ•°ç»„ã€‚ ç„¶åæ‰§è¡Œa()é‡Œé¢çš„åŒ¿åå‡½æ•°ï¼Œé‡æ–°å®šä¹‰äº†å±€éƒ¨å˜é‡x = 3ï¼Œç„¶åè°ƒç”¨åŒ¿åå‡½æ•°å¤–éƒ¨çš„y()ã€‚è€Œä¸Šé¢å·²è¯´yå†…éƒ¨æ”¹å˜çš„æ˜¯aå‡½æ•°çš„å½¢å¼å‚æ•°xçš„å€¼ï¼Œå› æ­¤ä¸ä¼šå½±å“åŒ¿åå‡½æ•°å†…éƒ¨çš„xï¼Œæ‰€ä»¥è¾“å‡ºç»“æœå°±æ˜¯3ã€‚è¿™é‡Œä¹Ÿå¯ä»¥ç”¨é—­åŒ…æ¥è§£é‡Šï¼Œconsole.log(x)çœ‹åˆ°çš„å°±æ˜¯åŒ¿åå‡½æ•°å†…éƒ¨çš„å˜é‡xï¼Œyå‡½æ•°å†…éƒ¨çœ‹ä¸åˆ°åŒ¿åå‡½æ•°å†…éƒ¨çš„å˜é‡ã€‚ åŸå‹åŸå‹prototypeæ˜¯ç”¨æ¥å®ç°JSä¸­çš„å¯¹è±¡ç»§æ‰¿çš„ï¼Œå…·ä½“å¯çœ‹æˆ‘ä»¥å‰è¿™ç¯‡Javascriptæ¨¡å¼ä¹‹äº”-ä»£ç å¤ç”¨æ¨¡å¼ã€‚ é—®é¢˜1ï¼š 12345678var A = function()&#123; this.name = 'A';&#125;;A.prototype.say = function()&#123; alert(this.name);&#125;;var B = function()&#123; &#125;; Q1ï¼šå†™æ®µä»£ç è®©Bç»§æ‰¿A 123var F = function()&#123;&#125;;F.prototype = A.prototype;B.prototype = new F(); æˆ‘ä½¿ç”¨äº†åœ£æ¯æ¨¡å¼çš„æ€æƒ³æ¥ç»§æ‰¿ï¼Œé€šè¿‡ä¸€ä¸ªä¸­é—´çš„ç©ºå‡½æ•°ï¼Œä½¿å¾—Bçš„åŸå‹å¯¹è±¡å®ä¾‹æœ€å°ï¼Œä¸ä¼šåŒ…å«Açš„å®ä¾‹å˜é‡nameã€‚ Q2ï¼šä¸‹é¢è¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿ 12var objB = new B();objB.say(); å¦‚æœæŒ‰ç…§æˆ‘ä¸Šé¢é‚£ç§ç»§æ‰¿æ–¹æ³•çš„è¯ï¼Œç”±äºBçš„åŸå‹å¯¹è±¡å…¶å®Fçš„å®ä¾‹ï¼ˆFçš„åŸå‹æŒ‡å‘Açš„åŸå‹ï¼‰ï¼ŒFçš„å®ä¾‹ä¸­å¹¶æ²¡æœ‰nameå±æ€§ï¼Œæ‰€ä»¥objB.say()è®¿é—®ä¸åˆ°this.nameï¼Œç»“æœå°±æ˜¯undefinedå•¦ã€‚ å¦‚æœä¸Šé¢çš„ç»§æ‰¿ä»£ç æ”¹æˆB.prototype = new A()å°±è¿™ä¸€å¥ï¼Œé‚£ä¹ˆBçš„åŸå‹å¯¹è±¡å°±æ˜¯Açš„å®ä¾‹ï¼Œå› æ­¤Bçš„åŸå‹ä¸­å°±æœ‰Açš„å®ä¾‹å±æ€§nameï¼Œæ‰€ä»¥objB.say()èƒ½è®¿é—®åˆ°this.nameã€‚ é—®é¢˜2ï¼š 123456Function.prototype.f = function()&#123;&#125;;Object.prototype.o = function()&#123;&#125;;function Factory()&#123;&#125;var car = new Factory(); Qï¼šèƒ½è°ƒç”¨car.f()å’Œcar.o()å—ï¼Ÿ é¦–å…ˆcaræ˜¯ä¸ªnewå‡ºæ¥çš„å¯¹è±¡ï¼Œè€ŒJSä¸­æ‰€æœ‰å¯¹è±¡çš„åŸå‹é“¾è¿½æº¯åˆ°é¡¶å±‚éƒ½æ˜¯Objectï¼Œå³æ‰€æœ‰å¯¹è±¡éƒ½ç»§æ‰¿è‡ªObjectï¼Œå› æ­¤car.o()è‚¯å®šæ²¡é—®é¢˜ã€‚ typeof caræ˜¯objectï¼Œè€Œcar.constructoræ˜¯Factoryã€‚typeof Factoryæ˜¯functionï¼Œè€ŒJSä¸­æ‰€æœ‰functionçš„constructoré»˜è®¤éƒ½æ˜¯Functionï¼Œå› æ­¤Factory.f()æ˜¯èƒ½è°ƒç”¨åˆ°çš„ã€‚å³car.constructor.f()èƒ½è°ƒç”¨åˆ°ï¼Œè€Œcar.f()æ˜¯æ— æ³•è°ƒç”¨åˆ°çš„ã€‚ é—­åŒ…é¢è¯•ä¸­é—®é—­åŒ…é—®çš„æœ€å¤šçš„å°±æ˜¯å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œæˆ‘åœ¨ä½¿ç”¨é—­åŒ…è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜è¿™ç¯‡æ–‡ç« ä¸­å·²ç»åˆ—å‡ºå¾ˆå¤šä¾‹å­äº†ã€‚æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªæ•°ç»„var array = [1, 2, 3, 4]ï¼Œè¯·æ¯éš”1ç§’ä¾æ¬¡è¾“å‡ºæ•°ç»„ä¸­çš„å…ƒç´ ã€‚è¿™é‡Œå°±ä¸å¤šå†™äº†ã€‚ æ€»ç»“JSä¸­çš„åŸå‹ã€ä½œç”¨åŸŸå’Œé—­åŒ…æ˜¯éå¸¸é‡è¦çš„ï¼Œè¿™æ˜¯è¯­è¨€æœºåˆ¶ï¼Œä¹Ÿæ˜¯è¿™ä¸ªè¯­è¨€çš„é­…åŠ›ã€‚æœ‰äº†æ‰å®çš„åŸºç¡€ï¼Œå†å»ç†è§£æ¨¡å—åŒ–å°±ä¼šå®¹æ˜“äº›ï¼Œç„¶åå†äº†è§£ä¸€äº›RequireJSï¼Œå°±èƒ½å¾—åˆ°é¢è¯•å®˜çš„å–œæ¬¢ï¼Œè‡³å°‘åŸºç¡€å…³æ²¡å¤ªå¤§é—®é¢˜ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‡ é“JSé¢è¯•é¢˜-åŸºç¡€ç¯‡]]></title>
    <url>%2Fblog%2F2015%2F04%2Fsome-interview-questions-of-javascript-1.html</url>
    <content type="text"><![CDATA[æ‹–äº†å¥½ä¹…çš„æ–‡ç« ï¼Œéƒ½æ˜¯å¿«ä¸€ä¸ªæœˆå‰çš„äº‹äº†ï¼Œéƒ½æ˜¯ç”µè¯é¢è¯•çš„ï¼Œæœ€è¿‘çš„è…¾è®¯ç¬”è¯•å±…ç„¶éƒ½æ²¡è¿‡ï¼Œä¸å¼€å¿ƒã€‚ã€‚ã€‚é¿å…æ‹–å»¶ç—‡ï¼Œè¿˜æ˜¯æƒ³æŠŠä¹‹å‰æ•´ç†çš„å’Œæƒ³åˆ°çš„èµ¶ç´§å†™ä¸‹æ¥ã€‚ åˆ¤æ–­æ•°ç»„æˆ‘ç­”ï¼š ä¸èƒ½ä½¿ç”¨typeofåˆ¤æ–­ï¼Œå› ä¸º typeof arr == â€˜objectâ€™ instanceof arr == Array arr.constructor == Array åæ¥æŸ¥èµ„æ–™è¿˜æœ‰ä¸€ç§ Object.prototype.toString.call(arr) == â€˜[object Array]â€™ å¼•ç”³ï¼šæ—¢ç„¶åˆ¤æ–­æ•°ç»„ï¼Œå¦‚æœåˆ¤æ–­æ•°å­—å‘¢ï¼Ÿ typeof num == â€˜numberâ€™ isNaN(num) == false æ³¨æ„ï¼šä¸èƒ½ç”¨NaNåˆ¤æ–­ï¼Œå› ä¸ºNaN !== NaN undefinedä¸nullçš„åŒºåˆ« undefinedè¡¨ç¤ºå€¼ç¼ºå¤±ï¼Œæœªå®šä¹‰ nullè¡¨ç¤ºæœ‰å€¼äº†ï¼Œåªä¸è¿‡å€¼å°±æ˜¯nullï¼Œå¸¸ç”¨äºæ¸…ç†å†…å­˜ è¿˜æœ‰æ›´å¥‡æ€ªçš„ 1234typeof null // 'object'typeof undefined // 'undefined'Number(null) // 0Number(undefined) // NaN ä¸€æ®µå°ç¨‹åºæœ‰å¦‚ä¸‹æ•°æ®æ ¼å¼ 1234567891011121314151617var data = [&#123; "id": 1, "province": "æ±Ÿè‹", "city": "å—äº¬"&#125;, &#123; "id": 2, "province": "æ±Ÿè‹", "city": "é•‡æ±Ÿ"&#125;, &#123; "id": 3, "province": "æ±Ÿè‹", "city": "å—äº¬"&#125;, &#123; "id": 4, "province": "å®‰å¾½", "city": "åˆè‚¥"&#125;]; è¿™é‡Œæˆ‘æŠŠæ•°æ®ç®€åŒ–äº†ï¼Œå®ƒå…¶å®è¡¨ç¤ºçš„æ˜¯ä¸€å®¶å®¶åº—çš„æ‰€åœ¨ä½ç½®ï¼Œå½“ç„¶åŒä¸€ä¸ªåŸå¸‚å¯èƒ½ä¼šæœ‰å¤šå®¶åˆ†åº—ã€‚ç°åœ¨è¦å†™æ®µç¨‹åºï¼Œä»ä¸Šé¢çš„æ•°æ®ä¸­æå–å‡ºçœä»½å’ŒåŸå¸‚ï¼Œå¦‚ä¸‹æ ¼å¼è¾“å‡ºã€‚ 1234567891011121314151617181920212223[&#123; "text": "æ±Ÿè‹", "value": "æ±Ÿè‹", "children": [ &#123; "text": "å—äº¬", "value": "å—äº¬" &#125;, &#123; "text": "é•‡æ±Ÿ", "value": "é•‡æ±Ÿ" &#125; ]&#125;, &#123; "text": "å®‰å¾½", "value": "å®‰å¾½", "children": [ &#123; "text": "åˆè‚¥", "value": "åˆè‚¥" &#125; ]&#125;] å®ƒå°±æ˜¯æƒ³ä»ä¸€ä¸ªåŒ…å«é‡å¤çœå¸‚çš„æ•°ç»„ä¸­å»æå–å»é‡åçš„çœå¸‚çº§è”å…³ç³»ï¼ˆçˆ¶å­å…³ç³»ï¼‰ï¼Œäºæ˜¯æˆ‘é¦–å…ˆæƒ³åˆ°ç”¨mapï¼ŒJSä¸­å°±æ˜¯{} 1234567891011121314151617181920212223242526272829303132333435var provinceMap = &#123;&#125;;var tempProv;var tempCity;// éå†ï¼Œç”¨mapå»é‡for(var i=0, len=data.length; i&lt;len; i++)&#123; tempProv = data[i]['province']; tempCity = data[i]['city']; if(typeof provinceMap[tempProv] === 'undefined')&#123; provinceMap[tempProv] = &#123;&#125;; &#125; provinceMap[tempProv][tempCity] = tempCity;&#125;var result = [];// mapè½¬æˆarrayfor(tempProv in provinceMap)&#123; var cities = []; for(tempCity in provinceMap[tempProv])&#123; cities.push(&#123; text: tempCity, value: tempCity &#125;); &#125; result.push(&#123; text: tempProv, value: tempProv, children: cities &#125;);&#125;console.log(result); è¿™é‡ŒprovinceMapä¸­æ¯ä¸ªprovinceåˆæ˜¯ä¸€ä¸ªmapï¼Œé‡Œé¢æˆ‘ç”¨cityååškeyï¼Œæ¯”èµ·ç”¨æ•°ç»„è¿˜å¾—æ¯æ¬¡å»é‡ï¼Œè¿™ç®—æ¯”è¾ƒå·æ‡’çš„å†™æ³•ï¼ŒæŠŠå·¥ä½œäº¤ç»™äº†ç¼–è¯‘å™¨ã€‚ ç„¶åè¢«é—®ï¼šè¿˜æœ‰åˆ«çš„å»é‡åŠæ³•å—ï¼Ÿ æç¤ºï¼šç”¨å­—ç¬¦ä¸² è¿˜æ˜¯ç”¨ä¸Šé¢çš„provinceMapï¼Œä¸è¿‡æ¯ä¸ªprovince keyå¯¹åº”çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåƒå—äº¬ é•‡æ±Ÿç”¨ç‰¹å®šç¬¦å·åˆ†éš”ã€‚å¦‚æ­¤å»é‡åªè¦ç”¨indexOfåˆ¤æ–­å³å¯ã€‚ å°ç»“è¿™ç¯‡ä¸»è¦è€ƒçš„æ˜¯JSä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ•°å€¼ã€å¸ƒå°”ã€å­—ç¬¦ä¸²ã€nullå’Œundefinedï¼Œé™¤è¿™5ç§å¤–ï¼Œå…¶ä»–éƒ½æ˜¯å¯¹è±¡ï¼Œæ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ã€‚JSé¢è¯•ä¸­æœ€é‡è¦çš„å‡ ç‚¹éƒ½æ˜¯ï¼šä½œç”¨åŸŸã€åŸå‹ã€é—­åŒ…ï¼Œè¯·çœ‹ä¸‹ä¸€ç¯‡ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(8)]]></title>
    <url>%2Fblog%2F2015%2F04%2Fstep-by-step-js-component-schoolbox-8.html</url>
    <content type="text"><![CDATA[æœ€è¿‘é¢è¯•ç»å¸¸æ‹¿è¿™ä¸ªå­¦æ ¡é€‰æ‹©å™¨ä½œä¸ºä¾‹å­æ¥è®²è‡ªå·±çš„JSå­¦ä¹ è¿‡ç¨‹ï¼Œæœ‰ä½å·¥ç¨‹å¸ˆå“¥å“¥ç›´æ¥æ‰“å¼€è¿™é‡Œâ€œæ³¨å†Œâ€é‡Œçš„ç¬¬äºŒæ­¥ï¼Œå°±æ˜¯æˆ‘è¿™ä¸ªåŠŸèƒ½æœ€åˆåº”ç”¨çš„åœ°æ–¹ã€‚è·Ÿä»–è®¨è®ºå®ç°æ¨¡æ€æ—¶äº‹ä»¶çš„unbindè¿™ç§æ–¹å¼æ˜¯ä¸æ˜¯ä¸å¥½æ—¶ï¼Œä»–ç»™äº†æˆ‘ä¸€ç‚¹å¯å‘ï¼Œäºæ˜¯æˆ‘å›è¿‡å¤´æ¥é‡æ–°æ€è€ƒã€‚ é—®é¢˜æ¥æºå‡è®¾é¡µé¢ä¸Šæœ‰è¿™ä¹ˆä¸‰è¡Œå…ƒç´  123456789101112131415&lt;div&gt; &lt;input type="text" class="school-input" readonly/&gt; &lt;input type="text" class="school-id" readonly&gt; &lt;a href="javascript:void(0)" class="choose-school"&gt;é€‰æ‹©å­¦æ ¡&lt;/a&gt;&lt;/div&gt;&lt;div&gt; &lt;input type="text" class="school-input" readonly/&gt; &lt;input type="text" class="school-id" readonly&gt; &lt;a href="javascript:void(0)" class="choose-school"&gt;é€‰æ‹©å­¦æ ¡&lt;/a&gt;&lt;/div&gt;&lt;div&gt; &lt;input type="text" class="school-input" readonly/&gt; &lt;input type="text" class="school-id" readonly&gt; &lt;a href="javascript:void(0)" class="choose-school"&gt;é€‰æ‹©å­¦æ ¡&lt;/a&gt;&lt;/div&gt; æƒ³è¦å¯¹æ¯è¡Œéƒ½â€œé€‰æ‹©å­¦æ ¡â€ï¼Œå¹¶å°†é€‰ä¸­çš„å€¼å¡«å›è¯¥è¡Œä¸­çš„inputå…ƒç´ ä¸­ï¼Œæœ€æ—©ä»£ç æ˜¯é…±ç´«çš„ã€‚ 1234567891011$('.choose-school').click(function(event)&#123; var $source = $(this); // ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ schoolBox.on('schoolChosen', function(data)&#123; $source.siblings('.school-input').val(data.schoolName); $source.siblings('.school-id').val(data.schoolId); &#125;); schoolBox.show();&#125;); å½“ç‚¹ä¸€ä¸ªå…ƒç´ æ—¶æ²¡é—®é¢˜ï¼Œä½†æ˜¯ç‚¹äº†ä¸¤ä¸ªä¸‰ä¸ªå…ƒç´ åï¼Œå°±ä¼šå‘ç°æ¯æ¬¡â€œé€‰æ‹©å­¦æ ¡â€åéƒ½ä¼šä¸€èµ·åˆ·æ–°ã€‚åŸå› å°±åœ¨äºè¿™ä¸‰ä¸ªå…ƒç´ éƒ½æŠŠå„è‡ªçš„å›è°ƒåŠ ç»‘åˆ°äº†schoolChosenäº‹ä»¶ä¸­ï¼Œè€ŒschoolBoxçš„schoolChosenè¢«è§¦å‘æ—¶ï¼Œå®ƒä¼šä¾æ¬¡è°ƒç”¨ç»‘åˆ°å®ƒèº«ä¸Šçš„handlersã€‚ åœ¨SchoolBoxå†…éƒ¨çš„å®ç°ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªmapæ¥è®°å½•æ‰€æœ‰çš„äº‹ä»¶å›è°ƒï¼Œkeyæ˜¯äº‹ä»¶åç§°ï¼Œè€Œvalueæ˜¯ç›‘å¬è¯¥äº‹ä»¶çš„å›è°ƒå‡½æ•°çš„æ•°ç»„ã€‚ 12345678910111213141516SchoolBox.prototype = &#123; on: function(type, handler)&#123; if(typeof this.handlers[type] === 'undefined')&#123; this.handlers[type] = []; &#125; this.handlers[type].push(handler); &#125;, fire: function(type, data)&#123; if(this.handlers[type] instanceof Array)&#123; var handlers = this.handlers[type]; for(var i=0, len=handlers.length; i&lt;len; i++)&#123; handlers[i](data); &#125; &#125; &#125;&#125;; å› æ­¤ä»¥ä¸Šå®ç°ä»£ç æ˜¯æœ‰å¼Šç«¯çš„ï¼Œé¡µé¢ä¸Šå¤šä¸ªå…ƒç´ å…±äº«åŒä¸€ä¸ªæ¨¡æ€å¯¹è¯æ¡†æ—¶ï¼Œæ— æ³•æ­£ç¡®åœ°å“åº”äº‹ä»¶ã€‚ åœ¨ä¸Šä¸€ç¯‡ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(7)ä¸­ä½¿ç”¨äº†ä¸€ç§æš´åŠ›çš„è§£å†³åŠæ³•ï¼Œæ¯æ¬¡clickæ—¶éƒ½å¯¹SchoolBoxå¯¹è±¡unbindæ‰æ‰€æœ‰çš„äº‹ä»¶ï¼Œç„¶åé‡æ–°ç›‘å¬ï¼Œä»¥ä¿è¯æ¯æ¬¡æ‰“å¼€SchoolBoxæ—¶handlers mapä¸­è¯¥äº‹ä»¶ç±»å‹çš„å›è°ƒå‡½æ•°åªæœ‰å”¯ä¸€çš„ä¸€ä¸ªã€‚å¾ˆæ˜æ˜¾è¿™ç§åšæ³•ä¸æ˜¯å¾ˆå¦¥ã€‚ ä»ç›‘å¬ä¸Šå…¥æ‰‹ç”±äºä¸Šé¢çš„ä»£ç åœ¨ç›‘å¬æ—¶åªç»‘å®šäº‹ä»¶åç§°ï¼Œä¸åŒºåˆ†ç›‘å¬è€…å…ƒç´ ï¼Œå› æ­¤å¾ˆå®¹æ˜“æƒ³åˆ°åœ¨onç›‘å¬æ—¶æŠŠå½“å‰æ“ä½œçš„å…ƒç´ IDè¿åŒå›è°ƒå‡½æ•°ä¸€èµ·ä¼ å…¥ã€‚è¿™æ ·çš„è¯ï¼ŒSchoolBoxå†…éƒ¨çš„handlersçš„mapæ ¼å¼è¦ç¨å¾®æ”¹ä¸‹ï¼Œå³{ eventType1: { sourceId1: function(){} } }è¿™æ ·çš„æ ¼å¼ã€‚ 123456789101112SchoolBox.prototype = &#123; on: function(type, sourceId, handler)&#123; if(typeof this.handlers[type] === 'undefined')&#123; this.handlers[type] = &#123;&#125;; &#125; this.handlers[type][sourceId] = handler; &#125;, fire: function(type, data)&#123; var handler = this.handlers[type][this.curSourceId]; handler &amp;&amp; handler(data); &#125;&#125;; è¿™é‡Œonæ—¶ç”±type + sourceIdæ¥ç¡®å®šhandlerï¼Œæ³¨æ„è¿™é‡Œfireæ—¶æ ¹æ®type + this.curSourceIdæ¥å–å‡ºç›¸åº”çš„handlerå›è°ƒå‡½æ•°ã€‚è€Œè¿™ä¸ªthis.curSourceIdéœ€è¦åœ¨SchoolBoxæ¯æ¬¡è¢«æ‰“å¼€çš„æ—¶å€™æ›´æ–°ï¼Œæ¯æ¬¡è¢«å…³é—­çš„æ—¶å€™æ¸…ç©ºå…¶å€¼ã€‚ 1234567891011121314151617SchoolBox.prototype.show = function(sourceId)&#123; // è®°å½•å½“å‰æ‰“å¼€SchoolBoxçš„è§¦å‘å…ƒç´  if(sourceId)&#123; this.curSourceId = sourceId; &#125; //ä»¥ä¸‹çœç•¥...&#125;;SchoolBox.prototype.hide = function()&#123; // æ¸…ç©ºsourceIdè§¦å‘å…ƒç´  if(this.curSourceId)&#123; this.curSourceId = null; &#125; //ä»¥ä¸‹çœç•¥...&#125;; æœ€ååº”ç”¨å±‚çš„ç›‘å¬ä»£ç å°±åƒè¿™æ · 123456789101112$('.choose-school').click(function()&#123; var $source = $(this); var id = $source.attr('id'); // ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ schoolBox.on('schoolChosen', id, function(data)&#123; $source.siblings('.school-input').val(data.schoolName); $source.siblings('.school-id').val(data.schoolId); &#125;); schoolBox.show(id);&#125;); è™½ç„¶æ¯æ¬¡showæ—¶éƒ½è¦ä¼ å…¥å½“å‰å…ƒç´ çš„IDï¼Œä½†æ˜¯è‚¯å®šæ¯”æ¯æ¬¡clickéƒ½å…ˆunbindå…¨éƒ¨ï¼Œå†é‡æ–°bindè¦å¥½ã€‚ å­¦æ ¡é€‰æ‹©å™¨v9 Demo çœ‹èµ·æ¥æ˜¯æ²¡é”™åƒä¸Šé¢çš„åº”ç”¨å±‚ä»£ç ï¼Œåœ¨ç›‘å¬æ—¶åˆ¤æ–­çš„è¯ï¼Œæ¯ä¸ªç›‘å¬è€…å…ƒç´ è¢«clickæ—¶ï¼Œéƒ½ä¼šé‡æ–°å»æ‰§è¡ŒschoolBoxçš„onæ–¹æ³•ï¼Œåå¤åœ°ç”ŸæˆåŒä¸€ä¸ªåŒ¿åçš„å›è°ƒå‡½æ•°å¹¶ç»‘å®šåˆ°åŒä¸€ä¸ªä½ç½®ï¼ˆhandlers[type][id]ï¼‰ã€‚æ˜¾ç„¶ä¸Šé¢çš„ä»£ç èƒ½å¤Ÿæ”¹æˆè¿™æ ·ã€‚ 12345678910111213141516var $source;var callback = function(data)&#123; $source.siblings('.school-input').val(data.schoolName); $source.siblings('.school-id').val(data.schoolId);&#125;;$('.choose-school').each(function()&#123; // ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ schoolBox.on('schoolChosen', $(this).attr('id'), callback);&#125;);$('.choose-school').click(function()&#123; $source = $(this); schoolBox.show($source.attr('id'));&#125;); å¼•å…¥äº†ä¸€ä¸ªå…¨å±€çš„$sourceå˜é‡å»è®°å½•å½“å‰clickçš„å…ƒç´ ï¼ˆä»¥ä½¿å›è°ƒä¸­èƒ½å¤Ÿæ­£ç¡®æ“ä½œç›¸åº”çš„å…ƒç´ ï¼‰ï¼Œè™½ç„¶è¿™æ ·å¾ˆçŸ¬ï¼Œä½†æ˜¯è‡³å°‘é¿å…äº†æ¯æ¬¡clickæ—¶éƒ½å»æ‰§è¡ŒschoolBoxçš„onæ–¹æ³•ï¼Œè€Œä¸”åœ¨å¾ªç¯ä¸­ä½¿ç”¨äº†callbackå‡½æ•°çš„å¼•ç”¨ï¼Œé¿å…äº†é‡å¤ç”Ÿæˆç›¸åŒçš„åŒ¿åå‡½æ•°ã€‚æ€»çš„æ¥è¯´ï¼Œè™½ç„¶é•¿å¾—ä¸‘ï¼Œä½†æ˜¯æ•ˆç‡ä¸Šæ˜¯æœ‰æé«˜çš„ã€‚ åæ€ä½†æ˜¯å¯¹äºå…¶ä¸­è¿™å°æ®µä»£ç  1234$('.choose-school').each(function()&#123; // ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ schoolBox.on('schoolChosen', $(this).attr('id'), callback);&#125;); æˆ‘å¼€å§‹æ€€ç–‘è‡ªå·±ï¼Œä¸ºä»€ä¹ˆåœ¨ä¸€ä¸ªå¾ªç¯ä¸­åå¤å»ä¸ºä¸åŒçš„å…ƒç´ IDç›‘å¬åŒä¸€ä¸ªäº‹ä»¶ç±»å‹ï¼Œæ›´å¯ç¬‘çš„æ˜¯ä½¿ç”¨åŒä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Ÿäºæ˜¯æˆ‘å¼€å§‹åæ€å½“åˆè®¾è®¡ç›‘å¬è€…å›è°ƒå‡½æ•°çš„åˆè¡·ã€‚ æœ€æ—©åœ¨ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(2)ä¸­æˆ‘æ˜¯è¿™æ ·ä½¿ç”¨å›è°ƒçš„ã€‚ 123456var schoolBox = new SchoolBox(&#123; appendTo: '#schoolBoxWrapper', schoolClickCallback: function()&#123; // çœç•¥... &#125;&#125;); è¿™æ ·çš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœé¡µé¢ä¸­æœ‰å¤šä¸ªä¸åŒçš„å…ƒç´ éƒ½è¦å¯¹â€œå­¦æ ¡é€‰ä¸­â€åšå‡ºå“åº”ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†å“åº”ä»£ç éƒ½å¾—å†™åœ¨è¿™ä¸ªschoolClickCallbackè¿™é‡Œã€‚å¦‚æœéœ€è¦å“åº”çš„é‚£äº›å…ƒç´ æ¥è‡ªé¡µé¢çš„ä¸åŒåŒºåŸŸï¼Œè´Ÿè´£å®Œå…¨ä¸åŒçš„åŠŸèƒ½ï¼Œè¿™æ ·æŠŠå“åº”ä»£ç éƒ½æ‰åœ¨ä¸€ä¸ªåœ°æ–¹çš„è¯ï¼Œä¼šé€ æˆä¸€å®šçš„è€¦åˆã€‚ æ‰€ä»¥å‡ºäºè¿™æ ·çš„è€ƒè™‘ï¼Œæˆ‘æƒ³åˆ°ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆå³è‡ªå®šä¹‰äº‹ä»¶ï¼‰ï¼Œä¸åŒçš„å…ƒç´ å„è‡ªç›‘å¬è‡ªå·±éœ€è¦çš„äº‹ä»¶ï¼Œè‡ªå·±ç»´æŠ¤è‡ªå·±å¦‚ä½•å“åº”ã€‚ 1234$('.choose-school').each(function()&#123; // ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ schoolBox.on('schoolChosen', $(this).attr('id'), callback);&#125;); è€Œè¿™æ®µä»£ç ä¼¼ä¹ä¸è¿™ä¸ªåˆè¡·æœ‰ç‚¹èµ°æ­ªè·¯äº†ï¼Œé¦–å…ˆå®ƒä»¬ç¡®å®æ˜¯ä¸åŒçš„å…ƒç´ ï¼Œä½†ä¹Ÿæ˜¯ç›¸ä¼¼çš„å…ƒç´ ï¼Œè€Œå®ƒä»¬ç›‘å¬çš„äº‹ä»¶ç±»å‹ä¹Ÿç›¸åŒï¼Œå¯¹äº‹ä»¶å“åº”çš„æ–¹å¼ä¹Ÿç›¸ä¼¼ã€‚å¦‚æ­¤â€œå¼ºè¡Œâ€ä¸ºä¸åŒçš„å…ƒç´ å„è‡ªç›‘å¬ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹ç”Ÿæ¬ç¡¬å¥—çš„æ„æ€äº†ï¼Ÿ åœ¨å›è°ƒæ—¶åˆ¤æ–­æˆ‘ä»äº‹ä»¶å§”æ‰˜é‚£é‡Œå¾—åˆ°äº†å¯å‘ï¼Œä¸ºä½•ä¸ä¸ºç›¸ä¼¼çš„å…ƒç´ ç»Ÿä¸€ç›‘å¬ä¸€ä¸ªäº‹ä»¶ï¼Œå¹¶ä¸”åªæœ‰å”¯ä¸€ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å…·ä½“åšæ³•å°±æ˜¯åœ¨fireäº‹ä»¶æ—¶åŠ å…¥â€œç”±å“ªä¸ªå…ƒç´ è§¦å‘â€ï¼Œä»¥é¿å…å¯¹æ‰€æœ‰å…ƒç´ éƒ½åšå‡ºå“åº”ã€‚ 123456789101112131415161718192021SchoolBox.prototype = &#123; on: function(type, handler)&#123; if(typeof this.handlers[type] === 'undefined')&#123; this.handlers[type] = []; &#125; this.handlers[type].push(handler); &#125;, fire: function(type, data)&#123; // åŠ å…¥sourceIdç»™å›è°ƒå‚æ•° if(this.curSourceId)&#123; data['sourceId'] = this.curSourceId; &#125; if(this.handlers[type] instanceof Array)&#123; var handlers = this.handlers[type]; for(var i=0, len=handlers.length; i&lt;len; i++)&#123; handlers[i](data); &#125; &#125; &#125;&#125;; è¿™é‡Œå¯¹onä¸åšæ”¹å˜ï¼Œthis.handlersè¿˜æ˜¯åŸæ¥çš„{ eventType1: [ function(){} ]}æ ¼å¼ã€‚åœ¨fireå†…éƒ¨ï¼Œåœ¨handlerså›è°ƒå‰ï¼ŒæŠŠå½“å‰çš„this.curSourceIdï¼ˆå½“å‰æ‰“å¼€SchoolBoxçš„è§¦å‘å…ƒç´ IDï¼‰ä¹Ÿå¡åˆ°å›è°ƒå‚æ•°dataä¸­ã€‚ è¿™é‡ŒåŒæ ·è¦ä¸ºSchoolBoxçš„showå’Œhideæ–¹æ³•é‡ŒåŠ å…¥curSourceIdçš„åˆ¤æ–­ï¼Œä»£ç åŒä»ç›‘å¬ä¸Šå…¥æ‰‹ã€‚ ç„¶ååº”ç”¨å±‚å…·ä½“çš„å›è°ƒå‡½æ•°ä¸­åªéœ€è¦åŠ å…¥å¯¹sourceIdçš„åˆ¤æ–­ã€‚ 123456789101112// ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶schoolBox.on('schoolChosen', function(data)&#123; if(data.sourceId)&#123; var $source = $('#' + data.sourceId); $source.siblings('.school-input').val(data.schoolName); $source.siblings('.school-id').val(data.schoolId); &#125;&#125;);$('.choose-school').click(function(event)&#123; schoolBox.show($(this).attr('id'));&#125;); åœ¨å›è°ƒæ—¶æ‰¾åˆ°â€œæ‰“å¼€SchoolBoxâ€çš„è§¦å‘å…ƒç´ ï¼Œç„¶ååªå¯¹ç›¸åº”çš„å…ƒç´ åšå‡ºå“åº”ã€‚æ­£å¦‚äº‹ä»¶å§”æ‰˜æ¯”â€œä¸ºæ‰€æœ‰å­å…ƒç´ éƒ½ç»‘å®šäº‹ä»¶â€è¦å¥½ä¸€æ ·ï¼Œè¿™é‡Œâ€œåœ¨å›è°ƒæ—¶åˆ¤æ–­â€ä¹Ÿæ¯”â€œåœ¨ç›‘å¬æ—¶åˆ¤æ–­â€æ•ˆç‡è¦é«˜ã€‚ å­¦æ ¡é€‰æ‹©å™¨v10 Demo å†™åœ¨æœ€åè¿™ä¸ªç³»åˆ—çš„æ–‡ç« ä»ç¬¬1ç¯‡åˆ°ç°åœ¨ç¬¬8ç¯‡ï¼Œå‰åè·¨åº¦2ä¸ªåŠæœˆï¼Œè€Œæœ€æ—©åœ¨é¡¹ç›®ä¸­åšè¿™éƒ¨åˆ†åŠŸèƒ½å·²ç»æ˜¯åŠå¹´å‰äº†ã€‚ç»è¿‡è¿™æ®µåå¤å®¡è§†ä»£ç å’Œå†™åšå®¢çš„è¿‡ç¨‹ï¼Œè‡ªå·±å¾—åˆ°äº†ä¸å°‘çš„æé«˜ï¼ŒæŠŠä»¥å‰çœ‹ä¹¦çœ‹åˆ«äººåšå®¢æ‰€è®°ä¸‹çš„ä¸€å †é›¶ç¢çš„çŸ¥è¯†èåˆäº†èµ·æ¥ã€‚ä¹Ÿæ­£æ˜¯è¿™ä¸ªé¡¹ç›®å’Œè¿™ä¸ªåšå®¢ï¼Œåœ¨æˆ‘æ‰¾å®ä¹ é¢è¯•çš„æ—¶å€™å¸®æˆ‘åŠ äº†å¾ˆå¤šåˆ†ã€‚ æˆ‘ä¼šç»§ç»­åšæŒèµ°ä¸‹å»ï¼Œå›å¤´çœ‹çœ‹èµ°è¿‡çš„è·¯å’Œè¸©è¿‡çš„å‘ã€‚è°¢è°¢~~ï¼ˆæœ¬ç³»åˆ—å®Œç»“ï¼‰]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‡ é“CSSé¢è¯•é¢˜]]></title>
    <url>%2Fblog%2F2015%2F04%2Fsome-interview-questions-of-css.html</url>
    <content type="text"><![CDATA[æ¨ªå‘å¸ƒå±€é—®ï¼šå¯ä»¥ç”¨å“ªäº›CSSå±æ€§è®©ä¸€ä¸ªä¸ªdivä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ¨ªå‘æ’åˆ—ï¼Ÿ æˆ‘ç­”ï¼š display: inline-block float: leftï¼ˆæ³¨æ„çˆ¶å…ƒç´ å¡Œé™·ï¼‰ tableå¸ƒå±€ï¼ˆNå‰å¹´çš„è¿‡æ—¶ç½‘ç«™æ˜¯è¿™æ ·å­çš„ï¼Œç°åœ¨ä¸æ¨èä½¿ç”¨tableå¸ƒå±€ï¼Œæ•ˆç‡ä½ï¼‰ ä½¿ç”¨absoluteå®šä½ï¼Œä¸€ä¸ªä¸ªè®¾å¥½åç§»åº”è¯¥ä¹Ÿå¯ä»¥ï¼ˆæˆ‘å®åœ¨æƒ³ä¸å‡ºäº†ï¼‰ ä»–æç¤ºè¯´ï¼šæœ‰æ²¡æœ‰CSS3çš„å±æ€§ä¹Ÿå¯ä»¥ï¼Ÿ æˆ‘ï¼šã€‚ã€‚ã€‚ ä»–æ¢ä¸ªé—®é¢˜ï¼šdisplayæœ‰å“ªäº›å–å€¼ï¼Ÿ inline, block, inline-block table, table-row, table-cellç±» none, initial, inherit ä»ç„¶ä¸æ˜¯ä»–æƒ³è¦çš„ã€‚ã€‚ã€‚ å›å¤´æŸ¥èµ„æ–™ï¼š displayè¿˜æœ‰felx, grid, inline-flex, inline-gridä»¥åŠ-webkit-box, -webkit-inline-boxç­‰CSS3çš„å±æ€§å€¼ã€‚ å›åˆ°æœ€åˆçš„é—®é¢˜ï¼Œè®©ä¸€ä¸ªä¸ªdivå…ƒç´ æ¨ªå‘æ’åˆ—ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„åŠæ³•ã€‚ å¯¹çˆ¶å…ƒç´ è®¾display: flexæˆ–-webkit-boxï¼ˆIE10ä¸‹ç”¨-ms-flexboxï¼‰ IE10+ä¸‹å¯¹çˆ¶å…ƒç´ è®¾display: gridï¼Œå­å…ƒç´ è®¾grid-columnå’Œgrid-rowæ¥å®ç°grid layout å±…ä¸­é—®ï¼šå¦‚ä½•è®©ä¸€ä¸ªå…ƒç´ åœ¨å®ƒçš„çˆ¶å…ƒç´ ä¸­æ°´å¹³ã€å‚ç›´å±…ä¸­ï¼Ÿï¼ˆç»å…¸çš„å±…ä¸­é—®é¢˜ï¼‰ æˆ‘ç­”ï¼š å…ˆæ¥æ°´å¹³å±…ä¸­ å­å…ƒç´ display: inline-blockï¼Œç„¶åçˆ¶å…ƒç´ text-align: center å­å…ƒç´ è®¾widthï¼Œç„¶åmargin-left: auto, margin-right: auto ç„¶åå‚ç›´å±…ä¸­ å­å…ƒç´ æ˜¯å•è¡Œæ–‡æœ¬çš„è¯ï¼Œç›´æ¥line-heightç­‰äºçˆ¶å…ƒç´ height å­å…ƒç´ æ˜¯å¤šè¡Œæ–‡æœ¬æˆ–å›¾æ–‡å¹¶æ’çš„è¯ï¼Œçˆ¶å…ƒç´ display: table-cell, vertical-align: middle å›å¤´çœ‹ç¬”è®°ï¼š è¿˜æœ‰ä¸€ç§ä¹Ÿå¯ä»¥å®ç°æ°´å¹³å±…ä¸­ï¼Œçˆ¶å…ƒç´ è®¾relativeå®šä½ï¼Œå­å…ƒç´ è®¾absoluteå®šä½ï¼Œå­å…ƒç´ left: 50%ï¼Œmargin-leftç­‰äºè´Ÿ1/2çš„widthå³å¯ã€‚æ¨¡æ€æ¡†çš„å±…ä¸­ä¸€èˆ¬ä½¿ç”¨è¿™ç§åŠæ³•ã€‚ 1234567891011121314151617181920.mask&#123; background-color: #666; height: 100%; left: 0; opacity: 0.3; position: absolute; top: 0; width: 100%; z-index: 99;&#125;.modal&#123; background-color: #fff; height: 300px; left: 50%; margin-left: -200px; position: fixed; top: 120px; z-index: 100; width: 400px;&#125; è¾¹æ¡†é—®ï¼šé™¤äº†ç”¨borderï¼Œè¿˜æœ‰ä»€ä¹ˆå…¶ä»–å±æ€§å¯ä»¥ç”»è¾¹æ¡†ï¼Ÿåªè¦è®©ç”¨æˆ·çœ‹èµ·æ¥åƒä¸ªè¾¹æ¡†å³å¯ã€‚ æˆ‘ç­”ï¼š backgroundï¼Œç”»ä¸ªè¾¹æ¡†çš„å›¾ç‰‡ box-shadowï¼Œé˜´å½±åº”è¯¥ä¹Ÿèƒ½çœ‹èµ·æ¥åƒä¸ªè¾¹æ¡†å§ã€‚ã€‚ã€‚ æƒ³ä¸å‡ºäº†ï¼Œä»–è¿›è€Œé—®ï¼šbox-shadowæœ€å¤šèƒ½ç”»å‡ æ¡è¾¹æ¡†ï¼Ÿ æˆ‘ï¼šï¼ˆè¿™æ˜¯ä»€ä¹ˆé¬¼ï¼‰ã€‚ã€‚ã€‚ å›å¤´æŸ¥w3schoolï¼š outline border-imageï¼ŒCSS3ä¸­æ”¯æŒçš„å±æ€§ è¾¹æ¡†ä»å†…åˆ°å¤–çš„æ•ˆæœå¦‚ä¸‹å›¾ é»„è‰²çš„ä¸€ç‰‡æ˜¯backgroundï¼ˆå…¶å®æ˜¯background-imageï¼‰ï¼›è“è‰²å’Œçº¢è‰²ç›¸é—´çš„è±å½¢æ˜¯border-imageï¼ˆåŒæ—¶è®¾äº†borderå®½åº¦å’Œtransparentï¼‰ï¼›ç»¿è‰²çš„æ–¹å—æ˜¯outlineï¼›å³ä¸‹è¾¹æœ‰ä¸€æ¡ç°è‰²çš„é˜´å½±æ˜¯box-shadowã€‚ å› æ­¤å¯ä»¥çœ‹åˆ°backgroundåªèƒ½å¡«å……åˆ°å…ƒç´ çš„content + paddingï¼Œå‘å¤–ç„¶åæ˜¯borderï¼Œè€Œoutlineå’Œbox-shadowéƒ½åœ¨borderä¹‹å¤–ã€‚demoåœ¨è¿™é‡Œ floatå¡Œé™·é—®ï¼šä½ ä¸Šé¢æåˆ°äº†floatä¼šå¯¼è‡´çˆ¶å…ƒç´ å¡Œé™·çš„é—®é¢˜ï¼Œæœ‰å“ªäº›åŠæ³•ï¼Ÿ æˆ‘ç­”ï¼š æš´åŠ›æ³•ï¼Œçˆ¶å…ƒç´ overflow: hiddenï¼ŒIEä¸‹è¦åŠ ä¸€æ¡*zoom: 1ä»¥è§¦å‘hasLayout clearfixæ³• 123456789101112.clearfix &#123; *zoom: 1;&#125;.clearfix:before,.clearfix:after &#123; display: table; line-height: 0; content: "";&#125;.clearfix:after &#123; clear: both;&#125; æ¥ç€é—®ï¼šIEä¸‹åŠ *zoom: 1å°±å¤Ÿäº†å—ï¼Ÿ æˆ‘ï¼šã€‚ã€‚ã€‚ å›å¤´æŸ¥èµ„æ–™ï¼š æˆ‘è§‰å¾—å¤šè®¾ä¸ªzoomå¤Ÿäº†ï¼Œåªä¸è¿‡è¿™åªé’ˆå¯¹IE6ï¼ŒåŒæ—¶zoomæ˜¯IEçš„ç§æœ‰å±æ€§ã€‚çœ‹äº†å¯¹overflowä¸zoomâ€æ¸…é™¤æµ®åŠ¨â€çš„ä¸€äº›è®¤è¯†ï¼Œè¿˜æœ‰åˆ«çš„åŠæ³•ä¹Ÿèƒ½æ¸…é™¤æµ®åŠ¨ã€‚ çˆ¶å…ƒç´ ä¹Ÿfloat çˆ¶å…ƒç´ position: absolute çˆ¶å…ƒç´ display: inline-block å¼•ç”¨absoluteç»å¯¹å®šä½çš„éç»å¯¹å®šä½ç”¨æ³•ä¸­çš„ä¸€æ®µè¯æ¥è§£é‡Šè¿™åä¸‰ç§æ¸…é™¤æµ®åŠ¨çš„åŸç†ï¼š æµ®åŠ¨çš„æœ¬è´¨å°±æ˜¯â€œåŒ…è£¹ä¸ç ´åâ€ï¼Œç ´åé«˜åº¦ï¼Œæµ®åŠ¨å…ƒç´ çš„å®é™…å æ®é«˜åº¦ä¸º0ï¼›è€Œabsoluteå…ƒç´ ï¼ˆæ— å®šä½å€¼ï¼‰ä¹Ÿæ˜¯â€œåŒ…è£¹ä¸ç ´åâ€ï¼Œåªæ˜¯å…¶â€œç ´åâ€æ¯”floatæ›´åŠ å‡¶çŒ›ï¼Œä¸ä»…å®é™…çš„é«˜åº¦æ²¡æœ‰ï¼Œè¿å®é™…çš„å®½åº¦ä¹Ÿæ²¡æœ‰ã€‚ å‚è€ƒèµ„æ–™CSS3 Grid Layout CSS box-flexå±æ€§ï¼Œç„¶åå¼¹æ€§ç›’å­æ¨¡å‹ç®€ä»‹ å¯¹overflowä¸zoomâ€æ¸…é™¤æµ®åŠ¨â€çš„ä¸€äº›è®¤è¯† absoluteç»å¯¹å®šä½çš„éç»å¯¹å®šä½ç”¨æ³•]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€é“è…¾è®¯ç¬”è¯•é¢˜æƒ³åˆ°çš„JSä¸­çš„ä¸€äº›ç‰¹æ€§]]></title>
    <url>%2Fblog%2F2015%2F03%2Fa-question-of-intern-recruit-test-by-tencent.html</url>
    <content type="text"><![CDATA[æ˜¨å¤©å‚åŠ äº†è…¾è®¯2015å®ä¹ ç”Ÿæ‹›è˜çš„çº¿ä¸‹ç¬”è¯•ï¼Œä¹‹å‰åœ¨ä»–ä»¬æä¾›çš„åœ¨çº¿æ¨¡æ‹Ÿç¬”è¯•ä¸­å·²ç»è¢«é„™è§†äº†ï¼Œæˆ‘çœŸçš„ä¸ä¼šC++ï¼Œæ•°æ®ç»“æ„å’Œç®—æ³•æ–¹é¢ä¹Ÿä¸€ç‚¹æ²¡å‡†å¤‡ã€‚è¿™æ¬¡ç¬”è¯•å°±åœ¨æˆ‘ä»¬å­¦æ ¡é‡Œï¼Œå°±æƒ³ç€å»é”»ç‚¼ä¸‹ï¼Œæ— æ‰€è°“ç»“æœã€‚C++çš„æ¯”é‡è¿˜æ˜¯ä¸å°‘ï¼Œå¤šäº†ä¸€äº›æ•°å­¦æ–¹é¢çš„é¢˜ç›®ï¼Œæˆ‘åªæ˜¯æƒ³æŠ•webå‰ç«¯çš„ï¼Œå¯æ˜¯çœ‹æ¥çœ‹å»åªæœ‰ä¸€é“javascriptçš„é¢˜ç›®ï¼Œä¹Ÿæ²¡æœ‰webæ–¹å‘çš„é€‰åšé¢˜ã€‚ é¢˜ç›®æ˜¯è¿™æ ·çš„123456789101112131415161718var a = 0;function one()&#123; for(var i=0; i&lt;10; i++)&#123; setTimeout(function()&#123; a += i; &#125;, 0); &#125;&#125;function two()&#123; setTimeout(function()&#123; alert(a); &#125;, 0);&#125;one();two(); é—®ï¼šå½“å¼¹å‡ºalertæ¡†æ—¶é‡Œé¢çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ ä¸€çœ‹åˆæ˜¯å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘å‰é¢ä¸¤ç¯‡å†™é—­åŒ…çš„æ–‡ç« ã€‚ è¿™é¢˜å¦‚æœåªæœ‰è¿™ä¸€ä¸ªpointçš„è¯ï¼Œæˆ‘ä¹Ÿä¸é«˜å…´å†å†™äº†ï¼Œå› ä¸ºè¿˜æœ‰ä¸€ä¸ªæˆ‘è§‰å¾—æ¯”è¾ƒé‡è¦çš„è¯­è¨€ç‰¹æ€§ã€‚ JSæ˜¯å•çº¿ç¨‹çš„è¯´â€œJSæ˜¯å•çº¿ç¨‹â€å¯èƒ½æœ‰ç‚¹ä¸ç¡®åˆ‡ï¼Œåº”è¯¥è¯´javascriptå¼•æ“æ˜¯å•çº¿ç¨‹çš„ã€‚ æµè§ˆå™¨å†…æ ¸ä¸­è‡³å°‘æœ‰ä¸‰ä¸ªå¸¸é©»çº¿ç¨‹ï¼šjavascriptå¼•æ“çº¿ç¨‹ï¼Œç•Œé¢æ¸²æŸ“çº¿ç¨‹ï¼Œæµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¹Ÿæœ‰ä¸€äº›æ‰§è¡Œå®Œå°±ç»ˆæ­¢çš„çº¿ç¨‹ï¼Œå¦‚Httpè¯·æ±‚çº¿ç¨‹ï¼Œè¿™äº›å¼‚æ­¥çº¿ç¨‹éƒ½ä¼šäº§ç”Ÿä¸åŒçš„å¼‚æ­¥äº‹ä»¶ã€‚ æµè§ˆå™¨æ˜¯å¤šçº¿ç¨‹çš„ï¼Œä½†JSå¼•æ“æ˜¯å•çº¿ç¨‹çš„ã€‚æˆ‘ä»¬æ¥çœ‹ä¸ªå›¾ JSå¼•æ“æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œæµè§ˆå™¨æ— è®ºåœ¨ä»€ä¹ˆæ—¶å€™éƒ½åªä¸”åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œjsç¨‹åºã€‚ åœ¨JSå¼•æ“è¿è¡Œè„šæœ¬æœŸé—´ï¼Œæµè§ˆå™¨æ¸²æŸ“çº¿ç¨‹éƒ½æ˜¯å¤„äºæŒ‚èµ·çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¢«â€œå†»ç»“â€äº†ã€‚ setTimeoutä¸setIntervalå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬æŠŠä¸€ä¸ªfunctionæ”¾åˆ°setTimeoutä¸­åï¼Œè¯¥functionç›¸å½“äºè¢«åŠ åˆ°äº†å›¾ä¸Šçš„Timeré˜Ÿåˆ—ä¸­ã€‚åŒæ—¶JSå¼•æ“ä¸­è¿˜æœ‰ä¸€ä¸ªå®šæ—¶è§¦å‘å™¨ï¼Œå½“setTimeoutæ‰€è®¾çš„å»¶è¿Ÿæ—¶é—´åˆ°äº†åï¼Œå®ƒä¼šå»å”¤é†’Timeré˜Ÿåˆ—ä¸­ç›¸åº”çš„functionã€‚ä½†æ˜¯å®šæ—¶è§¦å‘æ˜¯æœ‰å‰æçš„ï¼Œå°±æ˜¯JSå¼•æ“å¤„äºç©ºé—²çš„æ—¶å€™æ‰ä¼šå»è§¦å‘ã€‚ 1234567setTimeout(function()&#123; alert('hello');&#125;, 1000);for(var i=0; i&lt;100000; i++)&#123; // å¼€é”€å¤§çš„è®¡ç®—&#125; ä¸¾ä¸ªä¾‹å­ï¼Œå…ˆå¾€Timerä¸­æ”¾å…¥äº†å‡½æ•°ï¼ŒæŒ‡å®šå®ƒ1ç§’åæ‰§è¡Œã€‚ä½†æ˜¯éšåJSå¼•æ“è¦æ‰§è¡Œä¸€æ®µè¶…å¤§å¾ªç¯çš„å¤æ‚è®¡ç®—ï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦10ç§’æ‰èƒ½å…¨éƒ¨è®¡ç®—å®Œã€‚å¦‚æ­¤çš„è¯ï¼Œé‚£ä¸ªå®šæ—¶è§¦å‘çš„å‡½æ•°ä¹Ÿéœ€è¦åœ¨10ç§’åï¼ˆç­‰JSå¼•æ“ç©ºé—²ä¸‹æ¥åï¼‰æ‰ä¼šè¢«è§¦å‘ã€‚ è€ŒsetIntervalè®¾ç½®é—´éš”è§¦å‘çš„æ—¶é—´ï¼Œä¼šåœ¨JSå¼•æ“ä¸­åå¤æ”¾è¯¥å‡½æ•°å—ï¼Œç›¸å½“äºâ€œæ—¶é—´ç‰‡â€ï¼ŒJSå¼•æ“ä¼šé—´éš”åœ°å»è§¦å‘è¿™äº›å‡½æ•°ç‰‡ã€‚ä½†æ˜¯å‘¢ï¼Œè¿™ä¸ªé—´éš”æ—¶é—´ä¹Ÿæ˜¯ä¸ä¸€å®šçš„ï¼Œå®ƒä»¬è¢«è§¦å‘çš„å‰æéƒ½æ˜¯éœ€è¦JSå¼•æ“åœ¨ç©ºé—²çš„æ—¶å€™ã€‚ 123456setInterval(function()&#123; for(var i=0; i&lt;100000; i++)&#123; // å¼€é”€å¤§çš„è®¡ç®— &#125; alert('hello');&#125;, 1000); è¿™ä¸ªä¾‹å­è·Ÿä¸Šé¢ç±»ä¼¼ï¼ŒsetIntervalä¸­è®¾ç½®çš„å‡½æ•°æ˜¯ä¸€ä¸ªæ—¶é—´å¼€é”€å¾ˆå¤§çš„è¿‡ç¨‹ï¼Œå¦‚æœè®¾ç½®å®ŒåJSå¼•æ“å°±ç©ºé—²äº†ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è§¦å‘çš„æ—¶å€™ä¼šåœ¨1ç§’åã€‚ä½†æ˜¯ç¬¬ä¸€æ¬¡è§¦å‘æ‰§è¡Œæ—¶ï¼Œéœ€è¦èŠ±è´¹10ç§’æ‰èƒ½æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆè¯¥å‡½æ•°æ‰§è¡Œå®Œåç´§æ¥ç€ä¼šç»§ç»­è¢«è§¦å‘ï¼ˆå› ä¸ºå·²ç»è¶…è¿‡äº†å®ƒå½“åˆè¢«è®¾ç½®çš„1ç§’çš„é—´éš”ï¼‰ã€‚è¿™æ ·ç›¸å½“äºè¯¥å‡½æ•°è¢«è¿ç»­æ‰§è¡Œå¹¶ä¸”å½¼æ­¤ä¹‹é—´æ²¡æœ‰æ—¶é—´é—´éš”ã€‚ å°ç»“ä¸‹setTimeoutä¸setIntervalè®¾ç½®çš„æ—¶é—´å¹¶ä¸ä¸€å®šå°±æ˜¯å®é™…æƒ…å†µä¸‹çš„è§¦å‘æ—¶é—´ï¼Œè¦æ ¹æ®å®ƒä»¬è¢«å®šä¹‰å®Œåå‰©ä¸‹çš„JSè„šæœ¬çš„æ‰§è¡Œæ—¶é—´ï¼Œä»¥åŠå®ƒä»¬è¢«å®šä¹‰çš„å†…éƒ¨å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸èƒ½åœ¨setIntervalä¸­æ”¾å…¥æ—¶é—´å¼€é”€å·¨å¤§çš„è¿‡ç¨‹ï¼Œè¿™æ ·ä¼šè®©JSå¼•æ“ä¸€ç›´ç¹å¿™ï¼Œé¡µé¢ä¸Šçš„äº‹ä»¶å›è°ƒä¹Ÿå°±æ— æ³•è¢«è§¦å‘äº†ï¼Œå› ä¸ºå®ƒä»¬éƒ½åœ¨å•çº¿ç¨‹çš„JSå¼•æ“ä¸­ã€‚ å¦‚æœå®é™…åº”ç”¨ä¸­çœŸçš„æœ‰æ—¶é—´å¼€é”€å¾ˆå¤§çš„JSè„šæœ¬ï¼Œä¼šå¯¼è‡´æµè§ˆå™¨UIæ— æ³•å“åº”ç”¨æˆ·çš„ä»»ä½•æ“ä½œï¼ˆå› ä¸ºJSæ‰§è¡Œæ—¶UIçº¿ç¨‹æ˜¯è¢«æŒ‚èµ·çš„ï¼‰ã€‚åº”è¯¥å°½é‡é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥å°†JSä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ï¼ŒæŠŠæ¯ä¸ªå°ä»»åŠ¡éƒ½æ”¾åˆ°setTimeoutä¸­å¹¶è®¾ç½®ä¸€ç‚¹å°é—´éš”æ—¶é—´ã€‚è™½ç„¶è¿™æ ·ä¼šå¯¼è‡´å®Œæˆæ•´ä¸ªä»»åŠ¡éœ€è¦èŠ±è´¹çš„æ—¶é—´æ›´é•¿ï¼Œä½†æ˜¯è¿™æ ·èƒ½é¿å…JSå¼•æ“å§‹ç»ˆç¹å¿™ï¼Œç»™å®ƒç•™æœ‰ä¸€ç‚¹ç©ºé—²æ—¶é—´å»å“åº”ç”¨æˆ·çš„æ“ä½œå’Œäº‹ä»¶å›è°ƒï¼Œè¿™æ ·ç”¨æˆ·ä½“éªŒä¼šæ›´å¥½ã€‚ æœ€è¿‘çš„æµè§ˆå™¨ä¸ºé•¿æœŸè¿è¡Œçš„è„šæœ¬æä¾›äº†å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šWeb Workersã€‚å®ƒä¸ºæµè§ˆå™¨æä¾›äº†èƒŒæ™¯çº¿ç¨‹æ”¯æŒï¼Œå¯ä»¥å°†ä»»åŠ¡æ¯”è¾ƒç¹é‡çš„è®¡ç®—æ”¾åœ¨å•ç‹¬ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä»ä¸»ç¨‹åºï¼ˆç½‘é¡µï¼‰ä¸­è°ƒç”¨è¯¥æ–‡ä»¶ã€‚è¯¦ç»†å†…å®¹è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼Œå…·ä½“å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚ setTimeout(0)å¹¶ä¸æ˜¯ç«‹å³æ‰§è¡Œçœ‹äº†ä¸Šé¢ï¼ŒsetTimeout(function(){}, 0)ä»ç„¶ä¼šæŠŠfunctionåŠ åˆ°JSå¼•æ“çš„Timerä¸­ã€‚è®¾ç½®timeoutæ—¶é—´ä¸º1æ¯«ç§’æˆ–è€…0æ¯«ç§’ï¼Œå®é™…ä¸Šä¸æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿæœ‰å…³ã€‚0æ¯«ç§’ä¸æ„å‘³ç€æ²¡æœ‰timeoutï¼Œè€Œæ˜¯æŒ‡å°½å¯èƒ½å¿«çš„å¤„ç†ã€‚ä¾‹å¦‚åœ¨IEä¸­ï¼Œæœ€å¿«çš„æ—¶é’Ÿå‘¨æœŸæ˜¯15æ¯«ç§’ã€‚ ç»¼åˆåˆ†æé¢˜ç›®æœ‰äº†ä¸Šé¢çš„ç†è®ºåŸºç¡€ï¼Œè¿™é“é¢˜å°±è¿åˆƒè€Œè§£äº†ã€‚ 123456789101112131415161718var a = 0;function one()&#123; for(var i=0; i&lt;10; i++)&#123; setTimeout(function()&#123; a += i; &#125;, 0); &#125;&#125;function two()&#123; setTimeout(function()&#123; alert(a); &#125;, 0);&#125;one();two(); é¦–å…ˆone()è¢«æ‰§è¡Œæ—¶ï¼Œå®ƒé‡Œé¢æœ‰ä¸ªforå¾ªç¯10æ¬¡ï¼Œå¾€Timerä¸­æ·»åŠ äº†10ä¸ªfunction(){ a += i; }è¿™æ ·çš„å‡½æ•°ã€‚ç„¶åtwo()è¢«æ‰§è¡Œæ—¶ï¼Œå®ƒå¾€Timerä¸­æ·»åŠ äº†function(){ alert(a); }è¿™ä¸ªå‡½æ•°ã€‚ç°åœ¨Timeré˜Ÿåˆ—ä¸­æœ‰11ä¸ªå‡½æ•°ã€‚ ç”±äºè®¾ç½®çš„timeoutä¸º0æ¯«ç§’ï¼Œç­‰å¾…äº†ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸåï¼ˆæ—¶é—´å¯ä»¥å¿½ç•¥ä¸è®¡ï¼‰ï¼Œå°±å¼€å§‹ä¾æ¬¡è§¦å‘Timeré˜Ÿåˆ—ä¸­çš„å‡½æ•°ã€‚ ç”±äºone()ä¸­çš„forå¾ªç¯æ‰§è¡Œå®Œåï¼Œå˜é‡içš„ç»ˆå€¼æ˜¯10ï¼Œæ‰€ä»¥Timerä¸­çš„function(){ a += i; }æ‰§è¡Œæ—¶çœ‹åˆ°çš„iå€¼å°±æ˜¯10ã€‚è¿™é‡Œä¸æ¸…æ¥šåŸå› çš„è¯ï¼Œå¯ä»¥çœ‹è¿™ç¯‡ä½¿ç”¨é—­åŒ…è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚ æ‰€ä»¥Timerä¸­å‰10ä¸ªå‡½æ•°æ‰§è¡Œä¸‹æ¥åï¼Œå…¨å±€å˜é‡açš„å€¼å°±æ˜¯100ã€‚ç„¶åæ‰§è¡Œç¬¬11ä¸ªå‡½æ•°ï¼Œalertå‡º100ã€‚ æ€»ç»“å°å°çš„ä¸€é“ç¨‹åºç»“æœé¢˜ï¼Œä¹Ÿèƒ½æ¶‰åŠåˆ°å¾ˆåº•å±‚çš„è¯­è¨€æœºåˆ¶ã€‚åªæœ‰æŠŠè¯­è¨€æœºåˆ¶ç†è§£é€äº†ï¼Œæ‰èƒ½æ”¹è¿›çœŸæ­£å¼€å‘è¿‡ç¨‹ä¸­çš„ä»£ç ï¼Œè€Œä¸æ˜¯ä»…ä»…æŠŠé¢˜ç›®åšå¯¹ã€‚è¿™ç¯‡ä¸­è®²åˆ°çš„JSå•çº¿ç¨‹å’ŒsetTimeoutæœºåˆ¶ï¼Œæ˜¯æˆ‘å¯¹ä»¥å‰çœ‹ä¹¦å’Œçœ‹åˆ«äººæ–‡ç« çš„é›¶ç¢ç¬”è®°çš„äºŒæ¬¡æ•´ç†ã€‚é‡æ–°æ€è€ƒåï¼Œè‡ªå·±ç†è§£çš„å°è±¡æ›´æ·±äº†ã€‚ æˆ‘å¹³æ—¶ä½¿ç”¨å°è±¡ç¬”è®°ç§¯ç´¯çŸ¥è¯†ï¼ŒåŒ…æ‹¬è‡ªå·±çš„çœ‹ä¹¦ç¬”è®°å’Œç½‘é¡µè£å‰ªæ¥çš„åˆ«äººçš„æ–‡ç« ã€‚ä½†æ˜¯é‚£ä¹ˆå¤šä¸å¯èƒ½ä¸€ä¸‹å­éƒ½èƒ½è®°ä½ï¼Œé€šè¿‡å†™åšå®¢é‡æ–°æ•´ç†å’Œæ€è€ƒï¼Œä»¥å»è§£å†³å®é™…ä¸­é‡åˆ°çš„é—®é¢˜ã€‚æœ€åè°¢è°¢å¤§å®¶çš„æ”¯æŒï¼Œæˆ‘ä¼šåŠªåŠ›å­¦ä¹ å’Œå†™åšå®¢ï¼ç†è§£ä¸å¯¹çš„åœ°æ–¹ï¼Œä¹Ÿæ¬¢è¿ç•™è¨€ä¸€èµ·è®¨è®ºï¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨é—­åŒ…è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜]]></title>
    <url>%2Fblog%2F2015%2F03%2Fapply-closure-to-forloop.html</url>
    <content type="text"><![CDATA[ä¸Šä¸€ç¯‡è®²äº†JSä¸­çš„é—­åŒ…ä»¥åŠå®ƒçš„å‡ ä¸ªä½¿ç”¨åœºåˆï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå°±æ˜¯è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œè¿™ç¯‡æˆ‘å°†ç”¨æ›´å¤šçš„ä¾‹å­å†æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜ã€‚ é—®é¢˜æ¥æºå‡è®¾é¡µé¢ä¸­æœ‰4ä¸ªdivå¦‚ä¸‹ 1234&lt;div&gt;111&lt;/div&gt;&lt;div&gt;222&lt;/div&gt;&lt;div&gt;333&lt;/div&gt;&lt;div&gt;444&lt;/div&gt; ç°åœ¨è¦ä¸ºæ¯ä¸ªdivæ·»åŠ äº‹ä»¶ï¼Œä»¥ä½¿ç‚¹å‡»å®ƒä»¬æ—¶èƒ½å¼¹å‡ºå…¶innerHTMLï¼ˆç‚¹å‡»ç¬¬1ä¸ªdivå¼¹å‡º111ï¼Œç‚¹å‡»ç¬¬4ä¸ªdivå¼¹å‡º444ï¼‰ã€‚ 1234567var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; var div = elems[i]; div.onclick = function()&#123; alert(div.innerHTML); &#125;;&#125; ç»“æœå¹¶ä¸æ˜¯æƒ³çš„é‚£æ ·ï¼å½“forå¾ªç¯ç»“æŸæ—¶ï¼Œå…¶å†…éƒ¨çš„divå˜é‡çš„æœ€ç»ˆå€¼æ˜¯ç¬¬4ä¸ªå…ƒç´ ï¼Œå› æ­¤å½“divå…ƒç´ è¢«ç‚¹å‡»æ—¶ï¼Œonclickå‡½æ•°å†…éƒ¨çœ‹åˆ°çš„å˜é‡divå€¼å…¶å®å°±æ˜¯ç¬¬4ä¸ªå…ƒç´ ï¼Œå› æ­¤éƒ½å¼¹å‡ºçš„æ˜¯444ã€‚ å†å°†ä»£ç æ”¹æˆè¿™æ · 123456var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; elems[i].onclick = function()&#123; alert(elems[i].innerHTML); &#125;;&#125; ç»“æœåˆä¸ä¸Šé¢çš„é”™è¯¯ä¸ä¸€æ ·ï¼å½“forå¾ªç¯ç»“æŸæ—¶ï¼Œæœ€ç»ˆiçš„å€¼æ˜¯4ï¼Œå› æ­¤å½“divå…ƒç´ è¢«ç‚¹å‡»æ—¶ï¼Œonclickå†…éƒ¨elems[i]å³elems[4]ä¸ºundefinedï¼Œæ— æ³•å¼¹å‡ºå€¼ã€‚ ä½¿ç”¨é—­åŒ…åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„é—­åŒ…æ˜¯è¿™æ ·çš„ã€‚ 123456789var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; (function(i)&#123; var div = elems[i]; div.onclick = function()&#123; alert(div.innerHTML); &#125;; &#125;)(i);&#125; ä½†æ˜¯æœ‰æ²¡æœ‰è§‰å¾—è¿™ä¸ªé—­åŒ…â€œåŒ…â€çš„èŒƒå›´å¤ªå¤§äº†ï¼Œå¯ä»¥ç²¾ç®€ä¸€ä¸‹ã€‚ 123456789var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; var div = elems[i]; div.onclick = (function(div)&#123; return function()&#123; alert(div.innerHTML); &#125;; &#125;)(div);&#125; è¿™é‡Œonclickç»‘çš„å‡½æ•°æ˜¯ä¸€ä¸ªåŒ¿åçš„è‡ªæ‰§è¡Œå‡½æ•°ï¼Œè¯¥åŒ¿åå‡½æ•°ä»¥å½“å‰çš„divä½œä¸ºå‚æ•°ï¼Œè‡ªæ‰§è¡Œååˆè¿”å›äº†ä¸€ä¸ªå‡½æ•°æ‰æ˜¯çœŸæ­£çš„onclickå‡½æ•°ã€‚è™½ç„¶æ¯”èµ·å‰é¢ä¸€æ®µä»£ç ï¼Œè¿™æ®µä»£ç çš„é—­åŒ…èŒƒå›´æ˜¯å°äº†ç‚¹ï¼Œä½†åªæ˜¯æŠŠå‰é¢é—­åŒ…å†…éƒ¨å£°æ˜çš„å˜é‡divï¼Œå˜æˆäº†è¿™æ®µä»£ç é‡ŒåŒ¿åå‡½æ•°çš„å‚æ•°ã€‚æœ¬è´¨ä¸Šé—­åŒ…å¯¹å˜é‡çš„å­˜å‚¨å¼€é”€å¹¶æ²¡æ€ä¹ˆçœï¼Œä¸Šé¢çš„ä»£ç è¿˜èƒ½å†æ”¹è¿›ã€‚ 12345678var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; elems[i].onclick = (function(i)&#123; return function()&#123; alert(elems[i].innerHTML); &#125;; &#125;)(i);&#125; è¿™æ ·çš„è¯ï¼Œé—­åŒ…ä¸­â€œè®°ä½â€çš„å˜é‡æ›´å°ã€‚ä½†æ˜¯æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œåœ¨å¾ªç¯ä¸­ä¼šå¤šæ¬¡å»ç”ŸæˆåŒä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆåªä¸è¿‡è‡ªæ‰§è¡Œæ—¶ä¼ å…¥çš„å‚æ•°å€¼ä¸åŒï¼‰ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å‡½æ•°çš„å¼•ç”¨è¿›ä¸€æ­¥ä¼˜åŒ–ä¸Šé¢çš„ä»£ç ã€‚ 12345678910var elems = document.getElementsByTagName('div');var callback = function(i)&#123; return function()&#123; alert(elems[i].innerHTML); &#125;;&#125;;for(var i=0, len=elems.length; i&lt;len; i++)&#123; elems[i].onclick = (callback)(i);&#125; å¦‚æ­¤ï¼Œcallbackå‡½æ•°ä»…å­˜æœ‰ä¸€ä»½ï¼Œåœ¨forå¾ªç¯ä¸­ä¸ºå®ƒä¼ å…¥ä¸åŒçš„å‚æ•°å€¼è¿›è¡Œæ‰§è¡Œï¼Œå®ƒè¿”å›çš„å‡½æ•°æ‰æ˜¯çœŸæ­£ç»‘åˆ°onclickä¸Šçš„å‡½æ•°ã€‚ æ€»ç»“æˆ‘å†å¼•ç”¨ä¸€å¥æˆ‘åœ¨ä¸Šä¸€ç¯‡ä¸­çš„æ€»ç»“ é—­åŒ…å°±åƒä¸€ä¸ªå£³å­ï¼ŒæŠŠå®ƒé‡Œé¢çš„ä¸œè¥¿ç½©ä½äº†ã€‚é—­åŒ…æŠŠå®ƒé‡Œé¢çš„free variablesä¿æŠ¤ä½äº†ï¼Œä½¿å®ƒä»¬å…å—å¤–éƒ¨çš„æ±¡æŸ“ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡çš„æ±¡æŸ“ï¼Œæˆ–è€…æ˜¯å¾ªç¯å˜é‡ç»ˆå€¼çš„æ±¡æŸ“ã€‚ è™½ç„¶é—­åŒ…æœ‰å¦‚æ­¤å¤šçš„å¥½å¤„ï¼Œä½†å®ƒä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ»¥ç”¨é—­åŒ…å¿…ç„¶ä¼šæœ‰å‰¯ä½œç”¨ã€‚é—­åŒ…ä¸­å­˜åœ¨å¯èƒ½çš„æ•ˆç‡é—®é¢˜ï¼ŒåŒ…æ‹¬å¯¹è±¡çš„å»ºç«‹å’Œå†…å­˜ç®¡ç†é‡Šæ”¾ç­‰ï¼Œè¿™äº›éƒ½ä¸å¤ªå¥½æ§åˆ¶ã€‚æˆ‘ä»¬åªæœ‰å…ˆå°†é—­åŒ…ç”¨åœ¨å¯¹çš„åœºåˆï¼Œç„¶åå°½é‡å‡å°‘é—­åŒ…â€œåŒ…â€ä½çš„èŒƒå›´ï¼Œé¿å…å¾ªç¯ä¸­åˆ›å»ºåŒ¿åå‡½æ•°ï¼Œè€Œä½¿ç”¨å‡½æ•°çš„å¼•ç”¨ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSä¸­çš„é—­åŒ…åŠä½¿ç”¨åœºåˆ]]></title>
    <url>%2Fblog%2F2015%2F03%2Fclosure-in-js.html</url>
    <content type="text"><![CDATA[å¯¹äºJSä¸­çš„é—­åŒ…closureï¼Œå®˜æ–¹ç»™å‡ºçš„å®šä¹‰ä¸ºï¼šA â€œclosureâ€ is an expression (typically a function) that can have free variables together with an environment that binds those variables (that â€œclosesâ€ the expression)ã€‚ å¯¹æ­¤æˆ‘çš„ç†è§£æ˜¯ï¼šé—­åŒ…æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–å‡½æ•°è¡¨è¾¾å¼çš„æ‰§è¡Œç¯å¢ƒï¼›è¿™ä¸ªæ‰§è¡Œç¯å¢ƒä¸­ä¼šåŒ…å«ä¸€äº›å˜é‡ï¼Œåªæœ‰å‡½æ•°å†…éƒ¨èƒ½è®¿é—®åˆ°è¿™äº›å˜é‡ï¼›å› æ­¤è¿™äº›å˜é‡ç›¸å½“äºè¢«â€œåŒ…â€ä½äº†ï¼Œè„±ç¦»äº†è¿™ä¸ªé—­åŒ…ï¼Œå°±æ— æ³•è®¿é—®åˆ°è¿™äº›å˜é‡ã€‚ è¯æ³•æ€§è´¨çš„ä½œç”¨åŸŸJSå…·æœ‰å‡½æ•°çº§çš„ä½œç”¨åŸŸï¼Œè¿™æ„å‘³ç€å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å˜é‡åœ¨å‡½æ•°å¤–éƒ¨ä¸èƒ½è¢«è®¿é—®ã€‚ JSçš„ä½œç”¨åŸŸåˆæ˜¯è¯æ³•æ€§è´¨çš„ï¼ˆlexically scopedï¼‰ï¼Œè¿™æ„å‘³ç€å‡½æ•°è¿è¡Œåœ¨å®šä¹‰å®ƒçš„ä½œç”¨åŸŸä¸­ï¼Œè€Œä¸æ˜¯åœ¨è°ƒç”¨å®ƒçš„ä½œç”¨åŸŸä¸­ã€‚å› æ­¤ï¼Œå‡½æ•°æ‰§è¡Œæ—¶çš„å˜é‡å¯è§æ€§èŒƒå›´å°±æ˜¯å®ƒè¢«å®šä¹‰æ—¶çš„å˜é‡å¯è§æ€§èŒƒå›´ã€‚ é—­åŒ…çš„åˆ›å»ºæ–¹å¼åˆ›å»ºé—­åŒ…æœ€ç®€å•æœ€é€šå¸¸çš„æ–¹å¼å°±æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼Œç„¶ååœ¨å…¶å†…éƒ¨å†åµŒä¸€ä¸ªä¾›å¤–è°ƒç”¨çš„å‡½æ•°ï¼Œè¿™æ ·è¿™ä¸ªè‡ªæ‰§è¡Œå‡½æ•°å°±å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ã€‚ 1234567891011var someVar = 'global';var someFunc;(function()&#123; var someVar = 'inner'; someFunc = function()&#123; alert(someVar); &#125;;&#125;)();someFunc(); å¯ä»¥çœ‹åˆ°æœ€åæ‰§è¡Œç»“æœæ˜¯â€œinnerâ€ï¼Œå› ä¸ºsomeFuncåœ¨è‡ªæ‰§è¡Œå‡½æ•°çš„é—­åŒ…ä¸­è¢«å®šä¹‰ï¼Œè™½ç„¶someFuncåœ¨è‡ªæ‰§è¡Œå‡½æ•°æ‰§è¡Œå®Œåæ‰è¢«è°ƒç”¨ï¼Œä½†æ˜¯å‡½æ•°æ‰§è¡Œæ—¶å¯è®¿é—®åˆ°çš„å˜é‡ï¼Œå°±æ˜¯è¯¥å‡½æ•°è¢«å®šä¹‰æ—¶å‡½æ•°å†…éƒ¨å¯è®¿é—®åˆ°çš„å˜é‡ã€‚å› æ­¤someFuncå®šä¹‰æ—¶çœ‹åˆ°çš„someVarå€¼æ˜¯innerï¼Œå°±æ˜¯æœ€åæ‰§è¡Œæ—¶çš„ç»“æœã€‚ ä½¿ç”¨åœºåˆå‡å°‘å…¨å±€å˜é‡é—­åŒ…çš„æœ€å¤§ä½œç”¨å°±æ˜¯å˜é‡å…±äº«ï¼Œä»¥å‡å°‘å…¨å±€å˜é‡çš„ä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ 123456789101112131415var some = (function()&#123; var count = 0; var doSomething = function()&#123; for(var i=0; i&lt;100; i++)&#123; count++; &#125; &#125; return &#123; getResult: function()&#123; doSomething(); return count; &#125; &#125;&#125;)(); æœ€åè°ƒç”¨some.getResult()ç»“æœå½“ç„¶æ˜¯100ã€‚å¯¹å¤–éƒ¨æ¥è¯´ï¼Œæˆ‘ä»¬åªå…³å¿ƒæœ€åå¾—åˆ°çš„ç»“æœï¼Œè€Œæ— æ‰€è°“å®ƒæ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ã€‚å› æ­¤åœ¨å¤–éƒ¨ï¼Œåªå­˜åœ¨ä¸€ä¸ªå…¨å±€å˜é‡someï¼Œæˆ‘ä»¬æˆåŠŸçš„å°†ä¸­é—´å˜é‡countå’Œè¿‡ç¨‹doSomethingå˜æˆäº†é—­åŒ…å†…çš„è‡ªç”±å˜é‡ï¼ˆä¸Šè¿°å®šä¹‰ä¸­çš„free variablesï¼‰ï¼Œè€Œä¸æ˜¯å…¨å±€å˜é‡ã€‚å†…éƒ¨å‡½æ•°getResultèƒ½è®¿é—®åˆ°å¤–éƒ¨å‡½æ•°çš„å˜é‡ï¼Œå› æ­¤é—­åŒ…èƒ½å¤Ÿå‡å°‘å…¨å±€å˜é‡çš„ä½¿ç”¨ã€‚ æ¨¡å—åŒ–æ¨¡å¼ç”±ä¸Šé¢çš„å†å¾€ä¸‹è¿‡æ¸¡ï¼Œå°±æ˜¯JSä¸­çš„æ¨¡å—åŒ–æ¨¡å¼äº†ã€‚è¿™æ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³ï¼Œç”¨æ¥ç®¡ç†æ–¹æ³•å’Œå±æ€§çš„å¯è§åº¦ã€‚åœ¨ä»¥å‰å°è£…å­¦æ ¡é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œå°±å†™è¿‡ä¸€æ®µé¢å‘å¯¹è±¡çš„ä¾‹å­ã€‚ 12345678910111213141516171819202122232425262728293031323334var Book = (function()&#123; // ç§æœ‰é™æ€å±æ€§ var numOfBooks = 0; // ç§æœ‰é™æ€æ–¹æ³• function checkIsbn(isbn)&#123; &#125; // è¿”å›çœŸæ­£çš„æ„é€ å‡½æ•° return function(newIsbn, newTitle, newAuthor)&#123; // ç§æœ‰å±æ€§ var isbn, title, author; // ç‰¹æƒæ–¹æ³•ï¼ˆæ¯ä¸ªå®ä¾‹éƒ½ä¼šæœ‰ä¸€ä¸ªæ–¹æ³•çš„å¤‡ä»½ï¼‰ this.getIsbn = function()&#123; return isbn; &#125;; this.setIsbn = function(newIsbn)&#123; if(!checkIsbn(newIsbn))&#123; throw new Error('Book: ISBNæ— æ•ˆ'); &#125; isbn = newIsbn; &#125;; // æ‰§è¡Œæ„é€  numOfBooks++; if(numOfBooks &gt; 50)&#123; throw new Error('Book: æœ€å¤šåˆ›å»º50ä¸ªå®ä¾‹'); &#125; this.setIsbn(newIsbn); &#125;&#125;)(); è¿™é‡Œå°±æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼Œé‡Œé¢å†è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œä»¥å®ç°ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶å°†ç§æœ‰å±æ€§å°è£…åœ¨å†…éƒ¨ã€‚å¯¹å¤–éƒ¨æ¥è¯´ï¼ŒBookå°±æ˜¯ä¸€ä¸ªå°è£…å¥½çš„æ¨¡å—ã€‚æ³¨æ„ï¼Œè¿™é‡Œçœç•¥äº†prototypeéƒ¨åˆ†ï¼Œå…·ä½“è¯·çœ‹è¿™é‡Œã€‚ åå‡½æ•°åº”ç”¨å…³äºåå‡½æ•°çš„å…·ä½“å®šä¹‰ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šã€‚ä¸è¿‡å¾ˆå¥½ç†è§£ï¼Œå‡è®¾æœ‰ä¸ªå‡½æ•°å®šä¹‰äº†3ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆæŠŠç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ç»‘å®šåˆ°è¯¥å‡½æ•°ä¸­ï¼Œä»¥åè°ƒç”¨æ—¶åªéœ€è¦ä¼ å…¥åä¸¤ä¸ªå‚æ•°å€¼å°±å¯ä»¥äº†ã€‚ 12345678function say(word)&#123; return function(name)&#123; alert(word + ' ' + name); &#125;&#125;var sayHello = say('Hello');sayHello('World'); æˆ‘ä»¬æƒ³åšçš„äº‹æ˜¯æƒ³å†™ä¸ªsay(word, name)è¿™æ ·çš„å‡½æ•°ï¼Œå¯ä»¥å…ˆè®©say(&#39;Hello&#39;)è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åå†ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°å³å¯ã€‚è¿™æ˜¯åå‡½æ•°çš„æœ€æœ€ç®€å•çš„ä¾‹å­ã€‚JSä¸­æ”¯æŒå¯å˜å‚æ•°ï¼Œå¯ä»¥ä¸ºåå‡½æ•°ç»‘å®šå¤šä¸ªå‚æ•°çš„å€¼ï¼Œä¹Ÿå«åšcurryåŒ–ã€‚æ›´å¤æ‚çš„ä¾‹å­è¯·çœ‹å¸å¾’å…ˆç”Ÿçš„è¿™ç¯‡æ–‡ç« ã€‚ å¾ªç¯å¼•ç”¨é—®é¢˜è¿™æ˜¯ä½¿ç”¨é—­åŒ…çš„æœ€ç»å…¸çš„åœºåˆã€‚å…ˆæ¥çœ‹ä¸ªä¾‹å­ã€‚ 12345678// å‡è®¾é¡µé¢ä¸­æœ‰4ä¸ªdivvar elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; var div = elems[i]; div.onclick = function()&#123; alert(i); &#125;;&#125; é¡µé¢ä¸­æœ‰4ä¸ªdivå…ƒç´ ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºå®ƒä»¬ç»‘ä¸Šäº‹ä»¶ï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªdivå¼¹å‡º0ï¼Œç‚¹å‡»ç¬¬äºŒä¸ªdivå¼¹å‡º1ï¼Œä¾æ­¤ç±»æ¨ã€‚å¾ˆå¯æƒœï¼Œä¸Šé¢çš„ä»£ç æ‰§è¡Œåï¼Œä¸ç®¡ç‚¹å‡»å“ªä¸ªdivï¼Œå¼¹å‡ºçš„éƒ½æ˜¯4ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå½“forå¾ªç¯ç»“æŸæ—¶ï¼Œiçš„å€¼æ˜¯4ï¼Œå› æ­¤å½“divå…ƒç´ è¢«ç‚¹å‡»æ—¶ï¼Œonclickå‡½æ•°å†…éƒ¨çœ‹åˆ°çš„å˜é‡iå€¼å…¶å®å°±æ˜¯iæœ€ç»ˆçš„å€¼ï¼Œå³4ã€‚ ä½¿ç”¨é—­åŒ…å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ 123456789var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; (function(j)&#123; var div = elems[j]; div.onclick = function()&#123; alert(j); &#125;; &#125;)(i);&#125; åœ¨forå¾ªç¯é‡Œé¢åˆ›å»ºäº†ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼ŒæŠŠå½“å‰çš„iå€¼ä¼ è¿›å»ï¼Œå³åŒ¿åå‡½æ•°çš„å‚æ•°jï¼ˆä¸ºäº†åŒºåˆ†æˆ‘è¿™é‡Œå†™æˆäº†jï¼Œå½“ç„¶ä»¤å®ƒä¸ºiä¹Ÿå¯ä»¥ï¼‰ã€‚è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ï¼Œonclickæ‰§è¡Œæ—¶çœ‹åˆ°çš„å˜é‡jå°±æ˜¯åŒ¿åå‡½æ•°çš„å‚æ•°jã€‚è€ŒåŒ¿åå‡½æ•°æ˜¯è‡ªæ‰§è¡Œçš„ï¼Œå®ƒåœ¨forå¾ªç¯ä¸­å·²ç»è¢«æ‰§è¡Œè¿‡äº†ï¼Œå› æ­¤åŒ¿åå‡½æ•°çš„å‚æ•°jçš„å€¼å°±æ˜¯å®ƒè¢«å®šä¹‰æ—¶ä¼ å…¥çš„å˜é‡iå€¼ã€‚ å¦‚æœæˆ‘æŠŠä»£ç æ”¹æˆè¿™æ · 123456789var elems = document.getElementsByTagName('div');for(var i=0, len=elems.length; i&lt;len; i++)&#123; (function(i)&#123; var div = elems[i]; div.onclick = function()&#123; alert(i); &#125;; &#125;)(i);&#125; ä¾æ—§ä¸ä¼šå¯¹ç»“æœäº§ç”Ÿå½±å“ï¼Œå› ä¸ºåŒ¿åå‡½æ•°åœ¨forå¾ªç¯ä¸­å·²ç»è¢«æ‰§è¡Œè¿‡äº†ï¼Œå› æ­¤onclickä¸­çœ‹åˆ°çš„iå§‹ç»ˆæ˜¯åŒ¿åå‡½æ•°è¢«å®šä¹‰æ—¶çš„å‚æ•°iå€¼ï¼Œforå¾ªç¯çš„å¾ªç¯å˜é‡iä¸ä¼šå¯¹å®ƒäº§ç”Ÿå½±å“ã€‚ æ€»ç»“ç»¼ä¸Šæ‰€ä»¥æˆ‘æ„Ÿè§‰ï¼Œé—­åŒ…å°±åƒä¸€ä¸ªå£³å­ï¼ŒæŠŠå®ƒé‡Œé¢çš„ä¸œè¥¿ç½©ä½äº†ã€‚æ­£å¦‚æœ¬æ–‡ä¸€å¼€å¤´å¼•ç”¨çš„å®˜æ–¹å®šä¹‰ï¼Œé—­åŒ…æŠŠå®ƒé‡Œé¢çš„free variablesç½©ä½äº†ä¿æŠ¤ä½äº†ï¼Œä½¿å®ƒä»¬å…å—å¤–éƒ¨çš„æ±¡æŸ“ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡çš„æ±¡æŸ“ï¼Œæˆ–è€…æ˜¯å¾ªç¯å˜é‡ç»ˆå€¼çš„æ±¡æŸ“ã€‚å› æ­¤é—­åŒ…å†…éƒ¨çš„å‡½æ•°è¿è¡Œæ—¶çœ‹åˆ°çš„å˜é‡å€¼ï¼Œå°±æ˜¯å®ƒä»¬è¢«å®šä¹‰æ—¶çœ‹åˆ°çš„å˜é‡çš„å€¼ã€‚ ç”±äºæœ¬ç¯‡å†™çš„æ˜¯é—­åŒ…çš„ä½¿ç”¨åœºåˆï¼Œè§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜åªæ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œè¿˜æœ‰æ›´å¤šå¾ªç¯å¼•ç”¨çš„ä¾‹å­ï¼Œæˆ‘æ”¹å¤©å†å†™ä¸€ç¯‡^_^ å‚è€ƒæ–‡ç« æ·±å…¥ç†è§£JavaScriptç³»åˆ—ï¼ˆ4ï¼‰ï¼šç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ javascriptçš„curryingå‡½æ•°]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSSå®šä½æ¨¡å‹]]></title>
    <url>%2Fblog%2F2015%2F03%2Fcss-position-model.html</url>
    <content type="text"><![CDATA[å®šä½æ¨¡å‹ä¸Šä¸€ç¯‡CSSç›’æ¨¡å‹ä¸­æåˆ°æœ‰å…­ç§ç›’æ¨¡å‹ï¼šå†…è”ç›’æ¨¡å‹ã€å†…è”å—çŠ¶ç›’æ¨¡å‹ã€å—çŠ¶ç›’æ¨¡å‹ã€è¡¨æ ¼ç›’æ¨¡å‹ã€ç»å¯¹å®šä½ç›’æ¨¡å‹ã€æµ®åŠ¨ç›’æ¨¡å‹ã€‚è¿™é‡Œçš„å®šä½æ¨¡å‹ä¸ä¹‹ç±»ä¼¼ï¼Œå¯¹ä¸åŒçš„ç›’æ¨¡å‹é‡‡ç”¨ä¸åŒçš„å®šä½æ¨¡å‹å»å®šä½ã€‚ é™æ€å®šä½æ¨¡å‹ï¼šå¯¹å†…è”ã€å†…è”å—çŠ¶ã€å—çŠ¶å’Œè¡¨æ ¼ç›’æ¨¡å‹è¿›è¡Œå®šä½ ç»å¯¹å’Œå›ºå®šå®šä½æ¨¡å‹ï¼šå¯¹ç»å¯¹å®šä½ç›’æ¨¡å‹è¿›è¡Œå®šä½ æµ®åŠ¨å®šä½æ¨¡å‹ï¼šå¯¹æµ®åŠ¨ç›’æ¨¡å‹è¿›è¡Œå®šä½ ä¸Šé¢è¿™å‡ ç§å®šä½æ¨¡å‹å·²ç»æ¶µç›–äº†å…­ç§ç›’æ¨¡å‹äº†ï¼Œå¯¹äºä¸€ç§ç›’æ¨¡å‹ï¼Œéƒ½èƒ½æ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„å®šä½æ¨¡å‹ã€‚è¿˜æœ‰ä¸¤ç§æ··åˆå‹çš„å®šä½æ¨¡å‹ï¼Œä¸»è¦æ˜¯é’ˆå¯¹ç›¸å¯¹å®šä½ï¼Œå› ä¸ºç›¸å¯¹å®šä½å¹¶ä¸æ”¹å˜åŸæ¥çš„æ–‡æ¡£æµã€‚ç›¸å¯¹å®šä½çš„å…ƒç´ è¿˜åœ¨æ–‡æ¡£æµä¸­å æ®ç€åŸæ¥çš„ä½ç½®ï¼Œåªä¸è¿‡åœ¨â€œæ˜¾ç¤ºâ€ä¸Šç›¸å¯¹åŸæ¥çš„ä½ç½®æœ‰æ‰€åç§»ï¼Œä½†å®ƒçš„ç›¸é‚»å…ƒç´ å¹¶ä¸ä¼šå› ä¸ºå®ƒçš„ç›¸å¯¹å®šä½è€Œè°ƒæ•´ä½ç½®ã€‚ å› æ­¤å¯¹ä»»ä½•éabsoluteã€fixedå®šä½çš„å…ƒç´ ï¼Œéƒ½å¯ä»¥è®¾ç½®position: relativeæ¥æ··åŠ ï¼Œä»…ä»…æ˜¯åœ¨â€œæ˜¾ç¤ºâ€ä¸Šå¯¹å®ƒä»¬åŠ ç‚¹åç§»é‡ï¼Œå¹¶ä¸æ”¹å˜å®ƒä»¬åœ¨æ–‡æ¡£æµä¸­çš„å®é™…ä½ç½®ã€‚å› æ­¤ä¹Ÿå°±æœ‰äº†ä¸‹é¢ä¸¤ç§æ··åˆçš„å®šä½æ¨¡å‹ã€‚ ç›¸å¯¹å®šä½æ¨¡å‹ï¼šå¯¹é™¤ç»å¯¹å®šä½ç›’æ¨¡å‹å¤–çš„ä»»ä½•ç›’æ¨¡å‹è¿›è¡Œç›¸å¯¹å®šä½ ç›¸å¯¹æµ®åŠ¨å®šä½æ¨¡å‹ï¼šå¯¹æµ®åŠ¨ç›’æ¨¡å‹è¿›è¡Œç›¸å¯¹å®šä½ ç›¸å¯¹å®šä½æƒ³æ§åˆ¶æµ®åŠ¨å…ƒç´ æˆ–æ­£å¸¸æ’åˆ—ä¸­çš„å…ƒç´ çš„å †å é¡ºåºï¼Œé—®é¢˜æ˜¯ï¼Œz-indexä¸èƒ½åº”ç”¨åˆ°æµ®åŠ¨å…ƒç´ å’Œé™æ€å®šä½å…ƒç´ ã€‚è¿™æ—¶å¯ä»¥ç”¨position: relativeå¯¹å®ƒé‡‡å–ç›¸å¯¹å®šä½ï¼Œä½¿ç”¨z-indexè®¾ç½®å®ƒçš„å †å é¡ºåºã€‚ ç›¸å¯¹å…ƒç´ çš„å®šä½å¹¶æ²¡æœ‰è„±ç¦»æ­£å¸¸å…ƒç´ çš„æ’åˆ—ä½ç½®ï¼Œä¹Ÿæ²¡æœ‰æ”¹å˜å®ƒåœ¨æ­£å¸¸æ’åˆ—ä½ç½®æ—¶çš„å½¢çŠ¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå†…è”å…ƒç´ æ¨ªè·¨å¤šè¡Œï¼Œé‚£ä¹ˆå½“å¯¹å…¶è¿›è¡Œç›¸å¯¹å®šä½åï¼Œå®ƒä¼šä¿ç•™è¿™ä¸ªç‹¬ç‰¹çš„å¸ƒå±€ã€‚è€Œå¯¹ç»å¯¹å®šä½æ¥è¯´ï¼Œåˆ™æ°æ°ç›¸åï¼Œå®ƒä¼šæŠŠå†…è”å…ƒç´ è½¬åŒ–æˆä¸€ä¸ªç»å¯¹ç›’æ¨¡å‹ï¼ŒæŠŠå…¶ä¸­å†…å®¹é‡æ–°æ’è¿›ç»å¯¹å—çŠ¶ç›’æ¨¡å‹ï¼Œè¿™æˆ–è®¸ä¼šæ”¹å˜å®ƒçš„å¸ƒå±€ã€‚ å¯ä»¥é€‰æ‹©æ€§åœ°æŠŠç›¸å¯¹å®šä½å…ƒç´ ä»å®ƒçš„åŸå§‹æ’åˆ—ä½ç½®ä¸Šè¿›è¡Œåç§»ï¼Œè€Œä¸ä¼šæ”¹å˜æ’åˆ—ä¸­å…¶ä»–å…ƒç´ çš„ä½ç½®ã€‚ å¯ä»¥æŠŠposition: relativeèµ‹ç»™ä»»ä½•å…ƒç´ ï¼Œè¿™æ ·ï¼Œç»å¯¹å®šä½çš„åä»£å…ƒç´ ä¾¿å¯ç›¸å¯¹å®ƒæ¥å®šä½ã€‚ ç›¸å¯¹æµ®åŠ¨å…ˆè¯´æµ®åŠ¨å®šä½ æµ®åŠ¨å…ƒç´ çš„å®šä½å±‚ä½äºå—çŠ¶å…ƒç´ ä¹‹ä¸Šï¼Œä¸æ­£å¸¸æ’åˆ—é¡ºåºä¸­çš„å†…è”å†…å®¹æ˜¯ç›¸é‚»çš„ã€‚ æµ®åŠ¨ä¸ä¼šå½±å“å—çŠ¶ç›’æ¨¡å‹çš„å®šä½ï¼Œåªä¼šå½±å“å®ƒä»¬çš„å†…è”å†…å®¹ã€‚ æµ®åŠ¨å…ƒç´ ä¸ä¼šä¸å…¶ä»–æµ®åŠ¨å…ƒç´ æˆ–å†…è”å†…å®¹é‡å ï¼ˆé™¤éæµ®åŠ¨å…ƒç´ æœ‰è´Ÿçš„å¤–è¾¹è·ï¼‰ã€‚ ç”¨position: relativeå¯¹æµ®åŠ¨å…ƒç´ è¿›è¡Œç›¸å¯¹å®šä½ï¼Œåœ¨ä¸å½±å“å…¶ä»–å…ƒç´ ï¼ˆåŒ…æ‹¬å…¶ä»–æµ®åŠ¨å…ƒç´ å’Œå†…è”å†…å®¹ï¼‰å®šä½çš„å‰æä¸‹ï¼ŒæŠŠæµ®åŠ¨å…ƒç´ ä»ç°æœ‰ä½ç½®ä¸Šåç§»ã€‚ç›¸å¯¹æµ®åŠ¨è¿˜ä¿ç•™äº†å…ƒç´ åœ¨åŸå§‹æµ®åŠ¨æ’åˆ—é¡ºåºä¸­çš„ä½ç½®ã€‚ ç›¸å¯¹æµ®åŠ¨ä¹Ÿæ˜¯åœ¨å®šä½å±‚è¢«è§£æçš„ï¼Œå¯ä»¥ä½¿ç”¨z-indexæ§åˆ¶å®ƒç›¸å¯¹äºå…¶ä»–æµ®åŠ¨å…ƒç´ å’Œå®šä½å…ƒç´ çš„å †å é¡ºåºã€‚ æ³¨ï¼šåªæœ‰position relativeå’Œstaticæ˜¯ä¸æµ®åŠ¨å…¼å®¹çš„ å †å ç¯å¢ƒ é™æ€å…ƒç´ æŒ‰ç…§æ–‡æ¡£é¡ºåºä»ä¸‹è‡³ä¸Šè¿›è¡Œå æ”¾ã€‚ å®šä½å…ƒç´ ä¾ç…§æ–‡æ¡£å…ƒç´ æ’åºçš„ä¸åŒï¼Œä»åå¾€å‰æŒ‰ç…§z-indexä»å°åˆ°å¤§çš„é¡ºåºè¿›è¡Œå æ”¾ã€‚ å½“z-indexè¢«è®¾ç½®æˆautoæˆ–æŠŠz-indexèµ‹ç»™éå®šä½å…ƒç´ æ—¶ï¼Œæ˜¯ä¸èƒ½äº§ç”Ÿå †å ç¯å¢ƒçš„ã€‚ è´Ÿz-indexå€¼çš„å®šä½å…ƒç´ æ”¾åœ¨é™æ€å…ƒç´ å’Œéå®šä½æµ®åŠ¨å…ƒç´ çš„ä¸‹é¢ã€‚ z-indexä¸æ˜¯å…¨å±€çš„ï¼Œå®ƒæ˜¯ç›¸å¯¹äºè¢«èµ‹ä¸Šäº†z-indexå€¼çš„å®šä½æœ€è¿‘çš„ç¥–å…ˆå…ƒç´ è€Œè¨€çš„ã€‚ æ¯ç§å †å ç¯å¢ƒéƒ½æ˜¯åŸå­åŒ–çš„ï¼Œä¸å…è®¸å…¶ä»–ç¥–å…ˆå…ƒç´ æˆ–å…„å¼Ÿå…ƒç´ æ”¾ç½®äºå…¶å†…çš„å­å…ƒç´ ä¸­ã€‚ å †å ç¯å¢ƒæŒ‰ç…§å¦‚ä¸‹å®šä½å±‚ä»åå¾€å‰è¿›è¡Œè§£æï¼š èƒŒæ™¯é¢œè‰²ã€å›¾ç‰‡å’Œå †å ç¯å¢ƒå…ƒç´ çš„è¾¹æ¡† æ‹¥æœ‰è´Ÿz-indexå€¼çš„åä»£å®šä½å…ƒç´  åä»£éå®šä½å—çŠ¶å…ƒç´  åä»£éå®šä½æµ®åŠ¨å…ƒç´  åä»£éå®šä½å†…è”å…ƒç´  è¢«èµ‹äºˆäº†z-index :autoå’Œz-index: 0çš„åä»£å®šä½å…ƒç´  æœ‰æ­£z-indexå€¼çš„åä»£å®šä½å…ƒç´  åŸå­åŒ–é—®é¢˜ï¼šæµè§ˆå™¨æŠŠé™æ€å†…è”å†…å®¹æ”¾åœ¨é™æ€å—çŠ¶å…ƒç´ èƒŒæ™¯ä¹‹ä¸Šçš„ä¸€å±‚è¿›è¡Œè§£æçš„ï¼Œå½“é™æ€å—çŠ¶å…ƒç´ ä¹‹é—´äº’ç›¸è¦†ç›–çš„æ—¶å€™ï¼Œå®ƒä»¬çš„èƒŒæ™¯ä¹Ÿç›¸åº”åœ°è¦†ç›–äº†ï¼Œå¯æ˜¯å†…è”å†…å®¹å´æ²¡æœ‰ã€‚å› ä¸ºå †å ç¯å¢ƒé¦–å…ˆè§£æçš„æ˜¯æ‰€æœ‰çš„å—çŠ¶å…ƒç´ èƒŒæ™¯å’Œè¾¹æ¡†ï¼Œç„¶åæ˜¯æ‰€æœ‰æµ®åŠ¨å…ƒç´ ï¼Œæ¥ç€æ‰æ˜¯æ‰€æœ‰çš„å†…è”å…ƒç´ å’Œå†…å®¹ã€‚è¿™æ ·ä¾¿æŠŠå—çŠ¶å…ƒç´ çš„èƒŒæ™¯å’Œè¾¹æ¡†ç½®äºæµ®åŠ¨å…ƒç´ å’Œå†…è”å…ƒç´ çš„ä¸‹å±‚äº†ã€‚ è§£å†³ï¼šå®šä½å…ƒç´ å°±æ˜¯åŸå­åŒ–çš„ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰å¤–éƒ¨å…ƒç´ èƒ½å¤Ÿæ’åœ¨å®ƒçš„é™æ€å­å­™å…ƒç´ ã€å†…è”å†…å®¹å’ŒèƒŒæ™¯ä¹‹é—´ã€‚å †å ç¯å¢ƒè¦æ±‚æŠŠå®šä½å…ƒç´ å½“ä½œä¸å¯åˆ†å‰²çš„åŸå­æ¥è§£æï¼Œå¯ç”¨ç›¸å¯¹ã€ç»å¯¹ã€å›ºå®šè¿™3ç§å®šä½æ–¹å¼ä»¤å…ƒç´ åŸå­åŒ–ï¼Œè¢«è®¾ç½®äº†overflow: scrollçš„å—çŠ¶å…ƒç´ ä¹ŸåŒæ ·æ˜¯åŸå­åŒ–çš„ã€‚ æ³¨æ„ï¼šIE6æœ‰ä¸€äº›å°bugï¼Œå¯é€šè¿‡è§¦å‘hasLayoutæ¥ä¿®æ­£ï¼Œå¯ä»¥ç”¨IEçš„ç§æœ‰å±æ€§zoom: 1è§¦å‘å¸ƒå±€ï¼Œä½†æ˜¯zoomä¼šä»¤ä½ çš„æ ·å¼è¡¨ä¸èƒ½é€šè¿‡æ ¡éªŒã€‚]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSSç›’æ¨¡å‹]]></title>
    <url>%2Fblog%2F2015%2F03%2Fcss-box-model.html</url>
    <content type="text"><![CDATA[è¿™æ˜¯CSSä¸­çš„åŸºæœ¬ç›’æ¨¡å‹ï¼Œå†…ç›’å’Œå¤–ç›’çš„æ¦‚å¿µéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè€Œåœ¨ä¸‹é¢å…­ç§å…·ä½“ç›’æ¨¡å‹çš„è®¾ç½®å’Œæ˜¾ç¤ºä¸Šæœ‰æ‰€ä¸åŒã€‚ 1.å†…è”ç›’æ¨¡å‹ ä»å·¦åˆ°å³æ°´å¹³æ’åˆ—ï¼Œè¶…è¿‡çˆ¶å…ƒç´ å®½åº¦æ—¶ä¾¿æ¢è¡Œã€‚ widthã€heightå’Œoverflowåœ¨å†…è”å…ƒç´ ä¸Šä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå®ƒä»¬æ€»æ˜¯ä¸å†…å®¹çš„å®½åº¦å’Œé«˜åº¦ä¸€è‡´ã€‚ ç”¨margin-leftã€margin-rightæ¥æ”¹å˜å†…è”å…ƒç´ åœ¨æ°´å¹³æ’åˆ—ä¸­çš„ä½ç½®ï¼Œç”¨line-heightè®¾ç½®è¡Œé«˜ï¼ˆç›¸å½“äºæ”¹å˜ç«–ç›´æ–¹å‘çš„ä½ç½®ï¼Œå› ä¸ºmargin-topã€margin-bottomä¸èµ·ä½œç”¨ï¼‰ã€‚ borderæ°´å¹³çš„è¾¹æ¡†ä¼šæ”¹å˜å†…è”å…ƒç´ åœ¨æ’åˆ—ä¸­çš„ä½ç½®ï¼Œå·¦è¾¹æ¡†ä¼šä»¤å…ƒç´ é å·¦ï¼Œå³è¾¹æ¡†ä½¿ä¸‹ä¸€ä¸ªå…ƒç´ é å³ã€‚è€Œä¸Šä¸‹è¾¹æ¡†åˆ™ä¼šæ˜¾ç¤ºäºå†…è¾¹è·ä¹‹å¤–ï¼Œä½†æ˜¯æ²¡æœ‰æ‰©å±•è¡Œé«˜æˆ–æ”¹å˜å…ƒç´ åœ¨ç«–ç›´æ–¹å‘ä¸Šçš„ä½ç½®ã€‚è¾¹æ¡†ä¸ä¼šå¯¹è¡Œé«˜é€ æˆå½±å“ï¼Œä¸è¿‡è¾¹æ¡†èƒ½è¦†ç›–æ‰é‚»è¿‘è¡Œã€‚ paddingåº”ç”¨åˆ°å†…è”å…ƒç´ çš„æ–¹å¼ä¸borderå®Œå…¨ç›¸åŒã€‚ 2.å†…è”å—çŠ¶ç›’æ¨¡å‹ å†…è”å—çŠ¶å…ƒç´ æ˜¯ä½äºå†…è”æ’åˆ—é¡ºåºä¸­çš„ï¼Œå°±åƒå…¶ä»–çš„å†…è”ç›’å­ä¸€æ ·ï¼Œåªä¸è¿‡å®ƒè¿˜åŒ…æ‹¬äº†ä¸€äº›å—çŠ¶å…ƒç´ çš„å±æ€§ï¼šå¤–è¾¹è·ã€è¾¹æ¡†ã€å†…è¾¹è·ã€å®½åº¦å’Œé«˜åº¦ã€‚ widthå’Œheightï¼Œè®¾ç½®æˆautoæŠŠå†…è”å—çŠ¶å…ƒç´ åŒ…è£¹ä½ï¼Œè®¾ç½®æˆ100%æŠŠå†…è”å—æ‹‰é•¿ã€‚æ³¨æ„ï¼Œè¢«æ‹‰é•¿çš„å†…è”å—çŠ¶å…ƒç´ ä¸å—çŠ¶å…ƒç´ æ˜¯ä¸€æ ·çš„ã€‚ marginæœ‰ä¸€äº›ç‹¬ç‰¹çš„å†…è”å—çŠ¶åŠŸèƒ½ã€‚æ­£çš„margin-topä¼šå¢åŠ è¡Œé«˜ï¼Œè´Ÿçš„åˆ™ä¼šå‡å°è¡Œé«˜ã€‚ borderå’Œpaddingèƒ½æ‰©å±•å†…è”å…ƒç´ çš„å¤–å›´å°ºå¯¸ï¼Œä¼šä»¤å®ƒä»¥åŠåé¢çš„å†…å®¹å‘å³åç§»ï¼Œä¹Ÿä¼šè®©å®ƒå˜å¤§ï¼Œå¢åŠ å®ƒæ‰€åœ¨è¡Œçš„é«˜åº¦ã€‚ 3.å—çŠ¶ç›’æ¨¡å‹ ä»ä¸Šåˆ°ä¸‹ç«–ç›´æ’åˆ—ã€‚Terminalå—çŠ¶å…ƒç´ åœ¨å…¶å†…ç›’é‡Œåˆ›å»ºäº†ä¸€ä¸ªå†…è”æ ¼å¼åŒ–ç¯å¢ƒï¼Œä½†æ˜¯å®ƒçš„å¤–ç›’æ­¤æ—¶ä¸€å®šæ˜¯å¤„äºå—çŠ¶æ ¼å¼åŒ–ç¯å¢ƒä¸‹ã€‚ å—çŠ¶å…ƒç´ çš„å®½é«˜å¯ä¸å®ƒçš„çˆ¶å…ƒç´ ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥å°äºæˆ–å¤§äºå®ƒçš„çˆ¶å…ƒç´ ï¼Œå½“å®ƒçš„å°ºå¯¸å¤§äºçˆ¶å…ƒç´ çš„æ—¶å€™ï¼Œå°±ä¼šæº¢å‡ºæ¥ã€‚ widthé»˜è®¤å€¼æ˜¯autoï¼Œå®ƒä½¿å…ƒç´ çš„å®½åº¦ä¸çˆ¶å…ƒç´ ä¸€è‡´ã€‚ heighté»˜è®¤å€¼æ˜¯autoï¼Œå®ƒä½¿å…ƒç´ çš„é«˜åº¦åŒ…è£¹ä½å®ƒçš„æ‰€æœ‰å­å…ƒç´ ã€‚ margin-leftå’Œmargin-rightä¼šè°ƒæ•´å—çŠ¶å…ƒç´ å·²è®¾ç½®çš„å°ºå¯¸ï¼Œä¼šè®©å†…ç›’å˜å°ã€‚ margin-topå’Œmargin-bottomï¼Œæµè§ˆå™¨ä¼šæŠµæ¶ˆç›¸é‚»å—çŠ¶å…ƒç´ çš„é¡¶éƒ¨å’Œåº•éƒ¨å¤–è¾¹è·ã€‚ ç”¨margin-left: autoå’Œmargin-right: autoæ§åˆ¶å·²å›ºå®šäº†å°ºå¯¸çš„å—çŠ¶å…ƒç´ çš„æ°´å¹³æ’åˆ—ã€‚è®¾ç½®widthå’Œmargin-right: autoä¼šä»¤å—çŠ¶å…ƒç´ æ’åˆ—åœ¨å…¶çˆ¶å…ƒç´ çš„å·¦ä¾§ï¼›margin-left: autoä¼šåœ¨å³ä¾§ï¼›åŒæ—¶è®¾ç½®åˆ™ä¼šå±…ä¸­ã€‚ borderå’Œpaddingä¼šæ‰©å±•ç›’æ¨¡å‹çš„å¤–å®½å’Œå¤–é«˜ã€‚å¯¹è¢«æ‹‰é•¿äº†çš„å—çŠ¶å…ƒç´ æ¥è¯´ï¼Œæ°´å¹³è¾¹æ¡†å’Œå†…è¾¹è·ä¼šæ”¹å˜å†…ç›’çš„å¤§å°ã€‚è€Œå¯¹äºå›ºå®šå°ºå¯¸çš„å—çŠ¶å…ƒç´ æ¥è¯´ï¼Œå®ƒä»¬ä¼šè°ƒæ•´å¤–ç›’ã€‚ 4.è¡¨æ ¼ç›’æ¨¡å‹ è¡¨æ ¼æ˜¯ä¸€ä¸ªå«æœ‰å¾ˆå¤šè¡Œå•å…ƒæ ¼çš„å—çŠ¶ç›’æ¨¡å‹ã€‚è¡¨æ ¼ä¹Ÿä½äºå—çŠ¶å…ƒç´ çš„æ’åˆ—ä¸­ï¼Œè€Œè¡¨æ ¼ä¸­çš„å•å…ƒæ ¼åˆ™æŒ‰â€œè¡Œâ€å’Œâ€œåˆ—â€æ¥æ’åˆ—ã€‚ è¡¨æ ¼æœ‰å¤–è¾¹è·ï¼Œæ²¡æœ‰å†…è¾¹è·ã€‚å•å…ƒæ ¼æœ‰å†…è¾¹è·ï¼Œæ²¡æœ‰å¤–è¾¹è·ã€‚ widthå’Œheightï¼Œè¿™æ˜¯è¡¨æ ¼è¾¹æ¡†å¤–å›´çš„å®½é«˜ï¼Œè€Œä¸åƒå…¶ä»–ç›’æ¨¡å‹æ˜¯å†…ç›’çš„å®½é«˜ã€‚ ä¸èƒ½æŠŠoverflowåº”ç”¨äºè¡¨æ ¼ï¼Œå› ä¸ºè¡¨æ ¼æ˜¯ä¸èƒ½æº¢å‡ºçš„ã€‚åªæœ‰è¡¨æ ¼çš„å•å…ƒæ ¼èƒ½æº¢å‡ºã€‚ border-collapseå†³å®šäº†é‚»è¿‘çš„è¾¹æ¡†æ˜¯å¦åˆå¹¶ä¸ºä¸€ä¸ªã€‚ table-layoutå†³å®šäº†è¡¨æ ¼æ˜¯å›ºå®šå¤§å°ï¼ˆfixedï¼‰è¿˜æ˜¯ä¾æ®å…¶å†…å®¹è€Œå˜åŠ¨ï¼ˆautoï¼‰ã€‚ 5.ç»å¯¹å®šä½ç›’æ¨¡å‹ ç»å¯¹å®šä½å…ƒç´ ä»æ­£å¸¸çš„å…ƒç´ æ’åˆ—é¡ºåºä¸­è„±ç¦»äº†ï¼ŒæŠŠå®ƒç½®äºæ›´é«˜çš„ä¸€å±‚æˆ–æ›´ä½çš„ä¸€å±‚ã€‚ å®ƒæ˜¯ç›¸å¯¹äºæœ€è¿‘çš„å®šä½ç¥–å…ˆï¼ˆrelativeæˆ–absoluteçš„ç¥–å…ˆï¼Œéƒ½æ²¡æœ‰çš„è¯ç›´åˆ°htmlæ ¹å…ƒç´ ï¼‰æ¥å®šä½ï¼Œæˆ–è€…å›ºå®šäºè§†çª—çš„æŸä¸ªä½ç½®ã€‚ ä¸åƒå…¶ä»–çš„ç›’æ¨¡å‹ï¼Œç»å¯¹å®šä½ç›’æ¨¡å‹çš„ä½ç½®ä¸ä¼šå½±å“å…¶ä»–ç›’æ¨¡å‹çš„ä½ç½®ã€‚ z-indexæ§åˆ¶å®šä½å…ƒç´ çš„å æ”¾é¡ºåºã€‚ leftã€rightã€topå’Œbottoméƒ½è®¾ç½®ä¸ºautoï¼ˆé»˜è®¤å€¼ï¼‰æ—¶ï¼Œåˆ™ç»å¯¹å®šä½ç›’æ¨¡å‹çš„ä½ç½®ä¸å®ƒåŸå…ˆåœ¨æ’åˆ—é¡ºåºä¸­çš„ä½ç½®ä¸€è‡´ã€‚ widthé»˜è®¤å€¼ä¸ºautoã€‚ å½“widthæ˜¯autoå¹¶ä¸”leftå’Œrightä¹Ÿæ˜¯autoæ—¶ï¼Œç›’æ¨¡å‹å°±æ˜¯è¢«åŒ…è£¹çš„ã€‚ å½“widthæ˜¯autoå¹¶ä¸”leftå’Œrightæ˜¯0æˆ–å…¶ä»–ä»€ä¹ˆå€¼çš„æ—¶å€™ï¼Œç›’æ¨¡å‹ä¼šè¢«æ‹‰ä¼¸ã€‚ å½“widthæœ‰ä¸€ä¸ªå€¼ï¼Œleftæœ‰ä¸€ä¸ªå€¼ä¸”rightæ˜¯autoæ—¶ï¼Œç›’æ¨¡å‹å°±è¢«å›ºå®šäº†å°ºå¯¸å¹¶ä»å·¦ä¾§åç¦»ã€‚ å½“widthæœ‰ä¸€ä¸ªå€¼ï¼Œrightæœ‰ä¸€ä¸ªå€¼ä¸”leftæ˜¯autoæ—¶ï¼Œç›’æ¨¡å‹ä¹Ÿæ˜¯å›ºå®šå¤§å°çš„ï¼Œå¹¶ä»å³ä¾§åç¦»ã€‚ heightã€topå’Œbottomçš„è¿ä½œæ–¹å¼ä¸widthã€leftå’Œrightç±»ä¼¼ã€‚ marginä¸ºæ­£æ—¶ï¼Œä¼šä»¤ç»å¯¹å®šä½çš„ç›’æ¨¡å‹ç§»å‘å®ƒçš„å®¹å™¨ä¸­å¿ƒã€‚å½“å®ƒä¸ºè´Ÿæ—¶ï¼Œåˆ™ä¼šè¿œç¦»ä¸­å¿ƒã€‚ borderå’Œpaddingä¼šç¼©å°å·²æ‹‰ä¼¸çš„ç»å¯¹å®šä½ç›’æ¨¡å‹çš„å†…ç›’ã€‚borderå’Œpaddingä¼šæ‰©å±•å·²è®¾å®šå°ºå¯¸çš„ç›’å­çš„å¤–ç›’ï¼Œå¹¶æŠŠç»å¯¹å®šä½ç›’æ¨¡å‹åŒ…è£¹ä½ï¼Œå°†å…¶ç§»å‘å®¹å™¨çš„ä¸­å¿ƒã€‚ 6.æµ®åŠ¨ç›’æ¨¡å‹ æµ®åŠ¨å…ƒç´ ä¹Ÿè„±ç¦»äº†æ­£å¸¸çš„å…ƒç´ æ’åˆ—é¡ºåºï¼Œè¢«ç½®äºé‚»è¿‘å—çŠ¶å…ƒç´ çš„è¾¹æ¡†å’ŒèƒŒæ™¯ä¹‹ä¸Šã€‚è¿™ä¼šç¼©å°æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ ï¼Œå½“æ‰€æœ‰å­å…ƒç´ éƒ½æµ®åŠ¨çš„æ—¶å€™ï¼Œçˆ¶å…ƒç´ çš„èŒƒå›´ä¾¿å®Œå…¨æ¶ˆå¤±äº†ã€‚ å³ä½¿æµ®åŠ¨å…ƒç´ è„±ç¦»äº†åŸæœ¬å…ƒç´ çš„æ’åˆ—é˜Ÿä¼ï¼Œå®ƒä¼šä»¤é˜Ÿä¼ä¸­é‚»è¿‘çš„å†…å®¹æœæŸä¸ªæ–¹å‘ç¼©è¿›ã€‚å·¦æµ®åŠ¨ä¼šä»¤é‚»è¿‘çš„å†…å®¹å‘å³ç¼©è¿›ã€‚ æµ®åŠ¨å…ƒç´ æ˜¯åœ¨åŸæœ¬çš„ç«–ç›´æ–¹å‘ä¸Šä¾æ¬¡æ’åˆ—çš„ï¼Œå½“æµ®åŠ¨å…ƒç´ ä¸èƒ½ç´§é‚»å®ƒçš„ä¸‹ä¸€ä¸ªæµ®åŠ¨å…ƒç´ çš„æ—¶å€™ï¼Œå®ƒä¼šæŒªåˆ°ä¸‹æ–¹ã€‚ æµ®åŠ¨å…ƒç´ çš„ä½ç½®ã€å¤§å°ã€å†…è¾¹è·ã€è¾¹æ¡†å’Œå¤–è¾¹è·éƒ½ä¼šå½±å“é‚»è¿‘æµ®åŠ¨å…ƒç´ å’Œé‚»è¿‘å†…è”å†…å®¹çš„ä½ç½®ã€‚æµ®åŠ¨å…ƒç´ çš„ç²¾ç¡®ä½ç½®æ˜¯ä¸èƒ½äº‹å…ˆå®šä¹‰çš„ã€‚ widthé»˜è®¤å€¼æ˜¯autoï¼Œä¼šä»¤å®ƒçš„å®½åº¦ä¸å…¶æœ€é•¿çš„è¡Œä¸€è‡´ã€‚ heighté»˜è®¤å€¼æ˜¯autoï¼Œä¼šåŒ…è£¹ä½æ•´ä¸ªæµ®åŠ¨å…ƒç´ ï¼Œä½¿å®ƒçš„é«˜åº¦ä¸å…¶å­å…ƒç´ çš„æ€»é«˜åº¦ç›¸ä¸€è‡´ã€‚ æµ®åŠ¨å…ƒç´ çš„å¤–è¾¹è·æ˜¯ä¸ä¼šäº’ç›¸æŠµæ¶ˆçš„ã€‚ borderå’Œpaddingå¢å¤§äº†æµ®åŠ¨å…ƒç´ çš„å¤–ç›’å°ºå¯¸ã€‚ æ³¨æ„ï¼Œfloatå…·æœ‰ç ´åæ€§ï¼Œä¼šè®©å…ƒç´ å‘ˆç°å‡ºinline-blockçš„ä¸€äº›æ€§è´¨ï¼Œå³ä½¿è¯¥å…ƒç´ åŸæ¥æ˜¯inlineçš„ã€‚ æ€»ç»“widthå’Œheightwidth: auto æ°´å¹³åŒ…è£¹ä»¥ä¸‹å‡ ç§ç›’æ¨¡å‹ï¼šå†…è”ã€å†…è”å—çŠ¶ã€æµ®åŠ¨ã€è¡¨æ ¼ï¼Œå’Œç»å¯¹å®šä½ï¼ˆå½“leftå’Œrightéƒ½è®¾ç½®ä¸ºautoæ—¶ï¼‰ã€‚ æ°´å¹³æ‹‰ä¼¸å—çŠ¶ï¼Œå’Œç»å¯¹å®šä½ç›’æ¨¡å‹ï¼ˆå½“leftå’Œrightéƒ½è®¾ç½®äº†ä¸€ä¸ªå€¼ï¼Œä¾‹å¦‚0ï¼‰ã€‚ width: 100% ä¼šæŠŠå…ƒç´ çš„å®½åº¦è®¾ç½®ä¸ºå…¶çˆ¶å…ƒç´ çš„å®½åº¦ï¼Œä½†æ˜¯ä¸åƒautoï¼Œwidth: 100%æ‹¥æœ‰ä¸€äº›é™åˆ¶ï¼Œæµè§ˆå™¨ä¸ä¼šè‡ªåŠ¨è°ƒæ•´å®½åº¦ä»¥ä¿æŒå…ƒç´ è¢«æ‹‰ä¼¸ã€‚ å…ƒç´ çš„æ°´å¹³å¤–è¾¹è·ã€è¾¹æ¡†æˆ–è€…å†…è¾¹è·èƒ½å¤Ÿæ‰©å±•å®ƒçš„å®½åº¦ï¼Œç”šè‡³å¯è¶…è¶Šçˆ¶å…ƒç´ çš„å®½åº¦ã€‚ height: auto ç«–ç›´åŒ…è£¹ä»¥ä¸‹å‡ ç§ç›’æ¨¡å‹ï¼šå†…è”ã€å†…è”å—çŠ¶ã€å—çŠ¶ã€æµ®åŠ¨ã€è¡¨æ ¼å’Œç»å¯¹å®šä½ï¼ˆå½“topå’Œbottoméƒ½è®¾ç½®ä¸ºautoæ—¶ï¼‰ã€‚ ç«–ç›´æ‹‰ä¼¸ç»å¯¹å®šä½ç›’æ¨¡å‹ï¼ˆä»…å½“topå’Œbottoméƒ½è®¾ç½®äº†ä¸€ä¸ªå€¼ï¼Œä¾‹å¦‚0ï¼‰ã€‚è¿™æ˜¯ç«–ç›´æ‹‰ä¼¸ç›’æ¨¡å‹çš„æœ€å¥½æ–¹æ³•ï¼Œå› ä¸ºheight: 100%ä¼šæœ‰ä¸€äº›å±€é™æ€§ã€‚ height: 100% ä¼šæŠŠå…ƒç´ çš„é«˜åº¦è®¾ç½®æˆä¸çˆ¶å…ƒç´ ä¸€æ ·ï¼Œå…¶ä»–ä¸width: 100%ç±»ä¼¼ã€‚ å‚è€ƒç²¾é€šCSSä¸HTMLè®¾è®¡æ¨¡å¼]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå·±å†™çš„jqueryåˆ†é¡µæ’ä»¶]]></title>
    <url>%2Fblog%2F2015%2F03%2Fstep-by-step-jquery-plugin-pagination-1.html</url>
    <content type="text"><![CDATA[ç»å¸¸åšä¿¡æ¯ç®¡ç†ç±»çš„ç½‘ç«™ï¼Œåˆ†é¡µå¯ä»¥è¯´æ˜¯æœ€å¸¸è§çš„åŠŸèƒ½ä¹‹ä¸€äº†ã€‚çºµç„¶ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°ä¸€å †jqueryåˆ†é¡µæ’ä»¶ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³æ‰‹æŠŠæ‰‹è‡ªå·±å†™ä¸€ä¸ªåˆ†é¡µï¼Œæ›´æ¸…æ¥šè‡ªå·±éœ€è¦æ€æ ·çš„åˆ†é¡µåŠŸèƒ½ï¼Œä¸æƒ³åŒ…å«è¿‡äºå¤æ‚çš„åŠŸèƒ½ã€‚è¯´åˆ°åˆ†é¡µï¼Œæˆ‘èƒ½æƒ³åˆ°3ç§ï¼šç›´æ¥åˆ·æ–°é¡µé¢ï¼›Ajaxåˆ·æ–°åˆ†é¡µï¼›ä¼ªåˆ†é¡µã€‚ä¼ªåˆ†é¡µå…¶å®å°±æ˜¯å¯¹é¡µé¢æ•°æ®çš„è¿‡æ»¤ï¼Œé¡µé¢åŒ…å«äº†æ‰€æœ‰çš„æ•°æ®çš„å…ƒç´ ï¼Œåªä¸è¿‡â€œä¸€é¡µâ€ä»…æ˜¾ç¤ºéƒ¨åˆ†æ•°æ®çš„å…ƒç´ ã€‚Ajaxåˆ†é¡µåˆ™æ˜¯å±€éƒ¨åˆ·æ–°é¡µé¢ä¸Šçš„æ•°æ®å…ƒç´ ã€‚æˆ‘å…ˆå®ç°æœ€ç®€å•çš„åˆ†é¡µæ–¹å¼ï¼Œå³ç›´æ¥åˆ·æ–°é¡µé¢ã€‚ jqueryæ’ä»¶å†™æ³•jqueryä¸­æä¾›äº†fnæ‰©å±•å±æ€§ï¼Œä»»ä½•å†™åˆ°fnä¸­çš„å‡½æ•°ï¼Œéƒ½å¯ä»¥è¢«jquery DOMå…ƒç´ ç›´æ¥è°ƒç”¨ã€‚ 12345$.fn.sayHello = function()&#123; return this.each(function()&#123; alert(this); &#125;);&#125;; æœ‰äº†è¿™ä¸ªæ‰©å±•å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥å¯¹å…ƒç´ è¿™æ ·$(&#39;#someElement&#39;).sayHello()è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åŒæ—¶ä½œç”¨åœ¨å¤šä¸ªå…ƒç´ ä¸Šï¼Œåƒ$(&#39;.some-class&#39;).sayHello()è¿™æ ·ã€‚ æ³¨æ„sayHelloä¸­ä¸¤ä¸ªthisæ˜¯æœ‰åŒºåˆ«çš„ï¼Œå‡½æ•°è¿›æ¥çš„ç¬¬ä¸€ä¸ªthiså°±æ˜¯æŒ‡è°ƒç”¨sayHello()çš„å…ƒç´ ï¼Œè€Œä¸”è¿™é‡Œçš„thiså°±å·²ç»æ˜¯jqueryçš„å…ƒç´ äº†ï¼Œä¸éœ€è¦å†å¤šæ­¤ä¸€ä¸¾$(this)äº†ã€‚è€Œthis.each()è¡¨ç¤ºå¯¹æ‰€æœ‰è°ƒç”¨sayHello()çš„å…ƒç´ å‡è¿›è¡Œå¦‚ä¸‹æ“ä½œã€‚each(function(){})é‡Œé¢çš„thisè¡¨ç¤ºçš„æ˜¯å•ä¸ªè°ƒç”¨sayHello()çš„å…ƒç´ ï¼Œæ³¨æ„è¿™é‡Œçš„thisæ˜¯åŸç”ŸDOMå…ƒç´ ï¼Œå¦‚è¦ä½¿ç”¨jqueryçš„å‡½æ•°ï¼Œåˆ™éœ€è¦å…ˆ$(this)ä¸€ä¸‹ã€‚ å®Œå–„åçš„sayHelloä»£ç å¦‚ä¸‹ã€‚ 1234567$.fn.sayHello = function()&#123; return this.each(function()&#123; $(this).bind('click', function()&#123; alert('hello ' + $(this).prop('tagName')); &#125;); &#125;);&#125;; å³è¿™ä¸ªsayHelloæ’ä»¶ä¼šä¸ºå…ƒç´ ç»‘å®šä¸€ä¸ªclickäº‹ä»¶ï¼Œç‚¹å‡»åä¼šå¼¹å‡ºè¯¥å…ƒç´ çš„æ ‡ç­¾åã€‚æ•ˆæœå¦‚ä¸‹ã€‚ åˆ†é¡µæ’ä»¶è®¾è®¡ä»¤è¿™ä¸ªåˆ†é¡µæ’ä»¶ï¼ˆæ‰©å±•å‡½æ•°ï¼‰å«åšjqPaginationï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œåœ¨é¡µé¢ä¸­åªéœ€è¦å®šä¹‰ä¸€ä¸ª&lt;div&gt;ï¼Œæ— éœ€å®šä¹‰ä»»ä½•å­å…ƒç´ ï¼Œåªéœ€è¦jqPagination()ä¸€ä¸‹ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå¥½çœ‹çš„åˆ†é¡µæŒ‰é’®å‡ºæ¥ã€‚ç”±äºé¡µæ•°æ˜¯ä¸ç¡®å®šçš„ï¼Œä¸å¯èƒ½æŠŠæ‰€æœ‰é¡µç åœ¨ç•Œé¢ä¸Šéƒ½æ˜¾ç¤ºå‡ºæ¥ï¼ˆä½“éªŒå¤ªå·®ï¼‰ï¼Œå®ƒåªæ˜¾ç¤ºç¬¬ä¸€é¡µã€æœ€åä¸€é¡µï¼Œä»¥åŠå½“å‰é¡µçš„å‰åä¸¤é¡µã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæœ‰ç‚¹ç±»ä¼¼ä¸€ä¸ªâ€œæ»‘åŠ¨çª—å£â€ï¼Œçª—å£å¤§å°æ˜¯5ï¼ˆå½“å‰é¡µå’Œå‰å2é¡µï¼‰ï¼Œæœªæ˜¾ç¤ºçš„é¡µç ç”¨â€œâ€¦â€æ˜¾ç¤ºã€‚ ç”±äºåœ¨é¡µé¢ä¸­åªå®šä¹‰ä¸€ä¸ª&lt;div&gt;ï¼Œé‚£ä¹ˆå½“å‰çš„é¡µç å’Œæ€»é¡µæ•° è¦ä¹ˆå†™åœ¨&lt;div&gt;çš„è‡ªå®šä¹‰å±æ€§ä¸­ è¦ä¹ˆå½“ä½œå‚æ•°ä¼ ç»™jqPagination è¿™å°±æ˜¯è¿™ä¸ªåˆ†é¡µæ’ä»¶çš„å¯¹å¤–æ¥å£è®¾è®¡ã€‚&lt;div&gt;ä¸­æ”¯æŒdata-pnå’Œdata-tpnä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºå½“å‰é¡µç å’Œæ€»é¡µæ•°ã€‚ 1&lt;div id="pagination1" data-pn="5" data-tpn="12"&gt;&lt;/div&gt; åŒæ—¶jqPaginationä¹Ÿæ”¯æŒé…ç½®å‚æ•°ï¼Œå¦‚ä¸‹ã€‚ 1234$('#pagination1').jqPagination(&#123; pn: 5, tpn: 12&#125;); æ’ä»¶å®ç°å¤§ä½“å®ç°æ€è·¯å°±æ˜¯ï¼š ä¸º&lt;div&gt;æ·»åŠ ä¸€äº›å­å…ƒç´ ï¼Œä¸æ¶‰åŠå…·ä½“é¡µç ã€‚ ç”Ÿæˆå¸¦â€œæ»‘åŠ¨çª—å£â€çš„å…·ä½“é¡µç ï¼Œå¹¶ä¸ºé¡µç æ·»åŠ æ˜¯å¦activeçš„æ ·å¼ã€‚ ä¸ºæ¯ä¸ªé¡µç æ·»åŠ é“¾æ¥ï¼Œå³ç‚¹å‡»è¯¥é¡µåˆ™ç›´æ¥åˆ·æ–°é¡µé¢ã€‚ ä¸ºâ€œå‰ä¸€é¡µâ€å’Œâ€œåä¸€é¡µâ€ç»‘å®šç‚¹å‡»äº‹ä»¶ã€‚ Step 1 1234567891011121314151617181920212223242526272829$.fn.jqPagination = function(options)&#123; var generatePages = function($el)&#123; var $list = $('&lt;ul class="' + CLASS_PAGE_LIST + '"&gt;&lt;/ul&gt;'); // prePage $list.append('&lt;li class="' + CLASS_DISABLED + '"&gt;&lt;a href="javascript:void(0);" class="' + CLASS_PRE_PAGE + '"&gt;' + TEXT_PRE_PAGE + '&lt;/a&gt;&lt;/li&gt;'); // firstPage $list.append('&lt;li class="' + CLASS_ACTIVE + '"&gt;&lt;a href="javascript:void(0);" class="' + CLASS_PAGE + '" data-page="1"&gt;1&lt;/a&gt;&lt;/li&gt;'); // preOmit $list.append('&lt;li class="' + CLASS_DISABLED + '"&gt;&lt;a href="javascript:void(0);" class="' + CLASS_PRE_OMIT + '"&gt;' + TEXT_OMIT + '&lt;/a&gt;&lt;/li&gt;'); // nextOmit $list.append('&lt;li class="' + CLASS_DISABLED + '"&gt;&lt;a href="javascript:void(0);" class="' + CLASS_NEXT_OMIT + '"&gt;' + TEXT_OMIT + '&lt;/a&gt;&lt;/li&gt;'); // lastPage $list.append('&lt;li class=""&gt;&lt;a href="javascript:void(0);" class="' + CLASS_PAGE + '" data-page=""&gt;' + TEXT_EMPTY + '&lt;/a&gt;&lt;/li&gt;'); // nextPage $list.append('&lt;li class="' + CLASS_DISABLED + '"&gt;&lt;a href="javascript:void(0);" class="' + CLASS_NEXT_PAGE + '"&gt;' + TEXT_NEXT_PAGE + '&lt;/a&gt;&lt;/li&gt;'); // append to list $el.empty().append($list); &#125;; var init = function($el)&#123; $el.addClass(CLASS_PAGINATION); generatePages($el); &#125;; return init(this);&#125;; è¿™é‡Œç›´æ¥ä¸ºå‡ ä¸ªç‰¹æ®Šçš„å…ƒç´ å å¥½â€œå‘â€ï¼Œåˆ†åˆ«æ˜¯ï¼šä¸Šä¸€é¡µï¼Œç¬¬1é¡µï¼Œæ»‘åŠ¨çª—å£å‘å‰çš„çœç•¥ï¼Œæ»‘åŠ¨çª—å£å‘åçš„çœç•¥ï¼Œæœ€åä¸€é¡µï¼ˆé¡µç ä¸ºç©ºï¼‰ï¼Œä¸‹ä¸€é¡µã€‚å…·ä½“çš„é¡µç å…ƒç´ éƒ½æ˜¯æœ‰data-pageå±æ€§çš„ï¼Œè¿™é‡Œç¬¬ä¸€é¡µå’Œæœ€åä¸€é¡µä¹Ÿå±äºå…·ä½“é¡µç ã€‚ç„¶ååœ¨Step 2ä¸­ç”Ÿæˆå…¶ä»–å…·ä½“é¡µç ï¼Œå¹¶ä¸ºè¿™é‡Œå çš„â€œå‘â€è®¾ç½®activeã€disabledæˆ–hideã€‚ Step 2 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061var generatePages = function($el)&#123; // ä»¥ä¸Šçœç•¥... var $dummies = $list.children('li'); var dummyLen = $dummies.length; // targets reference var $firstPage = $dummies.eq(1); var $lastPage = $dummies.eq(dummyLen-2); var $prePage = $dummies.first(); // eq(0) var $nextPage = $dummies.last(); // eq(dummyLen-1) var $preOmitted = $dummies.eq(2); var $nextOmitted = $dummies.eq(dummyLen-3); // a copy for dynamic page, initial var $pageCopy = $firstPage.clone().removeAttr('class'); // page number region var pn = Number(opts.pn); var tpn = Number(opts.tpn); var lowerPn = Math.max(pn-2, 2); // ç¬¬1é¡µå·²å†™åœ¨htmlä¸­ var upperPn = Math.min(pn+2, tpn-1); // æœ€å1é¡µå·²å†™åœ¨htmlä¸­ // generate new specific pagesï¼ˆå½“å‰é¡µçš„å‰å2é¡µï¼‰ for(var i=lowerPn; i&lt;=upperPn; i++)&#123; var $newPage = $pageCopy.clone(); $newPage.find('a').attr('data-page', i).text(i); $newPage.insertBefore($nextOmitted); // add current page flag i == pn &amp;&amp; $newPage.addClass(CLASS_ACTIVE); &#125; // check first page $firstPage.removeClass(CLASS_ACTIVE); pn == 1 &amp;&amp; $firstPage.addClass(CLASS_ACTIVE); // check last page $lastPage.find('a').attr('data-page', tpn).text(tpn); $lastPage.removeClass(CLASS_ACTIVE); pn == tpn &amp;&amp; $lastPage.addClass(CLASS_ACTIVE); // check if last page equals first page $lastPage.removeClass(CLASS_HIDE) tpn == 1 &amp;&amp; $lastPage.addClass(CLASS_HIDE); // check Previous page $prePage.attr('class', CLASS_DISABLED); pn &gt; 1 &amp;&amp; $prePage.removeClass(CLASS_DISABLED); // check Next page $nextPage.attr('class', CLASS_DISABLED); pn &lt; tpn &amp;&amp; $nextPage.removeClass(CLASS_DISABLED); // check pre omitted $preOmitted.removeClass(CLASS_HIDE); lowerPn &lt;= 2 &amp;&amp; $preOmitted.addClass(CLASS_HIDE); // check next omitted $nextOmitted.removeClass(CLASS_HIDE); upperPn == tpn-1 &amp;&amp; $nextOmitted.addClass(CLASS_HIDE);&#125;; è¿™é‡Œçš„æ»‘åŠ¨çª—å£çš„é¡µç èŒƒå›´ä¸ºMath.max(pn-2, 2)åˆ°Math.min(pn+2, tpn-1)ï¼Œå› ä¸ºç¬¬1é¡µå’Œæœ€å1é¡µå·²ç»åœ¨Step 1ä¸­å å¥½â€œå‘â€äº†ã€‚ç”Ÿæˆçš„å…·ä½“é¡µç å³å½“å‰é¡µçš„å‰å2é¡µï¼Œæ·»åŠ å¥½data-pageå±æ€§ï¼Œæ’å…¥åˆ°â€œå‘â€çš„ç›¸åº”ä½ç½®ã€‚ç„¶åå°±æ˜¯æ ¹æ®pnï¼ˆå½“å‰é¡µç ï¼‰å’Œtpnï¼ˆæ€»é¡µæ•°ï¼‰å¯¹é‚£äº›â€œå‘â€è¿›è¡Œå¯è§æ€§çš„æ£€æŸ¥ï¼Œè¯¥disabledçš„å’Œè¯¥hideçš„ã€‚ Step 3 &amp; 4 1234567891011121314151617181920212223242526272829303132333435363738var bindPageEvents = function($el)&#123; // Previous page $el.find('.' + CLASS_PRE_PAGE).click(function()&#123; if($(this).parent().hasClass(CLASS_DISABLED))&#123; return false; &#125; var $target = $el.find('li.' + CLASS_ACTIVE).prev(); // omitted patch if($target.hasClass(CLASS_DISABLED))&#123; $target = $target.prev(); if($target.hasClass(CLASS_DISABLED))&#123; $target = $target.prev(); &#125; &#125; targetClick($target); &#125;); // Next page $el.find('.' + CLASS_NEXT_PAGE).click(function()&#123; if($(this).parent().hasClass(CLASS_DISABLED))&#123; return false; &#125; var $target = $el.find('li.' + CLASS_ACTIVE).next(); // omitted patch if($target.hasClass(CLASS_DISABLED))&#123; $target = $target.next(); if($target.hasClass(CLASS_DISABLED))&#123; $target = $target.next(); &#125; &#125; targetClick($target); &#125;); // specific pages $el.find('a.' + CLASS_PAGE).each(function()&#123; $(this).attr('href', getPageHref($(this).attr('data-page'))); &#125;);&#125;; è¿™é‡Œå°±æ˜¯ä¸ºå…·ä½“é¡µç å’Œâ€œå‰ä¸€é¡µâ€â€œåä¸€é¡µâ€æ·»åŠ ç‚¹å‡»æ•ˆæœã€‚æ¯ä¸ªå…·ä½“é¡µç éƒ½æ˜¯ä¸ªå¸¦æœ‰hrefå±æ€§çš„&lt;a&gt;æ ‡ç­¾ï¼Œä»¥ç›´æ¥åˆ·æ–°é¡µé¢ï¼Œè¿™é‡Œæœ‰ä¸ªgetPageHrefæ–¹æ³•ç¨åæè¿°ã€‚è€Œç‚¹å‡»â€œå‰ä¸€é¡µâ€â€œåä¸€é¡µâ€å®åˆ™æ˜¯å»æ‰¾åˆ°ç›¸å¯¹äºå½“å‰é¡µçš„å…·ä½“é¡µç å…ƒç´ ï¼Œç„¶åè°ƒç”¨targetClickå»æ¨¡æ‹Ÿç‚¹å‡»ï¼Œä¹Ÿåœ¨ç¨åæè¿°ã€‚ é…ç½®å‚æ•°é™¤äº†å‰é¢æåˆ°çš„pnå’Œtpnä¸¤ä¸ªå‚æ•°å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ ä¸¤ä¸ªå‚æ•°ã€‚å› ä¸ºæ˜¯ç›´æ¥åˆ·æ–°é¡µé¢ä»¥è·å–æ–°çš„åˆ†é¡µæ•°æ®ï¼Œé‚£urlä¸­è‚¯å®šè¦æœ‰ä¸ªå‚æ•°è¡¨ç¤ºé¡µç ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°çš„keyå«ä»€ä¹ˆã€‚æˆ‘ä»¬æä¾›ä¸€ä¸ªé»˜è®¤çš„åå­—ï¼Œå°±å«pageï¼Œå³urléƒ½é•¿æˆè¿™æ ·/some/to/?page=2ï¼Œå½“ç„¶è¿™ä¸ªå‚æ•°çš„åå­—ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚è¿˜æœ‰å°±æ˜¯ï¼Œåˆ†é¡µåˆ·æ–°é¡µé¢é»˜è®¤å°±æ˜¯å½“å‰çš„urlï¼Œåªä¸è¿‡pageå‚æ•°çš„å€¼ä¸åŒï¼Œè¿™ä¸ªurlä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚ 123456789101112131415161718192021$.fn.jqPagination = function(options)&#123; // default option values var opts = $.extend(&#123; 'pn': this.attr('data-pn') || 1, 'tpn': this.attr('data-tpn') || 1, 'name': 'page' &#125;, options); // default value of 'pageHref' var defaultHref = window.location.pathname + '?' + opts.name + '='; if(/\?(\w+)=/.test(window.location.href))&#123; // å¦‚æœå·²ç»æœ‰å‚æ•° defaultHref = window.location.href + (eval('/' + opts.name + '=/').test(window.location.href) ? '' : '&amp;' + opts.name + '='); &#125; opts['pageHref'] = opts['pageHref'] || defaultHref; // ä»¥ä¸‹çœç•¥...&#125;; ç”±æ­¤ï¼Œå‰é¢æåˆ°çš„getPageHrefå°±æ˜¯å»æ›¿æ¢urlé‡Œçš„pageå‚æ•°çš„å€¼ã€‚ 123var getPageHref = function(pageNo)&#123; return opts.pageHref.replace(eval('/' + opts.name + '=\\d*/'), opts.name + '=' + pageNo);&#125;; å½“ç„¶é‚£ä¸ªæ¨¡æ‹Ÿç‚¹å‡»é¡µç çš„targetClickå°±æ˜¯ç›´æ¥åˆ·æ–°window.location.hrefå’¯ 12345678910var targetClick = function($li)&#123; var $link = $li.find('a.' + CLASS_PAGE); if(!$link.hasClass(CLASS_ACTIVE) &amp;&amp; !$link.hasClass(CLASS_DISABLED) &amp;&amp; !$link.hasClass(CLASS_HIDE))&#123; // æ˜¯å¦åˆ·é¡µé¢ /^\/|((http|https|svn|ftp|file):\/\/)/.test($link.prop('href')) ? (window.location.href = $link.prop('href')) : $link.click(); &#125;&#125;; æ’ä»¶ä½¿ç”¨æä¾›3ç§ä½¿ç”¨æ–¹å¼ï¼Œæœ€åŸºæœ¬çš„å°±æ˜¯ 12345&lt;div id="pagination1" data-pn="5" data-tpn="12"&gt;&lt;/div&gt;&lt;script&gt;$('#pagination1').jqPagination();&lt;/script&gt; è¦æ‰‹åŠ¨è®¾ç½®pnå’Œtpnï¼Œä»¥åŠåˆ†é¡µå‚æ•°åç§°ï¼Œå°±åƒè¿™æ · 12345$('#pagination2').jqPagination(&#123; pn: 5, tpn: 12, name: 'p'&#125;); è¦è‡ªå®šä¹‰åˆ†é¡µurlçš„å°±åƒè¿™æ · 123$('#pagination3').jqPagination(&#123; pageHref: 'http://www.baidu.com?from=fuxiaode.cn&amp;page='&#125;); å®Œæ•´Demo]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>plugins</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[QQæ¶ˆæ¯è®°å½•è½¬ç ]]></title>
    <url>%2Fblog%2F2015%2F02%2Fqq-history-message-converter.html</url>
    <content type="text"><![CDATA[å’Œå¦¹å­ä¸€èµ·æœ‰æ®µæ—¶é—´äº†ï¼ŒæœŸé—´ç»å†äº†å¥¹ç”µè„‘é‡è£…ï¼Œæˆ‘æ‰‹æœºå´©æºƒNæ¬¡ï¼Œå› æ­¤ç°åœ¨çš„æƒ…å†µæ˜¯æˆ‘ç”µè„‘ä¸Šæœ‰æˆ‘ä»¬QQä¸Šçš„æ‰€æœ‰èŠå¤©è®°å½•ï¼Œè€Œå¥¹å¾®ä¿¡ä¹Ÿæœ‰æˆ‘ä»¬æ‰€æœ‰çš„è®°å½•ã€‚é—®é¢˜æ˜¯æˆ‘çœ‹ä¸åˆ°å¥¹çš„æ‰€æœ‰å¾®ä¿¡è®°å½•ï¼Œå¥¹çœ‹ä¸åˆ°æˆ‘çš„æ‰€æœ‰QQè®°å½• &gt;_&lt; æˆ‘å…ˆæƒ³ç€QQï¼Œè¯•ç€èƒ½ä¸èƒ½æŠŠæˆ‘è¿™è¾¹çš„æ•°æ®å¯¼å‡ºæ¥åå†è®©å¥¹å¯¼å…¥ï¼Œä»¥å¤±è´¥å‘Šç»ˆã€‚æˆ‘å°±æƒ³ç€èƒ½æŠŠæˆ‘å¯¼å‡ºçš„èŠå¤©è®°å½•ï¼Œè½¬æˆç½‘é¡µçš„æ ¼å¼ï¼Œæ–¹ä¾¿å¥¹çœ‹ã€‚ QQæ¶ˆæ¯è®°å½•QQè‡ªå¸¦çš„æ¶ˆæ¯ç®¡ç†å™¨ä¸­å°±æä¾›äº†â€œå¯¼å‡ºâ€åŠŸèƒ½ã€‚ å¯¼å‡ºçš„æ–‡ä»¶æ”¯æŒä»¥ä¸‹3ç§ç±»å‹ã€‚ å…¶ä¸­åªæœ‰*.bakç±»å‹çš„æ–‡ä»¶æ‰èƒ½å¯¼å…¥ï¼Œä½†æ˜¯åªèƒ½è‡ªå·±å¯¼å…¥è‡ªå·±çš„ï¼Œæˆ‘å¯¼å‡ºçš„æ–‡ä»¶ç»™å¥¹åå¥¹æ˜¯æ— æ³•å¯¼å…¥çš„ï¼Œå› ä¸ºæ–‡ä»¶æ˜¯åŠ å¯†è¿‡çš„ï¼Œè¿˜æœ‰æ¶ˆæ¯çš„sender/receiverä¹Ÿä¸ä¸€æ ·ï¼Œä¸€ç›´æŠ¥é”™ï¼Œåªå¥½å¼ƒäº†ã€‚ è€Œ*.txtæ–‡ä»¶ç®€å•æ˜¯ç®€å•ï¼Œç¼ºå°‘è¡¨æƒ…å’Œå›¾ç‰‡ï¼Œè·Ÿçœ‹æ‰‹æœºå°è¯´ä¼¼çš„ =_= *.mhtæ–‡ä»¶æ ¼å¼ å¯ä»¥çœ‹åˆ°å®ƒå…¶å®æ˜¯åœ¨HTMLæ ¼å¼ä¸ŠåŠ äº†ä¸€äº›å…¶å®ƒä¿¡æ¯ï¼Œæ–‡ä»¶çš„å¤´éƒ¨å°±æ˜¯è¿™æ ·çš„ï¼Œä»¥åæ¯ä¸€æ¡æ¶ˆæ¯å°±æ˜¯ä¸€ä¸ª&lt;tr&gt;ã€‚æ‰€æœ‰æ¶ˆæ¯çš„æœ€åæ˜¯&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;ç»“å°¾ã€‚æ–‡ä»¶ä¸­çš„HTMLéƒ¨åˆ†åªå ä¸€å°éƒ¨åˆ†ï¼Œåœ¨&lt;/html&gt;ç»“æŸååˆè¿½åŠ äº†ä¸€å¤§ç‰‡è¡¨æƒ…å’Œå›¾ç‰‡çš„ç¼–ç ä¿¡æ¯ã€‚ å…¶ä¸­éƒ½é‡‡ç”¨äº†base64ç¼–ç ï¼Œè€ŒHTMLä¸­çš„img srcéƒ½æŒ‡å‘è¿™é‡Œçš„{xxxx}.dat äºæ˜¯æ€è·¯å°±å¾ˆæ¸…æ™°äº† å…ˆæŠŠbase64ç¼–ç çš„è¡¨æƒ…å›¾ç‰‡è§£ç å‡ºæ¥ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶ æŠŠ*.mhtæ–‡ä»¶ä¸­éHTMLçš„éƒ¨åˆ†å»æ‰ æŠŠimg srcé‡æ–°æ›¿æ¢ è§£ç å›¾ç‰‡æˆ‘ä½¿ç”¨çš„æ˜¯Javaï¼ŒæŸ¥äº†ä¸‹åªéœ€è¦importsun.misc.BASE64Decoderå³å¯ã€‚åœ¨eclipseä¸­å¯èƒ½æ— æ³•è¯†åˆ«è¿™ä¸ªåŒ…ï¼Œåªéœ€è¦åœ¨Build Pathä¸­æŠŠJRE Libraryåˆ äº†å†é‡æ–°æ·»åŠ ä¸€ä¸‹å°±OKäº†ã€‚ ç„¶åbase64çš„è§£ç å°±å¾ˆç®€å•äº† 123456789101112131415161718192021222324private boolean decodeImage(String imgStr, String imgFile)&#123; if(imgStr == null)&#123; return false; &#125; BASE64Decoder decoder = new BASE64Decoder(); try &#123; // base64è§£ç  byte[] b = decoder.decodeBuffer(imgStr); // ç”Ÿæˆå›¾ç‰‡ OutputStream out = new FileOutputStream(imgFile); out.write(b); out.flush(); out.close(); return true; &#125; catch (Exception e) &#123; e.printStackTrace(); return false; &#125;&#125; æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬å°±è¦å¯¹*.mhtæ–‡ä»¶è¿›è¡Œç¬¬ä¸€éæ‰«æï¼Œå¯¹æ¯ä¸ªå›¾ç‰‡ç¼–ç çš„åœ°æ–¹éƒ½è°ƒç”¨è¯¥decodeImage 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647private void generateImages()&#123; try &#123; BufferedReader br = new BufferedReader(new FileReader(rawFileRoot + rawFileName + "." + rawFileExt)); skipRawHead(br); String temp; while((temp = br.readLine()) != null)&#123; //è¯»åˆ°image //Content-Type:image/gif if(temp.startsWith("Content-Type:"))&#123; String fileExt = temp.split("/")[1]; //Content-Transfer-Encoding:base64 temp = br.readLine(); //Content-Location:&#123;2E66FE72-A0EE-4982-A5E1-A7FD3F564743&#125;.dat temp = br.readLine(); String fileName = temp.substring(18, temp.length() - 5); String fileNameDat = temp.substring(17); //ç©ºè¡Œ temp = br.readLine(); //è¯»imageçš„base64æ•°æ® StringBuilder builder = new StringBuilder(); while((temp = br.readLine()).length() != 0)&#123; builder.append(temp); &#125; //imageè½¬ç (.dat) decodeImage(builder.toString(), outImageRoot + fileNameDat); //imageè½¬ç (.ext) decodeImage(builder.toString(), outImageRoot + fileName + "." + fileExt); //å®Œæˆ System.out.println("Image: " + fileNameDat); &#125; &#125; br.close(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125;&#125; è¿™é‡Œæˆ‘ä»¬å°±æ˜¯å»åˆ¤æ–­é‚£äº›ç‰¹æ®Šçš„è¡Œï¼Œè¯»å‡ºå›¾ç‰‡çš„æ–‡ä»¶ç±»å‹å’Œæ–‡ä»¶åï¼Œç„¶åæŠŠbase64ç¼–ç æˆçš„å­—ç¬¦ä¸²è¯»åˆ°bufferä¸­ï¼Œæœ€åè°ƒç”¨decodeImageã€‚æ³¨æ„è¿™é‡Œè°ƒç”¨äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯ç”Ÿæˆ*.datæ–‡ä»¶ï¼Œæ–¹ä¾¿HTMLä¸­img srcæ›¿æ¢ï¼Œä¸éœ€è¦ç®¡å›¾ç‰‡æ˜¯jpgè¿˜æ˜¯gifäº†ã€‚è€Œç¬¬äºŒæ¬¡è°ƒç”¨æ˜¯ç”ŸæˆåŸå§‹çš„å›¾ç‰‡æ–‡ä»¶ï¼ŒåŒ…å«å›¾ç‰‡æ‰©å±•åï¼Œæ˜¯ä¸ºäº†æ”¶è— ^_^ ç”ŸæˆHTMLå¦‚æœä»…æ˜¯æŠŠ*.mhtæ–‡ä»¶ä¸­éHTMLçš„éƒ¨åˆ†å»æ‰ï¼Œé‚£ä¹ˆåªè¦æŠŠè¯»åˆ°çš„æœ‰æ•ˆè¡Œå†™å…¥æ–°çš„æ–‡ä»¶å³å¯ã€‚ä½†æ˜¯å¯¼å‡ºçš„*.mhtæ–‡ä»¶é€šå¸¸è¦ä¸Šç™¾å…†ï¼Œå¦‚æœèŠå¤©è®°å½•å¤šçš„è¯ï¼Œæœ€åç”Ÿæˆçš„HTMLéƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œæ‰”åˆ°æµè§ˆå™¨ä¸­è‚¯å®šä¼šå¡ã€‚å› æ­¤è‡³å°‘æŠŠèŠå¤©è®°å½•æŒ‰ç…§â€œå¹´-æœˆâ€åˆ‡åˆ†å‡ºæ¥ã€‚ åœ¨åŸå§‹æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ°èŠå¤©â€œæ—¥æœŸâ€æ˜¯åƒè¿™æ ·å­å­˜åœ¨çš„ã€‚ å› æ­¤æˆ‘ä»¬ç”¨.*æ—¥æœŸ: (\d{4}-\d{2}-\d{2})&lt;/td&gt;&lt;/tr&gt;.*è¿™æ ·ä¸€ä¸ªæ­£åˆ™å°±èƒ½è¯†åˆ«å‡ºã€‚å”¯ç‹¬åŠ å¥½å‹åçš„ç¬¬ä¸€æ¡æ¶ˆæ¯çš„æ—¥æœŸæ˜¯è·Ÿ&lt;html&gt;&lt;head&gt;åŒä¸€è¡Œçš„ã€‚ æˆ‘ä»¬æ¯æ¬¡è¯»åˆ°ä¸€ä¸ªæ–°çš„â€œå¹´-æœˆâ€æ—¶ï¼Œå°±ç»“æŸå‰ä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œå¦èµ·ä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼ŒæŠŠä¸Šé¢çš„&lt;html&gt;&lt;head&gt;ä¿¡æ¯å…ˆå†™åˆ°æ–°çš„è¾“å‡ºæ–‡ä»¶ä¸­ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172private void generateHTML()&#123; try &#123; System.out.println("Generating output html..."); BufferedReader br = new BufferedReader(new FileReader(rawFileRoot + rawFileName + "." + rawFileExt)); BufferedWriter bw = null; skipRawHead(br); String temp; //æ—¥æœŸæ­£åˆ™ Pattern pattern = Pattern.compile(".*æ—¥æœŸ: (\\d&#123;4&#125;-\\d&#123;2&#125;-\\d&#123;2&#125;)&lt;/td&gt;&lt;/tr&gt;.*"); Matcher matcher; // å½“å‰çš„yyyy-MMï¼Œå¯¹æ‰€æœ‰è®°å½•æŒ‰ç…§å¹´æœˆæ±‡æ€» String current = null; // æ¯ä¸ªhtmlæ–‡ä»¶çš„å¤´éƒ¨ï¼ˆé™¤ç¬¬ä¸€æ¬¡è¯»åˆ°çš„æ—¥æœŸï¼‰ String htmlHead = null; while((temp = br.readLine()) != null)&#123; if(htmlHead == null)&#123; htmlHead = temp.replaceFirst("&lt;tr&gt;.*&gt;æ—¥æœŸ: (\\d&#123;4&#125;-\\d&#123;2&#125;-\\d&#123;2&#125;)&lt;/td&gt;&lt;/tr&gt;.*", ""); &#125; //åˆ¤æ–­æ—¥æœŸ matcher = pattern.matcher(temp); if(matcher.matches())&#123; String date = matcher.group(1); date = date.substring(0, date.lastIndexOf("-")); if(!date.equals(current))&#123; current = date; System.out.println(current); if(bw != null)&#123; bw.write("&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;"); bw.flush(); bw.close(); &#125; //å¦èµ·ä¸€æ–‡ä»¶ï¼ˆæŒ‰å¹´æœˆï¼‰ bw = new BufferedWriter(new FileWriter(outHTMLRoot + rawFileName + "-" + current + "." + outFileExt)); bw.write(htmlHead); bw.newLine(); bw.flush(); &#125; &#125; //æ›¿æ¢æºæ–‡ä»¶ä¸­çš„img srcï¼ˆåŠ ä¸ªç›®å½•ï¼‰ temp = temp.replaceAll("&lt;IMG src=\"", "&lt;IMG src=\"src/"); bw.write(temp); bw.newLine(); bw.flush(); //æ ‡å‡†htmlç»“æŸ if(temp.endsWith("&lt;/html&gt;"))&#123; break; &#125; &#125; br.close(); bw.close(); System.out.println("Done."); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125;&#125; æ³¨æ„è¿™é‡Œæœ‰ä¸ªskipRawHead(br)æ˜¯ä¸ºäº†è·³è¿‡*.mhtå¤´éƒ¨çš„å‡ è¡Œï¼Œç›´æ¥ä»&lt;html&gt;å¼€å§‹è¯»ï¼Œä¸€è¡Œä¸€è¡Œè¯»ï¼Œä¸€è¡Œå°±æ˜¯ä¸€æ¡æ¶ˆæ¯ã€‚ æœ€åç”Ÿæˆåçš„ç»“æœï¼Œsrcæ–‡ä»¶å¤¹ä¸­å°±å­˜æ”¾ç€æ‰€æœ‰è§£ç å‡ºæ¥çš„è¡¨æƒ…å›¾ç‰‡ä»¥åŠå›¾ç‰‡çš„*.datæ–‡ä»¶ã€‚ åç»­æŠŠèŠå¤©è®°å½•æ‰“åŒ…å‘ç»™äº†å¦¹å­ï¼Œæˆ‘èƒ½æƒ³åˆ°æœ€æµªæ¼«çš„äº‹ï¼Œå°±æ˜¯åœ¨é‚£ä¸€å¤©çš„æ—¶å€™å’Œä½ ä¸€èµ·èº²åœ¨æˆ¿é—´é‡Œçœ‹èŠå¤©è®°å½•ï¼Œå›æƒ³å½“åˆå¦‚ä½•ç›¸è¯†ç›¸çŸ¥ï¼Œå’Œä¸€è·¯èµ°æ¥çš„ç‚¹ç‚¹æ»´æ»´ã€‚ è®°å½•/è®°å¿†æœ‰å–œå½“ç„¶ä¹Ÿæœ‰æ‚²ï¼Œç”Ÿæ´»å°±æ˜¯è¿™æ ·ï¼Œçœ‹ä½ è§‰å¾—å“ªä¸ªæ›´é‡è¦ã€‚ çŒ®ä¸Šæºä»£ç ]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>å°ç©æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(7)]]></title>
    <url>%2Fblog%2F2015%2F02%2Fstep-by-step-js-component-schoolbox-7.html</url>
    <content type="text"><![CDATA[æœ¬æ¥è¿™ä¸ªç³»åˆ—ä¸»é¢˜å·²ç»ç»“æŸäº†ï¼Œçªç„¶æƒ³åˆ°è¿˜æœ‰ä¸ªåŠŸèƒ½è¦åšï¼Œå°±æ˜¯â€œæ¨¡æ€â€ï¼Œå³æŠŠå­¦æ ¡é€‰æ‹©å™¨åšæˆä¸€ä¸ªç±»ä¼¼æ¨¡æ€çš„å¯¹è¯æ¡†ã€‚è¿™æ ·å°±å¯ä»¥åº”ä»˜è¿™æ ·çš„ä½¿ç”¨åœºæ™¯ï¼šåœ¨ä¸€ä¸ªå­¦ç”Ÿåˆ—è¡¨çš„é¡µé¢ä¸­ï¼Œå¯ä»¥ä¿®æ”¹ä»»æ„å­¦ç”Ÿçš„æ‰€åœ¨å­¦æ ¡ï¼Œä¹Ÿå¯ä»¥æ·»åŠ å…¶ä»–å­¦æ ¡çš„å­¦ç”Ÿã€‚ æ¨¡æ€å¯¹è¯æ¡†ç»å¸¸çœ‹åˆ°â€œæ¨¡æ€â€è¿™ä¸ªè¯ï¼Œç‰¹åœ°ç™¾åº¦äº†ä¸€ä¸‹å®ƒçš„å®šä¹‰ï¼š æ¨¡æ€å¯¹è¯æ¡†ï¼ˆModal Dialogue Boxï¼Œåˆå«åšæ¨¡å¼å¯¹è¯æ¡†ï¼‰ï¼Œæ˜¯æŒ‡åœ¨ç”¨æˆ·æƒ³è¦å¯¹å¯¹è¯æ¡†ä»¥å¤–çš„åº”ç”¨ç¨‹åºè¿›è¡Œæ“ä½œæ—¶ï¼Œå¿…é¡»é¦–å…ˆå¯¹è¯¥å¯¹è¯æ¡†è¿›è¡Œå“åº”ã€‚å¦‚å•å‡»ã€ç¡®å®šã€‘æˆ–ã€å–æ¶ˆã€‘æŒ‰é’®ç­‰å°†è¯¥å¯¹è¯æ¡†å…³é—­ã€‚ å†çœ‹çœ‹Bootstrap v2æä¾›çš„æ¨¡æ€å¯¹è¯æ¡† å¯ä»¥çœ‹åˆ°å…¶å®æ²¡ä»€ä¹ˆï¼Œå°±æ˜¯é¡µé¢èƒŒæ™¯åŠ ä¸€å—é®ç½©ï¼ˆmaskï¼‰ï¼Œç„¶åæ·»åŠ ä¸€ä¸ªå¯¹è¯æ¡†çš„å…³é—­æŒ‰é’®ï¼Œå‘Šè¯‰ç”¨æˆ·ä¸€å®šè¦å…ˆå¯¹è¯¥å¯¹è¯æ¡†è¿›è¡Œæ“ä½œã€‚ æ·»åŠ æ¨¡æ€é¦–å…ˆä»SchoolBoxçš„å¯¹å¤–æ¥å£å‡ºå‘ï¼ŒåŸæ¥æˆ‘ä»¬æ„é€ SchoolBoxå¯¹è±¡æ—¶ä¼šä¼ å…¥ä¸€ä¸ªappendToå‚æ•°ï¼Œæ„æ€æ˜¯æŠŠè¿™ä¸ªå¯¹è±¡è¿½åˆ°åˆ°å“ªä¸ªå…ƒç´ ä¸­å»ã€‚ç°åœ¨æˆ‘ä»¬ä¸ç”¨ä¼ appendToäº†ï¼Œå°±å¯ä»¥è¡¨ç¤ºè¿™æ˜¯ä¸ªæ¨¡æ€æ¡†ï¼Œä¸éœ€è¦è¿½åŠ åˆ°å“ªä¸ªå…·ä½“å…ƒç´ ã€‚ 1.æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨SchoolBoxå¯¹å¤–çš„showå’Œhideæ–¹æ³•åšç›¸åº”çš„æ”¹å˜ã€‚ 1234567891011121314151617181920show: function()&#123; if(this.opts.popup)&#123; $('body').append('&lt;div class="school-box-mask"&gt;&lt;/div&gt;'); $(this.opts.appendTo).find('.school-box-wrapper') .removeClass('school-box-hide').addClass('school-box-popup'); &#125; else&#123; $(this.opts.appendTo).find('.school-box-wrapper').slideDown(); &#125;&#125;,hide: function()&#123; if(this.opts.popup)&#123; $('.school-box-mask').remove(); $(this.opts.appendTo).find('.school-box-wrapper') .removeClass('school-box-popup').addClass('school-box-hide'); &#125; else&#123; $(this.opts.appendTo).find('.school-box-wrapper').slideUp(); &#125;&#125; è¿™é‡Œæ³¨æ„ï¼Œå½“ç”¨æˆ·ä¸ä¼ å…¥appendToæ—¶ï¼Œæ„é€ å‡½æ•°ä¸­ä¼šç»™å®ƒä¸ªé»˜è®¤å€¼å°±æ˜¯bodyï¼Œå³ä¸Šé¢ä»£ç ä¸­çš„$(this.opts.appendTo)å°±æ˜¯$(&#39;body&#39;)ã€‚ 2.åœ¨åˆå§‹åŒ–æ—¶æ·»åŠ æ¨¡æ€æ¡†çš„çª—å£æ å’Œå…³é—­æŒ‰é’®ã€‚ 12345678910111213141516171819202122var $popupCloseCopy = $('&lt;div class="school-box-popup-close"&gt;&lt;a href="javascript:void(0)" title="å…³é—­"&gt;X&lt;/a&gt;&lt;/div&gt;');var init = function(instance)&#123; // ç”Ÿæˆå…ƒç´  var $parent = $(instance.opts.appendTo); var $el = $('&lt;div class="school-box-wrapper"&gt;&lt;/div&gt;'); $el.append($schoolBoxCopy.clone()); $parent.append($el); // popupå…³é—­ if(instance.opts.popup)&#123; var $popup = $popupCloseCopy.clone(); $el.prepend($popup); $popup.find('a').click(function()&#123; instance.hide(); &#125;); &#125; // ä»¥ä¸‹çœç•¥...&#125;; 3.ä¸ºæ¨¡æ€æ¡†å’Œé®ç½©æ·»åŠ ç›¸åº”çš„æ ·å¼ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738.school-box-mask&#123; background-color: #666; height: 100%; left: 0; opacity: 0.3; position: absolute; top: 0; width: 100%; z-index: 99;&#125;.school-box-popup&#123; margin-left: -25%; left: 50%; position: fixed; top: 120px; z-index: 100;&#125;.school-box-popup-close&#123; background-color: #444; height: 24px; opacity: 0.8; padding: 2px 6px;&#125;.school-box-popup-close a&#123; float: right; font-family: Arial; font-size: 20px; font-weight: bold; line-height: 24px; color: #ddd; text-decoration: none;&#125;.school-box-popup-close a:hover&#123; color: #fff;&#125;.school-box-hide&#123; display: none;&#125; 4.ã€patchã€‘åœ¨çœŸæ­£çš„æ„é€ å‡½æ•°ä¸­æ·»åŠ appendToçš„é»˜è®¤å€¼ï¼Œå¹¶æ·»åŠ this.opts.popupã€‚åœ¨prototypeçš„initä¸­å¦‚æœæ˜¯popupï¼Œå…ˆéšè—school-box-wrapperï¼Œå› ä¸ºå®ƒç›´æ¥appendåˆ°bodyæœ€åã€‚ å¯¹è±¡å…±äº«åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å®ç°äº†æ¨¡æ€çš„SchoolBoxï¼Œä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå› ä¸ºSchoolBoxçš„æ„é€ å¼€é”€ä¸å°ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›åœ¨é¡µé¢ä¸­æ¯ä¸ªæœ‰â€œå­¦æ ¡â€çš„åœ°æ–¹éƒ½ä¸ºä¹‹åˆ›å»ºä¸€ä¸ªSchoolBoxå¯¹è±¡ï¼Œæˆ‘ä»¬å¸Œæœ›åŒä¸€ä¸ªé¡µé¢ä¸­èƒ½å…±ç”¨åŒä¸€ä¸ªSchoolBoxå¯¹è±¡ã€‚ å› ä¸ºæˆ‘ä»¬ä¹‹å‰å·²ç»ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œé¡µé¢ä¸­çš„å…ƒç´ å»ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ï¼Œç„¶è€Œâ€œå­¦æ ¡é€‰å®šâ€è¿™ä»¶äº‹åªè§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚å› æ­¤å¦‚æœé¡µé¢ä¸­æœ‰å¤šä¸ªå…ƒç´ éƒ½ç›‘å¬ç€schoolChosenäº‹ä»¶ï¼Œé‚£ä¹ˆå½“ç”±ä¸€ä¸ªå…ƒç´ æ‰“å¼€çš„å­¦æ ¡é€‰æ‹©å™¨æ“ä½œå®Œæˆåï¼Œæ‰€æœ‰ç›‘å¬ç€è¯¥äº‹ä»¶çš„å…¶ä»–å…ƒç´ éƒ½ä¼šåšå‡ºç›¸åº”çš„æ”¹å˜ã€‚å³åœ¨ä¸€ä¸ªå­¦ç”Ÿåˆ—è¡¨çš„é¡µé¢ä¸­ï¼Œæˆ‘æ”¹å˜ä¸€ä¸ªå­¦ç”Ÿçš„å­¦æ ¡ï¼Œå…¶ä»–å­¦ç”Ÿçš„å­¦æ ¡ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚ å› æ­¤è¦å®ç°å…±ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å¾—åœ¨æ¯æ¬¡ä½¿ç”¨å®ƒæ—¶ï¼Œæ¸…ç©ºå®ƒçš„ç›‘å¬è€…åˆ—è¡¨ï¼Œå¹¶é‡æ–°èµ‹äºˆå®ƒè¯¥æ¬¡ä½¿ç”¨æ—¶å”¯ä¸€çš„å›è°ƒå‡½æ•°ã€‚è¿™æ ·å°±å¯ä»¥å®ç°æ“ä½œä¸€ä¸ªå­¦ç”Ÿçš„å­¦æ ¡ï¼Œåªå“åº”ä¸€ä¸ªå…ƒç´ ã€‚ 1234SchoolBox.prototype.unbind = function(type)&#123; this.handlers[type] = []; return this;&#125;; å®Œæ•´åº”ç”¨å¤šä¸ªéœ€è¦ä½¿ç”¨å­¦æ ¡çš„å…ƒç´  1234567891011121314151617&lt;div id="formResult"&gt; &lt;div&gt; &lt;input type="text" class="school-input" readonly/&gt; &lt;input type="text" class="school-id" readonly&gt; &lt;a href="javascript:void(0)" class="choose-school"&gt;é€‰æ‹©å­¦æ ¡&lt;/a&gt; &lt;/div&gt; &lt;div&gt; &lt;input type="text" class="school-input" readonly/&gt; &lt;input type="text" class="school-id" readonly&gt; &lt;a href="javascript:void(0)" class="choose-school"&gt;é€‰æ‹©å­¦æ ¡&lt;/a&gt; &lt;/div&gt; &lt;div&gt; &lt;input type="text" class="school-input" readonly/&gt; &lt;input type="text" class="school-id" readonly&gt; &lt;a href="javascript:void(0)" class="choose-school"&gt;é€‰æ‹©å­¦æ ¡&lt;/a&gt; &lt;/div&gt;&lt;/div&gt; å…±ç”¨ä¸€ä¸ªSchoolBoxå¯¹è±¡ï¼Œä¸ºé¡µé¢å…ƒç´ ç»‘å®šäº‹ä»¶ã€‚ 123456789101112$('.choose-school').click(function()&#123; var $schoolInput = $(this).siblings('.school-input'); var $schoolId = $(this).siblings('.school-id'); // ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ schoolBox.unbind('schoolChosen').on('schoolChosen', function(data)&#123; $schoolInput.val(data.schoolName); $schoolId.val(data.schoolId); &#125;); schoolBox.show();&#125;); å­¦æ ¡é€‰æ‹©å™¨v8 Demo]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(ç³»åˆ—)]]></title>
    <url>%2Fblog%2F2015%2F02%2Fstep-by-step-js-component-schoolbox-collections.html</url>
    <content type="text"><![CDATA[å‰ä¸€æ®µæ—¶é—´æ•´ç†å®Œäº†SchoolBoxè¿™ä¸ªç³»åˆ—çš„ä»£ç å’Œæ–‡ç« ï¼Œè¿™é‡Œå†åšä¸ªåˆé›†ï¼Œæ–¹ä¾¿å¤§å®¶æ‰¾åˆ°ç›¸åº”çš„ç¯‡ç›®ã€‚æˆ‘æ€»å…±æ•´ç†äº†10ä¸ªç‰ˆæœ¬ï¼ˆåæ¥è¡¥å……äº†3ä¸ªç‰ˆæœ¬ï¼‰çš„ä»£ç å’Œ8ç¯‡ï¼ˆåæ¥æ–°å¢äº†2ç¯‡ï¼‰æ–‡ç« ï¼Œåˆ†åˆ«å¦‚ä¸‹ã€‚ ç‰ˆæœ¬1åªæ˜¯ç®€å•çš„ç•Œé¢è®¾è®¡ï¼Œé™æ€æ’ç‰ˆï¼Œæ²¡æœ‰jséƒ¨åˆ†ã€‚ Demoï¼šdemo v1 æ–‡ç« ï¼šç©¿æ’åœ¨ç¬¬ä¸€ç¯‡ä¸­ ç‰ˆæœ¬2åŠ å…¥äº†jséƒ¨åˆ†ï¼Œå®ç°äº†çœå’Œå­¦æ ¡çš„çº§è”ã€‚ Demoï¼šdemo v2 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(1) ç‰ˆæœ¬3æŠŠç‰ˆæœ¬2çš„jsä»£ç å†™æˆç»„ä»¶çš„ç»“æ„ã€‚ Demoï¼šdemo v3 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(2) ç‰ˆæœ¬4æ·»åŠ è‡ªå®šä¹‰äº‹ä»¶ï¼Œå³ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚ Demoï¼šdemo v4 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(3) ç‰ˆæœ¬5åŠ å…¥å­¦æ ¡æœç´¢æ¡†çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„æ˜¯æœ¬åœ°æ•°æ®ï¼Œä¹Ÿå¯ä»¥Ajaxè¯·æ±‚ã€‚ Demoï¼šdemo v5 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(4) ç‰ˆæœ¬6ä¸ºæœç´¢ç»“æœæ·»åŠ æŒ‰é”®æ•ˆæœï¼Œå³é€šè¿‡â€œä¸Šâ€â€œä¸‹â€é”®é€‰ä¸­ï¼Œâ€œå›è½¦â€é”®ç¡®å®šã€‚ Demoï¼šdemo v6 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(5) ç‰ˆæœ¬7é™„åŠ åŠŸèƒ½ï¼Œæ·»åŠ è‡ªå®šä¹‰å­¦æ ¡ã€‚ Demoï¼šdemo v7 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(6) ç‰ˆæœ¬8ï¼ˆåå¢ï¼‰å®ç°å­¦æ ¡é€‰æ‹©å™¨çš„æ¨¡æ€å¯¹è¯æ¡†ï¼Œå¹¶åœ¨é¡µé¢ä¸­å…±ç”¨åŒä¸€ä¸ªé€‰æ‹©å™¨å¯¹è±¡ã€‚ Demoï¼šdemo v8 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(7) ç‰ˆæœ¬9 &amp; 10ï¼ˆè¡¥å……ï¼‰é¡µé¢ä¸Šå¤šä¸ªå…ƒç´ å…±äº«åŒä¸€ä¸ªæ¨¡æ€å¯¹è¯æ¡†ï¼Œåœ¨è§¦å‘äº‹ä»¶æ—¶åŠ å…¥â€œç”±å“ªä¸ªç›‘å¬å…ƒç´ è§¦å‘â€ï¼Œä»¥é¿å…å¯¹æ‰€æœ‰ç›‘å¬å…ƒç´ éƒ½åšå‡ºå“åº”ã€‚ ç›‘å¬æ—¶åˆ¤æ–­ï¼ŒDemoï¼šdemo v9 å›è°ƒæ—¶åˆ¤æ–­ï¼ŒDemoï¼šdemo v10 æ–‡ç« ï¼šä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(8) æœ€åè°¢è°¢å¤§å®¶~~]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”¨RequireJSåŒ…è£…AjaxChart]]></title>
    <url>%2Fblog%2F2015%2F02%2Fwrap-ajaxchart-with-requirejs.html</url>
    <content type="text"><![CDATA[å‰é¢æˆ‘å†™åˆ°AjaxChartï¼Œå†™åˆ°SchoolBoxï¼Œæˆ‘éƒ½åœ¨ç”¨javascriptæ¨¡æ‹Ÿâ€œç±»â€ï¼Œæä¾›ä¸€äº›æ¥å£è®©å¯¹è±¡ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ã€‚javascriptä¸­çš„prototypeå’Œé—­åŒ…ã€å›è°ƒç­‰ç­‰æœºåˆ¶ï¼Œå¯ä»¥å®Œå…¨ç”¨æ¥å®ç°â€œç±»â€çš„å°è£…ã€‚ç„¶è€Œéšç€â€œç±»â€è§„æ¨¡çš„ä¸æ–­åºå¤§ï¼Œç±»ä¸­éœ€è¦çš„ä¾èµ–è¶Šæ¥è¶Šå¤æ‚ï¼Œå¦‚ä½•æœ‰æ•ˆçš„ç®¡ç†ä¾èµ–å…³ç³»ä¹Ÿå°±æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚è€ŒRequireJSå°±æ˜¯ç”¨æ¥æ¨¡æ‹Ÿâ€œpackageâ€çš„ï¼Œä»¥ç®¡ç†â€œåŒ…â€ä¸­çš„ä¾èµ–ã€‚ é—®é¢˜ç”±æ¥åœ¨ä¸Šä¸€ç¯‡å†™AjaxChartï¼Œå®ƒåªæ˜¯åœ¨Highchartsåšäº†å±‚åŒ…è£…ï¼Œæ‰€ä»¥ä¾èµ–äºHighchartsï¼Œè€ŒHighchartsåˆä¾èµ–äºjQueryï¼Œå› æ­¤htmlå¼•å…¥çš„&lt;script&gt;ä¼šåƒè¿™æ ·ã€‚ 123456&lt;script type="text/javascript" src="http://cdn.staticfile.org/jquery/1.7.2/jquery.min.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="http://cdn.staticfile.org/highcharts/4.0.4/highcharts.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="AjaxChart.js"&gt;&lt;/script&gt;&lt;script type="text/javascript"&gt; // mainç¨‹åº&lt;/script&gt; jsçš„å¼•å…¥é¡ºåºä¸€å®šè¦æŒ‰ç…§è¿™ä¸ªé¡ºåºï¼Œæœ€åæ‰æ˜¯mainç¨‹åºã€‚å½“ç¨‹åºè¶Šæ¥è¶Šå¤æ‚æ—¶ï¼Œå®ƒå°±éœ€è¦æ›´å¤šçš„ä¾èµ–ï¼Œè€Œä¾èµ–çš„å¯¹è±¡æœ¬èº«ä¹‹é—´å¯èƒ½åˆå­˜åœ¨ç€ä¾èµ–ï¼Œè¿™æ ·åˆ°ä¸€å®šç¨‹åº¦åä¾èµ–å…³ç³»å°±ä¼šå˜å¾—å¾ˆå¤´ç–¼ã€‚ RequireJSRequireJSæ˜¯ç»§jQueryä»¥æ¥å‰ç«¯ç•Œå‘ç”Ÿçš„æœ€å¤§æˆå°±ä¹‹ä¸€ï¼Œç”¨äºå®¢æˆ·ç«¯çš„æ¨¡å—ç®¡ç†ï¼Œå®ƒæ˜¯ç¬¦åˆAMDè§„èŒƒï¼ˆAsynchronous Module Definitionï¼‰çš„ã€‚è€Œå…³äºä¸ºä½•è¦é‡‡ç”¨AMDè§„èŒƒæ¥å†™ä»£ç ï¼Œå¯ä»¥çœ‹è¿™ç¯‡Writing Modular JavaScript With AMD, CommonJS &amp; ES Harmonyã€‚RequireJSçš„åŸºæœ¬æ€æƒ³å°±æ˜¯ï¼Œé€šè¿‡defineæ–¹æ³•ï¼Œå°†ä»£ç å®šä¹‰ä¸ºæ¨¡å—ï¼Œè€Œé€šè¿‡requireæ–¹æ³•ï¼Œå®ç°ä»£ç çš„æ¨¡å—åŠ è½½ã€‚ è°ƒæ•´ä»£ç ç»“æ„1. requirejsé…ç½®ç”±äºè¦ä¾èµ–jQueryå’ŒHighchartsï¼Œæˆ‘ä»¬å…ˆé…ç½®å¥½ã€‚ 12345678910111213requirejs.config(&#123; baseUrl: 'js/lib', paths: &#123; jquery: 'http://cdn.staticfile.org/jquery/1.7.2/jquery.min', highcharts: 'http://cdn.staticfile.org/highcharts/4.0.4/highcharts' &#125;, shim: &#123; highcharts: &#123; deps: ['jquery'], exports: 'Highcharts' &#125; &#125;&#125;); è¿™é‡Œjqueryå’Œhighchartså‡é‡‡ç”¨çš„æ˜¯CDNä¸Šçš„ï¼Œç”±äºhighchartsä¸æ˜¯ç”¨defineå†™çš„ï¼Œæ‰€ä»¥è¦åŠ ä¸€æ¡shimæ¥åšè½¬åŒ–ã€‚ 2. å®šä¹‰AjaxChartæ¨¡å—12345define(['jquery', 'highcharts'], function($, Highcharts)&#123; // ä»¥ä¸Šçœç•¥... return AjaxChart;&#125;); AjaxChartä¾èµ–äºjqueryå’Œhighchartsï¼Œæœ€åè¿”å›AjaxChartå¯¹è±¡ã€‚æ³¨æ„è¿™é‡Œçš„æ–‡ä»¶åä¹Ÿè¦æ˜¯AjaxChart.jsã€‚ 3. æ‰§è¡Œmainç¨‹åº123requirejs(['jquery', 'highcharts', 'AjaxChart'], function($, Highcharts, AjaxChart)&#123; // çœç•¥...&#125;); æŠŠè¿™æ®µç¨‹åºæ”¾åœ¨main.jsä¸­ï¼Œæœ€ååœ¨é¡µé¢ä¸­å¼•å…¥&lt;script type=&quot;text/javascript&quot; src=&quot;js/require.js&quot; data-main=&quot;js/app/main.js&quot;&gt;&lt;/script&gt;å³å¯ã€‚ é™„ä¸Šç›®å½•ç»“æ„ 1234567- demo.html- js/ - require.js - lib/ - AjaxChart.js - app/ - main.js æœ€ådemo AjaxChart with RequireJS Demo]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>AMD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºHighchartsåšåŒ…è£…]]></title>
    <url>%2Fblog%2F2015%2F02%2Fajax-chart-for-highcharts.html</url>
    <content type="text"><![CDATA[Highchartsæ˜¯ä¸€ä¸ªç”¨çº¯JavaScriptç¼–å†™çš„ä¸€ä¸ªå›¾è¡¨åº“ï¼Œèƒ½å¤Ÿå¾ˆç®€å•ä¾¿æ·çš„åœ¨webç½‘ç«™æˆ–æ˜¯webåº”ç”¨ç¨‹åºæ·»åŠ æœ‰äº¤äº’æ€§çš„å›¾è¡¨ï¼Œå¹¶ä¸”å…è´¹æä¾›ç»™ä¸ªäººå­¦ä¹ ã€ä¸ªäººç½‘ç«™å’Œéå•†ä¸šç”¨é€”ä½¿ç”¨ï¼ˆæ‘˜è‡ªç™¾åº¦ç™¾ç§‘ï¼‰ã€‚å¦å¤–HighChartsè¿˜æœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œèƒ½å¤Ÿå®Œç¾æ”¯æŒå½“å‰å¤§å¤šæ•°æµè§ˆå™¨ï¼Œç°åœ¨å®˜æ–¹çš„æœ€æ–°ç‰ˆæœ¬ä¸ºHighcharts-4.0.4ã€‚ é—®é¢˜æ¥æºæˆ‘åœ¨å¾ˆæ—©ä¸€ç¯‡ä½¿ç”¨PhantomJså¯¹ç½‘é¡µæˆªå›¾ä¸­å°±æåˆ°äº†Highchartsï¼Œé‚£æ—¶ç”¨å®ƒåœ¨ç½‘é¡µä¸Šç»˜åˆ¶å›¾è¡¨ï¼Œç„¶åç”¨Phantomjså»æˆªå›¾ï¼Œå› ä¸ºæˆ‘æƒ³è®©æœåŠ¡ç«¯åªè´Ÿè´£ç”Ÿæˆæ•°æ®ï¼Œè€Œè®©å®¢æˆ·ç«¯å»ç”Ÿæˆå›¾è¡¨åŠå›¾ç‰‡ã€‚åœ¨é‚£ä¸ªé¡¹ç›®ä¸­ï¼Œæ‰€æœ‰çš„å›¾è¡¨éƒ½æ˜¯é€šè¿‡Ajaxå–æ¥æ•°æ®åï¼Œå†è°ƒç”¨Highchartsç”Ÿæˆå›¾è¡¨çš„ã€‚è€Œå¸¸ç”¨çš„å›¾è¡¨ç±»å‹ä¹Ÿæ— éé‚£å‡ ç§ï¼Œæ¯æ¬¡éƒ½è¦å…ˆAjaxè¯·æ±‚ï¼Œç„¶åæ„é€ highchartsçš„ä¸€å †é…ç½®å‚æ•°ã€‚ 1234567891011121314151617$.post( 'someAjaxUrl', &#123; param1: 'value1' &#125;, function(data)&#123; $('#container').highcharts(&#123; chart: &#123; type: 'line' &#125;, title: null, xAxis: &#123; ... &#125;, yAxis: &#123; ... &#125;, tooltip: &#123; ... &#125;, legend: &#123; ... &#125;, series: data &#125;); &#125;); å› ä¸ºæœåŠ¡ç«¯åªè¿”å›seriesé‡Œè¦æ±‚çš„æ•°æ®æ ¼å¼ï¼Œå°½é‡ä¸highchartsçš„é…ç½®é™ä½è€¦åˆï¼Œæ‰€ä»¥å‰å°æ¯æ¬¡æƒ³è¦ç”Ÿæˆä¸€ä¸ªå›¾è¡¨éƒ½è¦å†™ä¸€æ®µä¸Šé¢ç±»ä¼¼çš„ä»£ç ã€‚å› æ­¤æˆ‘è§‰å¾—æœ‰å¿…è¦å¯¹highchartsåšç®€å•çš„åŒ…è£…ï¼Œè®©å®ƒæ›´åŠ ç®€å•çš„é…åˆAjaxå’Œchart typeã€‚ æ¥å£è®¾è®¡æˆ‘ä»¬å¸Œæœ›å¯ä»¥è¿™æ ·ä½¿ç”¨chart 12345678910111213var chart1 = new AjaxChart(&#123; container: '#chartDemo1', chartType: 'line'ï¼Œ ajaxUrl: 'someAjaxUrl', ajaxParams: &#123; param1: 'value1', param2: function()&#123; return 'value2'; &#125; &#125;&#125;);chart1.refresh(); ä¼ å…¥å›¾è¡¨çš„containerå…ƒç´ å’Œchart typeï¼Œä¼ å…¥ajax urlå’Œparamsï¼Œä¸”è¿™é‡Œçš„paramsæ—¢å¯ä»¥æ˜¯ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ªfunctionã€‚æœ€åé€šè¿‡refresh()æ¥å£ç”Ÿæˆå›¾è¡¨ã€‚è¿™æ ·å¯ä»¥æŠŠchart1.refresh()æ”¾åˆ°æŸä¸ªæŒ‰é’®çš„clickæˆ–changeäº‹ä»¶é‡Œï¼Œä»¥å®ç°æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©åŠ¨æ€åˆ·æ–°å›¾è¡¨ã€‚ å…¨å±€é…ç½®é’ˆå¯¹å‡ ç§å¸¸ç”¨çš„å›¾è¡¨ç±»å‹ï¼ŒæŠ˜çº¿å›¾ã€é¥¼å›¾ã€æŸ±çŠ¶å›¾ã€åŒºåŸŸå›¾ï¼Œæˆ‘ä»¬åˆ†åˆ«ä¸ºæ­¤å®šä¹‰é»˜è®¤çš„Highchartsé…ç½®å±æ€§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485var CHART_OPTIONS = &#123; // å…¨å±€Highchartsé…ç½® global: &#123; title: null, xAxis: &#123; // NOTE: è¿™é‡Œå‡è®¾æ¯ä¸ªseriesçš„æ•°æ®é¡¹éƒ½ä¸€æ ·ï¼Œå› æ­¤å–ç¬¬ä¸€ä¸ªseriesæ¥ä½œä¸ºåˆ†ç±»å³å¯ã€‚ categories: function()&#123; var categories = []; // ç”¨dataæ•°ç»„ç”Ÿæˆcategories if(series[0].data[0] instanceof Array)&#123; $.each(series[0].data, function(k, v)&#123; categories.push(v[0]); &#125;); &#125; return categories; &#125; &#125;, tooltip: &#123; pointFormat: '&lt;span style="color:&#123;series.color&#125;"&gt;&#123;series.name&#125;&lt;/span&gt;: &#123;point.y&#125;' &#125;, legend: &#123; enabled: false &#125;, yAxis: &#123; title: &#123; enabled: false &#125; &#125; &#125;, // æŠ˜çº¿å›¾é…ç½®é¡¹ line: &#123; chart: &#123; type: 'line' &#125;, plotOptions: &#123; line: &#123; dataLabels: &#123; enabled: true &#125; &#125; &#125; &#125;, // é¥¼å›¾é…ç½®é¡¹ pie: &#123; chart: &#123; type:'pie' &#125;, tooltip: &#123; pointFormat: '&lt;span style="color:&#123;series.color&#125;"&gt;&#123;series.name&#125;&lt;/span&gt;: &#123;point.percentage:, .1f&#125;%' &#125; &#125;, // æŸ±å½¢å›¾é…ç½®é¡¹ column: &#123; chart: &#123; type:'column' &#125;, plotOptions: &#123; column: &#123; dataLabels: &#123; enabled: true &#125; &#125;, series: &#123; groupPadding: 0, pointPadding: 0 &#125; &#125; &#125;, // åŒºåŸŸå›¾ area: &#123; chart: &#123; type:'area' &#125;, plotOptions: &#123; area: &#123; marker: &#123; enabled: false, symbol: 'circle', radius: 2, states: &#123; hover: &#123; enabled: true &#125; &#125; &#125; &#125; &#125; &#125;&#125;; AjaxChartæ„é€ æ ¹æ®ä¸Šé¢çš„æ¥å£è®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç æ¡†æ¶ã€‚ 123456789101112var AjaxChart = function(config)&#123; this._container = config.container; this._chartType = config.chartType; this._url = config.ajaxUrl; this._params = config.ajaxParams;&#125;;AjaxChart.prototype = &#123; refresh: function()&#123; &#125;&#125;; refreshè´Ÿè´£è·å–ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶è¯·æ±‚Ajaxï¼Œè¿”å›æ—¶å†æ„é€ å‡ºHighchartså¯¹è±¡ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦å†™ä¸¤ä¸ªå¸®åŠ©æ–¹æ³•ã€‚ 1.è·å–ç”¨æˆ·å‚æ•° æ—¢ç„¶æˆ‘ä»¬å‰é¢è¯´â€œparamsæ—¢å¯ä»¥æ˜¯ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ªfunctionâ€ï¼Œå› æ­¤è¦å†™ä¸€ä¸ªè½¬åŒ–çš„è¿‡ç¨‹ï¼Œå¦‚æœæ˜¯functionï¼Œåˆ™å¯¹functionæ±‚å€¼ã€‚ 1234567AjaxChart.prototype._getAjaxParams = function()&#123; var result = &#123;&#125;; for(key in this._params)&#123; result[key] = (typeof this._params[key] == 'function') ? (this._params[key])() : this._params[key]; &#125; return result;&#125;; 2.æ„é€ å›¾è¡¨ è¿™é‡Œæ ¹æ®å‰é¢çš„å…¨å±€é…ç½®æ¥æ„é€ Highchartså¯¹è±¡ï¼Œå‚æ•°resultæ˜¯æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ï¼ˆå³Highchartsé…ç½®é‡Œçš„seriesï¼‰ã€‚ 1234567891011121314151617181920212223242526272829303132AjaxChart.prototype._updateChart = function(result)&#123; if('series' in result == false)&#123; return false; &#125; // é€‰æ‹©å›¾ç±»å‹ var chartOptions = $.extend(&#123;&#125;, CHART_OPTIONS['global'], CHART_OPTIONS[this._chartType]); // é€‰æ‹©å®¹å™¨ï¼ˆè¿™é‡Œè¦åŸç”ŸDOMå¯¹è±¡ï¼‰ chartOptions.chart.renderTo = $(this._container)[0]; // è½½å…¥æ•°æ®é¡¹ chartOptions.series = result['series']; // å¦‚æœæ˜¯å¤šä¸ªseriesçš„ï¼Œæ˜¾ç¤ºlegendï¼ˆå›¾ç¤ºï¼‰ chartOptions.legend.enabled = chartOptions.series.length &gt; 1 ? true : false; // å¤„ç†xAxis categories if('categories' in result)&#123; if(chartOptions.xAxis instanceof Array)&#123; for (var i = chartOptions.xAxis.length - 1; i &gt;= 0; i--) &#123; chartOptions.xAxis[i].categories = result['categories']; &#125;; &#125; else&#123; chartOptions.xAxis.categories = result['categories']; &#125; &#125; // ç”ŸæˆHighchartså¯¹è±¡ var chart = new Highcharts.Chart(chartOptions);&#125;; 3.æœ‰äº†ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ï¼Œrefreshå°±å¥½åŠäº†ã€‚ 12345678910111213AjaxChart.prototype.refresh = function()&#123; var params = this._getAjaxParams(); var that = this; $.post( this._url, params, function(json)&#123; var result = $.parseJSON(json); that._updateChart(result); &#125; );&#125;; æ³¨æ„è¿™é‡Œæœ‰å¥var that = this;ï¼Œç†Ÿæ‚‰å›è°ƒçš„æœ‹å‹è‚¯å®šå¯¹æ­¤ä¸é™Œç”Ÿï¼Œè¿™æ˜¯ä¸ºäº†ä¿å­˜å½“å‰çš„contextï¼Œå› ä¸ºåœ¨Ajaxçš„å›è°ƒå‡½æ•°æ‰§è¡Œæ—¶ï¼Œthisä¼šæŒ‡å‘xmlhttpresponseï¼Œè€Œä¸æ˜¯å½“å‰çš„AjaxChartå¯¹è±¡ã€‚ æ‰©å±•1ï¼šæ”¯æŒæœ¬åœ°æ•°æ®åˆ·æ–°ä½¿ç”¨åœºæ™¯ï¼šå½“ä¸€ä¸ªè¡¨æ ¼å·²ç»è¯·æ±‚å¥½äº†æ•°æ®ï¼Œå¹¶æ”¾åœ¨tableå…ƒç´ ä¸­äº†ã€‚æ­¤æ—¶å›¾è¡¨å…ƒç´ éœ€è¦åšçš„å°±æ˜¯æ ¹æ®è¡¨æ ¼ä¸­çš„æ•°æ®ç”Ÿæˆchartï¼Œè€Œå¹¶ä¸éœ€è¦å†æ¬¡å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚ æˆ‘ä»¬ä¸ºä¸Šé¢çš„refreshæ–¹æ³•æ·»åŠ ä¸€ä¸ªå‚æ•°ã€‚ 12345678910111213141516171819202122232425262728AjaxChart.prototype.refresh = function(chartData)&#123; // ajaxæ›´æ–° if(typeof chartData === 'undefined' &amp;&amp; this._url)&#123; var params = this._getAjaxParams(); var that = this; $.post( this._url, params, function(json)&#123; var result; if(typeof json === 'string')&#123; result = $.parseJSON(json); &#125; if(typeof json === 'object')&#123; result = json; &#125; if(typeof result !== 'undefined')&#123; that._updateChart(result); &#125; &#125; ); &#125; // éajaxæ›´æ–° else&#123; this._updateChart(chartData); &#125;&#125;; è¿™é‡ŒchartDataå°±æ˜¯Highchartsé…ç½®é‡Œseriesçš„æ ¼å¼ï¼Œè¿™æ ·å¯ä»¥åœ¨æœ¬åœ°ç”Ÿæˆç¬¦åˆæ ¼å¼çš„æ•°æ®ï¼Œç„¶åç›´æ¥refreshã€‚chartDataçš„æ ¼å¼å¯ä»¥å‚è€ƒajaxdata.jsonæˆ–ajaxdata2.jsonã€‚å¹¶ä¸”è¿™é‡Œå¯¹ajaxè¿”å›ç»“æœä¹Ÿåšäº†ä¸€äº›åˆ¤æ–­ï¼Œä»¥æ”¯æŒJSONå­—ç¬¦ä¸²æˆ–JSONå¯¹è±¡ã€‚ æ‰©å±•2ï¼šæ”¯æŒå›¾è¡¨ç‚¹å‡»äº‹ä»¶ä½¿ç”¨åœºæ™¯ï¼šåœ¨æŸ±çŠ¶å›¾æˆ–é¥¼å›¾ä¸­ï¼Œç»å¸¸éœ€è¦ç‚¹å‡»ä¸€å—æ—¶ï¼Œèƒ½å¤Ÿå¾—åˆ°ç›¸åº”çš„è”åŠ¨ã€‚æ¯”å¦‚åœ¨å›¾ä¸Šç‚¹å‡»äº†ä¸€å—ï¼Œç›¸åº”çš„è¡¨æ ¼æ•°æ®è¿‡æ»¤äº†ï¼Œæˆ–æ˜¯å¦ä¸€ä¸ªå›¾è¡¨ä¹Ÿéšä¹‹æ›´æ–°äº†ç­‰ç­‰ã€‚ è¿˜å¾—ä¸ºrefreshæ–¹æ³•æ·»åŠ å‚æ•°ï¼Œå¹²è„†æ·»åŠ ä¸€ä¸ªå¯¹è±¡å‚æ•°ã€‚ 1234567891011121314151617181920212223AjaxChart.prototype.refresh = function(opts)&#123; var chartData = opts &amp;&amp; opts.chartData; var clickHandler = opts &amp;&amp; opts.clickHandler; // ajaxæ›´æ–° if(typeof chartData === 'undefined' &amp;&amp; this._url)&#123; var params = this._getAjaxParams(); var that = this; $.post( this._url, params, function(json)&#123; var result = $.parseJSON(json); that._updateChart(result, clickHandler); &#125; ); &#125; // éajaxæ›´æ–° else&#123; this._updateChart(chartData, clickHandler); &#125;&#125;; åŒæ—¶_updateChartæ–¹æ³•ä¹Ÿå¾—å†æ·»åŠ ä¸€ä¸ªå‚æ•°ã€‚ 123456789101112131415161718192021AjaxChart.prototype._updateChart = function(result, handler)&#123; // ä»¥ä¸Šçœç•¥... // å¤„ç†events if(typeof handler === 'function')&#123; chartOptions.plotOptions = $.extend(&#123;&#125;, chartOptions.plotOptions, &#123; series: &#123; cursor: 'pointer', events: &#123; click: function(evt)&#123; var xLabel = evt.point.name || evt.point.category; handler(xLabel, evt.point.y); &#125; &#125; &#125; &#125;); &#125; // ç”ŸæˆHighchartså¯¹è±¡ var chart = new Highcharts.Chart(chartOptions);&#125;; è¿™é‡Œçš„handlerä¸­å¯ä»¥è·å–åˆ°ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯xåæ ‡çš„åˆ†ç±»å€¼ï¼Œä¸€ä¸ªæ˜¯yåæ ‡çš„å€¼ã€‚åº”ç”¨å±‚é‡Œå¯ä»¥è¿™æ ·å†™ã€‚ 12345chart1.refresh(&#123; clickHandler: function(xLabel, y)&#123; alert(xLabel + ': ' + y); &#125;&#125;); æ‰©å±•3ï¼šæ”¯æŒè‡ªå®šä¹‰å›è°ƒä½¿ç”¨åœºæ™¯ï¼šè·Ÿä¸Šé¢çš„ç‚¹å‡»äº‹ä»¶å·®ä¸å¤šï¼Œåªæ˜¯è¿™é‡Œåœ¨å›¾è¡¨æ›´æ–°å®Œæˆåï¼Œéœ€è¦é€šçŸ¥æŸäº›å…ƒç´ åšå‡ºç›¸åº”çš„å¤„ç†ã€‚ ä»£ç ä¹Ÿè·Ÿä¸Šé¢å·®ä¸å¤šï¼Œå†ä¸ºrefreshæ–¹æ³•æ·»åŠ ä¸ªå‚æ•°ã€‚ 1234567891011121314151617181920212223242526AjaxChart.prototype.refresh = function(opts)&#123; var chartData = opts &amp;&amp; opts.chartData; var clickHandler = opts &amp;&amp; opts.clickHandler; var afterUpdate = opts &amp;&amp; opts.afterUpdate; // ajaxæ›´æ–° if(typeof chartData === 'undefined' &amp;&amp; this._url)&#123; var params = this._getAjaxParams(); var that = this; $.post( this._url, params, function(json)&#123; var result = $.parseJSON(json); that._updateChart(result, clickHandler); afterUpdate &amp;&amp; afterUpdate(); &#125; ); &#125; // éajaxæ›´æ–° else&#123; this._updateChart(chartData, clickHandler); afterUpdate &amp;&amp; afterUpdate(); &#125;&#125;; å¦‚æœéœ€è¦æ”¯æŒæ›´å¤šçš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œæœ€å¥½ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸ºAjaxChart.prototypeæ·»åŠ ä¸€ä¸ªonå’Œfireæ–¹æ³•ï¼Œå¹¶åœ¨å¯¹è±¡ä¸­ç»´æŒä¸€ä¸ªhandlerså¯¹è±¡ã€‚è¿™é‡Œå°±ä¸ç»™å‡ºä»£ç äº†ï¼Œå¯å‚è€ƒé“¾æ¥ä¸­çš„å†…å®¹å¾ˆå®¹æ˜“å†™å‡ºç±»ä¼¼çš„ä»£ç ã€‚ æœ€ådemo AjaxChart Demo å‚è€ƒèµ„æ–™Highchartså®˜æ–¹ç½‘ç«™ï¼šwww.highcharts.com ä¸­æ–‡ç½‘ï¼šwww.hcharts.cn]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>chart</tag>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JPAæ³›å‹DAO]]></title>
    <url>%2Fblog%2F2015%2F02%2Fgeneric-dao-for-jpa.html</url>
    <content type="text"><![CDATA[JPAå…¨ç§°Java Persistence APIã€‚JPAé€šè¿‡JDK 5.0æ³¨è§£æˆ–XMLæè¿°å¯¹è±¡å…³ç³»è¡¨çš„æ˜ å°„å…³ç³»ï¼Œå¹¶å°†è¿è¡ŒæœŸçš„å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ï¼ˆæ‘˜è‡ªç™¾åº¦ç™¾ç§‘ï¼‰ã€‚æœ¬ç¯‡ç»“åˆè‡ªå·±çš„é¡¹ç›®ç»å†ï¼Œä½¿ç”¨çš„æ¡†æ¶æ˜¯Play Framework 1.2.7ï¼Œå…¶JPAåº•å±‚é‡‡ç”¨çš„æ˜¯Hibernate 3.6çš„å®ç°ï¼Œæ¥è®²è¿°åŸºäºJPAæ„å»ºä¸€ä¸ªæ³›å‹DAOï¼ˆData Access Objectï¼‰ã€‚ èƒŒæ™¯çŸ¥è¯†å…³äºJPAå°±ä¸å¤šåšä»‹ç»äº†ï¼Œå¦‚æœç”¨è¿‡Hibernateæˆ–Springï¼Œå°±ä¼šå¯¹JPAä¸€ç›®äº†ç„¶ã€‚å¯ä»¥ç‚¹å‡»è¿™é‡Œçœ‹çœ‹JPAæ¦‚è¦ã€‚æˆ‘ä¹‹å‰ä¹Ÿå†™è¿‡ä¸€ç¯‡ä»‹ç»åœ¨eclipseä¸­é›†æˆHibernateçš„æ–‡ç« ä¸­ä¹Ÿæåˆ°äº†DAOæ³›å‹ç¼–ç¨‹ã€‚ é—®é¢˜æ¥æºé¡¹ç›®ä¸­æœ‰å¥½å¤šå®ä½“ï¼Œæ¯”å¦‚è¯´è€å¸ˆã€å­¦ç”Ÿï¼Œè¿˜æœ‰è€ƒè¯•ï¼Œé‚£ä¹ˆå°±æœ‰å¯¹åº”çš„DAOå«TeacherDaoã€StudentDaoå’ŒExamDaoã€‚è™½ç„¶JPAå¯¹å®ä½“æä¾›äº†æ–¹ä¾¿çš„findæŸ¥è¯¢ï¼Œä½†æ˜¯è¿˜å¾—åœ¨TeacherDaoé‡Œå†™ä¸ªæ¯”å¦‚findTeachersBySchoolï¼Œåœ¨StudentDaoé‡Œå†™ä¸ªæ¯”å¦‚findStudentsByTeacherï¼Œæˆ–è€…åœ¨ExamDaoé‡Œå†™ä¸ªfindExamsByTeacherAndStudentç­‰ç­‰çš„æ–¹æ³•ï¼Œè€Œå…¶æ–¹æ³•å†…éƒ¨é€šè¿‡JPAä¸ºå®ä½“é™„åŠ çš„findæŸ¥è¯¢æ¥å®ç°ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯åœ¨ä¸åŒå®ä½“å¯¹åº”çš„DAOç±»é‡Œå­˜åœ¨ç€ä¸€å †çœ‹èµ·æ¥ç›¸ä¼¼çš„æ–¹æ³•ï¼ˆåªæ˜¯findé‡Œçš„å‚æ•°å’Œæ–¹æ³•çš„è¿”å›å€¼ä¸åŒï¼‰ï¼Œè¿™å°±æ˜¯å…¸å‹çš„åº”è¯¥ä½¿ç”¨æ³›å‹çš„åœºæ™¯ã€‚ æ³›å‹DAO1.æˆ‘ä»¬é¦–å…ˆè¦å»ºä¸€ä¸ªå«GenericDaoçš„æŠ½è±¡ç±» 12345678public abstract class GenericDao&lt;T, PK extends Serializable&gt; &#123; private Class&lt;T&gt; clazz; public GenericDao()&#123; // åå°„è·å–T.classï¼Œå®å‚ç±»å‹ clazz = (Class&lt;T&gt;)((ParameterizedType)getClass().getGenericSuperclass()).getActualTypeArguments()[0]; &#125;&#125; Tä»£è¡¨å®ä½“ç±»å‹ï¼ŒPKä»£è¡¨ä¸»é”®ç±»å‹ã€‚ 2.å®ä½“å¯¹åº”çš„DAOç±»å»ç»§æ‰¿GenericDao 123public class ExamDao extends GenericDao&lt;Exam, Long&gt; &#123;&#125; è¿™é‡ŒExamæ˜¯å®ä½“ç±»å‹ï¼ŒLongæ˜¯ä¸»é”®ç±»å‹ã€‚ 3.ä¸šåŠ¡å±‚ä½¿ç”¨DAOæ—¶åˆ›å»ºå…·ä½“DAOçš„å®ä¾‹ 1ExamDao examDao = new ExamDao(); æˆ‘ä»¬ç³»ç»Ÿä¸­æ‰€æœ‰çš„DAOéƒ½æŒ‰ç…§è¿™æ ·çš„è§„èŒƒæ¥å†™ï¼š a) å¯ä»¥é‡‡ç”¨ç»Ÿä¸€å®ç°çš„æ–¹æ³•éƒ½å†™åœ¨GenericDaoä¸­ b) å…·ä½“DAOä¸­å®ç°å„ä¸ç›¸åŒçš„æ–¹æ³•ï¼Œåœ¨GenericDaoå®šä¹‰æŠ½è±¡æ–¹æ³•ï¼Œå¹¶åœ¨å„è‡ªçš„DAOç±»ä¸­å®ç° c) å…·ä½“DAOä¸­ç‰¹æœ‰çš„æ–¹æ³•å°±å†™åœ¨è‡ªå·±çš„DAOç±»é‡Œ ç»Ÿä¸€å®ç°çš„query1234567891011121314151617181920212223242526public T findById(PK id)&#123; return (T) JPA.em().find(clazz, id);&#125;public List&lt;T&gt; findAll()&#123; return (List&lt;T&gt;) JPA.em().createQuery("select e from " + clazz.getName() + " e").getResultList();&#125;public void save(T instance)&#123; JPA.em().persist(instance);&#125;public void saveList(List&lt;T&gt; instances)&#123; EntityManager manager = JPA.em(); for (T instance : instances)&#123; manager.persist(instance); &#125;&#125;public void refresh(T instance)&#123; JPA.em().refresh(instance);&#125;public void delete(PK id)&#123; JPA.em().createQuery("delete from " + clazz.getName() + " e where e.id=" + id).executeUpdate();&#125; è¿™æ˜¯æ‹è„‘è¢‹é¦–å…ˆæƒ³å‡ºæ¥çš„ä¸€äº›æ–¹æ³•ï¼Œæœ€æœ€ç®€å•çš„å¢åˆ æ”¹æŸ¥ï¼Œè‚¯å®šæ¯ä¸ªå®ä½“çš„DAOä¸­éƒ½è¦ç”¨åˆ°ã€‚å¤§è‡´çœ‹çœ‹å¥½åƒæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ç»†æ€ææï¼Œå› ä¸ºä¸€èˆ¬ç³»ç»Ÿä¸­ç”¨çš„æœ€å¤šçš„æ˜¯æŒ‰æ¡ä»¶ä¸”å¸¦åˆ†é¡µçš„æŸ¥è¯¢ï¼Œç”šè‡³è¿˜å¸¦æ’åºï¼Œç®€å•ä¸€ä¸ªfindAllçœŸæ˜¯å›¾æ ·å›¾æ£®ç ´ã€‚ 1.é¦–å…ˆæˆ‘ä»¬è¦å®ç°ä¸€ä¸ªå¸¦åˆ†é¡µå¸¦æ’åºé¡¹çš„findAllæ–¹æ³•ã€‚ 123public List&lt;T&gt; findAll(int pageNo, String orderBy, String order)&#123; return find(getHQLString(null, null, orderBy, order), new Object[]&#123;&#125;, pageNo);&#125; è¿™é‡Œçš„findå†…éƒ¨åˆ©ç”¨Javaåå°„ï¼Œè°ƒç”¨äº†JPAä¸ºå…·ä½“å®ä½“ç±»é™„åŠ çš„æŸ¥è¯¢æ–¹æ³•ã€‚ 12345678910111213141516protected List&lt;T&gt; find(String query, Object[] params, Integer pageNo)&#123; try &#123; Method method = clazz.getMethod("find", new Class[]&#123;String.class, Object[].class&#125;); JPAQuery queryObj = (JPAQuery) method.invoke(clazz, new Object[]&#123;query, params&#125;); if(pageNo != null)&#123; return queryObj.fetch(pageNo, Constants.PAGE_SIZE); &#125; else&#123; return queryObj.fetch(); &#125; &#125; catch (Exception e) &#123; return new ArrayList&lt;T&gt;(); &#125;&#125; è¿™é‡Œçš„pageNoæ˜¯Integerç±»å‹ï¼Œä¸ºnullæ—¶ä»£è¡¨ä¸åˆ†é¡µã€‚è€Œqueryæ˜¯æˆ‘ä»¬æ‰‹å·¥æ‹¼æˆçš„ä¸€ä¸ªHQL queryï¼Œä¸‹é¢æ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•ã€‚ 1234567891011121314151617private String getHQLString(String[] columns, String[] signs, String orderBy, String order)&#123; StringBuilder builder = new StringBuilder(); if(columns != null &amp;&amp; columns.length &gt; 0)&#123; for(int i=0; i&lt;columns.length; i++)&#123; builder.append(columns[i] + " " + signs[i] + " ?"); if(i &lt; columns.length - 1)&#123; builder.append(" and "); &#125; &#125; &#125; if(orderBy != null)&#123; builder.append(" order by " + orderBy + " " + order); &#125; return builder.toString();&#125; è¿™é‡Œcolumnsè¡¨ç¤ºæŸ¥è¯¢éœ€è¦æ¯”è¾ƒçš„å­—æ®µï¼Œè€Œsignsè¡¨ç¤ºæ¯”è¾ƒæ—¶çš„ç¬¦å·ï¼ˆå°äºã€ç­‰äºã€å¤§äºç­‰ç­‰ï¼‰ã€‚æœ€åè¿”å›çš„HQLå½¢å¦‚columnX = ? and columnY &lt; ? orderBy columnZ descã€‚æœ€åå°†è¿™ä¸ªHQLä¼ ç»™findï¼Œé…ä¸Šå®é™…çš„å‚æ•°å€¼ï¼ˆå³â€œ?â€çš„å¡«å……å€¼ï¼‰ï¼Œå†è°ƒç”¨JPAæä¾›çš„findæ¥fetchå‡ºç›¸åº”çš„ç»“æœï¼Œä»¥å®Œæˆåˆ†é¡µæŸ¥è¯¢ã€‚è¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹å°±å¦‚æ­¤ï¼Œæ³¨æ„è¿™é‡Œæˆ‘ä»¬å°†â€œé¡µâ€çš„å¤§å°å­˜åˆ°äº†ä¸€ä¸ªå¸¸é‡ä¸­ã€‚ 2.ä¸ºsignså’Œorderå®šä¹‰ä¸€äº›å¸¸é‡ï¼Œä»¥åŠå¸®åŠ©æ–¹æ³•ã€‚ 123456789101112131415public static final String SIGN_EQUALS = "=";public static final String SIGN_LESS_THAN = "&lt;";public static final String SIGN_GREATER_THAN = "&gt;";public static final String SIGN_LESS_EQUALS_THAN = "&lt;=";public static final String SIGN_GREATER_EQUALS_THAN ="&gt;=";public static final String ORDER_ASC = "asc";public static final String ORDER_DESC = "desc";private String[] getDefaultSigns(int length)&#123; String[] signs = new String[length]; for(int i=0; i&lt;length; i++)&#123; signs[i] = SIGN_EQUALS; &#125; return signs;&#125; 3.æœ‰äº†ä»¥ä¸Šçš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥é¡ºåŠ¿å†™å‡ºå¥½å¤šfindByæ–¹æ³•å‡ºæ¥ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041public List&lt;T&gt; findBy(String[] columns, Object[] values, String[] signs, int pageNo, String orderBy, String order)&#123; return find(getHQLString(columns, signs, orderBy, order), values, pageNo);&#125;public List&lt;T&gt; findBy(String[] columns, Object[] values, String[] signs, int pageNo)&#123; return find(getHQLString(columns, signs, null, null), values, pageNo);&#125;public List&lt;T&gt; findBy(String[] columns, Object[] values, int pageNo, String orderBy, String order)&#123; String[] signs = getDefaultSigns(columns.length); return find(getHQLString(columns, signs, orderBy, order), values, pageNo);&#125;public List&lt;T&gt; findBy(String[] columns, Object[] values, int pageNo)&#123; String[] signs = getDefaultSigns(columns.length); return find(getHQLString(columns, signs, null, null), values, pageNo);&#125;public List&lt;T&gt; findBy(String column, Object value, int pageNo, String orderBy, String order)&#123; return find(getHQLString(new String[]&#123;column&#125;, new String[]&#123;SIGN_EQUALS&#125;, orderBy, order), new Object[]&#123;value&#125;, pageNo);&#125;public List&lt;T&gt; findBy(String column, Object value, int pageNo)&#123; return find(getHQLString(new String[]&#123;column&#125;, new String[]&#123;SIGN_EQUALS&#125;, null, null), new Object[]&#123;value&#125;, pageNo);&#125;public List&lt;T&gt; findLessThan(String column, Object value, int pageNo, String orderBy, String order)&#123; return find(getHQLString(new String[]&#123;column&#125;, new String[]&#123;SIGN_LESS_THAN&#125;, orderBy, order), new Object[]&#123;value&#125;, pageNo);&#125;public List&lt;T&gt; findLessThan(String column, Object value, int pageNo)&#123; return find(getHQLString(new String[]&#123;column&#125;, new String[]&#123;SIGN_LESS_THAN&#125;, null, null), new Object[]&#123;value&#125;, pageNo);&#125;public List&lt;T&gt; findGreaterThan(String column, Object value, int pageNo, String orderBy, String order)&#123; return find(getHQLString(new String[]&#123;column&#125;, new String[]&#123;SIGN_GREATER_THAN&#125;, orderBy, order), new Object[]&#123;value&#125;, pageNo);&#125;public List&lt;T&gt; findGreaterThan(String column, Object value, int pageNo)&#123; return find(getHQLString(new String[]&#123;column&#125;, new String[]&#123;SIGN_GREATER_THAN&#125;, null, null), new Object[]&#123;value&#125;, pageNo);&#125; 4.åŒç†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†™å‡ºfindInæ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829private String getInHQLString(String column, int inLength, String orderBy, String order)&#123; StringBuilder builder = new StringBuilder(column); if(inLength &gt; 0)&#123; builder.append(" in ("); for(int i=0; i&lt;inLength; i++)&#123; builder.append("?"); if(i &lt; inLength - 1)&#123; builder.append(","); &#125; &#125; builder.append(")"); &#125; if(orderBy != null)&#123; builder.append(" order by " + orderBy + " " + order); &#125; return builder.toString();&#125;public List&lt;T&gt; findIn(String column, Object[] values, int pageNo, String orderBy, String order)&#123; return find(getInHQLString(column, values.length, orderBy, order), values, pageNo);&#125;public List&lt;T&gt; findIn(String column, Object[] values, int pageNo)&#123; return find(getInHQLString(column, values.length, null, null), values, pageNo);&#125; å½“ç„¶æˆ‘ä»¬è¿˜èƒ½å†™å‡ºfindInå’ŒfindByæ··åˆçš„æ–¹æ³•ï¼Œå³éƒ¨åˆ†å­—æ®µç”¨ç¬¦å·æ¯”è¾ƒï¼Œè€Œéƒ¨åˆ†å­—æ®µç”¨inæ¯”è¾ƒã€‚è¿˜å¯ä»¥å†™ä¸€å †countæ–¹æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸å†ç½—åˆ—äº†ã€‚ æ€»ç»“æ³›å‹ç¼–ç¨‹æ˜¯å‡å°‘ä»£ç å†—ä½™çš„åˆ©å™¨ï¼Œå°¤å…¶æ˜¯åœ¨DAOå±‚é¢çš„æ³›å‹ï¼Œå¯ä»¥å°†HQLæˆ–SQLè¯­å¥éƒ½å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¤–éƒ¨ä½¿ç”¨æ—¶åªéœ€è°ƒç”¨æ–¹æ³•å’Œä¼ å‚å³å¯ï¼Œé™ä½äº†ç¨‹åºå‘˜å†™SQLå‡ºé”™çš„å¯èƒ½æ€§ã€‚]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>æ³›å‹ç¼–ç¨‹</tag>
        <tag>JPA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(6)]]></title>
    <url>%2Fblog%2F2015%2F01%2Fstep-by-step-js-component-schoolbox-6.html</url>
    <content type="text"><![CDATA[å‰é¢ä¸€è¿5ç¯‡ä¸‹æ¥ï¼Œå­¦æ ¡é€‰æ‹©å™¨å·²ç»æœ‰æ¨¡æœ‰æ ·äº†ã€‚è¿™ç¯‡ç®—æ˜¯ç‹—å°¾ç»­è²‚äº†ï¼Œå¦‚æœåœ¨é€‰æ‹©å™¨ä¸­æœä¸åˆ°æƒ³è¦çš„å­¦æ ¡è¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å†æ·»åŠ ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½ï¼Œå°±æ˜¯æ·»åŠ è‡ªå®šä¹‰å­¦æ ¡ã€‚ ç•Œé¢è®¾è®¡ç»§ç»­å‰é¢çš„è®¾è®¡é£æ ¼ï¼Œåœ¨å­¦æ ¡é€‰æ‹©å™¨çš„åº•éƒ¨æ·»åŠ å¦‚ä¸‹ä¸€è¡Œã€‚ åŒæ—¶åœ¨æœç´¢ç»“æœåˆ—è¡¨çš„åº•éƒ¨ï¼Œå½“æ— åŒ¹é…ç»“æœæ—¶ï¼Œä¹Ÿæ·»åŠ å¦‚ä¸‹ä¸€è¡Œã€‚ æ‰©å±•ç»„ä»¶åŠŸèƒ½1.åœ¨ç§æœ‰é™æ€å˜é‡é‡Œæ·»åŠ å…ƒç´ copy 123456789var $addSchoolCopy = $( '&lt;div class="add-school-wrapper"&gt;' + '&lt;a href="javascript:void(0)" class="add-school-link"&gt;æ²¡æ‰¾åˆ°ï¼Ÿæ·»åŠ å­¦æ ¡&lt;/a&gt;' + '&lt;div class="inline-block hide add-school-div"&gt;' + '&lt;input type="text" class="add-school-input"/&gt;' + '&lt;input type="button" class="add-school-ok" value="ç¡®å®š"/&gt;' + '&lt;input type="button" class="add-school-cancel" value="å–æ¶ˆ"/&gt;' + '&lt;/div&gt;' + '&lt;/div&gt;'); 2.åˆå§‹åŒ–æ–°çš„å…ƒç´  123456789var initAddSchool = function(instance)&#123; // ç”Ÿæˆå…ƒç´  var $el = $(instance.opts.appendTo).find('.school-box-wrapper'); $el.append($addSchoolCopy.clone()); $el.find('.search-school-empty').append('&lt;a href="javascript:void(0)" class="add-school-link"&gt;æ·»åŠ å­¦æ ¡&lt;/a&gt;'); // é‡Šæ”¾å˜é‡ $el = null;&#125;; 3.ä¸ºæ–°çš„ç›®æ ‡å…ƒç´ ç»‘å®šäº‹ä»¶ 12345678910111213141516171819202122232425262728293031323334353637// ç›®æ ‡å…ƒç´ var $addSchoolLink = $el.find('.add-school-link');var $addSchoolDiv = $el.find('.add-school-div');var $addSchoolInput = $el.find('.add-school-input');var $addSchoolOk = $el.find('.add-school-ok');var $addSchoolCancel = $el.find('.add-school-cancel');// äº‹ä»¶$addSchoolLink.click(function()&#123; $addSchoolDiv.removeClass('hide'); $addSchoolInput.focus();&#125;);$addSchoolCancel.click(function()&#123; $addSchoolDiv.addClass('hide');&#125;);$addSchoolOk.click(function()&#123; var schoolName = $.trim($addSchoolInput.val()); if(schoolName.length == 0)&#123; return false; &#125; // TODO: ajaxæ·»åŠ  var newSchoolId = 'undefined'; // è‡ªå®šä¹‰äº‹ä»¶å›è°ƒ instance.fire('schoolChosen', &#123; schoolName: schoolName, schoolId: newSchoolId &#125;); // è‡ªåŠ¨æ”¶èµ· instance.hide(); // æ¸…ç©ºè¾“å…¥å†…å®¹ $addSchoolInput.val(''); $addSchoolDiv.addClass('hide');&#125;); æ³¨æ„$addSchoolOkçš„clickæ‰§è¡Œé‡Œï¼Œåº”è¯¥ç”¨Ajaxå‘åå°å‘é€è¯·æ±‚ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„å­¦æ ¡åæ·»åŠ åˆ°æ•°æ®åº“ä¸­å»ï¼Œæœ€åå°†æ–°åŠ å­¦æ ¡çš„IDè¿”å›ç»™é¡µé¢ã€‚è€Œä¸Šé¢çš„ä»£ç ç›´æ¥å†™æ­»ä¸€ä¸ªundefinedçš„å­¦æ ¡IDï¼Œè¿™é‡Œä»…åšdemoã€‚æœ€åæ·»åŠ æˆåŠŸåï¼Œä¾ç„¶è¦è§¦å‘è‡ªå®šä¹‰schoolChosenäº‹ä»¶ï¼Œå¥½è®©åº”ç”¨å±‚é¡µé¢åšå‡ºå“åº”ã€‚ 4.åº”ç”¨å±‚ä½¿ç”¨ç»„ä»¶æ—¶æ·»åŠ ä¸€é¡¹åˆå§‹åŒ–å‚æ•° 12345var schoolBox = new SchoolBox(&#123; appendTo: '#schoolBoxWrapper', searchSchool: true, addSchool: true&#125;); å¯ä»¥çœ‹åˆ°æ‰©å±•ç»„ä»¶åŠŸèƒ½æ—¶ï¼Œå¯¹åº”ç”¨å±‚é¡µé¢ä»£ç çš„å½±å“æ˜¯å¾ˆå°çš„ã€‚åªè¦ä¸æ·»åŠ è‡ªå®šä¹‰äº‹ä»¶çš„ç±»å‹ï¼Œåº”ç”¨å±‚å‡ ä¹ä¸ç”¨æ”¹ä»£ç ï¼Œå› ä¸ºå®ƒåªå…³å¿ƒé€‰ä¸­çš„å­¦æ ¡ï¼Œå¹¶å°†å®ƒæ›´æ–°æ˜¾ç¤ºåˆ°é¡µé¢ä¸Šï¼Œè€Œä¸éœ€è¦å…³å¿ƒè¿™ä¸ªå­¦æ ¡åˆ°åº•æ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼é€‰æ¥çš„ã€‚ å­¦æ ¡é€‰æ‹©å™¨v7 Demo æ€»ç»“å­¦æ ¡é€‰æ‹©å™¨è¿™ä¸ªç³»åˆ—åˆ°è¿™é‡Œç»“æŸäº†ï¼Œæˆ‘æœ€åˆåœ¨é¡¹ç›®é‡Œåªåšäº†è¿™é‡Œç‰ˆæœ¬v2çš„æ ·å­ã€‚åæ¥åˆææ–°éœ€æ±‚ï¼Œæœç´¢å­¦æ ¡å’Œæ‰¾ä¸åˆ°å­¦æ ¡ï¼Œç„¶åå°±ç›´æ¥åœ¨v2ä¸Šè¿­ä»£ï¼Œä»…ä»…æ˜¯è¡¨å•é‡Œçš„ä¸€è¡Œé€‰æ‹©ï¼Œå°±æäº†è¿‘1000è¡Œä»£ç ã€‚åæ¥åˆæ¥æ–°éœ€æ±‚ï¼Œè¯´å…¶ä»–é¡µé¢ä¹Ÿéœ€è¦ç¼–è¾‘å­¦æ ¡ï¼Œå› æ­¤æˆ‘æ‰ä¸å¾—ä¸æ‹†å‡ºæ¥å†™æˆå¤ç”¨å½¢å¼ï¼Œä¸€åŠ³æ°¸é€¸ã€‚åœ¨è¿™ä¸ªé‡æ„çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å°†é˜¶æ®µæ€§çš„æ¯ä¸€æ­¥éƒ½åšæˆä¸€ä¸ªç‰ˆæœ¬ï¼Œæœ€åæ•´ç†æˆäº†è¿™6ç¯‡æ–‡ç« ã€‚æ—¢æ˜¯å¯¹æˆ‘è‡ªå·±çš„æ€»ç»“æé«˜ï¼ŒåŒæ—¶ä¹Ÿæƒ³å‘Šè¯‰å¤§å®¶ï¼Œåšå‰ç«¯çš„ä¸ä»…ä»…å®ç°é¡µé¢åŠŸèƒ½ï¼Œæ›´å¤šåœ°åº”è¯¥ä»¥å·¥ç¨‹å¸ˆçš„è§’åº¦å»æ€è€ƒé—®é¢˜ï¼Œè®©ä»£ç è´¨é‡æ›´é«˜æ›´æ˜“ç»´æŠ¤ã€‚ è¿™é‡Œçš„å­¦æ ¡é€‰æ‹©å™¨å½“ç„¶è¿˜ä¸å¤Ÿå®Œç¾ï¼Œè¿˜æœ‰å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ã€‚æ¯”å¦‚æˆ‘çœ‹åˆ°åˆ«äººçš„æœç´¢ç»“æœåˆ—è¡¨ä¸­å¯ä»¥æŒ‰ä½â€œä¸‹â€é”®ï¼Œå®ƒå°±ä¼šä¸€ç›´å‘ä¸‹ä¾æ¬¡é€‰ä¸­ï¼Œè¿˜æœ‰å¯¹æœç´¢ç»“æœçš„æ’åºç­‰ç­‰ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(5)]]></title>
    <url>%2Fblog%2F2015%2F01%2Fstep-by-step-js-component-schoolbox-5.html</url>
    <content type="text"><![CDATA[ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬ç®€å•å®ç°äº†æœç´¢æ¡†çš„åŠŸèƒ½ï¼Œè¿™èŠ‚ä¸­è¦ä¸ºå®ƒæ·»åŠ æŒ‰é”®äº‹ä»¶ï¼Œâ€œä¸Šâ€â€œä¸‹â€é”®é€‰æ‹©åŒ¹é…çš„ç»“æœï¼Œâ€œå›è½¦â€é”®æ¥è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œä»¥ä½¿å®ƒä½¿ç”¨èµ·æ¥æ›´åŠ äººæ€§åŒ–ã€‚ é”®ç›˜äº‹ä»¶å…¥å£åœ¨æœç´¢æ¡†keyupäº‹ä»¶é‚£é‡Œï¼Œé’ˆå¯¹ç‰¹æ®Šçš„æŒ‰é”®åšæ‹¦æˆªï¼ˆä¸è§¦å‘æœç´¢ï¼‰ã€‚ 12345678910111213141516171819202122232425262728293031var initSearchSchool = function(instance)&#123; // ä»¥ä¸Šçœç•¥... // äº‹ä»¶ $searchInput.bind('keyup', function(event)&#123; // ç‰¹æ®ŠæŒ‰é”®ï¼ˆåŠ¨ä½œé”®ï¼‰ if(event.keyCode == KEY_ENTER)&#123; searchSchoolChosen($searchList); return preventDefault(event); &#125; if(event.keyCode == KEY_UP)&#123; searchListScrollPrev($searchDiv, $searchList); return preventDefault(event); &#125; if(event.keyCode == KEY_DOWN)&#123; searchListScrollNext($searchDiv, $searchList); return preventDefault(event); &#125; var keywords = $.trim($(this).val()); // ç©ºæ ¼oræ‹¼éŸ³æ²¡è¾“å®Œæ—¶æš‚ä¸search if(keywords.length == 0 || keywords.indexOf("'") &gt; -1)&#123; $searchDiv.hide(); return false; &#125; searchSchool(keywords, $searchDiv, $searchList, $searchEmpty); &#125;); // ä»¥ä¸‹çœç•¥...&#125;; è¿™é‡Œå®šä¹‰äº†å‡ ä¸ªæŒ‰é”®keyCodeçš„å…¨å±€å˜é‡å’Œä¸€ä¸ªé˜»æ­¢æµè§ˆå™¨é»˜è®¤äº‹ä»¶çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ã€‚ 12345678910111213// Constantsvar KEY_ENTER = 13;var KEY_UP = 38;var KEY_DOWN = 40;// Utilsvar preventDefault = function(event)&#123; if(event &amp;&amp; event.preventDefault) event.preventDefault(); else window.event.returnValue = false; return false;&#125;; è¿™é‡Œç”¨è‡ªå·±å†™çš„preventDefaultæ˜¯ä¸ºäº†èƒ½å¤Ÿå…¼å®¹ä¸åŒçš„æµè§ˆå™¨ï¼Œevent.preventDefault()æ˜¯æ ‡å‡†æµè§ˆå™¨æä¾›çš„ï¼Œè€Œwindow.event.returnValue = falseæ˜¯IEä¸‹çš„å†™æ³•ã€‚ searchSchoolChosenæ˜¯é€‰æ‹©å½“å‰é¡¹ï¼ŒsearchListScrollPrevæ˜¯é€‰ä¸­ä¸Šä¸€é¡¹ï¼Œè€ŒsearchListScrollNextæ˜¯é€‰ä¸­ä¸‹ä¸€é¡¹ï¼Œæˆ‘ä»¬å°†åœ¨åé¢è¯¦ç»†è®²ã€‚ åŠ¨ç”»æ•ˆæœæœ‰äº†ä¸Šé¢çš„ä»£ç ç»“æ„ï¼Œæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯ä¸ºç‰¹æ®ŠæŒ‰é”®æ·»åŠ æ•ˆæœï¼Œè¿™é‡Œæ¶‰åŠåˆ°åŠ¨ç”»ï¼Œåˆæ˜¯ä¸€ä¸ªè›‹ç–¼çš„è¯é¢˜ã€‚ ç”»äº†ä¸€å¼ ç¤ºæ„å›¾ï¼ŒsDivæ˜¯çˆ¶å…ƒç´ searchDivï¼ŒsListå°±æ˜¯å…ƒç´ searchListï¼Œè€Œtargetå°±æ˜¯searchListä¸­å…·ä½“é€‰ä¸­çš„é‚£ä¸ªå­å…ƒç´ ã€‚æ ¹æ®è¿™å¹…å›¾ï¼Œæˆ‘ä»¬æœ‰ï¼š Î”offset = tarTop - sDivTop + scrollTop å…¶ä¸­çˆ¶å…ƒç´ sDivä¸Šè®¾ç½®äº†heightå¹¶ä¸”overflow-y: scrollï¼Œæˆ‘ä»¬å¯ä»¥æŠŠsDivè§†ä½œä¸€ä¸ªçª—å£ï¼Œåªè¦ä¿è¯targetå§‹ç»ˆåœ¨è¿™ä¸ªçª—å£é«˜åº¦èŒƒå›´å†…å³å¯ã€‚å³éšç€æˆ‘ä»¬æŒ‰â€œä¸Šâ€â€œä¸‹â€é”®ï¼Œæˆ‘ä»¬è¦ä¿è¯ç›®æ ‡å­å…ƒç´ åœ¨è¿™ä¸ªè§†çª—è¾¹ç•Œä¹‹å†…ã€‚ scrollTop &lt;= Î”offset &lt;= scrollTop + sDiv.height äºæ˜¯æˆ‘ä»¬æœ‰äº†æ§åˆ¶searchDivæ»šåŠ¨æ¡åŠ¨ç”»çš„æ–¹æ³•ã€‚ 12345678910111213141516var searchListScroll = function($searchDiv, $searchList)&#123; var scrollTop = $searchDiv.scrollTop(); var viewMin = scrollTop; var viewMax = viewMin + $searchDiv.height(); var $target = $searchList.children('li.active'); var deltaOffset = $target.offset().top - $searchDiv.offset().top + scrollTop; // deltaOffsetè¦åœ¨è§†çª—èŒƒå›´é‡Œ if(deltaOffset &gt; viewMax)&#123; $searchDiv.animate(&#123;scrollTop: scrollTop + deltaOffset - viewMax&#125;, 'fast'); &#125; else if(deltaOffset &lt; viewMin)&#123; $searchDiv.animate(&#123;scrollTop: scrollTop - (viewMin - deltaOffset)&#125;, 'fast'); &#125;&#125;; å¤§ä½“çœ‹ä¸Šå»æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ³¨æ„åˆ°å½“å‘â€œä¸‹â€é€‰ä¸­æ—¶ï¼Œå…¶å®æ˜¯Î”offset + target.heightè¦åœ¨è§†çª—èŒƒå›´å†…ã€‚å› æ­¤æˆ‘ä»¬ä½œå¦‚ä¸‹ä¿®æ­£ã€‚ 12345678var searchListScroll = function(isDown, $searchDiv, $searchList)&#123; // ä»¥ä¸Šçœç•¥... var deltaOffset = $target.offset().top - $searchDiv.offset().top + scrollTop; isDown &amp;&amp; (deltaOffset += $target.height()); // ä»¥ä¸‹çœç•¥...&#125;; æœ‰äº†è¿™ä¸ªæ»šåŠ¨æ¡åŠ¨ç”»çš„æ–¹æ³•ï¼Œä¸Šé¢æåˆ°çš„searchListScrollPrevå’ŒsearchListScrollNextä¹Ÿå°±ä¿¡æ‰‹æ‹ˆæ¥äº†ã€‚ 123456789101112131415161718192021222324252627var searchListScrollPrev = function($searchDiv, $searchList)&#123; var $cur = $searchList.children('li.active'); $cur.removeClass &amp;&amp; $cur.removeClass('active'); if($cur.length == 0 || $cur.index() == 0)&#123; $searchList.children('li').last().addClass('active'); searchListScroll(true, $searchDiv, $searchList); &#125; else&#123; $searchList.children('li').eq($cur.index() - 1).addClass('active'); searchListScroll(false, $searchDiv, $searchList); &#125;&#125;;var searchListScrollNext = function($searchDiv, $searchList)&#123; var $cur = $searchList.children('li.active'); $cur.removeClass &amp;&amp; $cur.removeClass('active'); if($cur.length == 0 || $cur.index() == $searchList.children().length-1)&#123; $searchList.children('li').first().addClass('active'); searchListScroll(false, $searchDiv, $searchList); &#125; else&#123; $searchList.children('li').eq($cur.index() + 1).addClass('active'); searchListScroll(true, $searchDiv, $searchList); &#125;&#125;; è¿™ä¸¤ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥å“åº”â€œä¸Šâ€â€œä¸‹â€é”®ï¼Œæ§åˆ¶searchListå½“å‰é€‰ä¸­çš„å­å…ƒç´ ï¼Œä¸ºä¹‹æ·»åŠ classï¼Œå¹¶ä¿è¯é€‰ä¸­çš„å…ƒç´ åœ¨searchDivçš„å¯è§èŒƒå›´å†…ã€‚ æ³¨æ„è¿™é‡Œä»£ç $cur.removeClass &amp;&amp; $cur.removeClass(&#39;active&#39;);è¿™æ ·å†™æ˜¯å› ä¸ºå¯èƒ½æ‰¾ä¸åˆ°$curå…ƒç´ ï¼Œé‚£ä¹ˆ$cur.removeClasså°±è‚¯å®šæ˜¯falseäº†ï¼Œå°±ä¸ä¼šæ‰§è¡Œ$cur.removeClass(&#39;active&#39;)äº†ã€‚ ~~è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œ$cur.index()å€¼çš„èŒƒå›´å¹¶ä¸æ˜¯0 ~ length-1ï¼Œå®é™…ä¸Šå€¼ä¸º-1æ—¶è¡¨ç¤ºæ‰¾ä¸åˆ°å…ƒç´ ï¼Œè€Œè¶…è¿‡length-1æ—¶åˆä¼šä»å¤´å¼€å§‹æ‰¾ï¼Œå³$cur.index()ç­‰äºlengthæ—¶å…¶å®æ˜¯ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚æ‰€ä»¥è¿™é‡Œçš„ä»£ç ä¸­å½“$cur.index() == $searchList.children().length-1æ—¶è¦å³æ—¶ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ æ·»åŠ classï¼Œä»¥ä¿è¯$cur.index()çš„å€¼èŒƒå›´åœ¨0 ~ length-1ä¸­ã€‚ ~~ é”¦ä¸Šæ·»èŠ±1.å½“é€šè¿‡â€œä¸Šâ€â€œä¸‹â€é”®æ¥é€‰ä¸­æ—¶ï¼Œæˆ‘ä»¬å·²ç»ä¸ºç›®æ ‡å­å…ƒç´ æ·»åŠ äº†activeçš„æ ·å¼ï¼Œé‚£ä¹ˆè¿™æ—¶å¦‚æœé¼ æ ‡å†æ¥æ£ä¹±è¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬åªå¥½å†ä¸ºé¼ æ ‡æ·»åŠ hoveræ•ˆæœï¼Œä»¥æŠ¹å»ä¸Šä¸‹é”®çš„é€‰ä¸­æ•ˆæœã€‚ 123456789101112var initSearchSchool = function(instance)&#123; // ä»¥ä¸Šçœç•¥... $searchList.find('li').live('mouseenter', function()&#123; $searchList.find('li.active').removeClass('active'); $(this).addClass('hover'); &#125;).live('mouseleave', function()&#123; $searchList.find('li.hover').removeClass('hover'); &#125;); // ä»¥ä¸‹çœç•¥...&#125;; 2.è‡³äºâ€œå›è½¦â€é”®çš„å“åº”æ–¹æ³•ï¼Œæˆ‘ä»¬ç”¨æœ€ç®€å•çš„åŠæ³•ï¼Œç›¸å½“äºé€‰ä¸­çš„å­å…ƒç´ clickä¸€ä¸‹ã€‚ 1234var searchSchoolChosen = function($searchList)&#123; // è½¬å‘click event $searchList.children('li.active').click();&#125;; 3.æˆ‘ä»¬å‘ç°å½“æˆ‘ä»¬è¾“å…¥å…³é”®å­—æœç´¢æ—¶ï¼Œå…¶å®æ¯æŒ‰ä¸€æ¬¡é”®éƒ½æ‰§è¡Œäº†ä¸€æ¬¡æœç´¢å’Œæ›´æ–°å…ƒç´ ã€‚è€Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå…³é”®å­—éœ€è¦è¿›è¡Œå¤šæ¬¡æŒ‰é”®ï¼Œæ¯”å¦‚æœç´¢â€œæ±Ÿè‹â€ï¼Œå…¶å®æŒ‰é”®ä¾æ¬¡è¾“å…¥äº†â€œjiangsuâ€å’Œæœ€åæ‹¼éŸ³é€‰æ‹©æ±‰å­—çš„æ•°å­—é”®æˆ–ç©ºæ ¼é”®ã€‚æˆ‘ä»¬åº”è¯¥å¯¹æ­¤åšäº›ä¼˜åŒ–ï¼Œä»¥å‡å°‘æœç´¢æ‰§è¡Œï¼Œè‹¥ä½¿ç”¨Ajaxæœç´¢çš„è¯ï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šæ¬¡ç½‘ç»œå¼€é”€ã€‚ 12345678910111213var initSearchSchool = function(instance)&#123; // ä»¥ä¸Šçœç•¥... // whenæ­£å¸¸è¾“å…¥ initSearchSchool.currentTime = (new Date()).getTime(); // æŒç»­å¿«é€Ÿè¾“å…¥æ—¶ä¸è§¦å‘æœç´¢ if(initSearchSchool.currentTime - initSearchSchool.lastKeypressTime &gt; KEY_PRESS_INTERVAL)&#123; initSearchSchool.lastKeypressTime = initSearchSchool.currentTime; searchSchool(keywords, $searchDiv, $searchList, $searchEmpty); &#125; // ä»¥ä¸‹çœç•¥...&#125;; è¿™é‡Œåœ¨å…¨å±€å®šä¹‰å¸¸é‡var KEY_PRESS_INTERVAL = 300;æ¯«ç§’å³å¯ã€‚è™½ç„¶ä¸èƒ½é¢é¢ä¿±åˆ°ï¼Œä½†æ˜¯å·²ç»å¯ä»¥å‡å°‘å¤§éƒ¨åˆ†æŒ‰é”®æƒ…å†µçš„æ‰§è¡Œå¼€é”€äº†ã€‚ å­¦æ ¡é€‰æ‹©å™¨v6 Demo]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(4)]]></title>
    <url>%2Fblog%2F2015%2F01%2Fstep-by-step-js-component-schoolbox-4.html</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬ç”¨è§‚å¯Ÿè€…æ¨¡å¼å®ç°äº†è‡ªå®šä¹‰äº‹ä»¶çš„åŠŸèƒ½ï¼Œè®©åº”ç”¨å±‚çš„äº‹ä»¶å›è°ƒæ›´åŠ æ¾è€¦åˆã€‚ä½†æ˜¯åˆ°æ­¤ä¸ºæ­¢å­¦æ ¡é€‰æ‹©å™¨ä»…ä»…åšäº†åŸºæœ¬çš„çœä»½å’Œå­¦æ ¡çš„çº§è”åŠŸèƒ½ï¼Œç°åœ¨æˆ‘ä»¬è¦ä¸ºå®ƒæ·»åŠ æœç´¢çš„åŠŸèƒ½ã€‚ ç•Œé¢è®¾è®¡ä¾æ—§æ¨¡ä»¿äººäººç½‘çš„å­¦æ ¡è®¾è®¡ï¼Œå®ƒä¹Ÿæœ‰ä¸ªåŠ¨æ€æœç´¢æ¡†ï¼Œå¦‚å›¾ã€‚ å…ˆä¾æ ·ç”»è‘«èŠ¦æŠŠå…ƒç´ å’Œæ ·å¼æå‡ºæ¥ 123456789101112&lt;div class="search-school-wrapper"&gt; &lt;div class="inline-block"&gt;&lt;label&gt;æœç´¢ï¼š&lt;/label&gt;&lt;/div&gt; &lt;div class="inline-block"&gt; &lt;input type="text" class="search-school-input"/&gt; &lt;div class="search-school-div"&gt; &lt;ul class="search-school-list"&gt;&lt;/ul&gt; &lt;div class="search-school-empty"&gt; &lt;span class="text-error"&gt;æ‰¾ä¸åˆ°è¯¥å­¦æ ¡&lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; è¿™é‡Œçš„å…ƒç´ æœ€åéƒ½è¦æ¬åˆ°jsä¸­å»ç”Ÿæˆï¼Œå…ˆå†™åœ¨htmlé‡Œä¸ºäº†è°ƒæ ·å¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839.search-school-wrapper&#123; float: right; font-size: 12px;&#125;.search-school-input&#123; padding: 2px 4px; width: 180px;&#125;.search-school-div&#123; background-color: #fff; border: 1px solid #C3C3C3; border-top: none; color: #005EAC; display: none; font-size: 12px; font-weight: normal; max-height: 200px; overflow-x: hidden; overflow-y: scroll; position: absolute; width: 188px;&#125;.search-school-list li&#123; cursor: pointer; height: 20px; line-height: 20px; padding-left: 5px;&#125;.search-school-list li.active,.search-school-list li.hover,.search-school-list li:hover&#123; background-color: #005EAC; color: white;&#125;.search-school-empty&#123; display: none; padding: 5px 0; text-align: center;&#125; å¦‚ä½•æœç´¢æˆ‘ä»¬å½“ç„¶é¦–å…ˆæƒ³åˆ°å‘é€ä¸€ä¸ªAjaxè¯·æ±‚ï¼Œç„¶ååå°å»æ•°æ®åº“æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæœ€åè¿”å›ä¸€ä¸ªå­¦æ ¡åˆ—è¡¨çš„æ•°æ®ã€‚ç”šè‡³åšçš„æ›´å¥½ä¸€äº›çš„è¯ï¼Œå¯ä»¥å®šä¹‰å…³é”®è¯åŒ¹é…åº¦ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå€¼æ¥è°ƒæ•´è¿”å›çš„å­¦æ ¡åˆ—è¡¨çš„é¡ºåºã€‚ åœ¨ä¹‹å‰çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªå¾ˆå¤§çš„SCHOOL_LISTå˜é‡å­˜åœ¨äº†jsä¸­ï¼ŒåŒ…å«äº†åå°æ•°æ®åº“ä¸­çš„æ‰€æœ‰å­¦æ ¡ã€‚è¿™é‡Œæˆ‘ä»¬ç»§ç»­è¿™ä¸ªæ€è·¯ï¼Œé‡‡ç”¨çš„æ˜¯ç›´æ¥åœ¨jsæœ¬åœ°æœç´¢ã€‚ 1var reg = eval('/' + keywords.split('').join('\\S*') + '/'); è¿™é‡Œkeywordså°±æ˜¯ç”¨æˆ·è¾“å…¥çš„textï¼Œæˆ‘ä»¬ç”¨è¿™æ ·ä¸€ä¸ªæ­£åˆ™å»åŒ¹é…SCHOOL_LISTçš„å­¦æ ¡åç§°ï¼Œæœ€åå°†ä¸€ä¸ªåˆ—è¡¨åˆ·æ–°åˆ°é¡µé¢å…ƒç´ ä¸Šã€‚ æ‰©å±•ç»„ä»¶åŠŸèƒ½1.åœ¨ç§æœ‰é™æ€å˜é‡é‡Œæ·»åŠ å…ƒç´ copy 1var $searchSchoolCopy = $('...çœç•¥...å³ä¸Šé¢é‚£æ®µhtml'); 2.åˆå§‹åŒ–æ–°çš„å…ƒç´  1234567891011121314151617var initSearchSchool = function(instance)&#123; // ç”Ÿæˆå…ƒç´  var $el = $(instance.opts.appendTo).find('.school-box-wrapper'); $el.find('.school-box-header').append($searchSchoolCopy.clone()); // é‡Šæ”¾å˜é‡ $el = null;&#125;;var init = function(instance)&#123; // ä»¥ä¸Šçœç•¥... // é™„åŠ åŠŸèƒ½ if(instance.opts.searchSchool)&#123; initSearchSchool(instance); &#125;&#125;; 3.æœç´¢å­¦æ ¡çš„åŠ¨æ€åˆ·æ–° 1234567891011121314151617181920212223242526272829303132var updateSearchList = function(schools, $searchDiv, $searchList, $searchEmpty)&#123; $searchEmpty.hide(); $searchDiv.show(); $searchList.empty(); for(var i=0; i&lt;schools.length; i++)&#123; $searchList.append('&lt;li class="school-item" data-school="' + schools[i]['id'] + '"&gt;' + schools[i]['name'] + '&lt;/li&gt;'); &#125; // no result hint if(schools.length == 0)&#123; $searchEmpty.show(); &#125;&#125;;var searchSchool = function(keywords, $searchDiv, $searchList, $searchEmpty)&#123; // ä»provincesç¼“å­˜é‡Œæœç´¢ var reg = eval('/' + keywords.split('').join('\\S*') + '/'); var result = []; var schools = []; for(var key in provinces)&#123; schools = provinces[key]['school']; for(var i=0, len=schools.length; i&lt;len; i++)&#123; if(reg.test(schools[i]['name']))&#123; result.push(schools[i]); &#125; &#125; &#125; updateSearchList(result, $searchDiv, $searchList, $searchEmpty);&#125;; è¿™é‡Œé‡‡ç”¨ä¸ä¹‹å‰å®ç°çœä»½-å­¦æ ¡çº§è”åŠŸèƒ½ç±»ä¼¼çš„åŠæ³•ï¼Œç”±äºè¿™äº›æ–¹æ³•å†™æˆäº†ç±»çš„é™æ€ç§æœ‰æ–¹æ³•ï¼ˆå› ä¸ºæˆ‘ä¸æƒ³æŠŠå®ƒä»¬æš´éœ²åˆ°ç±»çš„å¤–é¢ï¼Œä¹Ÿä¸æƒ³è®©æ¯ä¸ªç±»çš„å®ä¾‹éƒ½å­˜æœ‰è¯¥æ–¹æ³•çš„å¤‡ä»½ï¼‰ï¼Œæ‰€ä»¥éœ€è¦æŠŠå…·ä½“å®ä¾‹æ¶‰åŠåˆ°çš„DOMå…ƒç´ ä½œä¸ºå‚æ•°ä¼ åˆ°è¿™äº›æ–¹æ³•ä¸­ã€‚ 4.ä¸ºæœç´¢å­¦æ ¡ç»‘å®šäº‹ä»¶ 123456789101112131415161718192021222324var initSearchSchool = function(instance)&#123; // ç”Ÿæˆå…ƒç´  // çœç•¥... // ç›®æ ‡å…ƒç´  var $searchInput = $el.find('.search-school-input'); var $searchDiv = $el.find('.search-school-div'); var $searchList = $el.find('.search-school-list'); var $searchEmpty = $el.find('.search-school-empty'); // äº‹ä»¶ $searchInput.bind('keyup', function(event)&#123; var keywords = $.trim($(this).val()); // ç©ºæ ¼oræ‹¼éŸ³æ²¡è¾“å®Œæ—¶æš‚ä¸search if(keywords.length == 0 || keywords.indexOf("'") &gt; -1)&#123; $searchDiv.hide(); return false; &#125; searchSchool(keywords, $searchDiv, $searchList, $searchEmpty); &#125;); // ä»¥ä¸‹çœç•¥...&#125;; 5.æœç´¢æ¡†ä¸­é€‰å®šå­¦æ ¡ï¼Œè§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼ˆç»™ç±»çš„å¤–éƒ¨ï¼‰ 1234567891011121314151617181920212223var initSearchSchool = function(instance)&#123; // ä»¥ä¸Šçœç•¥... // é€‰å®šå­¦æ ¡ $searchList.find('li').live('click', function()&#123; // é…ç½®é‡Œå®šä¹‰çš„äº‹ä»¶å›è°ƒ if(instance.opts.schoolClickCallback)&#123; instance.opts.schoolClickCallback.apply(this, []); &#125; // è‡ªå®šä¹‰äº‹ä»¶å›è°ƒ instance.fire('schoolChosen', &#123; schoolId: $(this).attr('data-school'), schoolName: $(this).text() &#125;); // è‡ªåŠ¨æ”¶èµ· instance.hide(); // æ¸…ç©ºæœç´¢å†…å®¹ $searchInput.val(''); $searchDiv.hide(); &#125;); // ä»¥ä¸‹çœç•¥...&#125;; 6.åº”ç”¨å±‚ä½¿ç”¨ç»„ä»¶æ—¶æ·»åŠ ä¸€é¡¹åˆå§‹åŒ–å‚æ•° 1234var schoolBox = new SchoolBox(&#123; appendTo: '#schoolBoxWrapper', searchSchool: true&#125;); è¿™é‡Œé€šè¿‡æœç´¢æ¡†é€‰æ‹©çš„å­¦æ ¡è§¦å‘çš„ä¹Ÿæ˜¯schoolChosenäº‹ä»¶ï¼Œæ‰€ä»¥å¯¹åº”ç”¨å±‚æ¥è¯´æ˜¯é€æ˜çš„ã€‚å³åº”ç”¨å±‚ä¸éœ€è¦çŸ¥é“è¯¥äº‹ä»¶æ¥è‡ªçœä»½-å­¦æ ¡çº§è”ï¼Œè¿˜æ˜¯æ¥è‡ªå­¦æ ¡æœç´¢æ¡†ã€‚ å­¦æ ¡é€‰æ‹©å™¨v5 Demo ç²¾ç›Šæ±‚ç²¾è™½ç„¶ç®€å•å®ç°äº†æœç´¢æ¡†çš„åŠŸèƒ½ï¼Œå…¶å®åªèƒ½ç®—â€œè¿‡æ»¤â€ï¼Œè¿™ä¸ªç³»åˆ—å°±è¦è¿™æ ·ç»“æŸäº†å—ï¼Ÿç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ä¸Šé¢çš„demoæœç´¢æ¡†å‡ºæ¥çš„ç»“æœåªèƒ½ç”¨é¼ æ ‡ç‚¹å‡»ï¼Œä¸æ”¯æŒé”®ç›˜äº‹ä»¶ã€‚è€Œæ ¹æ®æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨åˆ«äººè½¯ä»¶çš„ä¹ æƒ¯ï¼Œç»å¸¸æ˜¯è¾“å…¥å®Œå…³é”®å­—åæŒ‰æ–¹å‘é”®é€‰æ‹©åŒ¹é…çš„é¡¹ï¼Œç„¶åç›´æ¥æŒ‰å›è½¦é”®è¿›å…¥ä¸‹ä¸€æ­¥ã€‚æˆ‘å°†åœ¨ä¸‹ä¸€ç¯‡ä¸­æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(3)]]></title>
    <url>%2Fblog%2F2015%2F01%2Fstep-by-step-js-component-schoolbox-3.html</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬ä½¿ç”¨äº†å°è£…çš„è®¾è®¡æ–¹æ³•ï¼Œå®ç°äº†ä¸€ä¸ªå­¦æ ¡é€‰æ‹©å™¨çš„â€œç±»â€ï¼Œé™ä½äº†é¡µé¢ä¸­ä½¿ç”¨è¯¥åŠŸèƒ½çš„éš¾åº¦ã€‚ä½†åŒæ—¶æˆ‘ä»¬å‘ç°é¡µé¢ä¸­éœ€è¦çš„å›è°ƒéƒ½å¾—å†™åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œè¿™ä½¿å¾—éšç€é¡µé¢åŠŸèƒ½çš„è¿­ä»£ï¼Œå­¦æ ¡é€‰æ‹©å™¨çš„å›è°ƒå‡½æ•°å°†å˜å¾—è¶Šæ¥è¶Šåºå¤§ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªéšæ‚£ï¼Œéœ€è¦è‡ªå®šä¹‰äº‹ä»¶ï¼Œç„¶ååœ¨é¡µé¢ä¸­éœ€è¦ç”¨åˆ°å›è°ƒçš„åœ°æ–¹æ”¹æˆç›‘å¬äº‹ä»¶ã€‚æˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä¸‹è§‚å¯Ÿè€…æ¨¡å¼ã€‚ è§‚å¯Ÿè€…æ¨¡å¼åœ¨ä¹‹å‰çš„javascriptè®¾è®¡æ¨¡å¼ä¸­æœ‰ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼çš„ä¾‹å­ï¼Œåœ¨é‚£ä¸ªä¾‹å­ä¸­çš„è®°å½•äº†äº‹ä»¶ç±»å‹ã€å›è°ƒå‡½æ•°ä»¥åŠå›è°ƒcontextã€‚è¿™é‡Œæˆ‘ä»¬å¯¹å…¶ç®€åŒ–ï¼Œæš‚ä¸è€ƒè™‘å›è°ƒå‡½æ•°çš„contextã€‚ 1.ç”±äºéœ€è¦åœ¨å¯¹è±¡å¤–éƒ¨ç›‘å¬/è®¢é˜…äº‹ä»¶ï¼Œæˆ‘ä»¬åœ¨SchoolBoxçš„prototypeä¸­æ·»åŠ ä¸¤ä¸ªæ–¹æ³•ã€‚ 123456789101112131415161718SchoolBox.prototype = &#123; // ä»¥ä¸Šçœç•¥... on: function(type, handler)&#123; if(typeof this.handlers[type] === 'undefined')&#123; this.handlers[type] = []; &#125; this.handlers[type].push(handler); &#125;, fire: function(type, data)&#123; if(this.handlers[type] instanceof Array)&#123; var handlers = this.handlers[type]; for(var i=0, len=handlers.length; i&lt;len; i++)&#123; handlers[i](data); &#125; &#125; &#125;&#125;; onæ˜¯ç”¨äºç›‘å¬çš„ï¼Œä¾›å¯¹è±¡å¤–éƒ¨ï¼ˆåº”ç”¨å±‚ï¼‰ä½¿ç”¨ã€‚è€Œfireç”¨äºè§¦å‘äº‹ä»¶ï¼Œåœ¨å¯¹è±¡å†…éƒ¨ä½¿ç”¨ã€‚handlersæ˜¯ç”¨æ¥å­˜å‚¨äº‹ä»¶ç±»å‹å’Œå›è°ƒå‡½æ•°çš„ä¸€ä¸ªmapï¼Œå®ƒçš„keyå°±æ˜¯äº‹ä»¶ç±»å‹ï¼Œè€Œvalueæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œé¢å°±æ˜¯ç›‘å¬è¯¥äº‹ä»¶ç±»å‹çš„æ‰€æœ‰å›è°ƒå‡½æ•°ã€‚ 2.è¿™é‡Œçš„handlerséœ€è¦åœ¨å¯¹è±¡æ„é€ çš„æ—¶å€™åˆå§‹åŒ–ï¼Œåœ¨çœŸæ­£çš„æ„é€ å‡½æ•°é‡Œæ·»åŠ ä¸€è¡Œthis.handlers = {};å³å¯ã€‚ 3.è§¦å‘äº‹ä»¶ 123456789$schoolDiv.find('a').live('click', function(event)&#123; // ä»¥ä¸Šçœç•¥... // è‡ªå®šä¹‰äº‹ä»¶å›è°ƒ instance.fire('schoolChosen', &#123; schoolId: $(this).attr('data-school'), schoolName: $(this).text() &#125;);&#125;); 4.åº”ç”¨å±‚ç›‘å¬äº‹ä»¶ 12345schoolBox.on('schoolChosen', function(data)&#123; $schoolInput.val(data.schoolName); $schoolId.val(data.schoolId); $chooseBoxLink.show();&#125;); å­¦æ ¡é€‰æ‹©å™¨v4 Demo è¿˜æœ‰å—ï¼Ÿè§‚å¯Ÿè€…æ¨¡å¼ä¹Ÿå«åšè‡ªå®šä¹‰äº‹ä»¶ï¼Œç°åœ¨SchoolBoxå†…éƒ¨å¯ä»¥è§¦å‘å„ç§äº‹ä»¶ï¼Œè€Œåœ¨åº”ç”¨å±‚é¡µé¢å„éƒ¨åˆ†åªéœ€è¦é€‰æ‹©ç›‘å¬å®ƒéœ€è¦çš„äº‹ä»¶å³å¯ï¼Œè¿™æ ·å°±è§£å†³äº†å…ˆå‰çš„schoolClickCallbackè¿‡å¤§çš„é—®é¢˜ã€‚ é‚£ä¹ˆåˆ°è¿™å„¿å°±ç»“æŸäº†å—ï¼Ÿåœ¨ä¸‹ä¸€ç¯‡ä¸­æˆ‘ä»¬ä¼šæ·»åŠ æœç´¢æ¡†çš„åŠŸèƒ½ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(2)]]></title>
    <url>%2Fblog%2F2015%2F01%2Fstep-by-step-js-component-schoolbox-2.html</url>
    <content type="text"><![CDATA[åœ¨ç¬¬ä¸€ç¯‡ä¸­æˆ‘ä»¬å·²ç»å®ç°äº†å­¦æ ¡é€‰æ‹©å™¨çš„åŸºæœ¬åŠŸèƒ½ï¼Œä½†æ˜¯å½“å…¶ä»–é¡µé¢ä¹Ÿéœ€è¦åŒæ ·çš„åŠŸèƒ½çš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“ç„¶ä¸å¸Œæœ›å¤§æ®µçš„å¤åˆ¶ä»£ç ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé™ä½jså’Œé¡µé¢çš„è€¦åˆï¼Œæä¾›ä¸€ç§æ›´ç®€å•çš„åˆå§‹åŒ–å’Œè°ƒç”¨æ–¹å¼ã€‚ ç›®æ ‡æˆ‘ä»¬å¸Œæœ›åœ¨é¡µé¢ä¸Šåªéœ€è¦å®šä¹‰ä¸€ä¸ªçˆ¶å…ƒç´ ï¼Œç„¶åç›´æ¥newä¸€ä¸ªé€‰æ‹©å™¨å‡ºæ¥å³å¯ã€‚ 123var schoolBox = new SchoolBox(&#123; appendTo: '#schoolBoxWrapper'&#125;); å¹¶ä¸”SchoolBoxåªæš´éœ²ä¸€äº›å¿…è¦çš„ä¾›å¤–ä½¿ç”¨çš„APIï¼Œå¦‚schoolBox.show()ã€schoolBox.hide()ç­‰ã€‚ å°è£…è®¾è®¡æ¨¡å¼ä¸ºäº†å®ç°â€œç®€å•â€çš„ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸‹â€œå°è£…â€ã€‚å…¶å®jsæä¾›äº†éå¸¸å¼±çš„è¯­æ³•èƒ½åŠ›ï¼Œå®ƒæ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œæ²¡æœ‰classçš„æ¦‚å¿µï¼Œæ²¡æœ‰publicå’Œprivateï¼Œä¹Ÿæ²¡æœ‰å‡½æ•°é‡è½½ã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œæ­£æ˜¯å®ƒçš„å¼±è¯­æ³•ï¼Œå®ƒæä¾›äº†æ›´é«˜çš„è‡ªç”±åº¦ï¼Œåˆ©ç”¨å®ƒæœ¬èº«çš„closureå’Œprototypeçš„æœºåˆ¶ï¼Œå®Œå…¨å¯ä»¥æ¨¡æ‹Ÿå‡ºâ€œç±»â€å’Œå…¬æœ‰/ç§æœ‰å±æ€§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546var Book = (function()&#123; // ç§æœ‰é™æ€å±æ€§ var numOfBooks = 0; // ç§æœ‰é™æ€æ–¹æ³• function checkIsbn(isbn)&#123; &#125; // è¿”å›çœŸæ­£çš„æ„é€ å‡½æ•° return function(newIsbn, newTitle, newAuthor)&#123; // ç§æœ‰å±æ€§ var isbn, title, author; // ç‰¹æƒæ–¹æ³•ï¼ˆæ¯ä¸ªå®ä¾‹éƒ½ä¼šæœ‰ä¸€ä¸ªæ–¹æ³•çš„å¤‡ä»½ï¼‰ this.getIsbn = function()&#123; return isbn; &#125;; this.setIsbn = function(newIsbn)&#123; if(!checkIsbn(newIsbn))&#123; throw new Error('Book: ISBNæ— æ•ˆ'); &#125; isbn = newIsbn; &#125;; // æ‰§è¡Œæ„é€  numOfBooks++; if(numOfBooks &gt; 50)&#123; throw new Error('Book: æœ€å¤šåˆ›å»º50ä¸ªå®ä¾‹'); &#125; this.setIsbn(newIsbn); &#125;&#125;)();// å…¬æœ‰é™æ€æ–¹æ³•ï¼ˆç±»çš„é™æ€æ–¹æ³•ï¼‰Book.convertToTitleCase = function(inputString)&#123;&#125;;// å…¬æœ‰éç‰¹æƒæ–¹æ³•ï¼ˆæ¯ä¸ªå®ä¾‹çš„æ–¹æ³•éƒ½æŒ‡å‘åŒä¸€ä¸ªå¤‡ä»½ï¼‰Book.prototype = &#123; display: function()&#123; &#125;&#125;; ç‰¹æƒæ–¹æ³•èƒ½å¤Ÿè®¿é—®ç§æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯å¿…é¡»å£°æ˜åœ¨thisä¸­ã€‚ä»»ä½•ä¸éœ€è¦ç›´æ¥è®¿é—®ç§æœ‰å±æ€§çš„æ–¹æ³•éƒ½å¯ä»¥åœ¨prototypeä¸­å£°æ˜ã€‚prototypeä¸­çš„æ–¹æ³•å¯ä»¥é€šè¿‡è®¿é—®ç‰¹æƒæ–¹æ³•æ¥é—´æ¥è®¿é—®ç§æœ‰å±æ€§ã€‚åªæœ‰é‚£äº›éœ€è¦ç›´æ¥è®¿é—®ç§æœ‰æˆå‘˜çš„æ–¹æ³•æ‰åº”è¯¥è¢«è®¾è®¡ä¸ºç‰¹æƒæ–¹æ³•ï¼Œä½†æ˜¯æ¯ä¸ªå¯¹è±¡å®ä¾‹éƒ½ä¼šåŒ…å«æ‰€æœ‰ç‰¹æƒæ–¹æ³•çš„æ–°å‰¯æœ¬ï¼Œå®¹æ˜“å å†…å­˜ã€‚ SchoolBoxé‡æ„æ ¹æ®ä¸Šé¢çš„å°è£…æ¨¡å¼ï¼Œæˆ‘ä»¬å…ˆæ­å‡ºSchoolBoxçš„æ¡†å­ã€‚ 12345678910111213141516171819202122232425262728293031323334353637(function($)&#123; var SchoolBox = (function()&#123; // å…ƒç´ copy // çœç•¥... // ç¼“å­˜ var provinces = SCHOOL_LIST; // ç§æœ‰é™æ€æ–¹æ³• // çœç•¥... // çœŸæ­£çš„æ„é€ å‡½æ•° return function(options)&#123; // åˆå§‹åŒ–ç‰¹æƒå±æ€§ // åˆå§‹åŒ–ç”Ÿæˆ // çœç•¥... &#125;; &#125;)(); SchoolBox.prototype = &#123; init: function()&#123; &#125;, show: function()&#123; &#125;, hide: function()&#123; &#125; &#125;; // export window.SchoolBox = SchoolBox;&#125;)(jQuery); 1.å°†ç›®æ ‡å…ƒç´ å’Œå…ƒç´ copyå®šä¹‰æˆç§æœ‰é™æ€å±æ€§ 123456789101112var $schoolBoxCopy = $( '&lt;div class="school-box"&gt;' + '&lt;div class="school-box-header"&gt;é€‰æ‹©å­¦æ ¡&lt;/div&gt;' + '&lt;div class="school-box-provinces"&gt;&lt;/div&gt;' + '&lt;div class="school-box-schools"&gt;&lt;/div&gt;' + '&lt;/div&gt;');var $provinceCopy = $('&lt;a href="javascript:void(0)" class="province-item"&gt;&lt;/a&gt;');var $schoolCopy = $('&lt;a href="javascript:void(0)" class="school-item"&gt;&lt;/a&gt;');// éå®ä¾‹åŒ–ç¼“å­˜var provinces = SCHOOL_LIST; 2.å°†åˆå§‹åŒ–provinceå’Œschoolå®šä¹‰æˆç§æœ‰é™æ€æ–¹æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152var getProvinceById = function(pid)&#123; for(var i=0; i&lt;provinces.length; i++)&#123; // NOTE: å‰ç½®æ¡ä»¶province idå¯ä»¥è½¬æˆæ•°å­— if(Number(provinces[i]['id']) == Number(pid))&#123; return provinces[i]; &#125; &#125; return undefined;&#125;;var initProvinces = function($provinceDiv)&#123; for(var i=0; i&lt;provinces.length; i++)&#123; var province = provinces[i]; var $province = $provinceCopy.clone(); $province.attr('data-province', province['id']) .text(province['name']); $provinceDiv.append($province); &#125;&#125;;var initSchools = function($schoolDiv, provinceId)&#123; var province = getProvinceById(provinceId); if(typeof province !== 'undefined')&#123; var schools = province['school']; $schoolDiv.empty(); for(var i=0; i&lt;schools.length; i++)&#123; var school = schools[i]; var $school = $schoolCopy.clone(); $school.attr('data-school', school['id']) .text(school['name']); $schoolDiv.append($school); &#125; &#125; return false;&#125;;var onProvinceClick = function($provinceDiv, $schoolDiv, cache)&#123; cache.lastProvinceIndex = $(this).index(); var pid = $(this).attr('data-province'); if(cache.curProvince != pid)&#123; // set chosen $provinceDiv.find('a[data-province="' + cache.curProvince + '"]').removeClass('chosen'); $provinceDiv.find('a[data-province="' + pid + '"]').addClass('chosen'); // update cache.curProvince = pid; initSchools($schoolDiv, pid); &#125; // æ»šåŠ¨æ¡ç½®é¡¶ $schoolDiv.scrollTop(0);&#125;; æ³¨æ„è¿™é‡Œä¸å…ˆå‰ä¸ä¸€æ ·çš„æ˜¯ï¼Œéœ€è¦æ“ä½œå…ƒç´ çš„æ–¹æ³•ä¸­å¾—æŠŠç›®æ ‡å…ƒç´ ä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼Œè€Œå®ä¾‹åŒ–çš„ç¼“å­˜ï¼ˆå½“å‰é€‰ä¸­çš„provinceï¼‰ä¹Ÿéœ€è¦ä½œä¸ºå¯¹è±¡æŒ‡é’ˆä¼ å…¥ã€‚ 3.åˆå§‹åŒ–æ–¹æ³•åŠæ„é€ å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243var init = function(instance)&#123; // ç”Ÿæˆå…ƒç´  var $parent = $(instance.opts.appendTo); var $el = $('&lt;div class="school-box-wrapper"&gt;&lt;/div&gt;'); $el.append($schoolBoxCopy.clone()); $parent.append($el); // åˆå§‹åŒ–å­¦æ ¡ // NOTE: è¿™é‡Œä¸èƒ½ç”¨$elæ¥findï¼ˆå¦åˆ™live clickå°†å¤±æ•ˆï¼‰ var $provinceDiv = $parent.find('.school-box-provinces'); var $schoolDiv = $parent.find('.school-box-schools'); initProvinces($provinceDiv); // äº‹ä»¶ $provinceDiv.find('a').click(function(event)&#123; onProvinceClick.apply(this, [$provinceDiv, $schoolDiv, instance.cache]); &#125;); // é‡Šæ”¾å˜é‡ // NOTE: $provinceDivå’Œ$schoolDivä¸èƒ½é‡Šæ”¾ï¼Œåœ¨äº‹ä»¶ä¸­è¿˜ç”¨åˆ° $schoolBox = null; $parent = null; $el = null;&#125;;// çœŸæ­£çš„æ„é€ å‡½æ•°return function(options)&#123; // é»˜è®¤é…ç½® this.opts = $.extend(&#123; appendTo: 'body' &#125;, options); // å®ä¾‹åŒ–çš„ç¼“å­˜ this.cache = &#123; curProvince: -1, lastProvinceIndex: 0 //æœ€åä¸€æ¬¡ç‚¹å‡»çš„indexï¼Œç”¨äºåˆå§‹åŒ–é€‰ä¸­ &#125;; // åˆå§‹åŒ–ç”Ÿæˆ init(this);&#125;; 4.åœ¨prototypeä¸­æ·»åŠ å¯¹å¤–API 12345678SchoolBox.prototype = &#123; show: function()&#123; $(this.opts.appendTo).find('.school-box-wrapper').slideDown(); &#125;, hide: function()&#123; $(this.opts.appendTo).find('.school-box-wrapper').slideUp(); &#125;&#125;; 5.æ·»åŠ å­¦æ ¡clickäº‹ä»¶çš„å¤–éƒ¨å›è°ƒï¼Œå°†è¿™ä¸ªå›è°ƒæ”¾åœ¨æ„é€ å‡½æ•°çš„optionsä¸­ 1234567891011121314var init = function(instance)&#123; // ä»¥ä¸Šçœç•¥... $schoolDiv.find('a').live('click', function(event)&#123; // é…ç½®é‡Œå®šä¹‰çš„äº‹ä»¶å›è°ƒ if(instance.opts.schoolClickCallback)&#123; instance.opts.schoolClickCallback.apply(this, []); &#125; // è‡ªåŠ¨æ”¶èµ· instance.hide(); &#125;); // ä»¥ä¸‹çœç•¥...&#125;; 6.ç‚¹ç¼€ä¸‹ï¼Œåˆå§‹åŒ–SchoolBoxæ—¶é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªprovinceï¼Œå¹¶å¯¹å¤–æä¾›initæ–¹æ³• 12345678910111213141516var SchoolBox = (function()&#123; // ä»¥ä¸Šçœç•¥... // çœŸæ­£çš„æ„é€ å‡½æ•° return function(options)&#123; // ä»¥ä¸Šçœç•¥... // åˆå§‹åŒ–ç”Ÿæˆ init(this); this.init(); &#125;;&#125;)();SchoolBox.prototype.init = function()&#123; $(this.opts.appendTo).find('.school-box-provinces').find('a').first().click();&#125;; 7.åº”ç”¨å±‚è°ƒç”¨ 12345678910111213141516171819202122// ç›®æ ‡å…ƒç´ var $schoolInput = $('#schoolInput');var $schoolId = $('#schoolId');var $chooseBoxLink = $('#openSchoolBoxLink');// å®ä¾‹åŒ–å¯¹è±¡var schoolBox = new SchoolBox(&#123; appendTo: '#schoolBoxWrapper', schoolClickCallback: function()&#123; // NOTE: è¿™é‡Œè¢«è°ƒç”¨æ—¶thisæŒ‡å‘äº‹ä»¶è§¦å‘çš„å…ƒç´  $schoolInput.val($(this).text()); $schoolId.val($(this).attr('data-school')); // åŠ¨ç”» $chooseBoxLink.show(); &#125;&#125;);// bind event$chooseBoxLink.click(function()&#123; schoolBox.show(); $(this).hide();&#125;); å­¦æ ¡é€‰æ‹©å™¨v3 Demo åˆ°æ­¤ä¸ºæ­¢ï¼Ÿåˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å°†å­¦æ ¡é€‰æ‹©å™¨çš„åŸºæœ¬åŠŸèƒ½å°è£…æˆäº†ä¸€ä¸ªâ€œç±»â€ï¼Œå…·ä½“é¡µé¢ä½¿ç”¨æ—¶ï¼Œåªéœ€è¦å®šä¹‰å®ƒè¢«åŒ…è£¹çš„çˆ¶å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥newä¸€ä¸ªå¯¹è±¡å‡ºæ¥ï¼Œå¹¶åœ¨æ„é€ æ—¶çš„é…ç½®å˜é‡é‡Œå®šä¹‰äº‹ä»¶å›è°ƒã€‚è™½ç„¶å¤§ä½“ä¸Šå®ç°äº†æœ¬æ–‡ä¸€å¼€å§‹çš„ç›®æ ‡ï¼Œä½†æ˜¯ä»…ä»…å®ç°äº†åŸºæœ¬çš„çº§è”åŠŸèƒ½ï¼Œè€Œä¸”åªèƒ½å®šä¹‰ä¸€ä¸ªäº‹ä»¶å›è°ƒã€‚å¦‚æœé¡µé¢æœ‰å¤šä¸ªå…ƒç´ éƒ½éœ€è¦æ ¹æ®é€‰ä¸­çš„å­¦æ ¡è¿›è¡Œä¸€äº›æ”¹å˜ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç éƒ½å¾—å†™åœ¨schoolClickCallbackä¸­ï¼Œè¿™éƒ¨åˆ†ä»£ç å¯èƒ½æ“ä½œç€æ¥è‡ªé¡µé¢ä¸åŒéƒ¨åˆ†çš„å…ƒç´ ï¼ˆç”šè‡³æ˜¯å…¶ä»–ç»„ä»¶ï¼‰ï¼Œè¿™æ ·å°±ä¼šé€ æˆä¸€äº›è€¦åˆã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æ­¥æ­¥åšç»„ä»¶-å­¦æ ¡é€‰æ‹©å™¨(1)]]></title>
    <url>%2Fblog%2F2015%2F01%2Fstep-by-step-js-component-schoolbox-1.html</url>
    <content type="text"><![CDATA[å¼€ç¯‡è¿™å­¦æœŸæ¥ä¸€ç›´åœ¨å¿™é¡¹ç›®ï¼Œæ•´æ•´ä¸€ä¸ªå­¦æœŸéƒ½åœ¨åšï¼Œè‡ªå·±çš„çœ‹ä¹¦è®¡åˆ’ä¹Ÿæ²¡èƒ½å®æ–½ã€‚ä¸è¿‡è¿˜æ˜¯æœ‰ä¸å°‘æ”¶è·çš„ï¼Œæ˜¯å¯¹ä»¥å‰çœ‹è¿‡çš„ JS Patterns ç³»åˆ—çš„ç»¼åˆè¿ç”¨ï¼Œæ‰€ä»¥å…‰çœ‹æ˜¯ä¸å¤Ÿçš„ï¼Œä¸€å®šè¦èƒ½åº”ç”¨åˆ°å®é™…çš„ä¸šåŠ¡ä¸­ï¼Œå¹¶æ ¹æ®å…·ä½“ä¸šåŠ¡ç›¸åº”è°ƒæ•´ã€‚è¶ç€ç°åœ¨è¿™æ®µæ—¶é—´ï¼Œæƒ³æŠŠä»¥å‰å†™è¿‡çš„ä»£ç é‡æ–°reviewä¸€éï¼Œå¹¶æŠ½å‡ºå¯å¤ç”¨çš„åŠŸèƒ½æŠŠå®ƒä»¬æ”¹å†™æˆé€šç”¨ç»„ä»¶ï¼Œæ—¢æ˜¯è‡ªå·±æ€»ç»“å’Œæå‡çš„æœºä¼šï¼Œä¹ŸæŠŠå®ƒä»¬ä½œä¸ºä»¥åçš„ä»£ç ç§¯ç´¯ã€‚ æœ€è¿‘è¿™ä¸ªé¡¹ç›®æ˜¯åšåœ¨çº¿ç¼–ç¨‹æ•™è‚²çš„ï¼Œæ—¢ç„¶æ˜¯æ•™è‚²ï¼Œå½“ç„¶ä¼šè·Ÿå­¦æ ¡æŒ‚é’©ï¼Œæ‰€ä»¥æ³¨å†Œçš„æ—¶å€™å°±æ¶‰åŠåˆ°å­¦æ ¡é€‰æ‹©ã€‚æˆ‘å°±ä»è¿™é‡Œå…¥æ‰‹ï¼Œè®²è¿°ä¸‹å¦‚ä½•ä¸€æ­¥æ­¥åšæˆå­¦æ ¡é€‰æ‹©å™¨çš„jsç»„ä»¶ã€‚ ç•Œé¢è®¾è®¡ç”±äºæœ¬äººè®¾è®¡èƒ½åŠ›æ‹™åŠ£ï¼Œæ‰€ä»¥å·æ‡’ç›´æ¥å‚è€ƒäº†äººäººç½‘é‡Œçš„å­¦æ ¡é€‰æ‹©å™¨çš„ç”»é£ã€‚ æˆ‘ä»¬è¿™é‡Œåªåšäº†å›½å†…çš„é«˜æ ¡ï¼Œæ¯”äººäººç½‘å°‘ä¸€å±‚ï¼Œå…ˆä»ç®€ï¼Œå®šä¹‰äº†ä¸‹é¢çš„å…ƒç´ ã€‚ 123456789101112&lt;div class="school-box-wrapper"&gt; &lt;div class="school-box"&gt; &lt;div class="school-box-header"&gt;é€‰æ‹©å­¦æ ¡&lt;/div&gt; &lt;div class="school-box-provinces"&gt; &lt;a href="javascript:void(0)" class="province-item" data-province="1"&gt;æ±Ÿè‹&lt;/a&gt; &lt;/div&gt; &lt;div class="school-box-schools"&gt; &lt;a href="javascript:void(0)" class="school-item" data-school="10284"&gt;å—äº¬å¤§å­¦&lt;/a&gt; &lt;a href="javascript:void(0)" class="school-item" data-school="10286"&gt;ä¸œå—å¤§å­¦&lt;/a&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; æˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰å±æ€§data-xxxæ¥å­˜å‚¨IDï¼Œè¿™é‡Œçš„å­¦æ ¡IDé‡‡ç”¨çš„æ˜¯æ•™è‚²éƒ¨æ ‡å‡†çš„å­¦æ ¡ä»£ç ï¼Œè€Œçœä»½IDæ— å®é™…å«ä¹‰ã€‚å‚ç…§ä¸Šé¢çš„å›¾ï¼Œå†™å‡ºäº†ä»¥ä¸‹æ ·å¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657.school-box-wrapper&#123; margin: 10px 0;&#125;.school-box&#123; background-color: white; border: 1px solid #005EAC; width: 650px;&#125;.school-box-header&#123; background: #3777BC; color: white; font-size: 14px; font-weight: bold; padding: 5px 10px;&#125;.school-box-provinces,.school-box-schools&#123; border: 1px solid #C3C3C3; margin: 5px 10px 10px 10px;&#125;.school-box-schools&#123; height: 200px; overflow-x: hidden; overflow-y: auto;&#125;.school-box-provinces a,.school-box-schools a&#123; color: #005EAC; cursor: pointer; display: inline-block; font-size: 12px; height: 18px; line-height: 18px; text-decoration: none;&#125;.school-box-provinces a&#123; margin: 2px 5px; padding: 1px;&#125;.school-box-provinces a:hover&#123; text-decoration: underline;&#125;.school-box-provinces a.chosen&#123; background-color: #005EAC; color: white;&#125;.school-box-schools a&#123; margin: 4px 12px; overflow: hidden; padding-left: 10px; width: 160px;&#125;.school-box-schools a:hover&#123; background-color: #005EAC; color: white;&#125; å¤§ä½“æ•ˆæœå¦‚å›¾ï¼Œä¾æ ·ç”»è‘«èŠ¦è¿˜å‡‘åˆå§ã€‚ å­¦æ ¡é€‰æ‹©å™¨v1 Demo å­¦æ ¡æ•°æ®å­˜å‚¨ä¸Šé¢çš„demoä¸­å­¦æ ¡æ˜¯hard codeåˆ°å…ƒç´ ä¸­çš„ï¼Œä½†å®é™…ä¸Šä¸å¯èƒ½è¿™æ ·åšã€‚æˆ‘ä»¬éœ€è¦å®šä¹‰schoolçš„æ•°æ®æ ¼å¼ã€‚ 123456789101112[ &#123; "id": 1, "name": "åŒ—äº¬", "school": [ &#123; "id": 10001, "name": "åŒ—äº¬å¤§å­¦" &#125; ] &#125;] äºæ˜¯æˆ‘ä»¬å°†æŠ“æ¥çš„æ‰€æœ‰å­¦æ ¡æ•°æ®ç”Ÿæˆä¸€ä¸ªJSONå¯¹è±¡æ”¾åœ¨å…¨å±€ä¸­ã€‚å­¦æ ¡åˆ—è¡¨.js çœä»½-å­¦æ ¡ çº§è”é¦–å…ˆå®šä¹‰ç›®æ ‡å…ƒç´ ï¼Œprovinceå’ŒschoolåŒºåŸŸçš„çˆ¶å…ƒç´ ï¼Œä»¥åŠprovinceå’Œschoolå…ƒç´ çš„copyï¼ˆçœå¾—åŠ¨æ€ç”Ÿæˆå…ƒç´ æ—¶å†™HTMLäº†ï¼‰ã€‚ 12345var $provinceDiv = $('.school-box-provinces');var $schoolDiv = $('.school-box-schools');var $provinceCopy = $('&lt;a href="javascript:void(0)" class="province-item"&gt;&lt;/a&gt;');var $schoolCopy = $('&lt;a href="javascript:void(0)" class="school-item"&gt;&lt;/a&gt;'); å…¶æ¬¡ï¼Œè¦å®šä¹‰å˜é‡å°†å½“å‰é€‰ä¸­çš„provinceå­˜èµ·æ¥ï¼Œæˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªå˜é‡æŒ‡å‘å…¨å±€çš„SCHOOL_LISTã€‚ 12var provinces = SCHOOL_LIST;var curProvince = -1; //province id 1.å¼€å§‹å†™åˆå§‹åŒ–provinceåŒºåŸŸçš„ä»£ç ã€‚ 123456789var initProvinces = function()&#123; for(var i=0; i&lt;provinces.length; i++)&#123; var province = provinces[i]; var $province = $provinceCopy.clone(); $province.attr('data-province', province['id']) .text(province['name']); $provinceDiv.append($province); &#125;&#125;; 2.åˆå§‹åŒ–å­¦æ ¡ï¼Œå½“ç„¶è¦æ ¹æ®ä¼ å…¥çš„provinceIdã€‚ 1234567891011121314151617181920212223242526var getProvinceById = function(pid)&#123; for(var i=0; i&lt;provinces.length; i++)&#123; // NOTE: å‰ç½®æ¡ä»¶province idå¯ä»¥è½¬æˆæ•°å­— if(Number(provinces[i]['id']) == Number(pid))&#123; return provinces[i]; &#125; &#125; return undefined;&#125;;var initSchools = function(provinceId)&#123; var province = getProvinceById(provinceId); if(typeof province !== 'undefined')&#123; var schools = province['school']; $schoolDiv.empty(); for(var i=0; i&lt;schools.length; i++)&#123; var school = schools[i]; var $school = $schoolCopy.clone(); $school.attr('data-school', school['id']) .text(school['name']); $schoolDiv.append($school); &#125; &#125; return false;&#125;; 3.ä¸ºprovinceç»‘å®šclickäº‹ä»¶ï¼Œè¿™æ ·å°±èƒ½çº§è”èµ·æ¥ã€‚ 123456789101112var onProvinceClick = function()&#123; var pid = $(this).attr('data-province'); if(curProvince != pid)&#123; // set chosen $provinceDiv.find('a[data-province="' + curProvince + '"]').removeClass('chosen'); $provinceDiv.find('a[data-province="' + pid + '"]').addClass('chosen'); // update curProvince = pid; initSchools(pid); &#125;&#125;; 4.åŒæ ·ä¸ºschoolæ·»åŠ clickï¼Œè¿˜éœ€è¦å®šä¹‰ä¸¤ä¸ªè¡¨å•é‡Œçš„å…ƒç´ ã€‚ 1234567var $schoolInput = $('#schoolInput');var $schoolId = $('#schoolId');var onSchoolClick = function()&#123; $schoolInput.val($(this).text()); $schoolId.val($(this).attr('data-school'));&#125;; 5.æ·»åŠ åŠ¨ç”»ä»¥åŠç»Ÿä¸€åˆå§‹åŒ–æ–¹æ³• 1234567891011121314151617181920212223var $schoolBox = $('.school-box-wrapper');var $schoolBoxLink = $('#openSchoolBoxLink');var hideSchoolBox = function()&#123; $schoolBox.slideUp(); $schoolBoxLink.show();&#125;;var showSchoolBox = function()&#123; $schoolBox.slideDown(); $schoolBoxLink.hide();&#125;;var init = function()&#123; initProvinces(); // bind events $provinceDiv.find('a').click(onProvinceClick); // ç”±äºschoolå…ƒç´ æ˜¯åŠ¨æ€æ”¹å˜çš„ï¼Œè¿™é‡Œä¸€å®šè¦é€šè¿‡liveå»ç»‘å®š $schoolDiv.find('a').live('click', onSchoolClick); $schoolBoxLink.click(showSchoolBox); // execute showSchoolBox();&#125;; 6.æœ€åä¸ºäº†é¿å…å˜é‡ä½œç”¨åŸŸçš„æ±¡æŸ“ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼Œå»åŒ…è£¹ä»¥ä¸Šæ‰€æœ‰jsä»£ç ã€‚ 123456(function()&#123; // ä»¥ä¸Šçœç•¥... // æ‰§è¡Œåˆå§‹åŒ– return init();&#125;)(); 7.æ·»åŠ ä¸‹ç‚¹ç¼€ï¼Œè®©å®ƒæ¯æ¬¡showSchoolBoxæ—¶éƒ½èƒ½è‡ªå®šé€‰ä¸­å‰ä¸€æ¬¡é€‰æ‹©çš„provinceã€‚ 1234567891011121314151617var lastProvinceIndex = 0; //æœ€åä¸€æ¬¡ç‚¹å‡»çš„indexï¼Œç”¨äºåˆå§‹åŒ–é€‰ä¸­var onProvinceClick = function()&#123; lastProvinceIndex = $(this).index(); // ä¸­é—´çœç•¥... // æ»šåŠ¨æ¡ç½®é¡¶ $schoolDiv.scrollTop(0);&#125;;var showSchoolBox = function()&#123; // ä»¥ä¸Šçœç•¥... // é»˜è®¤é€‰ä¸­æœ€åä¸€æ¬¡ç‚¹å‡»çš„province $provinceDiv.find('a').eq(lastProvinceIndex).click();&#125;; å­¦æ ¡é€‰æ‹©å™¨v2 Demo è¿˜æœ‰å—ï¼Ÿåˆ°è¿™é‡Œä¸€ä¸ªç®€å•çš„demoå®Œæˆäº†ï¼Œä½†æ˜¯jsä»£ç å’Œå½“å‰é¡µé¢çš„HTMLå…ƒç´ è€¦åˆå¾ˆå¤§ï¼Œå¦‚æœæ”¹äº†HTMLåˆ™jsä¹Ÿè¦ç›¸åº”çš„æ”¹ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœåœ¨å¦ä¸€ä¸ªé¡µé¢ä¹Ÿéœ€è¦è¿™æ ·çš„å­¦æ ¡é€‰æ‹©å™¨è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¤åˆ¶å¤§æ®µä»£ç å—ï¼Ÿ]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>webç»„ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹ä¸ƒ-æµè§ˆå™¨æ¨¡å¼]]></title>
    <url>%2Fblog%2F2014%2F12%2Fjs-pattern-part7-browser-pattern.html</url>
    <content type="text"><![CDATA[å…³æ³¨åˆ†ç¦»HTMLã€CSSã€JSç›¸äº’ç‹¬ç«‹ï¼Œä¸è¦ä½¿ç”¨å†…è”å¤„ç†å™¨ï¼ˆonclickä¹‹ç±»ï¼‰å’Œå†…è”æ ·å¼å±æ€§ï¼ˆstyleå±æ€§ï¼‰ï¼Œå› ä¸ºè¿™äº›éƒ½ä¸å±äºå†…å®¹å±‚ã€‚jsåº”è¯¥æ˜¯ç”¨æ¥åŠ å¼ºç½‘é¡µåŠŸèƒ½ï¼Œè€Œä¸èƒ½ç§°ä¸ºç½‘é¡µæ­£å¸¸å·¥ä½œçš„å¿…éœ€ç»„ä»¶ã€‚ ä¸è¦ä½¿ç”¨ç”¨æˆ·ä»£ç†æ¥å—…æ¢ä»£ç è·¯å¾„ï¼Œè€Œåº”è¯¥åœ¨è¿è¡Œç¯å¢ƒä¸­æ£€æŸ¥æ˜¯å¦æœ‰æ‰€éœ€çš„å±æ€§æˆ–æ–¹æ³•ã€‚ 1234567891011121314// åæ¨¡å¼if(navigator.userAgent.indexOf('MSIE') !== -1)&#123; document.attachEvent('onclick', console.log);&#125;// æ¯”è¾ƒå¥½çš„åšæ³•if(document.attachEvent)&#123; document.attachEvent('onclick', console.log);&#125;// æ›´å…·ä½“çš„åšæ³•if(typeof document.attachEvent !== 'undefined')&#123; document.attachEvent('onclick', console.log);&#125; DOMè„šæœ¬DOMè®¿é—®çš„ä»£ä»·æ˜¯æ˜‚è´µçš„ï¼Œå®ƒæ˜¯åˆ¶çº¦jsæ€§èƒ½çš„ä¸»è¦ç“¶é¢ˆï¼Œè¿™æ˜¯å› ä¸ºDOMé€šå¸¸æ˜¯ç‹¬ç«‹äºjså¼•æ“è€Œå®ç°çš„ã€‚æ€»ä¹‹ï¼ŒDOMçš„è®¿é—®åº”è¯¥å‡å°‘åˆ°æœ€ä½ï¼Œè¿™æ„å‘³ç€ï¼š é¿å…åœ¨å¾ªç¯ä¸­ä½¿ç”¨DOMè®¿é—® å°†DOMå¼•ç”¨åˆ†é…ç»™å±€éƒ¨å˜é‡ï¼Œå¹¶ä½¿ç”¨è¿™äº›å±€éƒ¨å˜é‡ åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨selector APIï¼ˆIE8ä»¥åéƒ½æ”¯æŒï¼‰ å½“åœ¨HTMLå®¹å™¨ä¸­é‡å¤ä½¿ç”¨æ—¶ï¼Œç¼“å­˜é‡å¤çš„æ¬¡æ•° example. 1234567891011// åæ¨¡å¼for(var i=0; i&lt;100; i++)&#123; document.getElementById('result').innerHTML += (i + ' , ');&#125;// æ›´å¥½çš„æ–¹å¼ï¼Œä½¿ç”¨äº†å±€éƒ¨ä¾¿åˆ©äº†var i, content = '';for(i=0; i&lt;100; i++)&#123; content += (i + ' , ');&#125;document.getElementById('result').innerHTML += content; ä¸ºç»å¸¸è®¿é—®çš„å…ƒç´ å¢åŠ idå±æ€§æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ï¼Œå› ä¸ºdocument.getElementById(myId)æ˜¯æœ€ç®€å•å¿«æ·æŸ¥æ‰¾èŠ‚ç‚¹çš„æ–¹æ³•ã€‚ é™¤äº†è®¿é—®DOMå…ƒç´ ä»¥å¤–ï¼Œå¯¹å…ƒç´ çš„å¢åˆ æ”¹ä¹Ÿå¾ˆé¢‘ç¹ã€‚æ›´æ–°DOMä¼šå¯¼è‡´æµè§ˆå™¨é‡æ–°ç»˜åˆ¶å±å¹•ï¼Œä¹Ÿä¼šç»å¸¸å¯¼è‡´reflowï¼ˆä¹Ÿå°±æ˜¯é‡æ–°è®¡ç®—å…ƒç´ çš„å‡ ä½•ä½ç½®ï¼‰ï¼Œè¿™æ ·ä¼šå¸¦æ¥å·¨å¤§çš„å¼€é”€ã€‚ 1. æ·»åŠ èŠ‚ç‚¹æ—¶ï¼Œä½¿ç”¨æ–‡æ¡£ç¢ç‰‡ï¼ˆdocument fragmentï¼‰ 1234567891011121314var p, t;var frag = document.createDocumentFragment();p = document.createElement('p');t = document.createTextNode('first paragraph');p.appendChild(t);frag.appendChild(p);p = document.createElement('p');t = document.createTextNode('second paragraph');p.appendChild(t);frag.appendChild(p);document.body.appendChild(frag); // åªè§¦å‘ä¸€æ¬¡å±å¹•é‡ç»˜ 2. æ›´æ–°èŠ‚ç‚¹æ—¶ï¼Œä½¿ç”¨å…‹éš†é•œåƒ 1234567var oldNode = document.getElementById('result');var clone = oldNode.cloneNode(true);// å¤„ç†å…‹éš†å¯¹è±¡...// æ›´æ–°åˆ°DOMoldNode.parentNode.replaceChild(clone, oldNode); // åªè§¦å‘ä¸€æ¬¡é‡ç»˜ äº‹ä»¶å§”æ‰˜äº‹ä»¶å§”æ‰˜æ¨¡å¼å¾—ç›Šäºäº‹ä»¶å†’æ³¡ï¼Œä¼šå‡å°‘ä¸ºæ¯ä¸ªèŠ‚ç‚¹é™„åŠ çš„äº‹ä»¶ç›‘å¬å™¨æ•°é‡ã€‚å¦‚æœåœ¨divå…ƒç´ ä¸­æœ‰10ä¸ªæŒ‰é’®ï¼Œåªéœ€è¦ä¸ºè¯¥divå…ƒç´ é™„åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨å°±å¯ä»¥å®ç°ä¸ºæ¯ä¸ªæŒ‰é’®åˆ†åˆ«é™„åŠ ä¸€ä¸ªç›‘å¬å™¨çš„æ•ˆæœã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142function myHandler(e) &#123; var src, parts; // è·å–äº‹ä»¶å’Œæºå…ƒç´  e = e || window.event; src = e.target || e.srcElement; // è¿‡æ»¤ä¸æ„Ÿå…´è¶£çš„äº‹ä»¶æº if (src.nodeName.toLowerCase() !== 'button') &#123; return; &#125; // å®é™…å·¥ä½œï¼šæ›´æ–°æ ‡ç­¾ parts = src.innerHTML.split(": "); parts[1] = parseInt(parts[1], 10) + 1; src.innerHTML = parts[0] + ": " + parts[1]; // æ— å†’æ³¡ if (typeof e.stopPropagation === "function") &#123; e.stopPropagation(); &#125; if (typeof e.cancelBubble !== 'undefined') &#123; e.cancelBubble = true; &#125; // é˜»æ­¢é»˜è®¤æ“ä½œ if (typeof e.preventDefault === "function") &#123; e.preventDefault(); &#125; if (typeof e.returnValue !== 'undefined') &#123; e.returnValue = false; &#125;&#125;// äº‹ä»¶ç»‘å®švar el = document.getElementById('click-wrap');if (document.addEventListener) &#123; // W3C el.addEventListener('click', myHandler, false);&#125; else if (document.attachEvent) &#123; // IE el.attachEvent('click', myHandler);&#125; else &#123; // ç»ˆææ‰‹æ®µ el.onclick = myHandler;&#125; äº‹ä»¶å§”æ‰˜çš„ç¼ºç‚¹åœ¨äºå¦‚æœç¢°å·§æ²¡æœ‰æ„Ÿå…´è¶£çš„äº‹ä»¶å‘ç”Ÿï¼Œé‚£ä¹ˆå¢åŠ çš„å°éƒ¨åˆ†ä»£ç å°±æ˜¾å¾—æ²¡ç”¨äº†ã€‚ YUI3ä¸­æœ‰ä¸€ä¸ªY.delegate()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æŒ‡å®šä¸€ä¸ªCSSé€‰æ‹©å™¨æ¥åŒ¹é…å°è£…ï¼Œå¹¶ä½¿ç”¨å¦å¤–ä¸€ä¸ªé€‰æ‹©å™¨æ¥åŒ¹é…æ„Ÿå…´è¶£çš„èŠ‚ç‚¹ã€‚è¿™æ˜¯ååˆ†æ–¹ä¾¿çš„ï¼Œå› ä¸ºå½“äº‹ä»¶åœ¨å…³æ³¨çš„èŠ‚ç‚¹ä¹‹å¤–å‘ç”Ÿæ—¶ï¼Œå›è°ƒå‡½æ•°å®é™…ä¸Šå¹¶æ²¡æœ‰è¢«è°ƒç”¨ã€‚ 123456789101112function myHandler(e) &#123; var src = e.target; var parts = src.get('innerHTML').split(": "); parts[1] = parseInt(parts[1], 10) + 1; src.set('innerHTML', parts[0] + ": " + parts[1]); e.halt();&#125;YUI().use("event-delegate", function (Y) &#123; Y.delegate('click', myHandler, "#click-wrap", "button");&#125;); åŒæ ·ï¼ŒjQueryä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„æ¥å£ã€‚$(selector).delegate(childSelector,event,data,function)å‚è§http://www.w3school.com.cn/jquery/event_delegate.asp é•¿æœŸè¿è¡Œè„šæœ¬å¯èƒ½ä¼šæ³¨æ„åˆ°æœ‰æ—¶å€™æµè§ˆå™¨ä¼šæç¤ºæŸä¸ªè„šæœ¬å·²ç»è¿è¡Œäº†å¾ˆé•¿æ—¶é—´ï¼Œæ˜¯å¦åº”è¯¥åœæ­¢è„šæœ¬ã€‚å®é™…ä¸Šæ— è®ºè¦å¤„ç†å¤šä¹ˆå¤æ‚çš„ä»»åŠ¡ï¼Œéƒ½ä¸å¸Œæœ›åº”ç”¨ç¨‹åºå‘ç”Ÿä¸Šè¿°äº‹æƒ…ã€‚è€Œä¸”ï¼Œå¦‚æœè¯¥è„šæœ¬çš„å·¥ä½œååˆ†ç¹é‡ï¼Œé‚£ä¹ˆæµè§ˆå™¨çš„UIå°†ä¼šæ— æ³•å“åº”ç”¨æˆ·çš„ä»»ä½•æ“ä½œï¼Œåº”è¯¥å°½é‡é¿å…ã€‚ åœ¨jsä¸­æ²¡æœ‰çº¿ç¨‹ï¼Œä½†æ˜¯å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨setTimeout()æ¥æ¨¡æ‹Ÿçº¿ç¨‹ã€‚è¿™æ ·åšçš„æ€æƒ³æ˜¯å°†ä¸€ä¸ªå¤§ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªå°ä»»åŠ¡ï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªå°ä»»åŠ¡è®¾ç½®timeoutä¸º1æ¯«ç§’ã€‚è™½ç„¶è¿™æ ·ä¼šå¯¼è‡´å®Œæˆæ•´ä¸ªä»»åŠ¡éœ€è¦è€—è´¹æ›´é•¿çš„æ—¶é—´ï¼Œä½†æ˜¯é€šè¿‡è¿™æ ·åšï¼Œå¯ä»¥ä½¿å¾—ç”¨æˆ·æ¥å£ä¿æŒå“åº”ï¼Œç”¨æˆ·ä½“éªŒè¾ƒå¥½ã€‚ æ³¨æ„ï¼Œtimeoutæ—¶é—´è®¾ç½®ä¸º1æ¯«ç§’ï¼ˆæˆ–è€…0æ¯«ç§’ï¼‰å®é™…ä¸Šæ˜¯ä¸æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿæœ‰å…³çš„ã€‚0æ¯«ç§’ä¸æ„å‘³ç€æ²¡æœ‰timeoutï¼Œè€Œæ˜¯æŒ‡å°½å¯èƒ½å¿«çš„å¤„ç†ã€‚ä¾‹å¦‚åœ¨IEä¸­ï¼Œæœ€å¿«çš„æ—¶é’Ÿå‘¨æœŸæ˜¯15æ¯«ç§’ã€‚ æœ€è¿‘çš„æµè§ˆå™¨ä¸ºé•¿æœŸè¿è¡Œçš„è„šæœ¬æä¾›äº†å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šWeb Workersã€‚å®ƒä¸ºæµè§ˆå™¨æä¾›äº†èƒŒæ™¯çº¿ç¨‹æ”¯æŒï¼Œå¯ä»¥å°†ä»»åŠ¡æ¯”è¾ƒç¹é‡çš„è®¡ç®—æ”¾åœ¨å•ç‹¬ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä»ä¸»ç¨‹åºï¼ˆç½‘é¡µï¼‰ä¸­è°ƒç”¨è¯¥æ–‡ä»¶ã€‚ è¿œç¨‹è„šæœ¬XMLHttpRequestXMLHttpRequestæ˜¯ä¸€ä¸ªåœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­éƒ½æ”¯æŒçš„ç‰¹æ®Šå¯¹è±¡ã€‚å»ºç«‹ä¸€ä¸ªHTTPè¯·æ±‚åˆ†ä¸ºå¦‚ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š å»ºç«‹ä¸€ä¸ªXMLHttpRequestå¯¹è±¡ï¼ˆç®€å†™ä¸ºXHRï¼‰ æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å‘ŠçŸ¥è¯·æ±‚å¯¹è±¡æ”¹å˜çŠ¶æ€ å‘é€è¯·æ±‚ ä½†æ˜¯åœ¨IE 7.0ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒXHRåŠŸèƒ½æ€§æ˜¯ä»¥ActiveXå¯¹è±¡çš„æ–¹å¼å®ç°çš„ï¼Œå› æ­¤å¯¹äºé‚£äº›ç‰ˆæœ¬éœ€è¦åšä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚ 12345678910111213141516171819202122232425262728293031var xhr;var activeXids = [ 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP', 'Microsoft.XMLHTTP'];if (typeof XMLHttpRequest === "function") &#123; // åŸç”ŸXHR xhr = new XMLHttpRequest(); &#125; else &#123; // IE 7.0ä¹‹å‰ç‰ˆæœ¬ for (var i = 0; i &lt; activeXids.length; i += 1) &#123; try &#123; xhr = new ActiveXObject(activeXids[i]); break; &#125; catch (e) &#123;&#125; &#125;&#125;xhr.onreadystatechange = function () &#123; if (xhr.readyState !== 4) &#123; return false; &#125; if (xhr.status !== 200) &#123; alert("Error, status code: " + xhr.status); return false; &#125; document.body.innerHTML += "&lt;pre&gt;" + xhr.responseText + "&lt;\/pre&gt;";&#125;;xhr.open("GET", "page.html", true);xhr.send(""); JSONPJSONPï¼ˆJSON with Paddingï¼‰æ˜¯å¦å¤–ä¸€ç§åˆ›å»ºè¿œç¨‹è¯·æ±‚çš„æ–¹æ³•ã€‚å’ŒXHRæœ‰æ‰€ä¸åŒï¼Œå®ƒä¸å—åŒä¸€ä¸ªåŸŸæµè§ˆå™¨ç­–ç•¥çš„é™åˆ¶ï¼Œå‡ºäºä»ç¬¬ä¸‰æ–¹ç½‘ç«™è½½å…¥æ•°æ®çš„å®‰å…¨è€ƒè™‘ï¼Œéœ€è¦å°å¿ƒä½¿ç”¨ã€‚ å¯¹åº”äºXHRè¯·æ±‚ï¼ŒJSONPçš„è¯·æ±‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ–‡æ¡£ï¼š XMLæ–‡æ¡£ï¼ˆè¿‡å»å¸¸ç”¨ï¼‰ HTMLå—ï¼ˆç°åœ¨ååˆ†å¸¸è§ï¼‰ JSONæ•°æ®ï¼ˆè½»é‡çº§ï¼Œæ–¹ä¾¿ï¼‰ ç®€å•æ–‡æœ¬æ–‡ä»¶æˆ–è€…å…¶ä»–æ–‡æ¡£ å¯¹äºJSONPï¼Œæœ€å¸¸è§çš„æ˜¯ç”¨å‡½æ•°è°ƒç”¨å°è£…çš„JSONï¼Œå‡½æ•°åç”±è¯·æ±‚æ–¹æä¾›ã€‚JSONPè¯·æ±‚çš„URLé€šå¸¸æ ¼å¼å¦‚ï¼Œhttp://example.org/getdata.php?callback=myHandlergetdata.phpå¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„ç½‘é¡µï¼Œcallbackå‚æ•°æŒ‡å®šé‡‡ç”¨å“ªä¸ªjså‡½æ•°æ¥å¤„ç†è¯¥è¯·æ±‚çš„è¿”å›å€¼ã€‚ ç„¶ååƒè¿™æ ·å°†URLè½½å…¥åˆ°åŠ¨æ€çš„&lt;script&gt;å…ƒç´  123var script = document.createElement('script');script.src = url;document.body.appendChild(script); æœåŠ¡å™¨å“åº”JSONPæ•°æ®ï¼Œè¿™äº›æ•°æ®å°†ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ã€‚æœ€ç»ˆçš„ç»“æœæ˜¯åœ¨ç½‘é¡µä¸­åŒ…å«äº†ä¸€ä¸ªæ–°è„šæœ¬ï¼Œè¯¥è„šæœ¬ç¢°å·§æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚ä½†éœ€æ³¨æ„çš„æ˜¯ï¼ŒJSONPä¸­çš„å›è°ƒå‡½æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå…¬æœ‰çš„å’Œå…¨å±€æœ‰æ•ˆçš„å‡½æ•°ã€‚ æ¡†æ¶å’Œå›¾åƒç¯å¡”ä½¿ç”¨æ¡†æ¶ä¹Ÿæ˜¯ä¸€ç§å¤„ç†è¿œç¨‹è„šæœ¬çš„å¤‡é€‰æ–¹æ¡ˆã€‚å¯ä»¥ä½¿ç”¨jsåˆ›å»ºä¸€ä¸ªiframeå…ƒç´ ï¼Œå¹¶ä¿®æ”¹å…¶srcå±æ€§çš„urlï¼Œæ–°çš„URLå¯ä»¥åŒ…å«æ›´æ–°è°ƒç”¨è€…ï¼ˆåœ¨iframeä¹‹å¤–çš„çˆ¶é¡µé¢ï¼‰çš„æ•°æ®å’Œå‡½æ•°è°ƒç”¨ã€‚ ä½¿ç”¨è¿œç¨‹è„šæœ¬æœ€ç®€å•çš„åœºæ™¯æ˜¯åœ¨åªéœ€è¦å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œè€Œæ— éœ€æœåŠ¡å™¨å›åº”çš„æ—¶å€™ã€‚åœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°å›¾åƒï¼Œå¹¶å°†å…¶srcå±æ€§è®¾ç½®ä¸ºæœåŠ¡å™¨ä¸Šçš„è„šæœ¬æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1new Image().src = 'http://example.org/some/page.php'; è¿™ç§æ¨¡å¼ç§°ä¸ºå›¾åƒç¯å¡”ï¼ˆimage beaconï¼‰ï¼Œè¿™åœ¨å¸Œæœ›å‘æœåŠ¡å™¨å‘é€æ—¥å¿—æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œè¯¥æ¨¡å¼å¯ä»¥ç”¨äºæ”¶é›†è®¿é—®è€…ç»Ÿè®¡ä¿¡æ¯ã€‚å› ä¸ºç”¨æˆ·å¹¶ä¸éœ€è¦æœåŠ¡å™¨å¯¹è¿™äº›æ—¥å¿—æ•°æ®çš„å“åº”ï¼Œé€šå¸¸çš„åšæ³•æ˜¯æœåŠ¡å™¨ç”¨ä¸€ä¸ª1x1åƒç´ çš„GIFå›¾ç‰‡æ¥ä½œä¸ºå“åº”ï¼ˆè™½ç„¶è¿™æ˜¯ä¸€ç§ä¸å¥½çš„æ¨¡å¼ï¼‰ã€‚ä½¿ç”¨â€204 Not Contentâ€è¿™æ ·çš„HTTPå“åº”æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œè¯¥HTTPå“åº”çš„æ„æ€æ˜¯æŒ‡ä»…å‘å®¢æˆ·ç«¯å‘é€HTTPæŠ¥å¤´æ–‡ä»¶ï¼Œè€Œä¸å‘é€HTTPå†…å®¹ä½“ã€‚ è„šæœ¬è½½å…¥æ€§èƒ½è„šæœ¬å…ƒç´ ä¼šé˜»æ­¢ä¸‹è½½ç½‘é¡µå†…å®¹ã€‚æµè§ˆå™¨å¯ä»¥åŒæ—¶ä¸‹è½½å¤šä¸ªç»„ä»¶ï¼Œä½†ä¸€æ—¦é‡åˆ°ä¸€ä¸ªå¤–éƒ¨è„šæœ¬æ–‡ä»¶åï¼Œæµè§ˆå™¨ä¼šåœæ­¢è¿›ä¸€æ­¥ä¸‹è½½ï¼Œç›´åˆ°è¿™ä¸ªè„šæœ¬æ–‡ä»¶ä¸‹è½½ã€è§£æå¹¶æ‰§è¡Œå®Œæ¯•ã€‚ä¸ºäº†æœ€å°åŒ–é˜»æ­¢çš„å½±å“ï¼Œå¯ä»¥å°†è„šæœ¬å…ƒç´ æ”¾ç½®äºç½‘é¡µçš„æœ€åéƒ¨åˆ†ï¼Œåˆšå¥½åœ¨&lt;/body&gt;æ ‡ç­¾ä¹‹å‰ã€‚ ä¹Ÿæœ‰ä¸€äº›æ¨¡å¼å¯ä»¥é˜²èŒƒè¿™ä¸ªé—®é¢˜ï¼š ä½¿ç”¨XHRè¯·æ±‚è½½å…¥è„šæœ¬ï¼Œå¹¶ä½¿ç”¨eval()å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ç¼ºç‚¹æ˜¯è¯¥æ–¹æ³•å—åŒä¸€ä¸ªåŸŸçš„é™åˆ¶ï¼Œå¹¶ä¸”ä½¿ç”¨äº†eval()è¿™ç§ä¸å¥½çš„æ¨¡å¼ã€‚ ä½¿ç”¨deferå’Œasyncå±æ€§ã€‚ç¼ºç‚¹æ˜¯è¿™ç§æ–¹æ³•å¹¶ä¸èƒ½åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šéƒ½æœ‰æ•ˆã€‚ ä½¿ç”¨åŠ¨æ€çš„&lt;script&gt;å…ƒç´  åŠ¨æ€scriptå…ƒç´ 123var script = document.createElement('script');script.src = 'all_20141209.js';document.documentElement.firstChild.appendChild(script); ä¸Šé¢çš„è¿‡ç¨‹ä¸ä¼šé˜»å¡ç½‘é¡µæ–‡ä»¶ä¸­å…¶ä»–éƒ¨åˆ†çš„ä¸‹è½½ã€‚ä½†è¯¥æ¨¡å¼çš„ç¼ºç‚¹åœ¨äºå¦‚æœjsè„šæœ¬ä¾èµ–äºè½½å…¥ä¸»jsæ–‡ä»¶ï¼Œé‚£ä¹ˆé‡‡ç”¨è¯¥æ¨¡å¼åä¸èƒ½æœ‰å…¶ä»–è„šæœ¬å…ƒç´ ã€‚ä¸»jsæ–‡ä»¶æ˜¯å¼‚æ­¥è½½å…¥çš„ï¼Œå› æ­¤æ— æ³•ä¿è¯è¯¥æ–‡ä»¶ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿè½½å…¥å®Œæ¯•ï¼Œæ‰€ä»¥ç´§è·Ÿç€ä¸»jsæ–‡ä»¶çš„è„šæœ¬å¯èƒ½è¦å‡å®šå¯¹è±¡éƒ½è¿˜æœªå®šä¹‰ã€‚ ä¸ºäº†è§£å†³è¯¥ç¼ºç‚¹ï¼Œå¯ä»¥è®©æ‰€æœ‰å†…è”çš„è„šæœ¬éƒ½ä¸è¦ç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯å°†è¿™äº›è„šæœ¬éƒ½æ”¶é›†èµ·æ¥æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ã€‚ç„¶åå½“ä¸»è„šæœ¬æ–‡ä»¶è½½å…¥å®Œæ¯•åï¼Œå°±å¯ä»¥æ‰§è¡Œæ‰€æœ‰ç¼“å­˜æ•°ç»„ä¸­æ”¶é›†çš„å‡½æ•°äº†ã€‚ é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨æ‰€æœ‰å†…è”ä»£ç ï¼Œè¿™éƒ¨åˆ†ä»£ç åº”è¯¥æ”¾åœ¨é¡µé¢æ–‡ä»¶å°½å¯èƒ½å‰é¢çš„ä½ç½®ã€‚ 123var myNamespace = &#123; inlineScripts: []&#125;; ç„¶åï¼Œéœ€è¦å°†æ‰€æœ‰å•ç‹¬çš„å†…è”è„šæœ¬å°è£…åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¹¶å°†æ¯ä¸ªå‡½æ•°å¢åŠ åˆ°inlineScriptsæ•°ç»„ä¸­ã€‚ 12345678// è¿‡å»æ˜¯// &lt;script&gt;console.log('inline');&lt;/script&gt;// ä¿®æ”¹ä¸º&lt;script&gt;myNamespace.inlineScripts.push(function()&#123; console.log('inline');&#125;);&lt;/script&gt; æœ€åï¼Œå¾ªç¯æ‰§è¡Œç¼“å­˜ä¸­çš„æ‰€æœ‰å†…è”è„šæœ¬ã€‚ 123for(var i=0, len=myNamespace.inlineScripts.length; i&lt;len; i++)&#123; myNamespace.inlineScripts[i]();&#125; scriptå…ƒç´ ä½ç½®ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒdocumentElementæ˜¯æŒ‡&lt;html&gt;ï¼Œè€Œå®ƒçš„ç¬¬ä¸€ä¸ªå­å…ƒç´ å°±æ˜¯&lt;head&gt; 1document.documentElement.firstChild.appendChild(script); é€šå¸¸ä¹Ÿå¯ä»¥è¿™æ ·å†™ 1document.getElementsByTagName('head')[0].appendChild(script); å¯ä»¥åœ¨ç½‘é¡µä¸­ä¸ä½¿ç”¨&lt;head&gt;å’Œ&lt;body&gt;ï¼Œå°½ç®¡document.bodyé€šå¸¸èƒ½å¤Ÿåœ¨æ²¡æœ‰&lt;body&gt;æ ‡ç­¾æ—¶æ­£å¸¸è¿ä½œã€‚ä½†æ˜¯å®é™…ä¸Šæœ‰ä¸€ä¸ªæ ‡ç­¾ä¸€ç›´ä¼šåœ¨è„šæœ¬è¿è¡Œçš„ç½‘é¡µä¸­å­˜åœ¨ï¼Œé‚£å°±æ˜¯&lt;script&gt;æ ‡ç­¾ï¼Œå¦‚æœæ²¡æœ‰å®ƒï¼Œé‚£ä¹ˆé‡Œé¢çš„jsä»£ç å°±ä¸ä¼šè¿è¡Œã€‚åŸºäºä»¥ä¸Šäº‹å®ï¼Œå¯ä»¥åœ¨ç½‘é¡µä¸­ä½¿ç”¨insertBefore()æ¥åœ¨ç¬¬ä¸€ä¸ªæœ‰æ•ˆçš„å…ƒç´ ä¹‹å‰æ’å…¥å…ƒç´ ã€‚ 12var firstScript = document.getElementsByTagName('script')[0];firstScript.parentNode.insertBefore(script, firstScript); å»¶è¿ŸåŠ è½½12345window.onload = function()&#123; var script = document.createElement('script'); script.src = 'all_lazy_20141209.js'; document.documentElement.firstChild.appendChild(script);&#125;; è¿™æ ·çš„åšæ³•ç¬¦åˆæ¸è¿›å¢å¼ºçš„æ€æƒ³ï¼Œä¸€éƒ¨åˆ†ä»£ç æ˜¯ç”¨äºåˆå§‹åŒ–é¡µé¢å¹¶å°†äº‹ä»¶é™„åŠ åˆ°UIå…ƒç´ ä¸Šï¼Œè€Œç¬¬äºŒéƒ¨åˆ†ä»£ç åªåœ¨ç”¨æˆ·äº¤äº’æˆ–è€…å…¶ä»–æ¡ä»¶ä¸‹æ‰ç”¨å¾—ä¸Šï¼Œå› æ­¤è¿™éƒ¨åˆ†å†…å®¹å¯ä»¥åœ¨ç”¨æˆ·æµè§ˆè¯¥é¡µé¢æ—¶åœ¨åå°è½½å…¥ã€‚å¯¹äºè®¸å¤šåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå»¶è¿ŸåŠ è½½çš„ä»£ç éƒ¨åˆ†è¿œè¿œå¤§äºç«‹å³åŠ è½½çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå› ä¸ºå¾ˆå¤šæœ‰è¶£çš„æ“ä½œï¼ˆä¾‹å¦‚æ‹–æ”¾ã€XHRå’ŒåŠ¨ç”»ç­‰ï¼‰åªåœ¨ç”¨æˆ·è§¦å‘åå‘ç”Ÿã€‚ æŒ‰éœ€åŠ è½½ä¸Šé¢çš„æ¨¡å¼åœ¨é¡µé¢è½½å…¥åï¼Œæ— æ¡ä»¶åœ°è½½å…¥é™„åŠ çš„jsè„šæœ¬ï¼Œå‡å®šè¿™äº›ä»£ç ææœ‰å¯èƒ½ç”¨å¾—ä¸Šã€‚å¦‚æœåªè½½å…¥é‚£äº›ç¡®å®éœ€è¦çš„ä»£ç ï¼Œè¯·ä½¿ç”¨æŒ‰éœ€åŠ è½½æ¨¡å¼ã€‚å¯ä»¥åˆ›å»ºä¸€ä¸ªrequire()å‡½æ•°ï¼Œè¯¥å‡½æ•°åŒ…å«éœ€è¦åŠ è½½çš„è„šæœ¬çš„åç§°å’Œå½“é™„åŠ è„šæœ¬åŠ è½½åéœ€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚ç”¨æ³•å¦‚ä¸‹ 123require('extra.js', function()&#123; functionDefinedInExtraJS();&#125;); requireå‡½æ•°çš„å®ç° 12345678910111213141516171819function require(file, callback) &#123; var script = document.getElementsByTagName('script')[0], newjs = document.createElement('script'); // IE newjs.onreadystatechange = function () &#123; if (newjs.readyState === 'loaded' || newjs.readyState === 'complete') &#123; callback(); &#125; &#125;; // å…¶ä»–æµè§ˆå™¨ newjs.onload = function () &#123; callback(); &#125;; newjs.src = file; script.parentNode.insertBefore(newjs, script);&#125; åœ¨IEä¸­è®¢é˜…readystatechangeäº‹ä»¶ï¼Œå¹¶å¯»æ‰¾readyStateçŠ¶æ€ä¸ºâ€loadedâ€æˆ–â€completeâ€çš„çŠ¶æ€ã€‚è€Œåœ¨Firefoxã€Safariå’ŒOperaä¸­ï¼Œéœ€è¦é€šè¿‡onloadå±æ€§è®¢é˜…loadäº‹ä»¶ã€‚æ³¨æ„ï¼šè¿™ç§æ–¹æ³•ä¸é€‚ç”¨äºSafari 2ï¼Œå¦‚æœéœ€è¦ï¼Œè¯·åˆ›å»ºä¸€ä¸ªæ—¶é—´é—´éš”æ¥å®šæœŸæ£€æŸ¥æ˜¯å¦æŒ‡å®šå˜é‡å·²å®šä¹‰ï¼ˆåœ¨é™„åŠ æ–‡ä»¶ä¸­å®šä¹‰çš„å˜é‡ï¼‰ã€‚å½“è¯¥å˜é‡è¢«å®šä¹‰ä»¥åï¼Œå°±æ„å‘³ç€æ–°è„šæœ¬å·²ç»åŠ è½½å¹¶æ‰§è¡Œäº†ã€‚ é¢„åŠ è½½æ¨¡å¼åœ¨å»¶è¿ŸåŠ è½½å’ŒæŒ‰éœ€åŠ è½½æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬å»¶è¿ŸåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„è„šæœ¬ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å»¶è¿ŸåŠ è½½å½“å‰é¡µé¢ä¸éœ€è¦ï¼Œä½†æ˜¯åœ¨åç»­é¡µé¢ä¸­å¯èƒ½éœ€è¦çš„è„šæœ¬ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·æ‰“å¼€æ¥ä¸‹æ¥çš„ç½‘é¡µåï¼Œæ‰€éœ€è¦çš„è„šæœ¬å·²ç»é¢„å…ˆåŠ è½½äº†ï¼Œè¿›è€Œç”¨æˆ·ä¼šæ„Ÿè§‰é€Ÿåº¦åŠ å¿«äº†ã€‚ é¢„åŠ è½½å¯ä»¥ä½¿ç”¨åŠ¨æ€è„šæœ¬æ¨¡å¼æ¥å®ç°ï¼Œä½†æ˜¯è¿™æ„å‘³ç€è¯¥è„šæœ¬å°†è¢«è§£æå’Œæ‰§è¡Œã€‚è§£æä»…ä»…ä¼šå¢åŠ é¢„åŠ è½½çš„æ—¶é—´ï¼Œè€Œæ‰§è¡Œè„šæœ¬å¯èƒ½ä¼šå¯¼è‡´jsé”™è¯¯ï¼Œå› ä¸ºè¿™äº›è„šæœ¬åº”è¯¥æ˜¯åœ¨ç¬¬äºŒä¸ªé¡µé¢æ‰§è¡Œçš„ï¼Œä¾‹å¦‚å¯»æ‰¾æŸä¸ªç‰¹å®šçš„DOMèŠ‚ç‚¹ã€‚ å¯ä»¥åŠ è½½è„šæœ¬è€Œå¹¶ä¸è§£æå’Œæ‰§è¡Œè¿™äº›è„šæœ¬ï¼Œåœ¨IEä¸­å¯ä»¥ä½¿ç”¨å›¾åƒç¯å¡”æ¥å‘å‡ºè¯·æ±‚ã€‚åœ¨æ‰€æœ‰å…¶ä»–æµè§ˆå™¨ä¸­å¯ä»¥ä½¿ç”¨ä¸€ä¸ª&lt;object&gt;æ¥ä»£æ›¿è„šæœ¬å…ƒç´ ï¼Œå¹¶å°†å…¶dataå±æ€§æŒ‡å‘è„šæœ¬çš„URLã€‚ 123456789101112131415var preload; if (/*@cc_on!@*/false) &#123; // ä½¿ç”¨æ¡ä»¶æ³¨é‡Šçš„IEå—…æ¢ preload = function (file) &#123; new Image().src = file; &#125;;&#125; else &#123; preload = function (file) &#123; var obj = document.createElement('object'); // é¿å…æ˜¾ç¤ºå‡ºè¯¥å¯¹è±¡ obj.width = 0; obj.height = 0; obj.data = file; document.body.appendChild(obj); &#125;;&#125; æ³¨æ„ï¼šä¸Šé¢çš„ä»£ç ä½¿ç”¨äº†åˆ†æ”¯æ³¨é‡Šæ¥å—…æ¢IEï¼Œè¯¥æ–¹æ³•æ¯”åœ¨navigator.userAgentä¸­å¯»æ‰¾å­—ç¬¦ä¸²è¦å®‰å…¨ä¸€äº›ï¼Œå› ä¸ºé‚£äº›å­—ç¬¦ä¸²å¾ˆå®¹æ˜“è¢«ç”¨æˆ·ä¿®æ”¹ã€‚var isIE = /*@cc_on!@*/false; ä¼šåœ¨é™¤IEå¤–çš„å…¶ä»–æµè§ˆå™¨ä¸­å°†isIEè®¾ç½®ä¸ºfalseï¼Œå› ä¸ºåœ¨æ³¨é‡Šè¯­å¥ä¸­æœ‰ä¸€ä¸ª!ï¼Œå› æ­¤åœ¨IEä¸­isIEçš„å€¼ä¸ºtrueã€‚ è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹åœ¨äºä½¿ç”¨äº†ç”¨æˆ·ä»£ç†å—…æ¢ï¼Œä½†æ˜¯è¿™æ˜¯æ— æ³•é¿å…çš„ã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ç‰¹æ€§æ£€æµ‹æŠ€æœ¯æ— æ³•å‘ŠçŸ¥å…³äºæµè§ˆå™¨è¡Œä¸ºçš„è¶³å¤Ÿä¿¡æ¯ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹å¦‚æœ typeof Image === &#39;function&#39;ï¼Œé‚£ä¹ˆç†è®ºä¸Šå¯ä»¥ç”¨è¯¥å‡½æ•°æ¥ä»£æ›¿å—…æ¢ã€‚ç„¶è€Œåœ¨è¿™é‡Œè¯¥æ–¹æ³•æ²¡æœ‰ä½œç”¨ï¼Œå› ä¸ºæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒ new Image(); åŒºåˆ«ä»…ä»…åœ¨äºæœ‰çš„æµè§ˆå™¨ä¸ºå›¾åƒæœ‰ç‹¬ç«‹çš„ç¼“å­˜ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä½œä¸ºå›¾åƒé¢„åŠ è½½çš„ç»„ä»¶ä¸ä¼šè¢«ç”¨ä½œç¼“å­˜ä¸­çš„è„šæœ¬ï¼Œå› æ­¤ä¸‹ä¸€ä¸ªé¡µé¢ä¼šå†æ¬¡ä¸‹è½½è¯¥å›¾åƒã€‚ é¢„åŠ è½½æ¨¡å¼å¯ä»¥ç”¨äºå„ç§ç±»å‹ç»„ä»¶ï¼Œè€Œä¸é™äºè„šæœ¬ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œè¿™åœ¨ç™»å½•é¡µé¢å°±ååˆ†æœ‰ç”¨ã€‚å½“ç”¨æˆ·å¼€å§‹è¾“å…¥ç”¨æˆ·åæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¾“å…¥çš„æ—¶é—´æ¥å¯åŠ¨é¢„åŠ è½½ï¼Œå› ä¸ºç”¨æˆ·ä¸‹ä¸€æ­¥ææœ‰å¯èƒ½è¿›å…¥ç™»å½•åçš„ç•Œé¢ã€‚ å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹å…­-è®¾è®¡æ¨¡å¼]]></title>
    <url>%2Fblog%2F2014%2F11%2Fjs-pattern-part6-design-pattern.html</url>
    <content type="text"><![CDATA[å•ä½“æ¨¡å¼å•ä½“ï¼ˆSingletonï¼‰æ¨¡å¼çš„æ€æƒ³åœ¨äºä¿è¯ä¸€ä¸ªç‰¹å®šç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ã€‚è¿™æ„å‘³ç€å½“ç¬¬äºŒæ¬¡ä½¿ç”¨åŒä¸€ä¸ªç±»åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œåº”è¯¥å¾—åˆ°ä¸ç¬¬ä¸€æ¬¡æ‰€åˆ›å»ºå¯¹è±¡å®Œå…¨ç›¸åŒçš„å¯¹è±¡ã€‚ åœ¨jsä¸­ï¼Œå¯¹è±¡ä¹‹é—´æ°¸è¿œä¸ä¼šå®Œå…¨ç›¸ç­‰ï¼Œé™¤éå®ƒä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å³ä½¿åˆ›å»ºä¸€ä¸ªå…·æœ‰å®Œå…¨ç›¸åŒæˆå‘˜çš„åŒç±»å¯¹è±¡ï¼Œå®ƒä¹Ÿä¸ä¼šä¸ç¬¬ä¸€ä¸ªå¯¹è±¡å®Œå…¨ç›¸åŒã€‚ 123var obj1 = &#123;&#125;;var obj2 = &#123;&#125;;obj1 == obj2; //output: false å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ¯æ¬¡åœ¨ä½¿ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªå•ä½“ã€‚æ³¨æ„æœ‰æ—¶äººä»¬åœ¨jsä¸­æ‰€è¯´çš„â€œå•ä½“â€ï¼Œå°±æ˜¯æŒ‡å‰é¢æåˆ°çš„â€œæ¨¡å—æ¨¡å¼â€ã€‚ 1.é€šè¿‡é™æ€å±æ€§å®ç°å•ä½“ 1234567891011121314function Universe()&#123; if(typeof Universe.instance === 'object')&#123; return Universe.instance; &#125; // æ­£å¸¸è¿›è¡Œ this.start_time = 0; // ç¼“å­˜ Universe.instance = this; // éšå¼è¿”å› // return this;&#125; è¿™ç§æ–¹æ³•éå¸¸ç›´æ¥ï¼Œä½†æ˜¯ç¼ºç‚¹åœ¨äºå…¶instanceå±æ€§æ˜¯å…¬å¼€çš„ï¼Œå­˜åœ¨è¢«æ¶æ„ä¿®æ”¹çš„éšæ‚£ã€‚ 2.é€šè¿‡é—­åŒ…å®ç°å•ä½“ 123456789101112function Universe()&#123; // ç¼“å­˜å®ä¾‹ var instance = this; // æ­£å¸¸è¿›è¡Œ this.start_time = 0; // é‡å†™è¯¥æ„é€ å‡½æ•° Universe = function()&#123; return instance; &#125;;&#125; è¿™ç§å®ç°å®é™…ä¸Šæ˜¯æ¥è‡ªäºå‰é¢æåˆ°çš„â€œè‡ªå®šä¹‰å‡½æ•°â€æ¨¡å¼çš„å¦ä¸€ä¸ªä¾‹å­ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹åœ¨äºï¼Œé‡å†™æ„é€ å‡½æ•°ä¼šä¸¢å¤±æ‰€æœ‰åœ¨åˆå§‹åŒ–å®šä¹‰å’Œé‡å®šä¹‰æ—¶åˆ»ä¹‹é—´æ·»åŠ åˆ°å®ƒé‡Œé¢çš„å±æ€§ã€‚ 1234567891011121314Universe.prototype.nothing = true;var uni = new Universe();Universe.prototype.everything = true;var uni2 = new Universe();uni.nothing; //output: trueuni2.nothing; //output: trueuni.everything; //output: undefineduni2.everything; //ouput: undefined// ç»“æœçœ‹ä¸Šå»æ˜¯æ­£ç¡®çš„uni.constructor.name; //ouput: "Universe"// ä½†è¿™æ˜¯å¥‡æ€ªçš„uni.constructor === Universe; //output: flase ä¹‹æ‰€ä»¥uni.constructorä¸åœ¨ä¸Universe()æ„é€ å‡½æ•°ç›¸åŒï¼Œæ˜¯å› ä¸ºuni.constructorä»ç„¶æŒ‡å‘äº†åŸå§‹çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯é‡æ–°å®šä¹‰çš„é‚£ä¸ªæ„é€ å‡½æ•°ã€‚ å¦‚æœéœ€è¦ä½¿åŸå‹å’Œæ„é€ å‡½æ•°æŒ‡é’ˆå®‰è£…é¢„æœŸçš„é‚£æ ·è¿è¡Œï¼Œæ”¹è¿›å¦‚ä¸‹ 1234567891011121314151617181920212223function Universe()&#123; // ç¼“å­˜å®ä¾‹ var instance; // é‡å†™æ„é€ å‡½æ•° Universe = function Universe()&#123; return instance; &#125;; // ä¿ç•™åŸå‹å±æ€§ Universe.prototype = this; // å®ä¾‹ instance = new Universe(); // é‡ç½®æ„é€ å‡½æ•°æŒ‡é’ˆ instance.constructor = Universe; // æ‰€æœ‰åŠŸèƒ½ instance.start_time = 0; return instance;&#125; å¦ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°†æ„é€ å‡½æ•°å’Œå®ä¾‹åŒ…è£…åœ¨å³æ—¶å‡½æ•°ä¸­ï¼Œå¦‚ä¸‹ 123456789101112131415var Universe;(function()&#123; var instance; Universe = function Universe()&#123; if(instance)&#123; return instance; &#125; instance = this; // æ‰€æœ‰åŠŸèƒ½ this.start_time = 0; &#125;;&#125;)(); å·¥å‚æ¨¡å¼å·¥å‚æ¨¡å¼çš„ç›®çš„æ˜¯ä¸ºäº†åˆ›å»ºå¯¹è±¡ï¼Œå®ƒé€šå¸¸åœ¨ç±»æˆ–ç±»çš„é™æ€æ–¹æ³•ä¸­å®ç°ï¼Œå…·æœ‰ä¸‹åˆ—ç›®æ ‡ï¼š 1.å½“åˆ›å»ºç›¸ä¼¼å¯¹è±¡æ—¶æ‰§è¡Œé‡å¤æ“ä½œ 2.å½“ç¼–è¯‘æ—¶ä¸çŸ¥é“å…·ä½“ç±»å‹ï¼ˆç±»ï¼‰çš„æƒ…å†µä¸‹ï¼Œä¸ºå·¥å‚å®¢æˆ·æä¾›ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æ¥å£ 1234567891011121314151617181920212223242526272829303132333435363738394041// çˆ¶æ„é€ å‡½æ•°function CarMaker()&#123;&#125;CarMaker.prototype.drive = function()&#123; return "Vroom, I hvae " + this.doors + ' doors';&#125;;// é™æ€å·¥å‚æ–¹æ³•CarMaker.factory = function(type)&#123; var newcar; // å¦‚æœæ„é€ å‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™å‘ç”Ÿé”™è¯¯ if(typeof CarMaker[type] !== 'function')&#123; throw &#123; name: 'Error', message: type + ' doesn\'t exist' &#125;; &#125; // åœ¨è¿™é‡Œï¼Œæ„é€ å‡½æ•°æ˜¯å·²çŸ¥å­˜åœ¨çš„ // æˆ‘ä»¬ä½¿å¾—åŸå‹ç»§æ‰¿çˆ¶ç±»ï¼Œä½†ä»…ç»§æ‰¿ä¸€æ¬¡ if(typeof CarMaker[type].prototype.drive !== 'function')&#123; CarMaker[type].prototype = new CarMaker(); &#125; // åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ newcar = new CarMaker[type](); // å¯é€‰æ‹©æ€§çš„è°ƒç”¨ä¸€äº›æ–¹æ³•åè¿”å›â€¦â€¦ return newcar;&#125;// å®šä¹‰ç‰¹å®šçš„æ±½è½¦åˆ¶é€ å•†CarMaker.Compact = function()&#123; this.doors = 4;&#125;;CarMaker.Convertible = function()&#123; this.doors = 2;&#125;;CarMaker.SUV = function()&#123; this.doors = 24;&#125;; factoryæ–¹æ³•é€šè¿‡å­—ç¬¦ä¸²æŒ‡å®šç±»å‹æ¥åˆ›å»ºå¯¹è±¡ã€‚ç»§æ‰¿éƒ¨åˆ†ä»…æ˜¯å¯ä»¥æ”¾è¿›å·¥å‚æ–¹æ³•çš„ä¸€ä¸ªå…¬ç”¨é‡å¤ä»£ç ç‰‡æ®µçš„èŒƒä¾‹ï¼Œè€Œä¸æ˜¯å¯¹æ¯ç§ç±»å‹çš„æ„é€ å‡½æ•°çš„é‡å¤ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œjså†…ç½®çš„Object()å°±æ˜¯ä¸€ä¸ªè‡ªç„¶å·¥å‚ï¼Œå®ƒæ ¹æ®è¾“å…¥ç±»å‹è€Œåˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚ 1234var s = new Object('1');var n = new Object(1);s.constructor === String; //output: truen.constructor === Number; //output: true è£…é¥°è€…æ¨¡å¼è£…é¥°è€…æ¨¡å¼çš„ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„ç‰¹å¾åœ¨äºå…¶é¢„æœŸè¡Œä¸ºçš„å¯å®šåˆ¶å’Œå¯é…ç½®ç‰¹æ€§ã€‚å¯ä»¥ä»ä»…å…·æœ‰ä¸€äº›åŸºæœ¬åŠŸèƒ½çš„æ™®é€šå¯¹è±¡å¼€å§‹ï¼Œç„¶åä»å¯ç”¨è£…é¥°èµ„æºæ± ä¸­é€‰æ‹©éœ€è¦ç”¨äºå¢å¼ºæ™®é€šå¯¹è±¡çš„é‚£äº›åŠŸèƒ½ï¼Œå¹¶ä¸”æŒ‰ç…§é¡ºåºè¿›è¡Œè£…é¥°ï¼Œå°¤å…¶æ˜¯å½“è£…é¥°é¡ºåºå¾ˆé‡è¦çš„æ—¶å€™ã€‚ 1.ä½¿ç”¨ç»§æ‰¿å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445function Sale(price)&#123; this.price = price || 100;&#125;Sale.prototype.getPrice = function()&#123; return this.price;&#125;;// ä»¥å­—ç¬¦ä¸²çš„æ–¹å¼æ‰¾åˆ°å¯¹è±¡å—æ‹¼æ¥Sale.prototype.decorate = function(decorator)&#123; var F = function()&#123;&#125;; F.prototype = this; var newObj = new F(); newObj.super = F.prototype; var overrides = this.constructor.decorators[decorator]; for(var i in overrides)&#123; if(overrides.hasOwnProperty(i))&#123; newObj[i] = overrides[i]; &#125; &#125; return newObj;&#125;// è£…é¥°è€…å¯¹è±¡éƒ½å°†ä»¥æ„é€ å‡½æ•°çš„å±æ€§è¿™ç§æ–¹å¼æ¥å®ç°Sale.decorators = &#123;&#125;;Sale.decorators.fedtax = &#123; getPrice: function()&#123; var price = this.super.getPrice(); price += price * 5 / 100; return price; &#125;&#125;;Sale.decorators.cdn = &#123; getPrice: function()&#123; return 'CDN$ ' + this.super.getPrice().toFixed(2); &#125;&#125;;// ç”¨æ³•var sale= new Sale(100);sale = sale.decorate('fedtax');sale = sale.decorate('cdn');sale.getPrice(); //output: CDN$ 105.00 2.ä½¿ç”¨åˆ—è¡¨å®ç° åˆ©ç”¨jsè¯­è¨€çš„åŠ¨æ€æ€§è´¨ï¼Œæ ¹æœ¬ä¸éœ€è¦ä½¿ç”¨ç»§æ‰¿ã€‚æ­¤å¤–ï¼Œå¹¶ä¸æ˜¯ä½¿æ¯ä¸ªè£…é¥°æ–¹æ³•è°ƒç”¨é“¾ä¸­å‰é¢çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†å‰é¢æ–¹æ³•çš„ç»“æœä½œä¸ºå‚æ•°ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªæ–¹æ³•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637function Sale(price)&#123; this.price = (price &gt; 0) || 100; this.decorators_list = [];&#125;Sale.decorators = &#123;&#125;;Sale.decorators.fedtax = &#123; getPrice: function(price)&#123; return price + price * 5 / 100; &#125;&#125;;Sale.decorators.cdn = &#123; getPrice: function(price)&#123; return 'CDN$ ' + price.toFixed(2); &#125;&#125;;Sale.prototype.decorate = function(decorator)&#123; this.decorators_list.push(decorator);&#125;;Sale.prototype.getPrice = function()&#123; var price = this.price; var name; for(var i=0, len=this.decorators_list.length; i&lt;len; i++)&#123; name = this.decorators_list[i]; price = Sale.decorators[name].getPrice(price); &#125; return price;&#125;;// ç”¨æ³•var sale = new Sale(100);sale.decorate('fedtax');sale.decorate('cdn');sale.getPrice(); //output: CDN$ 105.00 åœ¨ä½¿ç”¨ç»§æ‰¿çš„å®ç°æ–¹æ³•ä¸­ï¼Œdecorate()å…·æœ‰ä¸€å®šçš„å¤æ‚æ€§ï¼Œè€ŒgetPrice()éå¸¸ç®€å•ã€‚è€Œåœ¨è¿™é‡Œçš„å®ç°ä¸­æ­£å¥½ç›¸åï¼Œdecorate()è¿›ç”¨äºè¿½åŠ åˆ—è¡¨ï¼Œè€ŒgetPrice()å´å®Œæˆæ‰€æœ‰å·¥ä½œã€‚è¿™ç§å®ç°æ–¹å¼æ›´ä¸ºç®€å•ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å¾ˆå®¹æ˜“çš„æ”¯æŒåè£…é¥°æˆ–æ’¤é”€è£…é¥°ã€‚ å¦‚æœæƒ³æ‹¥æœ‰æ›´å¤šå¯ä»¥è¢«è£…é¥°çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæ¯ä¸ªé¢å¤–çš„è£…é¥°æ–¹æ³•éƒ½éœ€è¦é‡å¤éå†è£…é¥°è€…åˆ—è¡¨è¿™ä¸€éƒ¨åˆ†çš„ä»£ç ã€‚ç„¶è€Œï¼Œè¿™å¾ˆå®¹æ˜“æŠ½è±¡æˆä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œé€šè¿‡å®ƒæ¥æ¥å—æ–¹æ³•å¹¶ä½¿å…¶æˆä¸ºâ€œå¯è£…é¥°â€çš„æ–¹æ³•ã€‚ã€æ¥å—æ–¹æ³•ï¼Ÿã€‘åœ¨è¿™æ ·çš„å®ç°ä¸­ï¼Œsaleä¸­çš„decorators_listå±æ€§å˜æˆäº†ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”è¯¥å¯¹è±¡ä¸­çš„æ¯ä¸ªå±æ€§éƒ½æ˜¯ä»¥è£…é¥°å¯¹è±¡æ•°ç»„ä¸­çš„æ–¹æ³•å’Œå€¼å‘½åã€‚ã€ï¼Ÿã€‘ ã€æˆ‘çš„å®ç°ã€‘ 123456789101112131415Sale.prototype.getDecoratedValue = function(methodName)&#123; var value, name; var params = Array.prototype.slice.call(arguments, 1); for(var i=0, len=this.decorators_list.length; i&lt;len; i++)&#123; name = this.decorators_list[i]; value = Sale.decorators[name][methodName].apply(this, params); params = [value]; &#125; return value;&#125;;Sale.prototype.getPrice = function()&#123; return this.getDecoratedValue('getPrice', this.price);&#125;; ç­–ç•¥æ¨¡å¼ç­–ç•¥æ¨¡å¼æ”¯æŒåœ¨è¿è¡Œæ—¶é€‰æ‹©ç®—æ³•ã€‚ä»£ç çš„å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæ¥å£æ¥å·¥ä½œï¼Œä½†æ˜¯å®ƒå´æ ¹æ®å®¢æˆ·æ­£åœ¨è¯•å›¾æ‰§è¡Œä»»åŠ¡çš„ä¸Šä¸‹æ–‡ï¼Œä»å¤šä¸ªç®—æ³•ä¸­é€‰æ‹©ç”¨äºå¤„ç†ç‰¹å®šä»»åŠ¡çš„ç®—æ³•ã€‚ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„ä¸€ä¸ªä¾‹å­æ˜¯è§£å†³è¡¨å•éªŒè¯çš„é—®é¢˜ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283var validator = &#123; // æ‰€æœ‰å¯ç”¨çš„æ£€æŸ¥ types: &#123;&#125;, // åœ¨å½“å‰éªŒè¯ä¼šè¯ä¸­çš„é”™è¯¯æ¶ˆæ¯ messages: [], // å½“å‰éªŒè¯é…ç½® // key: åç§° value: éªŒè¯ç±»å‹ config: &#123;&#125;, // æ¥å£æ–¹æ³• // dataä¸ºkey-valueå¯¹ validate: function(data)&#123; var msg, type, checker, result_ok; // é‡ç½®æ‰€æœ‰æ¶ˆæ¯ this.messages = []; for(var i in data)&#123; if(data.hasOwnProperty(i))&#123; type = this.config[i]; checker = this.types[type]; if(!type)&#123; continue; // ä¸éœ€è¦éªŒè¯ &#125; if(!checker)&#123; throw &#123; name: 'ValidationError', message: 'No handler to validate type ' + type &#125;; &#125; result_ok = checker.validate(data[i]); if(!result_ok)&#123; msg = 'Invalid value for *' + i + '*, ' + checker.instructions; this.messages.push(msg); &#125; &#125; &#125; return this.hasErrors(); &#125;, // å¸®åŠ©æ–¹æ³• hasErrors: function()&#123; return this.messages.length &gt; 0; &#125;&#125;;// éç©ºå€¼çš„æ£€æŸ¥validator.types.isNonEmpty = &#123; validate: function(value)&#123; return value !== ''; &#125;, instructions: 'the value cannot be empty'&#125;;// æ£€æŸ¥æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°å­—validator.types.isNumber = &#123; validate: function(value)&#123; return !isNaN(value); &#125;, instructions: 'the value can only be a valid number'&#125;;// *****// ç”¨æ³•// *****var data = &#123; name: 'fucky', age: 'unknown'&#125;;validator.config = &#123; name: 'isNonEmpty', age: 'isNumber'&#125;;validator.validate(data);if(validator.hasErrors())&#123; console.log(validator.messages.join('\n'));&#125; å¦‚ä¸Šæ‰€ç¤ºï¼Œvalidatorå¯¹è±¡æ˜¯é€šç”¨çš„ï¼Œå¢å¼ºvalidatorå¯¹è±¡çš„æ–¹æ³•æ˜¯æ·»åŠ æ›´å¤šçš„ç±»å‹æ£€æŸ¥ã€‚ä»¥åé’ˆå¯¹æ¯ä¸ªæ–°çš„ç”¨ä¾‹ï¼Œæ‰€éœ€åšçš„å°±æ˜¯é…ç½®è¯¥éªŒè¯å™¨å¹¶è¿è¡Œvalidate()æ–¹æ³•ã€‚ å¤–è§‚æ¨¡å¼å¤–è§‚ï¼ˆfacadeï¼‰æ¨¡å¼æ˜¯ä¸€ç§ç®€å•çš„æ¨¡å¼ï¼Œå®ƒä¸ºå¯¹è±¡æä¾›äº†ä¸€ä¸ªå¯ä¾›é€‰æ‹©çš„æ¥å£ã€‚è¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„è®¾è®¡å®è·µï¼Œå¯ä¿æŒæ–¹æ³•çš„ç®€æ´æ€§å¹¶ä¸”ä¸ä¼šä½¿å®ƒä»¬å¤„ç†è¿‡å¤šçš„å·¥ä½œã€‚æœ‰æ—¶å€™ï¼Œä¸¤ä¸ªæˆ–æ›´å¤šçš„æ–¹æ³•å¯èƒ½æ™®éçš„è¢«ä¸€èµ·è°ƒç”¨ï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºå¦ä¸€ä¸ªæ–¹æ³•ä»¥åŒ…è£…é‡å¤çš„æ–¹æ³•è°ƒç”¨æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚ ä¾‹å¦‚ï¼Œå½“å¤„ç†æµè§ˆå™¨äº‹ä»¶æ—¶ï¼ŒstopPropagation()å’ŒpreventDefault()ä¸¤ä¸ªæ–¹æ³•ç»å¸¸è¢«ä¸€èµ·è°ƒç”¨ã€‚å¤–è§‚æ¨¡å¼éå¸¸é€‚åˆäºæµè§ˆå™¨è„šæœ¬å¤„ç†ï¼Œæ®æ­¤å¯è®²æµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚éšè—åœ¨å¤–è§‚ä¹‹åã€‚ 123456789101112131415161718var myevent = &#123; stop: function(e)&#123; // IE if(typeof e.returnValue === 'boolean')&#123; e.returnValue = false; &#125; if(typeof e.cancelBubble === 'boolean')&#123; e.cancelBubble = true; &#125; // å…¶ä»– if(typeof e.preventDefault === 'function')&#123; e.preventDefault(); &#125; if(typeof e.stopPropagation === 'function')&#123; e.preventDefault(); &#125; &#125;&#125;; ä»£ç†æ¨¡å¼åœ¨ä»£ç†è®¾è®¡æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªå¯¹è±¡å……å½“å¦ä¸€ä¸ªå¯¹è±¡çš„æ¥å£ã€‚å®ƒä¸å¤–è§‚æ¨¡å¼çš„åŒºåˆ«åœ¨äºï¼Œåœ¨å¤–è§‚æ¨¡å¼ä¸­ä½ æ‰€æ‹¥æœ‰çš„æ˜¯åˆå¹¶äº†å¤šä¸ªæ–¹æ³•è°ƒç”¨çš„ä¾¿åˆ©æ–¹æ³•ã€‚ä»£ç†åˆ™ä»‹äºå¯¹è±¡çš„å®¢æˆ·ç«¯å’Œå¯¹è±¡æœ¬èº«ä¹‹é—´ï¼Œå¹¶ä¸”å¯¹è¯¥å¯¹è±¡çš„è®¿é—®è¿›è¡Œä¿æŠ¤ã€‚ è¿™ç§æ¨¡å¼å¯èƒ½çœ‹èµ·æ¥åƒæ˜¯é¢å¤–çš„å¼€é”€ï¼Œä½†æ˜¯å‡ºäºæ€§èƒ½å› ç´ çš„è€ƒè™‘å®ƒå´éå¸¸æœ‰ç”¨ã€‚ä»£ç†å……å½“äº†æŸä¸ªå¯¹è±¡ï¼ˆä¹Ÿç§°ä¸ºâ€œæœ¬ä½“å¯¹è±¡â€ï¼‰çš„å®ˆæŠ¤å¯¹è±¡ï¼Œå¹¶ä¸”è¯•å›¾ä½¿æœ¬ä½“å¯¹è±¡åšå°½å¯èƒ½å°‘çš„å·¥ä½œã€‚ ä½¿ç”¨è¿™ç§æ¨¡å¼çš„ä¸€ä¸ªä¾‹å­æ˜¯å»¶è¿Ÿåˆå§‹åŒ–ï¼ˆlazy initializationï¼‰ã€‚å‡è®¾åˆå§‹åŒ–æœ¬ä½“å¯¹è±¡å¼€é”€éå¸¸å¤§ï¼Œè€Œæ°å¥½åˆåœ¨å®¢æˆ·ç«¯åˆå§‹åŒ–è¯¥æœ¬ä½“å¯¹è±¡ä»¥åï¼Œåº”ç”¨ç¨‹åºå®é™…ä¸Šå´ä»æ¥æ²¡æœ‰ä½¿ç”¨è¿‡å®ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé¦–å…ˆç”±å®¢æˆ·ç«¯å‘å‡ºä¸€ä¸ªåˆå§‹åŒ–è¯·æ±‚ï¼Œç„¶åä»£ç†ä»¥â€œä¸€åˆ‡æ­£å¸¸â€ä½œä¸ºå“åº”ï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰å°†è¯¥æ¶ˆæ¯ä¼ é€’åˆ°æœ¬ä½“å¯¹è±¡ï¼Œç›´åˆ°å®¢æˆ·ç«¯æ˜æ˜¾éœ€è¦æœ¬ä½“å¯¹è±¡å®Œæˆä¸€äº›å·¥ä½œçš„æ—¶å€™ã€‚åªæœ‰åˆ°é‚£ä¸ªæ—¶å€™ï¼Œä»£ç†æ‰å°†ä¸¤ä¸ªæ¶ˆæ¯ä¸€èµ·ä¼ é€’ã€‚ å¦ä¸€ä¸ªä¾‹å­æ˜¯å°†è®¿é—®èšé›†ä¸ºç»„ï¼Œæ¯”å¦‚å°½å¯èƒ½åˆå¹¶æ›´å¤šçš„httpè¯·æ±‚å°±å¾ˆé‡è¦ï¼ŒèŠ‚çœç½‘ç»œå¼€é”€ã€‚è¿™ä¸€ç‚¹æœ‰ç‚¹åƒæ•°æ®åº“é‡Œçš„ batch insertã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445var proxy = &#123; ids: [], delay: 50, timeout: null, callback: null, context: null, makeRequest: function(id, callback, context)&#123; // åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ this.ids.push(id); this.callback = callback; this.context = context; // è®¾ç½®è¶…æ—¶æ—¶é—´ if(!this.timeout)&#123; this.timeout = setTimeout(function()&#123; proxy.flush(); &#125;, this.delay); &#125; &#125;, flush: function()&#123; // httpæ˜¯å¤„ç†è¯·æ±‚çš„æœ¬ä½“å¯¹è±¡ï¼Œä»…æœ‰è¿™ä¸€ä¸ªæ–¹æ³• http.makeRequest(this.ids, 'proxy.handler'); // æ¸…é™¤è¶…æ—¶è®¾ç½®å’Œé˜Ÿåˆ— this.timeout = null; this.ids = []; &#125;, // JSONPçš„callback handler: function(data)&#123; // å•ä¸ªç»“æœ if(parseInt(data.query.count, 10) === 1)&#123; proxy.callback.call(proxy.context, data.query.results.Video); return; &#125; // å¤šä¸ªç»“æœ for(var i=0, len=data.query.results.Video.length; i&lt;len; i++)&#123; proxy.callback.call(proxy.context, data.query.results.Video[i]); &#125; &#125;&#125;; æœ¬ä¾‹ä¸­ï¼Œä»£ç†å¯ä»¥é€šè¿‡å°†ä»¥å‰çš„è¯·æ±‚ç»“æœç¼“å­˜åˆ°æ–°çš„cacheå±æ€§ä¸­ï¼Œä»è€Œæ›´è¿›ä¸€æ­¥çš„ä¿æŠ¤å¯¹æœ¬ä½“å¯¹è±¡httpçš„è®¿é—®ï¼ŒèŠ‚çœç½‘ç»œå¾€è¿”æ¶ˆæ¯ã€‚ ä¸­ä»‹è€…æ¨¡å¼åœ¨ä¸­ä»‹è€…æ¨¡å¼ä¸­ï¼Œç‹¬ç«‹çš„å¯¹è±¡ï¼ˆç§°ä¸ºcolleagueï¼‰ä¹‹é—´å¹¶ä¸ç›´æ¥é€šä¿¡ï¼Œè€Œæ˜¯é€šè¿‡mediatorå¯¹è±¡ã€‚å½“å…¶ä¸­ä¸€ä¸ªcolleagueå¯¹è±¡æ”¹å˜çŠ¶æ€åï¼Œå®ƒå°†ä¼šé€šçŸ¥è¯¥mediatorï¼Œè€Œmediatorå°†ä¼šæŠŠè¯¥å˜åŒ–ä¼ è¾¾åˆ°ä»»æ„å…¶ä»–åº”è¯¥çŸ¥é“æ­¤å˜åŒ–çš„colleagueå¯¹è±¡ã€‚ ç¤ºä¾‹ï¼šæŒ‰é”®æ¸¸æˆ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576// ç©å®¶function Player(name) &#123; this.points = 0; this.name = name;&#125;Player.prototype.play = function () &#123; this.points += 1; mediator.played();&#125;;// è®¡åˆ†æ¿var scoreboard = &#123; // å¾…æ›´æ–°çš„HTMLå…ƒç´  element: document.getElementById('results'), // æ›´æ–°å¾—åˆ†æ˜¾ç¤º update: function (score) &#123; var i, msg = ''; for (i in score) &#123; if (score.hasOwnProperty(i)) &#123; msg += '&lt;p&gt;&lt;strong&gt;' + i + '&lt;\/strong&gt;: '; msg += score[i]; msg += '&lt;\/p&gt;'; &#125; &#125; this.element.innerHTML = msg; &#125;&#125;;// ä¸­ä»‹è€…å¯¹è±¡var mediator = &#123; // æ‰€æœ‰ç©å®¶ï¼ˆplayerå¯¹è±¡ï¼‰ players: &#123;&#125;, // åˆå§‹åŒ–æ¸¸æˆ setup: function () &#123; var players = this.players; players.home = new Player('Home'); players.guest = new Player('Guest'); &#125;, // å¦‚æœæœ‰äººç©ï¼Œåˆ™æ›´æ–°å¾—åˆ†å€¼ played: function () &#123; var players = this.players, score = &#123; Home: players.home.points, Guest: players.guest.points &#125;; scoreboard.update(score); &#125;, // å¤„ç†ç”¨æˆ·äº¤äº’ keypress: function (e) &#123; e = e || window.event; // IE if (e.which === 49) &#123; // key "1" mediator.players.home.play(); return; &#125; if (e.which === 48) &#123; // key "0" mediator.players.guest.play(); return; &#125; &#125;&#125;;// è¿è¡Œæ¸¸æˆmediator.setup();window.onkeypress = mediator.keypress;// æ¸¸æˆåœ¨30ç§’å†…ç»“æŸsetTimeout(function () &#123; window.onkeypress = null; alert('Game over!');&#125;, 30000); è§‚å¯Ÿè€…æ¨¡å¼è§‚å¯Ÿè€…æ¨¡å¼å¹¿æ³›åº”ç”¨äºå®¢æˆ·ç«¯jsç¼–ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„æµè§ˆå™¨äº‹ä»¶ï¼ˆé¼ æ ‡æ‚¬åœï¼ŒæŒ‰é”®ç­‰äº‹ä»¶ï¼‰éƒ½æ˜¯è¯¥æ¨¡å¼çš„ä¾‹å­ã€‚å®ƒçš„å¦ä¸€ä¸ªåå­—ä¹Ÿç§°ä¸ºè‡ªå®šä¹‰äº‹ä»¶ï¼ˆcustom eventsï¼‰ï¼Œè¯¥æ¨¡å¼çš„å¦ä¸€ä¸ªåˆ«åæ˜¯è®¢é˜…/å‘å¸ƒï¼ˆsubscriber/publisherï¼‰æ¨¡å¼ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹è±¡è®¢é˜…å¦ä¸€ä¸ªå¯¹è±¡çš„ç‰¹å®šæ´»åŠ¨ï¼Œå¹¶åœ¨çŠ¶æ€æ”¹å˜åè·å¾—é€šçŸ¥ã€‚è®¢é˜…è€…ä¹Ÿç§°ä¸ºè§‚å¯Ÿè€…ï¼Œè€Œè¢«è§‚å¯Ÿçš„å¯¹è±¡ç§°ä¸ºå‘å¸ƒè€…æˆ–ä¸»é¢˜ã€‚å½“å‘ç”Ÿäº†ä¸€ä¸ªé‡è¦çš„äº‹ä»¶æ—¶ï¼Œå‘å¸ƒè€…å°†ä¼šé€šçŸ¥ï¼ˆè°ƒç”¨ï¼‰æ‰€æœ‰è®¢é˜…è€…ï¼Œå¹¶ä¸”å¯èƒ½ç»å¸¸ä»¥äº‹ä»¶å¯¹è±¡çš„å½¢å¼ä¼ é€’æ¶ˆæ¯ã€‚ ç¤ºä¾‹ï¼šæŒ‰é”®æ¸¸æˆ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162// å‘å¸ƒè€…å¯¹è±¡var publisher = &#123; // è®¢é˜…è€… // keyä¸ºè®¢é˜…çš„æ¶ˆæ¯ç±»å‹ï¼ˆé»˜è®¤ä¸º'any'ï¼‰ // valueä¸ºå›è°ƒå‡½æ•°çš„åˆ—è¡¨ subscribers: &#123; any: [] &#125;, // å³subscribeæ–¹æ³• // contextæ”¯æŒå›è°ƒæ–¹æ³•ä½¿ç”¨thisä»¥å¼•ç”¨è‡ªå·±çš„å¯¹è±¡ on: function (type, fn, context) &#123; type = type || 'any'; fn = typeof fn === "function" ? fn : context[fn]; if (typeof this.subscribers[type] === "undefined") &#123; this.subscribers[type] = []; &#125; this.subscribers[type].push(&#123;fn: fn, context: context || this&#125;); &#125;, // å³unsubscribeæ–¹æ³• remove: function (type, fn, context) &#123; this.visitSubscribers('unsubscribe', type, fn, context); &#125;, // å³publishæ–¹æ³• // publicationä¸ºä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•° fire: function (type, publication) &#123; this.visitSubscribers('publish', type, publication); &#125;, // helpéå†æ–¹æ³• visitSubscribers: function (action, type, arg, context) &#123; var pubtype = type || 'any', subscribers = this.subscribers[pubtype], i, max = subscribers ? subscribers.length : 0; for (i = 0; i &lt; max; i += 1) &#123; if (action === 'publish') &#123; // æ”¯æŒå›è°ƒæ–¹æ³•ä½¿ç”¨thisæŒ‡å‘è‡ªèº«å¯¹è±¡ // argä¸ºä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œå¤šå‚æ•°è¯·ç”¨å¯¹è±¡åŒ…èµ·æ¥ subscribers[i].fn.call(subscribers[i].context, arg); &#125; else &#123; // å–æ¶ˆè®¢é˜… if (subscribers[i].fn === arg &amp;&amp; subscribers[i].context === context) &#123; subscribers.splice(i, 1); &#125; &#125; &#125; &#125;&#125;;// ä½¿ä¸€ä¸ªå¯¹è±¡æˆä¸ºä¸€ä¸ªå‘å¸ƒè€…function makePublisher(o) &#123; var i; for (i in publisher) &#123; if (publisher.hasOwnProperty(i) &amp;&amp; typeof publisher[i] === "function") &#123; o[i] = publisher[i]; &#125; &#125; // éå‡½æ•°æˆå‘˜ä¸èƒ½å¤ç”¨æŒ‡é’ˆï¼Œéœ€åˆ›å»ºæ–°å¯¹è±¡ o.subscribers = &#123;any: []&#125;;&#125;// ç©å®¶function Player(name, key) &#123; this.points = 0; this.name = name; this.key = key; // è§¦å‘äº‹ä»¶ this.fire('newplayer', this);&#125;Player.prototype.play = function () &#123; this.points += 1; // è§¦å‘äº‹ä»¶ this.fire('play', this);&#125;;// æ¸¸æˆæ§åˆ¶var game = &#123; // è®°å½•ç©å®¶ // keyä¸ºæŒ‰é”®ï¼Œvalueä¸ºç©å®¶å¯¹è±¡ keys: &#123;&#125;, addPlayer: function (player) &#123; var key = player.key.toString().charCodeAt(0); this.keys[key] = player; &#125;, // å¤„ç†ç”¨æˆ·äº¤äº’ handleKeypress: function (e) &#123; e = e || window.event; // IE if (game.keys[e.which]) &#123; game.keys[e.which].play(); &#125; &#125;, // å¦‚æœæœ‰äººç©ï¼Œåˆ™æ›´æ–°å¾—åˆ†å€¼ handlePlay: function (player) &#123; var i, players = this.keys, score = &#123;&#125;; for (i in players) &#123; if (players.hasOwnProperty(i)) &#123; score[players[i].name] = players[i].points; &#125; &#125; // è§¦å‘äº‹ä»¶ this.fire('scorechange', score); &#125;&#125;;// è®¡åˆ†æ¿var scoreboard = &#123; // å¾…æ›´æ–°çš„HTMLå…ƒç´  element: document.getElementById('results'), // æ›´æ–°å¾—åˆ†æ˜¾ç¤º update: function (score) &#123; var i, msg = ''; for (i in score) &#123; if (score.hasOwnProperty(i)) &#123; msg += '&lt;p&gt;&lt;strong&gt;' + i + '&lt;\/strong&gt;: '; msg += score[i]; msg += '&lt;\/p&gt;'; &#125; &#125; this.element.innerHTML = msg; &#125;&#125;;// å‘å¸ƒ/è®¢é˜…ç»‘å®šmakePublisher(Player.prototype); // æ³¨æ„Playerè¦ç»‘åœ¨prototypeä¸Šï¼Œé¿å…å¤šä»½æ‹·è´makePublisher(game);Player.prototype.on("newplayer", "addPlayer", game);Player.prototype.on("play", "handlePlay", game);game.on("scorechange", scoreboard.update, scoreboard);window.onkeypress = game.handleKeypress;// è¿è¡Œæ¸¸æˆvar playername, key;while (1) &#123; playername = prompt("Add player (name)"); if (!playername) &#123; break; &#125; while (1) &#123; key = prompt("Key for " + playername + "?"); if (key) &#123; break; &#125; &#125; new Player(playername, key); &#125; ä¸­ä»‹è€…VSè§‚å¯Ÿè€…åœ¨ä¸­ä»‹è€…æ¨¡å¼çš„å®ç°ä¸­ï¼Œmediatorå¯¹è±¡å¿…é¡»çŸ¥é“æ‰€æœ‰å…¶ä»–å¯¹è±¡ï¼Œä»¥ä¾¿åœ¨æ­£ç¡®çš„æ—¶é—´è°ƒç”¨æ­£ç¡®çš„æ–¹æ³•å¹¶ä¸”ä¸æ•´ä¸ªæ¸¸æˆç›¸åè°ƒã€‚è€Œåœ¨è§‚å¯Ÿè€…æ¨¡å¼ä¸­ï¼Œgameå¯¹è±¡æ˜¾å¾—æ›´ç¼ºä¹æ™ºèƒ½ï¼Œå®ƒä¸»è¦ä¾èµ–äºå¯¹è±¡è§‚å¯ŸæŸäº›äº‹ä»¶å¹¶é‡‡å–è¡ŒåŠ¨ã€‚æ¯”å¦‚ï¼Œscoreboardç›‘å¬scorechangeäº‹ä»¶ã€‚è¿™å¯¼è‡´äº†æ›´ä¸ºæ¾æ•£çš„è€¦åˆï¼ˆè¶Šå°‘çš„å¯¹è±¡çŸ¥é“è¶Šå°‘ï¼‰ï¼Œå…¶ä»£ä»·æ˜¯åœ¨è®°å½•è°ç›‘å¬ä»€ä¹ˆäº‹ä»¶æ—¶æ˜¾å¾—æ›´å›°éš¾ä¸€ç‚¹ã€‚ åœ¨æœ¬ä¾‹çš„æ¸¸æˆä¸­ï¼Œæ‰€æœ‰è®¢é˜…è¡Œä¸ºéƒ½å‡ºç°åœ¨ä»£ç ç‰‡æ®µçš„åŒä¸€ä½ç½®ï¼Œä½†æ˜¯éšç€åº”ç”¨ç¨‹åºçš„å¢é•¿ï¼Œon()è°ƒç”¨å¯èƒ½åˆ°å¤„éƒ½æ˜¯ï¼ˆä¾‹å¦‚åœ¨æ¯ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–ä»£ç ä¸­ï¼‰ã€‚è¿™ä¼šä½¿å¾—è¯¥ç¨‹åºéš¾ä»¥è°ƒè¯•ï¼Œå› ä¸ºç°åœ¨æ— æ³•ä»…åœ¨å•ä¸ªä½ç½®æŸ¥çœ‹ä»£ç å¹¶ç†è§£åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ã€‚åœ¨è§‚å¯Ÿè€…æ¨¡å¼ä¸­ï¼Œå¯ä»¥æ‘†è„±é‚£ç§ä»å¼€å§‹ä¸€ç›´è·Ÿéšåˆ°æœ€åçš„é‚£ç§è¿‡ç¨‹å¼é¡ºåºä»£ç æ‰§è¡Œçš„ç¨‹åºã€‚ å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç…®ç²¥è®°]]></title>
    <url>%2Fblog%2F2014%2F07%2Fmy-congee-cooking.html</url>
    <content type="text"><![CDATA[æœ¬äººä¹Ÿç®—å‡ºè‡ªåŠä¸ªâ€œå¨è‰ºä¸–å®¶â€ï¼Œæˆ‘çˆ·çˆ·åœ¨é‚£æ—¶çš„å¤§åŒ…å¹²é£Ÿå ‚åšäº†30å¹´çš„å¨å¸ˆï¼Œåˆ°é€€ä¼‘æ—¶é¢†å¯¼è¿˜ä¸è‚¯æ”¾äººï¼Œå†è˜è¯·ä»–å†å¹²5å¹´ã€‚æˆ‘çˆ¸åˆ™æ˜¯åœ¨å®¶çƒ§äº†20å¹´çš„é¥­ï¼Œéƒ¨åˆ†ç»§æ‰¿äº†çˆ·çˆ·çš„æ‰‹è‰ºï¼Œéƒ¨åˆ†è¿˜æ”¹è‰¯äº†ã€‚è¦æ˜¯å»å¤–é¢å¼€ä¸ªå°é¥­åº—ï¼Œç»å¯¹æ˜¯è¢«äººç§°èµå¥½åƒçš„ã€‚ è®ºå¨è‰ºå˜›æˆ‘æ˜¯æˆ˜äº”æ¸£ï¼Œåƒè‡ªåŠ©çš„æˆ˜æ–—åŠ›å€’æ˜¯ç™¾åˆ†ç™¾ã€‚è‡ªä»å®¿èˆæœ‰äº†ç”µç£ç‚‰ï¼Œä¹Ÿå­¦ä¼šäº†ç‚¹è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿï¼Œå’³å’³â€¦â€¦ æœ€è¿‘ç…®äº†å¥½å¤šç²¥ï¼Œå°è¯•äº†é“¶è€³æ±¤çš„å„ç§åšæ³•ã€‚èµ·ç æ¯”æˆ‘ä»¥å‰ç…®æŒ‚é¢å¥½å¤šäº† çº¢ç³–å¤§æ£ç³¯ç±³ç²¥ææ–™ åœ†ç³¯ç±³ çº¢æ£ çº¢ç³– å·¥åº æ²¸è…¾åè¦æ”¹å°ç«ï¼Œè€Œä¸”æ—¶ä¸æ—¶è¦ç”¨å‹ºå­æ…æ‹Œï¼Œä»¥å…ç²˜é”… ç‚–åˆ°ç³¯ç±³å‘ç¨ ï¼Œç„¶åå†åŠ çº¢ç³– æ’æ›² ç”±äºç¬¬ä¸€æ¬¡ç…®ç²¥æ²¡ç»éªŒï¼Œç±³æ”¾å¤ªå¤šäº†ï¼Œå›¾ä¸­æ»¡æ»¡ä¸€é”…æœ‰æœ¨æœ‰ï¼Œè€Œä¸”å°±ä¸¤ä¸ªäººåƒ=_= åˆšå¼€å§‹è¿˜å¿˜äº†æ…æ‹Œï¼Œçƒ§ç³Šäº†ï¼Œè¿˜å¥½æœºæ™ºçš„çº¢ç³–å›è‡ªå¸¦äº†ç”Ÿå§œæœ«ï¼ˆå› ä¸ºä»–å«ç”Ÿå§œçº¢ç³–ï¼Œä¸æ˜¯æœˆæœˆçº¢ç³–ï¼ï¼‰ ç”Ÿå§œå†²æ·¡äº†ç„¦å‘³ï¼Œåªè¦ä¸è¯´ï¼Œä¸ä¼šè§‰å¾—è¿™æ˜¯çƒ§ç³Šçš„ç²¥ã€‚ã€‚ã€‚ é“¶è€³è²å­æœ¨ç“œæ±¤ææ–™ é“¶è€³ æœ¨ç“œ è²å­ã€æ¸æå°‘è®¸ å¤§å—çš„é»„å†°ç³– å‡†å¤‡ å°†é“¶è€³æµ¸äºå†·æ°´ä¸­ï¼Œæ³¡ä¸¤ä¸ªå°æ—¶ï¼Œç„¶åå»æ‰é»„è‰²çš„æ ¹éƒ¨ åŒæ ·å°†è²å­æµ¸äºæ°´ä¸­ï¼Œå‰¥å¼€å°†å…¶ç»¿è‰²çš„èŠ¯å»é™¤ æœ¨ç“œå»çš®åˆ‡å— å·¥åº å°†é“¶è€³å’Œè²å­ä¸€èµ·ä¸¢å…¥é”…ä¸­ï¼Œå€’å…¥ä¸¤å€é«˜åº¦çš„æ°´ å¾…æ°´æ²¸è…¾åæ”¹å°ç«æ…¢ç‚– 15-20åˆ†é’Ÿåæ”¾æœ¨ç“œ å¾…æ±¤æ°´å¼€å§‹ç²˜ç¨ æ—¶æ”¾å…¥é€‚é‡çš„å¤§å—é»„å†°ç³– å†æ…¢ç‚–10åˆ†é’Ÿ æ’’å…¥å°‘è®¸æ¸æ ç»§ç»­ç„–10åˆ†é’Ÿ æ³¨æ„ ç‚–é“¶è€³æ±¤æ˜¯ä¸ªæ…¢æ´»ï¼Œè™½ç„¶é“¶è€³ä¸ä¼šçƒ§ç³Šï¼Œä½†æ˜¯ä¼šèµ·æ³¡æ²«å®¹æ˜“å™—ã€‚å› ä¸ºæˆ‘åˆæ˜¯æ»¡æ»¡ä¸€é”…ï¼ˆ=_=ï¼‰æ‰€ä»¥å°ç«æ…¢ç‚–çš„æ—¶å€™åœ¨é”…ä¸Šæ¶ä¸¤æ ¹ç­·å­ï¼ŒæŠŠé”…ç›–éš”å¼€ã€‚å‰åå·®ä¸å¤šç‚–äº†è¿‘ä¸€ä¸ªå°æ—¶ï¼Œæˆ‘å–œæ¬¢åƒç²˜ç¨ çš„ï¼Œåªèƒ½è¿™æ ·â€¦â€¦ é“¶è€³è²å­çº¢æ£æ±¤ææ–™å¤§ä½“åŒä¸Šï¼Œå°†æœ¨ç“œæ¢æˆçº¢æ£ã€‚ å·¥åº å°†é“¶è€³ã€è²å­å’Œçº¢æ£ä¸€èµ·ä¸¢å…¥é”…ä¸­ï¼Œå€’å…¥ä¸¤å€é«˜åº¦çš„æ°´ å¾…æ°´æ²¸è…¾åæ”¹å°ç«æ…¢ç‚– å¾…æ±¤æ°´å¼€å§‹ç²˜ç¨ æ—¶æ”¾å…¥é€‚é‡çš„å¤§å—é»„å†°ç³– å†æ…¢ç‚–ç›´åˆ°ä½ æƒ³åƒçš„ç¨ åº¦ æ³¨æ„ çº¢æ£è¦å‰¥å¼€ç¼åå†ä¸¢å…¥ï¼Œè¿™æ ·èƒ½æ›´å…¥å‘³~ é“¶è€³å’Œçº¢æ£ç»å¯¹æ˜¯å¤©ç”Ÿä¸€å¯¹ï¼ é“¶è€³è²å­çº¢æ£å—ç“œç¾¹ææ–™å¤§ä½“åŒä¸Šï¼Œå¤šæ”¾ä¸ªå—ç“œã€‚å—ç“œä¹Ÿè¦ä¸€å¼€å§‹å°±ä¸¢å…¥é”…ä¸­ã€‚ æ”¾äº†å—ç“œå›è¿‡åè²Œä¼¼å°±ä¸å®¹æ˜“ç²˜ç¨ äº†=_= ç³¯ç±³ç™½ç²¥æŸæ—©ä¸‹å¤§é›¨ï¼Œæ‡’å¾—å‡ºé—¨åƒæ—©é¥­ï¼Œå°±ç”¨ç³¯ç±³ç…®äº†ç‚¹ç™½ç²¥åƒã€‚ è¦æ³¨æ„å°ç«æ…¢ç‚–ï¼Œå¹¶ä¸”æ—¶ä¸æ—¶æ…æ‹Œï¼Œå…å¾—ç²˜é”…çƒ§ç³Šäº†ã€‚ ç™½ç²¥æ±¤ç•¥å¸¦ä¸€ç‚¹ç¨ ï¼Œå¾ˆå¥½å–ã€‚é…ä¸Šæ¦¨èœï¼Œå—¯å—¯ æ€»ç»“ä¸è¦ä½ä¼°äº†ç³¯ç±³çš„å®åŠ›ï¼Œçœ‹ä¸Šå»ä¸€ç‚¹ç‚¹ç…®å‡ºæ¥åƒäº†è¯´ä¸å®šå°±é¥±äº†ã€‚ è¯•äº†ä¸‰ç§æ··æ–™çš„é“¶è€³æ±¤ï¼Œé“¶è€³+æœ¨ç“œï¼Œé“¶è€³+çº¢æ£ï¼Œé“¶è€³+å—ç“œï¼Œäº²æµ‹è¿˜æ˜¯é“¶è€³+çº¢æ£æœ€å¥½åƒï¼Œçº¢æ£å’Œé»„å†°ç³–çš„ç”œå‘³æ˜¯ä¸€ä¸ªæ–¹å‘çš„ã€‚è€ŒåŠ äº†æœ¨ç“œå®¹æ˜“ä¸²å‘³ï¼Œå—ç“œçš„è¯è¿˜å¯ä»¥ã€‚ ç‚ç‚å¤æ—¥åƒé“¶è€³çº¢æ£æ±¤æ˜¯ä¸æ˜¯ç•¥è¡¥â€¦â€¦ä¸‹æ¬¡è¯•ä¸‹ç»¿è±†æ±¤ï¼Œæˆ‘è¦åšæœ€å¥½åƒçš„ç»¿è±†æ±¤ã€‚åŠ è–„è·åŠ çº¢ç»¿ä¸çš„é‚£ç§ç»¿è±†æ±¤ï¼Œåªåœ¨å°æ—¶å€™å–è¿‡ï¼Œæˆ‘è¦è¿˜åŸè®°å¿†ä¸­çš„å‘³é“ï¼]]></content>
      <categories>
        <category>life</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[äººæœºäº¤äº’ä½œä¸šæ£€æŸ¥çš„ä¸€ç‚¹æ„Ÿæƒ³â€”â€”æš¨å‰ç«¯é˜¶æ®µæ€»ç»“]]></title>
    <url>%2Fblog%2F2014%2F07%2Ftrivial-thoughts-after-hci-homework-checking.html</url>
    <content type="text"><![CDATA[ä»Šå¤©å¸®åŒå­¦å½“äº†â€œäººæœºäº¤äº’â€è¯¾åŠ©æ•™çš„è‹¦åŠ›ï¼Œæˆ‘ä»¥å‰ä¸€ç›´å¾ˆé„™è§†è¿™ç§â€œæ–‡æ¡£é©±åŠ¨â€çš„è¯¾çš„ï¼Œè¯¾ä¸Šå…‰è®²å„ç§XXåŸåˆ™ï¼Œå†çœ‹äº›å¤©èŠ±ä¹±å çš„è§†é¢‘ï¼Œæœ€åè¿˜æ˜¯ä»¥è®¾è®¡æ–‡æ¡£ä¸ºä¸»åŠ›ã€‚å­¦é™¢ä¸»æ‰“è½¯å·¥ç±»çš„è¯¾ç¨‹ï¼Œè¿˜è¢«æˆè°‘â€œæ–‡æ¡£å­¦é™¢â€ =_= Knowing is not enough, we must apply. Willing is not enough, we must do. è¿™ä¸¤å¥è¯å¥½åƒæ˜¯Bruce Leeè¯´çš„ã€‚åœ¨æˆ‘ä»¬09çº§ä¹‹åï¼Œå­¦é™¢è¿™æ–¹é¢ç•¥æœ‰æ”¹å–„ã€‚ä»Šå¹´äººæœºäº¤äº’çš„ä½œä¸šæ˜¯åŸºäºè‡ªå·±ä»¥å¾€åšè¿‡çš„é¡¹ç›®ï¼Œå¯¹äº¤äº’æ–¹é¢åšæ”¹è¿›ã€‚å…«æˆçš„å°ç»„éƒ½åšçš„æ˜¯Webé¡¹ç›®ï¼Œäºæ˜¯ä»–ä»¬åˆæ’æˆ‘æªå£äº†ï¼Œæƒ³å¿½æ‚ æˆ‘no way æˆ‘æƒ³äº†ä¸‹ä»–ä»¬çš„ä¸€äº›ç‰¹å¾ï¼Œå½’äº†å½’ç±»ï¼Œä»¥äººä¸ºé•œï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±çš„åæ€ã€‚ å…³äºå¿½æ‚ æˆ‘ä¸€ç›´ä½©æœå®éªŒå®¤ä¸€åšå£«çš„äº¤é™…èƒ½åŠ›ï¼Œå¿½æ‚ æ—¶ä¸€ç‚¹éƒ½ä¸è™šï¼Œèƒ½æŠŠæ²¡æœ‰çš„è¯´å·²ç»æœ‰äº†ã€‚è¦å¿½æ‚ é¦–å…ˆä½ è¦å¿ƒç†ç´ è´¨å¥½ï¼Œè¿˜è¦é ç»éªŒï¼Œå°½é‡å¾€å®¢æˆ·æ–¹é¢é ã€‚å°±åƒä¹°é‹ï¼Œä¸æ˜¯ä½ å¤šå¤§è„šä¹°å¤šå¤§é‹ï¼Œè€Œæ˜¯ä»–å¤šå¤§é‹ä½ å°±å¤šå¤§è„šã€‚è¿˜æœ‰å¿½æ‚ æˆåŠŸçš„é‡è¦å› ç´ è¿™æ–¹é¢ä½ çŸ¥é“çš„è¦æ¯”å®¢æˆ·çŸ¥é“çš„å¤šçš„å¤šã€‚ å›åˆ°äººæœºäº¤äº’ä½œä¸šï¼Œå¤§éƒ¨åˆ†äººåšçš„éƒ½æ˜¯webé¡µé¢ä¸Šçš„æ”¹è¿›ï¼Œæˆ‘ä¸“åšå‰ç«¯ä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ã€‚æˆ‘è·Ÿä»–ä»¬è¯´ä¸æ˜¯çš„åœ°æ–¹ï¼Œå±…ç„¶è¿˜æœ‰äººè¦ç‹¡è¾©æƒ³å¿½æ‚ æˆ‘ï¼ŒçœŸæ˜¯too youngäº†ã€‚ å…³äºæ¡†æ¶å’Œæ’ä»¶è¶…è¿‡ä¸€åŠçš„å°ç»„éƒ½ç”¨äº†Bootstrapå¤§æ³•ï¼Œå§æ§½çœŸæ˜¯çƒ­ï¼åšå‰ç«¯ç”¨ç”¨æ¡†æ¶å’Œæ’ä»¶å¾ˆæ­£å¸¸ï¼Œä½†è‡³å°‘è¦ä¿è¯æ’ä»¶ä¹‹é—´çš„å…¼å®¹ï¼Œè‡³å°‘æ”¹æ”¹ç”»é£ï¼Œä¸èƒ½çœ‹èµ·æ¥åƒä¸¤ä¸ªæ ¼æ ¼ä¸å…¥çš„ç³»ç»Ÿé£æ ¼ã€‚æœ‰äººè·Ÿæˆ‘ç‹¡è¾©è¯´â€œä»€ä¹ˆä»€ä¹ˆæ’ä»¶ç”¨äº†åä»€ä¹ˆä»€ä¹ˆåœ°æ–¹ä¼šå‡ºé—®é¢˜â€ï¼Œæˆ‘è¯´â€œä¸æ˜¯æ’ä»¶çš„é—®é¢˜ï¼Œæ˜¯ä½ ä¸ä¼šâ€ã€‚è¿™ä¹Ÿåæ˜ äº†ä»–ä»¬å¯¹æ’ä»¶çš„è¿‡äºä¾èµ–ï¼Œè€Œä¸”åœ¨ä¸€çŸ¥åŠè§£çš„æƒ…å†µä¸‹çš„è¿‡äºä¾èµ–ã€‚ æˆ‘åæ¥è·Ÿä¸€ä½åŒå­¦äº¤æµäº†ä¸‹ï¼Œæˆ‘è¯´åˆšä¸Šæ¥æ—¶ç”¨æ¡†æ¶ç”¨æ’ä»¶ç¡®å®èƒ½å‡å°‘å¾ˆå¤šå·¥ä½œé‡ï¼Œä½†æ˜¯ä½ è¦çŸ¥é“æ¯æ ·ä¸œè¥¿çš„é€‚åˆä¹‹å¤„å’Œä¸é€‚åˆä¹‹å¤„ï¼Œä½ è¦çŸ¥é“å®ƒå¥½åœ¨å“ªé‡Œã€‚ä¹‹åä½ å°±è¦å­¦å­¦å®ƒä»¬èƒŒåçš„ç†å¿µï¼Œå­¦ä¼šæ‰©å±•å®ƒä»¬ï¼Œç”šè‡³å¯ä»¥ä¾æ ·ç”»è‘«èŠ¦åšä¸€ä¸ªç±»ä¼¼çš„æ’ä»¶ã€‚ ä»€ä¹ˆæ˜¯äº¤äº’çš„æ”¹è¿›ä¹Ÿè®¸æ˜¯å­¦é™¢ä»å¤§ä¸€åˆ°å¤§ä¸‰éƒ½å¼ºè°ƒçš„æ˜¯åç«¯ç¼–ç¨‹ï¼Œæ ¹æ·±è’‚å›ºçš„Javaä¹ æƒ¯ï¼Œå¥½å¤šå­¦ç”Ÿä¸çŸ¥é“äº¤äº’ä¸Šè¦æ”¹è¿›ä»€ä¹ˆã€‚æœ‰äººå°±ä»¥ä¸ºæ˜¯åŠŸèƒ½ä¸Šçš„æ”¹è¿›ï¼ŒåˆåŠ åŠŸèƒ½ï¼Œæˆ–è€…æ˜¯æŠŠåŠŸèƒ½çš„åå°å¤„ç†æ›´å¥½äº›ã€‚ä¹Ÿæœ‰äººä»¥ä¸ºå°±æ˜¯æ”¹æ”¹å¤–è§‚ã€‚è¦ä¹ˆå°±æ˜¯ä»–ä»¬å·æ‡’ï¼Œä¸ç„¶è¿™é—¨è¯¾çœŸæˆâ€œæ”¿æ²»è¯¾â€äº†ã€‚äºæ˜¯æˆ‘å°±æœ‰äº†å¥‡è‘©çš„è¯„åˆ†æ ‡å‡†ï¼šçœ‹è¡¨å•éªŒè¯ï¼Œçœ‹æ¶ˆæ¯çš„å¼¹æ¡†ï¼Œçœ‹åˆ†é¡µï¼Œçœ‹ç«™å†…æœç´¢ï¼Œçœ‹ç”¨æˆ·è¾“å…¥æ˜¯å¦ç®€å•ï¼Œè¿˜æœ‰æœ€é‡è¦çš„æ˜¯çœ‹æ•´ä½“å¸ƒå±€å’Œè‰²è°ƒæ˜¯å¦åƒä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿã€‚ è¿˜æœ‰ä¸€ç‚¹æ„Ÿè§¦æ˜¯ï¼Œä½œä¸šæ¯•ç«Ÿæ˜¯ä½œä¸šï¼Œæ€ä¹ˆç®€å•æ€ä¹ˆæ¥ï¼Œç›´æ¥ä¸€ä¸ªalertï¼Œç›´æ¥ä¸€ä¸ª&lt;input type=&quot;date&quot;&gt;â€¦â€¦ æƒ³æƒ³æˆ‘å¤§ä¸‰çš„æ—¶å€™ä¹Ÿæ˜¯è¿™æ ·çš„&gt;_&lt; å½“ç„¶ä¹Ÿæœ‰å‰å®³çš„äººï¼Œåšçš„çœ‹èµ·æ¥çœŸåƒä¸€ä¸ªå¯ä»¥å‘å¸ƒçš„äº§å“äº†ã€‚ å‰ç«¯çš„è¯¯åŒºå‰ç«¯ â‰  å†™ç½‘é¡µçš„ å‰ç«¯ â‰  CSSæ¡†æ¶ + jQuery + æ‚ä¸ƒæ‚å…«æ’ä»¶ + w3schoolæ‰‹å†Œ å‰ç«¯æ—¢æ˜¯æœ€å®¹æ˜“çš„ï¼Œåˆæ˜¯æœ€ä¸å®¹æ˜“çš„ã€‚ è¿™å¥è¯ä¸æ˜¯å“ªæŠ„çš„ï¼Œæ˜¯æˆ‘è‡ªå·±çš„çœŸå®æ„Ÿå—ã€‚å‰ç«¯é—¨æ§›ä½ï¼Œä¸‰ä»¶å¥—ï¼ˆHTML+CSS+JSï¼‰åœ¨w3schoolä¸Šä¸‰å¤©å°±èƒ½é€Ÿæˆï¼Œè€Œä¸”è¿˜æœ‰Bootstrapã€Metro UIç­‰æ¡†æ¶ç»„ä»¶çš„å­˜åœ¨ï¼Œå†é…åˆjQueryï¼Œä»é›¶å¼€å§‹åŠä¸ªæœˆå°±èƒ½æä¸ªé€¼æ ¼åè¶³çš„ç½‘ç«™å‡ºæ¥ã€‚å†åŠ ä¸Šå‰ç«¯å›ºæœ‰çš„â€œå¼€æºâ€ç‰¹æ€§ï¼Œä¸ä¼šçš„åœ°æ–¹å¯ä»¥ä¾æ ·ç”»è‘«èŠ¦ã€‚æ‰€ä»¥å‰ç«¯æ˜¯æœ€å®¹æ˜“çš„ã€‚ ä½†å¦‚æœåªåœç•™åœ¨â€œäºŒåä¸€å¤©ç²¾é€šXXXâ€çš„ç¨‹åº¦ï¼Œæ°¸è¿œä¹Ÿå…¥ä¸äº†é—¨ã€‚æ¡†æ¶ä¸€ç›´åœ¨å˜ï¼Œæ°¸è¿œè¢«å®ƒç‰µç€é¼»å­èµ°ï¼Œæ²¡æœ‰è‡ªå·±çš„ç†è§£æ˜¯ä¸è¡Œçš„ã€‚çœ‹è¿‡æœ‰ä½åšä¸»è¯´â€œå‰ç«¯ä¸ä»…ä»…æ˜¯å®ç°é¡µé¢ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆçš„èŒè´£æ˜¯è¿ç”¨åˆç†çš„æ–¹æ³•è®©å¼€å‘å˜å¾—é«˜æ•ˆï¼Œè®©ç”¨æˆ·ä½“éªŒæœ€ä½³â€ã€‚è¿™é‡Œè¯´çš„å°±æ˜¯è½¯ä»¶å·¥ç¨‹ã€ä½“ç³»ç»“æ„ã€è®¾è®¡æ¨¡å¼ï¼Œä»¥åŠäººæœºäº¤äº’é‡Œçš„ä¸œè¥¿ï¼Œè€Œè¿™äº›è¯¾æ­£æ˜¯æˆ‘å¤§è½¯é™¢çš„ä¸»çº¿ã€‚æˆ‘ä»¬åº”è¯¥æŠŠé‚£äº›ä¸€å¥—å¥—çš„æ¨¡å‹å’ŒåŸåˆ™æ¸—é€åˆ°å®é™…çš„é¡¹ç›®æ“ä½œä¸­å»ï¼Œè€Œä¸æ˜¯æŠŠé‚£äº›è¯¾å½“æˆâ€œæ”¿æ²»è¯¾â€å»èƒŒã€‚ æˆ‘ä¸å‰ç«¯æƒ³åˆ°æˆ‘è‡ªå·±åˆ°å¤§ä¸‰æ‰åˆšç¢°webé¡¹ç›®ï¼ˆä¹‹å‰éƒ½æ˜¯å¤§è½¯é™¢æ ‡é…çš„Javaå®¢æˆ·ç«¯ï¼‰ï¼Œä¹Ÿæ˜¯ä»æœ€æœ€åŸºç¡€çš„å¼€å§‹çœ‹ï¼Œè¾¹çœ‹è¾¹åšã€‚å¤§ä¸‰æš‘å‡åœ¨å¤–é¢å°ä½œåŠå®ä¹ çš„æ—¶å€™ï¼Œè€æ¿éƒ½æ˜¯æŒ‰åŠŸèƒ½åˆ†å·¥çš„ï¼Œä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½ä»æ•°æ®åº“æ”¹è¡¨å¼€å§‹ï¼Œç„¶åä¸€ç›´åšåˆ°ç•Œé¢ã€‚æ¯å›éƒ½æ˜¯æŠŠåº•ä¸‹çš„é€»è¾‘ç†æ¸…æ¥šäº†ï¼Œæœ€åçº ç»“åœ¨ç•Œé¢ä¸Šï¼Œä¸€ä¸ªæŒ‰é’®ä¸€ä¸ªç¼–è¾‘åŒºåŸŸä¸€ä¸ªAjaxéƒ½è¦æŠ˜è…¾å¥½ä¹…ã€‚å½“æ—¶å°±çŸ¥é“w3schoolæ‰‹å†Œï¼Œæœ‰é—®é¢˜å°±ç™¾åº¦ï¼Œåˆ«äººå¥½å¥½çš„ï¼Œåˆ°æˆ‘è¿™é‡Œéƒ½å‡ºé—®é¢˜ï¼Œå¯¹çŸ¥è¯†éƒ½ä¸€çŸ¥åŠè§£ï¼Œè€æ¿è¿˜ä¸€ä¸ªåŠ²å„¿çš„å‚¬ã€‚ è¯´åˆ°åº•å½“æ—¶çš„å„ç§ä¸é¡ºéƒ½æ˜¯å› ä¸ºæ²¡æœ‰é™ä¸‹å¿ƒç³»ç»Ÿåœ°å­¦è¿‡webã€‚å¯¹æŠ€æœ¯ä¸Šçš„æµ®èºå’Œæµ…å°è¾„æ­¢çš„å¿ƒï¼Œåˆè®©æˆ‘æƒ³æ¢åˆ«çš„ç©äº†ã€‚åæ¥ä¸å‰ç«¯çš„ç»“ç¼˜æ˜¯æœ¬ç§‘æ¯•è®¾æ—¶ï¼Œåˆ†å·¥å°±æŒ‰å‰åç«¯åˆ†ï¼Œå› ä¸ºåç«¯é€‰æ‹©çš„è¯­è¨€æˆ‘ä¸ä¼šï¼Œæ‰€ä»¥æˆ‘å°±æŒ‘äº†å‰ç«¯ =_= é‚£æ—¶çŸ¥é“äº†Bootstrapç¥å¥‡çš„å­˜åœ¨ï¼Œç†Ÿç»ƒäº†jQueryå¤§æ³•çš„å¸¸è§æ“ä½œï¼Œéº»éº»å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘åšwebäº†â€¦â€¦ ä½†äº²çˆ±çš„é‚£å¹¶ä¸æ˜¯çˆ±æƒ… æ¸æ¸æ˜ç™½åªä¼šç”¨ç”¨æ’ä»¶ï¼Œç»ˆç©¶æ˜¯ä¸ªæ²¡æœ‰çµé­‚çš„èº¯å£³ã€‚åæ¥è®¤çœŸçš„çœ‹äº†çœ‹CSSä¸­çš„ä¸€äº›å®šä¹‰ï¼Œè¯•å›¾åƒæœºå™¨ä¸€æ ·å»ç†è§£ä¸€äº›å¸¸è§çš„CSSè§„åˆ™ã€‚å†é™ä¸‹å¿ƒçœ‹äº†äº›åŸç”Ÿjavascriptçš„çŸ¥è¯†ï¼Œç†è§£å…¶è¯­è¨€æœºåˆ¶ï¼Œå¯ä»¥æ›´å¥½çš„ç”¨å¥½jQueryè¿™æŠŠåˆ€ã€‚ æœ€åæ¨èå‡ æœ¬ä¹¦ç²¾é€šCSSä¸HTMLè®¾è®¡æ¨¡å¼ JavaScriptè‰ºæœ¯ä¸ç§‘å­¦ JavaScriptæ¨¡å¼ JavaScriptè®¾è®¡æ¨¡å¼ æœ€è¿‘åœ¨å­¦ä¹ JavaScriptæ¡†æ¶è®¾è®¡ çœŸçš„å¥½éš¾&gt;_&lt; è¿˜æœ‰å¥½å¤šè·¯è¦èµ°ï¼Œé˜¶æ®µæ€§è®°å½•ä¸‹ï¼Œä»¥æ¿€åŠ±è‡ªå·±ç»§ç»­å‰è¡Œã€‚]]></content>
      <categories>
        <category>å¹æ°´</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨PhantomJså¯¹ç½‘é¡µæˆªå›¾]]></title>
    <url>%2Fblog%2F2014%2F06%2Fuse-phantomjs-to-capture-webpage.html</url>
    <content type="text"><![CDATA[é—®é¢˜æ¥æºæˆ‘ä»¬åœ¨åšä¸€ä¸ªç”µå•†æ•°æ®åˆ†æçš„é¡¹ç›®ï¼Œwebå‰ç«¯çš„æ•°æ®å±•ç¤ºä½¿ç”¨çš„æ˜¯Highchartsåº“ã€‚ç›®å‰æˆ‘ä»¬çš„é¡¹ç›®æ­£åœ¨åšç§»åŠ¨ç‰ˆï¼Œä»¥å¾®ä¿¡æ¶ˆæ¯æˆ–å¾®åšçš„å½¢å¼ç»™ç”¨æˆ·æ¨é€summaryä¿¡æ¯ï¼Œç„¶åå†ä»¥æ‰‹æœºæµè§ˆå™¨çš„å½¢å¼å±•ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚è¿™é‡Œå°±å­˜åœ¨ä¸ªé—®é¢˜ï¼Œé¦–å…ˆï¼ŒHighchartsæ˜¯ä¾èµ–jQueryçš„ï¼Œè¿™ä¸¤ä¸ªåº“å¯¹äºç§»åŠ¨ç«¯æ¥è¯´æœ‰ç‚¹å¤§äº†ï¼Œç§»åŠ¨webç«¯ç›®å‰æµè¡Œä½¿ç”¨æ›´è½»é‡çº§çš„zeptoæ¥ä»£æ›¿jQueryã€‚å…¶æ¬¡ï¼ŒHighchartsçš„å›¾è¡¨ç±»å‹åœ¨æ‰‹æœºæµè§ˆå™¨ä¸Šå¹¶ä¸èƒ½å¾ˆå¥½çš„æ”¯æŒï¼Œä¼šå‡ºç°æœ‰äº›å›¾è¡¨æ— æ³•æ­£ç¡®æ˜¾ç¤ºï¼Œæ¯”å¦‚bar-stackedå›¾ã€‚ é€€è€Œæ±‚å…¶æ¬¡ç§»åŠ¨ç‰ˆå°±æ˜¯ä¸ºäº†ç”¨æˆ·èƒ½å¤Ÿéšæ—¶éšåœ°çœ‹å’¨è¯¢ï¼Œæ“ä½œæ–¹ä¾¿å’Œä¼ è¾“é€Ÿåº¦æ˜¯ç¬¬ä¸€ä½çš„ã€‚è€Œä¸”å¯¹äºå›¾è¡¨è¿™ç±»ä¸œè¥¿ï¼Œç”±äºè§¦å±çš„é™åˆ¶ï¼ˆå®ƒæ²¡æœ‰hoverçš„æ¦‚å¿µï¼‰ï¼Œæœ¬èº«å°±ä¸å¥½åƒPCæµè§ˆå™¨é‚£æ ·åšå›¾è¡¨ä¸Šçš„äº¤äº’ã€‚å› æ­¤ç§»åŠ¨ç«¯çš„å›¾è¡¨å¯ä»¥æš‚ä¸è€ƒè™‘äº¤äº’ï¼Œä¼˜å…ˆç»™ç”¨æˆ·å›¾è¡¨çš„é™æ€å›¾ç‰‡å³å¯ã€‚ æœ€ä½æˆæœ¬æ–¹æ¡ˆç”±äºPCç«¯webå·²ç»é‡‡ç”¨Highchartsç»˜åˆ¶äº†æ•°æ®å›¾è¡¨ï¼Œå› æ­¤è‡ªç„¶ä¼šæƒ³åˆ°ä¸¤ç§åŠæ³•ã€‚ ä½¿ç”¨Highchartsè‡ªå¸¦çš„exporting moduleï¼Œå°†chartè½¬æˆå›¾ç‰‡å½¢å¼ã€‚ ç›´æ¥åœ¨æµè§ˆå™¨é‡Œå¯¹ç›¸åº”çš„å›¾è¡¨åŒºåŸŸæˆªå›¾ã€‚ ä¸ç®¡ç”¨å“ªç§æ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æŠŠç³»ç»Ÿä¸­æ‰€æœ‰çš„å›¾è¡¨çš„åœ°æ–¹æ±‡èšèµ·æ¥ï¼Œåšä¸€ä¸ªREST APIï¼Œå°†åŠŸèƒ½çš„actionã€å‚æ•°ä»¥åŠå›¾è¡¨ç±»å‹ä¼ å…¥urlä¸­ï¼Œç»Ÿä¸€ç”ŸæˆHighchartã€‚ å¦‚æœä½¿ç”¨ç¬¬1ç§åŠæ³•ï¼Œé‚£å¾—å¼•å…¥Highchartsé‡Œçš„exporting.jsï¼Œç„¶åæ‰¾åˆ°exportå‡½æ•°çš„å…¥å£ï¼Œæƒ³åŠæ³•ä»¥æ‰§è¡Œè„šæœ¬çš„æ–¹å¼å¯¼å‡ºå›¾ç‰‡ã€‚ä½†è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ï¼Œå¦‚æœé€šè¿‡å†™ç¨‹åºçš„æ–¹å¼ï¼ˆpythonä¸­æ˜¯urlopenï¼‰å»è®¿é—®è¯¥REST APIï¼Œå¦‚ä½•æ‰§è¡Œjsè„šæœ¬å‘¢ã€‚ç¬¬äºŒï¼Œå°±ç®—èƒ½æ‰§è¡Œjsè„šæœ¬ï¼ŒHighchartsè‡ªå¸¦çš„exportingæœåŠ¡å™¨è‚¯å®šä¼šæŠŠé¢‘ç¹çš„è¯·æ±‚æ‹’äº†ï¼Œå› æ­¤è¿˜å¾—è‡ªå·±å†™exportingçš„åå°ï¼Œè™½ç„¶å®˜æ–¹ç»™å‡ºäº†exporting serverçš„ç¤ºä¾‹ä»£ç ã€‚ å‡ºäºè¿™äº›è€ƒè™‘ï¼Œæˆ‘å†³å®šæœç¬¬2ä¸­æ–¹æ³•åŠªåŠ›ã€‚ phantomjsphantomjsæ˜¯ä¸€ä¸ªåŸºäºwebkitçš„æ— ç•Œé¢æµè§ˆå™¨ï¼Œä½ å¯ä»¥é€šè¿‡javascriptçš„è¯­æ³•å»æ§åˆ¶å®ƒã€‚å®ƒä¸ä¼ ç»Ÿçš„çˆ¬è™«ä¸åŒï¼Œçˆ¬è™«æ˜¯ç›´æ¥å¯¹Http Responseè¿›è¡Œå¤„ç†ï¼Œåªèƒ½è·å–æ‰€æœ‰çš„åŸå§‹æ•°æ®ï¼ˆåŒ…æ‹¬DOM documentå’Œscriptï¼‰ï¼Œè‡³äºscriptæ‰§è¡Œåä¼šå¯¹documentäº§ç”Ÿæ€æ ·çš„æ”¹å˜ï¼Œå®ƒä¸çŸ¥é“ï¼Œåªèƒ½è‡ªå·±å†™ä¸šåŠ¡é€»è¾‘å»å¤„ç†ã€‚è€Œphantomjså°±æ˜¯ä¸€ä¸ªæµè§ˆå™¨ï¼Œå®ƒåŒ…å«å®Œæ•´çš„æ¸²æŸ“å¼•æ“å’Œjsæ‰§è¡Œå™¨ï¼Œå®ƒå¯ä»¥ç«™åœ¨æµè§ˆå™¨å±‚é¢ï¼ˆè€Œä¸æ˜¯Http Responseï¼‰å»çœ‹å¾…é—®é¢˜ã€‚å› æ­¤phantomjsè¢«ä¸»è¦ç”¨äºç½‘é¡µæˆªå›¾ï¼Œç½‘ç»œæ£€æµ‹ï¼ˆMonitoringï¼‰ï¼Œä»¥åŠç•Œé¢æµ‹è¯•ï¼ˆTestingï¼‰ç­‰ã€‚ ä¸€ä¸ªæœ€ç®€å•çš„demo 123456var page = require('webpage').create();var url = 'http://www.baidu.com/';page.open(url, function() &#123; page.render('baidu.png'); phantom.exit()&#125;); æˆªå›¾æ•ˆæœ casperjscasperjsæ˜¯å¯¹phantomjsçš„ä¸€ä¸ªå°è£…ï¼Œæä¾›äº†æµè§ˆå™¨çš„å¤šæ­¥è®¿é—®ï¼Œå¡«å†™è¡¨å•ï¼Œç‚¹å‡»äº‹ä»¶ï¼Œä»¥åŠæˆªå›¾çš„è‡ªå®šä¹‰ç­‰ã€‚æœ€é‡è¦çš„å°±æ˜¯å®ƒçš„å¤šæ­¥è®¿é—®ï¼Œæä¾›äº†æ›´å¥½çš„å¼‚æ­¥æ“ä½œï¼Œå¯é¿å…callbackçš„å¤šå±‚åµŒå¥—ã€‚ å¤šæ­¥è®¿é—®æˆªå›¾demo 123456789101112131415161718192021222324252627282930313233343536373839var casper = require('casper').create();var url = 'http://www.baidu.com/';casper.start(url, function() &#123; // å¡«å†™è¡¨å•ï¼ˆæœç´¢å…³é”®å­—ï¼‰ // æœ€åä¸€ä¸ªå‚æ•°trueè¡¨ç¤ºsubmit this.fill('form#form1', &#123; wd: 'phantomjs' &#125;, true);&#125;);casper.then(function() &#123; this.viewport(1366, 768); // æ³¨æ„ï¼šè¿™é‡Œè¦ç­‰å¾…ç»“æœåˆ·æ–°ï¼Œç™¾åº¦æœç´¢ç»“æœæ˜¯å¼‚æ­¥åˆ·å‡ºæ¥çš„ this.waitFor(function check()&#123; return this.evaluate(function()&#123; return document.querySelectorAll('#content_left').length &gt; 0; &#125;); &#125;, function then()&#123; this.captureSelector('phantomjs.png', 'body'); &#125;);&#125;);casper.then(function() &#123; // å¡«å†™è¡¨å•ï¼ˆæœç´¢å…³é”®å­—ï¼‰ // æ³¨æ„æ­¤æ—¶form idä¸åŒäºä¹‹å‰ this.fill('form#form', &#123; wd: 'casperjs' &#125;, true);&#125;);casper.then(function() &#123; this.viewport(1366, 768); this.waitFor(function check()&#123; return this.evaluate(function()&#123; return document.querySelectorAll('#content_left').length &gt; 0; &#125;); &#125;, function then()&#123; this.captureSelector('casperjs.png', 'body'); &#125;);&#125;);casper.run(); æˆªå›¾æ•ˆæœ å›å½’æ­£é¢˜æˆ‘ä»¬æœ‰äº†REST APIï¼Œé€šè¿‡casperjså»éå†è®¿é—®urlç»™ä»¥å„ç§å‚æ•°ï¼Œå¹¶å¯¹é¡µé¢ä¸­çš„Highchartæˆªå›¾ã€‚åœ¨å®é™…çš„æ“ä½œä¸­éœ€è¦æ³¨æ„çš„æ˜¯ å¾ªç¯ä¸­çš„é—­åŒ…ï¼ˆclosureï¼‰ å¦‚æœå›¾è¡¨æ˜¯å¼‚æ­¥åŠ è½½ï¼Œéœ€è¦ç­‰å¾…å®Œå†æˆªå›¾ éƒ¨åˆ†ç¤ºä¾‹ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324// çœç•¥â€¦â€¦// categoriesæ˜¯åŠŸèƒ½çš„åˆ†ç±»æ•°ç»„// pagesæ˜¯å¯¹æ¯ä¸ªcategoryä¸‹ç”Ÿæˆçš„åˆæ³•urlæ•°ç»„ï¼Œå³pagesæ˜¯urlçš„äºŒç»´æ•°ç»„casper.then(function()&#123; for(var i=0; i&lt;pages.length; i++)&#123; (function(that, category, urls)&#123; that.each(urls, function(self, link)&#123; var params = (link.split('?')[1]).split('&amp;'); // TODO: get params self.thenOpen(link, function()&#123; self.waitFor(function check()&#123; return self.evaluate(function()&#123; // TODO: å¼‚æ­¥åŠ è½½çš„åˆ¤æ–­ return true; &#125;); &#125;, function then()&#123; self.captureSelector(/from/to' + category + '/' + param + '.png', '#chart'); &#125;); &#125;); &#125;); &#125;)(this, categories[i], pages[i]); &#125;&#125;); æˆªå›¾æ•ˆæœ æ€»ç»“æˆ‘ä»¬ä½¿ç”¨äº†æœ€ä½æˆæœ¬çš„æ–¹æ³•å®ç°äº†åœ¨ç§»åŠ¨ç«¯å±•ç¤ºæ•°æ®å›¾è¡¨ï¼Œéƒ½æ˜¯åŸºäºPCç«¯ä½¿ç”¨çš„Highchartsã€‚çœå»äº†åœ¨ç§»åŠ¨ç«¯æµè§ˆå™¨å¯¼å…¥å›¾è¡¨jsåº“å‡ºç°çš„å…¼å®¹å’Œæ€§èƒ½é—®é¢˜ï¼Œä¹Ÿçœå»äº†è‡ªå·±ç¼–å†™åå°ä»£ç å»ç”Ÿæˆå›¾ç‰‡ã€‚ åˆ©ç”¨phantomjs + casperjsçš„æˆªå›¾æ–¹æ³•ï¼Œç»å®éªŒï¼Œç”Ÿæˆçš„900 Ã— 600åƒç´ çš„å›¾ç‰‡å¹³å‡å¤§å°åœ¨20Kå·¦å³ï¼Œè¿™ä¸ªå¤§å°åœ¨ç§»åŠ¨ç«¯æ˜¯å¯ä»¥æ¥å—çš„ã€‚å¦‚æœä¸€ä¸ªé¡µé¢ä¸­å›¾ç‰‡è¾ƒå¤šï¼Œæˆ‘ä»¬è¿˜èƒ½å†™jså¯¹å›¾ç‰‡å»¶è¿ŸåŠ è½½ï¼ˆimgçš„srcå±æ€§å»¶è¿Ÿèµ‹å€¼ï¼‰ã€‚å”¯ä¸€ç¾ä¸­ä¸è¶³çš„æ˜¯phantomjså¯¹å­—ä½“çš„æ•ˆæœä¸å¤ªå¥½ã€‚]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>æˆªå›¾</tag>
        <tag>PhantomJs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[eclipseä¸­é›†æˆHibernate]]></title>
    <url>%2Fblog%2F2014%2F05%2Fintegrate-hibernate-into-eclipse.html</url>
    <content type="text"><![CDATA[å‰ä¸€é˜µå­å¸®åˆ«äººæœ‰å¿åšæœ¬ç§‘æ¯•è®¾çš„XXç®¡ç†ç³»ç»Ÿï¼Œå¯¹æ–¹è¦æ±‚ä¸€å®šè¦Javaï¼Œä¸ç„¶ä»–æ²¡å­¦è¿‡ä¸åˆ©äºç­”è¾©ã€‚æƒ³æˆ‘ä»¬å¤§è½¯é™¢ä»å¤§ä¸€å¼€å§‹å°±åœ¨åšXXç®¡ç†ç³»ç»Ÿäº†ï¼Œå¤§äºŒå¤§ä¸‰åªæ˜¯å­¦çš„å†…å®¹ä¸ä¸€æ ·ï¼Œä½†å¤§ä½œä¸šçš„è½½ä½“éƒ½æ˜¯è¯¥æ­»çš„XXç®¡ç†ç³»ç»Ÿã€‚ä»åŸç”ŸJava Swingåšçš„é æ–‡ä»¶è¯»å†™æ•°æ®çš„XXç®¡ç†ç³»ç»Ÿï¼Œåˆ°ä¸‹å­¦æœŸåŠ å…¥æ•°æ®åº“è¯»å†™çš„ï¼Œå†è¿‡ä¸€å­¦æœŸç”¨jspåšç½‘é¡µç‰ˆçš„XXç®¡ç†ç³»ç»Ÿï¼Œç„¶åå†ç”¨J2EEæ¡†æ¶ï¼Œæˆ–è€…æ¢phpå†å®ç°ä¸€ä¸ªXXç®¡ç†ç³»ç»Ÿã€‚æœ€åç†¬åˆ°å‘çˆ¹çš„ç ”ç©¶ç”Ÿï¼Œç¬¬ä¸€å­¦æœŸäº‘è®¡ç®—è¯¾ç¨‹å…ˆç”¨ä¼ ç»Ÿæ–¹å¼å®ç°ä¸€ä¸ªXXç®¡ç†ç³»ç»Ÿï¼Œç„¶åå†æŠŠæ•°æ®è¿ç§»åˆ°äº‘å¹³å°ä¸Šåšå®éªŒã€‚å¥½å§ï¼Œæˆ‘é”™äº†ï¼Œä¸çŸ¥ä¸è§‰åˆä¹ æƒ¯å–·äº† å…¶å®æˆ‘æƒ³è¯´çš„æ˜¯è¦ä¸æ˜¯çœ‹åœ¨åŒå­¦çš„ä»½ä¸Šï¼ŒçœŸä¸æƒ³åšè¿™ä¸ªäº‹æƒ…ï¼Œè¿˜è¦æ±‚Javaï¼ŒçœŸä¸æƒ³ç¢°Swingçš„ä¸œè¥¿äº†ï¼Œä¹Ÿä¸æƒ³çƒ¦äººçš„Strutsã€‚æœ‰äººè¦ç½‘é¡µç‰ˆï¼Œæˆ‘å°±ç”¨æ›´ç®€å•æ˜“å­¦çš„Play Frameworkï¼ˆæˆ‘éƒ½ç”¨è¾ƒæ—©çš„1.2.7ç‰ˆæœ¬ï¼‰ã€‚è€Œè¿˜æœ‰äººè¦çª—å£ç¨‹åºï¼Œä¸å¾—ä»¥å»æŸ¥äº†æŸ¥ç®€å•çš„åŠæ³•ã€‚ å‡†å¤‡æˆ‘ç”¨çš„æ˜¯è¾ƒæ—©çš„eclipse 3.6.2 heliosã€‚å¯¹äºSwingçª—å£ç¨‹åºçš„æ­å»ºï¼Œæˆ‘ä½¿ç”¨äº†WindowBuilderæ’ä»¶ï¼Œå› ä¸ºä»¥å‰ç”¨è¿‡çš„VisualEditorè²Œä¼¼ç°åœ¨ä¸ç»´æŠ¤äº†ã€‚ ç”±äºXXç®¡ç†ç³»ç»Ÿéƒ½æ¶‰åŠåˆ°å¢åˆ æ”¹æŸ¥æ“ä½œï¼Œè¿™ç§sqlå†™èµ·æ¥å°±æ˜¯çº¯ç²¹è‹¦åŠ›æ´»ã€‚ä»¥å‰åœ¨MyEclipseä¸­ç”¨è¿‡Struts + Hibernateï¼ˆMyEclipseä¸­å‡è‡ªå¸¦è¿™äº›æ’ä»¶ï¼‰ï¼Œä½†æ˜¯è‹¦äºMyEclipseå¤ªå¤§äº†ï¼Œå¯åŠ¨å¤ªæ…¢ï¼Œæ‰€ä»¥æˆ‘æƒ³åŠæ³•æŠŠHibernateè£…åˆ°eclipseä¸­ã€‚ Hibernateæ’ä»¶å®‰è£… æ‰“å¼€eclipse -&gt; Help -&gt; Install New Software æ·»åŠ  http://download.jboss.org/jbosstools/updates/stable/helios/ é€‰æ‹©All JBoss Toolsä¸‹çš„Hibernate Toolså³å¯ï¼ˆå› ä¸ºHibernateè¢«JBossæ”¶äº†ï¼Œåªéœ€è£…è¿™ä¸€ä¸ªå°±è¡Œï¼‰ æ¼«é•¿çš„ç­‰å¾… æ³¨æ„ï¼Œæœ‰å¯èƒ½å®‰è£…å‡ºé”™ï¼Œæˆ‘è¯•äº†ä¸¤ä¸‰æ¬¡æ‰å¥½ï¼ˆå¹æ°”ï¼‰ æœ€åè¿™ä¸ªå…³äºunsignedçš„Warningæ— è§†ä¹‹ï¼Œç›´æ¥OKåå°±å®‰è£…æˆåŠŸäº†^_^ Hibernate ConfigHibernateToolå®‰è£…å®Œæˆåï¼Œå¯åœ¨eclipseä¸­æ·»åŠ Hibernate perspectiveã€‚ æ­¥éª¤1 å°†Hibernateæ ¸å¿ƒjaråŒ…æ·»åŠ åˆ°projectä¸­ï¼Œå¯åˆ°è¿™é‡Œä¸‹è½½ã€‚ æ­¥éª¤2 åœ¨projectçš„srcæ ¹ä¸‹æ·»åŠ åä¸ºhibernate.cfg.xmlçš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ 1234567891011121314151617&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"&gt;&lt;hibernate-configuration&gt; &lt;session-factory&gt; &lt;property name="hibernate.connection.driver_class"&gt;org.gjt.mm.mysql.Driver&lt;/property&gt; &lt;property name="hibernate.connection.password"&gt;123123&lt;/property&gt; &lt;!-- æŒ‡å®šæ•°æ®åº“å¯¹åº”çš„schemaï¼ˆæˆ‘ç”¨çš„æ˜¯mysqlï¼‰ --&gt; &lt;property name="hibernate.connection.url"&gt;jdbc:mysql://localhost/factory_manage&lt;/property&gt; &lt;property name="hibernate.connection.username"&gt;root&lt;/property&gt; &lt;property name="hibernate.dialect"&gt;org.hibernate.dialect.MySQLInnoDBDialect&lt;/property&gt; &lt;!-- ä¸‹é¢è¿™å¥å¾ˆé‡è¦ --&gt; &lt;property name="current_session_context_class"&gt;thread&lt;/property&gt; &lt;!-- ä¸‹é¢ä¸ºè¡¨çš„mappingé¡¹ï¼ˆå·²çœç•¥ï¼‰ --&gt; &lt;/session-factory&gt;&lt;/hibernate-configuration&gt; æ­¥éª¤3 æ‰“å¼€Hibernate perspectiveï¼Œåœ¨è¯¥åŒºåŸŸä¸­å³å‡»æ·»åŠ configuration è¿™é‡Œçš„Typeæˆ‘é€‰æ‹©äº†Annotationsçš„æ–¹å¼ OKåå°±èƒ½åœ¨åˆšæ‰çš„åŒºåŸŸä¸­çœ‹åˆ°æ•°æ®åº“ä¸­çš„è¡¨äº† æ­¥éª¤4 ç‚¹å‡»èœå•æ ä¸­çš„è¿™ä¸ªå›¾æ ‡ï¼Œæ‰“å¼€â€Hibernate Code Generation Configurationsâ€ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªConfigurationã€‚ æ³¨æ„è¦æŠŠâ€œReverse engineer from JDBC Connectionâ€é€‰é¡¹æ‰“å¼€ï¼Œè¿™æ˜¯Hibernateçš„åå‘å·¥ç¨‹ã€‚ä»æ•°æ®åº“çš„è¡¨æ˜ å°„æˆå®ä½“ç±»å’Œé…ç½®æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä»é…ç½®æ–‡ä»¶æ˜ å°„æˆæ•°æ®åº“çš„è¡¨ã€‚ è¿™é‡Œçš„Exportersæˆ‘å°±å‹¾é€‰äº†å‰ä¸¤é¡¹ï¼Œä¸€ä¸ªæ˜¯tableå¯¹åº”çš„å®ä½“ç±»ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯mappingé…ç½®ã€‚è€Œå…¶ä»–çš„å¦‚.cfg.xmlå’ŒDAO codeæˆ‘å‡†å¤‡éƒ½æ‰‹å·¥æ“ä½œã€‚å› ä¸ºè¿™ä¸ªcode generationæ¯æ¬¡ç”Ÿæˆæ—¶ä¼šæŠŠä»¥å‰çš„è¦†ç›–æ‰ã€‚ æ­¥éª¤5 è¿è¡ŒHibernate code generationï¼Œå°±ä¼šç”Ÿæˆæ•°æ®åº“factory_manageä¸‹æ‰€æœ‰è¡¨çš„æ˜ å°„ã€‚ æ­¥éª¤6 mappingæ–‡ä»¶ï¼ˆ.hbm.xmlï¼‰å¤§å¯ç”¨ç”Ÿæˆçš„ï¼Œåªéœ€è¦æ³¨æ„çš„æ˜¯ä¸€å¯¹å¤šå’Œå¤šå¯¹ä¸€æ˜ å°„æ—¶æ˜¯å¦è¦lazy fetchï¼ˆé»˜è®¤ä¸ºtrueï¼‰ã€‚ æœ€åè®°å¾—å°†mappingæ–‡ä»¶çš„è·¯å¾„æ·»åŠ åˆ°hibernate.cfg.xmlä¸­ï¼ Hibernate Session Factoryåˆ›å»ºä¸€ä¸ªhibernateçš„packageï¼Œæ–°å»ºHibernateSessionFactory.javaï¼Œå†…å®¹å¦‚ä¸‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118package hibernate;import org.hibernate.HibernateException;import org.hibernate.Session;import org.hibernate.cfg.Configuration;/** * Configures and provides access to Hibernate sessions, tied to the * current thread of execution. Follows the Thread Local Session * pattern, see &#123;@link http://hibernate.org/42.html &#125;. */public class HibernateSessionFactory &#123; /** * Location of hibernate.cfg.xml file. * Location should be on the classpath as Hibernate uses * #resourceAsStream style lookup for its configuration file. * The default classpath location of the hibernate config file is * in the default package. Use #setConfigFile() to update * the location of the configuration file for the current session. */ private static String CONFIG_FILE_LOCATION = "/hibernate.cfg.xml"; private static final ThreadLocal&lt;Session&gt; threadLocal = new ThreadLocal&lt;Session&gt;(); private static Configuration configuration = new Configuration(); private static org.hibernate.SessionFactory sessionFactory; private static String configFile = CONFIG_FILE_LOCATION; static &#123; try &#123; configuration.configure(configFile); sessionFactory = configuration.buildSessionFactory(); &#125; catch (Exception e) &#123; System.err .println("%%%% Error Creating SessionFactory %%%%"); e.printStackTrace(); &#125; &#125; private HibernateSessionFactory() &#123; &#125; /** * Returns the ThreadLocal Session instance. Lazy initialize * the &lt;code&gt;SessionFactory&lt;/code&gt; if needed. * * @return Session * @throws HibernateException */ public static Session getSession() throws HibernateException &#123; Session session = (Session) threadLocal.get(); if (session == null || !session.isOpen()) &#123; if (sessionFactory == null) &#123; rebuildSessionFactory(); &#125; session = (sessionFactory != null) ? sessionFactory.openSession() : null; threadLocal.set(session); &#125; return session; &#125; /** * Rebuild hibernate session factory * */ public static void rebuildSessionFactory() &#123; try &#123; configuration.configure(configFile); sessionFactory = configuration.buildSessionFactory(); &#125; catch (Exception e) &#123; System.err .println("%%%% Error Creating SessionFactory %%%%"); e.printStackTrace(); &#125; &#125; /** * Close the single hibernate session instance. * * @throws HibernateException */ public static void closeSession() throws HibernateException &#123; Session session = (Session) threadLocal.get(); threadLocal.set(null); if (session != null) &#123; session.close(); &#125; &#125; /** * return session factory * */ public static org.hibernate.SessionFactory getSessionFactory() &#123; return sessionFactory; &#125; /** * return session factory * * session factory will be rebuilded in the next call */ public static void setConfigFile(String configFile) &#123; HibernateSessionFactory.configFile = configFile; sessionFactory = null; &#125; /** * return hibernate configuration * */ public static Configuration getConfiguration() &#123; return configuration; &#125;&#125; æ³¨ï¼šè¿™æ®µä»£ç æ˜¯æˆ‘ä»¥å‰åœ¨MyEclipseä¸­ç”¨Hibernateæ—¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè¿™é‡Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆç”Ÿæˆï¼Œæ‰€ä»¥å°±ç›´æ¥å¤åˆ¶äº†è¿‡æ¥ã€‚ åŒæ ·ï¼Œå†æ–°å»ºä¸€ä¸ªHibernateSessionFactoryUtil.javaï¼Œå†…å®¹å¦‚ä¸‹ã€‚ 123456789101112131415161718192021222324252627282930package hibernate.util;import org.hibernate.SessionFactory;import org.hibernate.cfg.Configuration;public class HibernateSessionFactoryUtil &#123; private static final SessionFactory sessionFactory; static &#123; try &#123; sessionFactory = new Configuration().configure().buildSessionFactory(); &#125; catch (Throwable e) &#123; /* * éœ€è¦æ•è·Throwableå¯¹è±¡ï¼Œ * å¦åˆ™æ•è·ä¸åˆ°ErroråŠå…¶å­ç±»ï¼Œä»¥åŠNoClassDefFoundErrorç±»å‹çš„é”™è¯¯ */ throw new ExceptionInInitializerError(e); &#125; &#125; private HibernateSessionFactoryUtil()&#123;&#125; public static SessionFactory getSessionFactory() &#123; return sessionFactory; &#125; &#125; DAOæ³›å‹ç¼–ç¨‹åˆ›å»ºdao.interfacesçš„packageï¼Œæ–°å»ºGenericDao.javaï¼Œå†…å®¹å¦‚ä¸‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354package dao.interfaces;import java.io.Serializable;import java.util.ArrayList;public interface GenericDao&lt;T, PK extends Serializable&gt; &#123; /** * æ ¹æ®ä¸»é”®å–å¯¹è±¡ * @param id ä¸»é”® * @return T æ‰¾ä¸åˆ°æ—¶è¿”å›null */ public T findById(PK id); /** * å–å‡ºè¡¨ä¸­æ‰€æœ‰å¯¹è±¡ * @return ArrayList */ public ArrayList&lt;T&gt; findAll(); /** * å­˜ä¸€ä¸ªå®Œæ•´å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸»é”® * @param entity å®Œæ•´å¯¹è±¡ * @return PK ä¸»é”® */ public PK save(T entity); /** * æ›´æ–°ä¸€ä¸ªå¯¹è±¡ï¼Œä¸»é”®æ‰¾ä¸åˆ°æ—¶æ”¹ä¸ºå­˜ä¸€ä¸ªå¯¹è±¡ * @param entity å®Œæ•´å¯¹è±¡ * @return boolean */ public boolean update(T entity); /** * åˆ é™¤ä¸€ä¸ªå®Œæ•´å¯¹è±¡ * @param entity å®Œæ•´å¯¹è±¡ * @return boolean */ public boolean delete(T entity); /** * æ ¹æ®ä¸»é”®åˆ é™¤ä¸€ä¸ªå¯¹è±¡ * @param id ä¸»é”® * @return boolean */ public boolean delete(PK id); &#125; ç›¸åº”åœ°ï¼Œåˆ›å»ºdao.hibernateçš„packageï¼Œæ–°å»ºGenericDaoHibernate.javaï¼Œå†…å®¹å¦‚ä¸‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175package dao.hibernate;import java.io.Serializable;import java.lang.reflect.ParameterizedType;import java.util.ArrayList;import org.hibernate.Query;import org.hibernate.Session;import org.hibernate.Transaction;import dao.interfaces.GenericDao;import hibernate.util.HibernateSessionFactoryUtil;public abstract class GenericDaoHibernate&lt;T, PK extends Serializable&gt; implements GenericDao&lt;T, PK&gt; &#123; private Class&lt;T&gt; clazz; public GenericDaoHibernate() &#123; //åå°„è·å–T.classï¼Œå®å‚ç±»å‹ clazz = (Class&lt;T&gt;)((ParameterizedType)getClass().getGenericSuperclass()).getActualTypeArguments()[0]; &#125; @Override public T findById(PK id) &#123; T entity = null; try &#123; Session session = HibernateSessionFactoryUtil.getSessionFactory().getCurrentSession(); Transaction tx = session.beginTransaction(); try &#123; entity = (T) session.get(clazz, id); tx.commit(); &#125; catch (Exception e) &#123; tx.rollback(); e.printStackTrace(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return entity; &#125; @Override public ArrayList&lt;T&gt; findAll() &#123; ArrayList&lt;T&gt; result = new ArrayList&lt;T&gt;(); try &#123; Session session = HibernateSessionFactoryUtil.getSessionFactory().getCurrentSession(); Transaction tx = session.beginTransaction(); try &#123; Query query = session.createQuery("from " + clazz.getName()); result = new ArrayList&lt;T&gt;(query.list()); tx.commit(); &#125; catch (Exception e) &#123; tx.rollback(); e.printStackTrace(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return result; &#125; @Override public PK save(T entity) &#123; //boolean result = false; PK result = null; try &#123; Session session = HibernateSessionFactoryUtil.getSessionFactory().getCurrentSession(); Transaction tx = session.beginTransaction(); try &#123; //result = true; result = (PK) session.save(entity); tx.commit(); &#125; catch (Exception e) &#123; tx.rollback(); e.printStackTrace(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return result; &#125; @Override public boolean update(T entity) &#123; boolean result = false; try &#123; Session session = HibernateSessionFactoryUtil.getSessionFactory().getCurrentSession(); Transaction tx = session.beginTransaction(); try &#123; session.saveOrUpdate(entity); result = true; tx.commit(); &#125; catch (Exception e) &#123; tx.rollback(); e.printStackTrace(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return result; &#125; @Override public boolean delete(T entity) &#123; boolean result = false; try &#123; Session session = HibernateSessionFactoryUtil.getSessionFactory().getCurrentSession(); Transaction tx = session.beginTransaction(); try &#123; session.delete(entity); result = true; tx.commit(); &#125; catch (Exception e) &#123; tx.rollback(); e.printStackTrace(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return result; &#125; @Override /** * æ­¤æ³•ä¸å¥½ï¼Œæš‚æ—¶è¿™æ · */ public boolean delete(PK id) &#123; boolean result = false; try &#123; T entity = findById(id); if(entity!=null &amp;&amp; delete(entity)==true) result = true; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return result; &#125; &#125; æœ‰äº†GenericDaoçš„åŸºç¡€ï¼Œå¯¹äºå…¶ä»–å…·ä½“å®ä½“ç±»ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªå®ƒçš„æ¥å£ç±»å»ç»§æ‰¿GenericDaoï¼Œåƒè¿™æ · public interface UserDao extends GenericDao&lt;User, Integer&gt; åœ¨è¿™é‡Œå®šä¹‰å®ƒçš„ç‰¹æœ‰æ–¹æ³• å¯¹äºæ¥å£çš„å®ç°ç±»ï¼Œåƒè¿™æ · public class UserDaoHibernate extends GenericDaoHibernate&lt;User, Integer&gt; implements UserDao å› æ­¤æœ‰äº†æ³›å‹DAOï¼Œå°±ä¸å¿…ä¸ºæ¯ä¸ªå®ä½“éƒ½å†™ä¸€å¥—å¤§åŒå°å¼‚çš„æœ€åŸºç¡€çš„å¢åˆ æ”¹æŸ¥æ“ä½œäº†ã€‚ æ€»ç»“åœ¨eclipseä¸­é›†æˆHibernateToolsåï¼Œå¯ä»¥å…ˆåœ¨æ•°æ®åº“ä¸­å»ºå¥½tableï¼Œç„¶åé€šè¿‡Hibernateçš„Reverse Engineeringæ˜ å°„æˆå¯¹åº”çš„å®ä½“ç±»å’Œé…ç½®æ–‡ä»¶ã€‚é€šè¿‡å»ºç«‹æ³›å‹DAOæ¥å£å’Œå®ç°ç±»ï¼Œä¸å¿…ä¸ºå…·ä½“æ¯ä¸ªå®ä½“ç±»ç¼–å†™è¯¸å¦‚getByIdçš„æ–¹æ³•ã€‚Mappingå’ŒDAOæ³›å‹ç¼–ç¨‹ï¼Œå¤§å¤§å‡å°‘äº†åŸºäºå¢åˆ æ”¹æŸ¥çš„XXç®¡ç†ç³»ç»Ÿçš„å¼€å‘å·¥ä½œé‡ã€‚]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>Hibernate</tag>
        <tag>æ³›å‹ç¼–ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤§å§¨å¤«çƒ¦èºä¹‹å]]></title>
    <url>%2Fblog%2F2014%2F03%2Flife-is-like-a-boat.html</url>
    <content type="text"><![CDATA[ç”·äººæ¯ä¸ªæœˆä¹Ÿæ€»æœ‰é‚£ä¹ˆå‡ å¤©æµ‘èº«ä¸èˆ’æœï¼Œæˆ‘ä»¬æŠŠè¿™å‡ å¤©ç§°ä¸ºâ€œå¤§å§¨å¤«æ¥äº†â€ï¼Œè€éƒ­è¯´é™ªå¤§å§¨å¤«å–é…’å–å¤šäº†â€¦â€¦ ä¸Šå‘¨å»äº†4æ¬¡é©¾æ ¡ï¼Œæ¯å¤©6ç‚¹å¤šèµ·ï¼Œè°å«æˆ‘æŠ¥äº†ä¸ªè¿™ä¹ˆä¸¥çš„é©¾æ ¡ï¼Œæˆ‘è¯´4æ¬¡æˆ‘éƒ½æ˜¯å»ä¸ºäº†ç§‘ç›®ä¸€çš„ï¼Œä¼šä¸ä¼šè¢«å˜²è®½å•Šã€‚ã€‚ã€‚ã€‚ è¿™ä¸€å‘¨è¿‡çš„åˆå‹åŠ›å¥½å¤§ï¼Œæ¥äº†å‡ ä¸ªè¶…å‡ºæˆ‘æ­£å¸¸èƒ½åŠ›ä¹‹å¤–çš„äº‹ã€‚å…ˆæ˜¯è€æ¿æ¯å‘¨çš„ç ”è®¨ç­ï¼Œåªä¸è¿‡è¿™å‘¨ç»„ç»‡äº†æ¬¡4ä¸ªé™¢ç³»çš„å¤§è®¨è®ºï¼Œå¥½äº§ç”Ÿæ€ç»´å†²å‡»ã€‚æˆ‘éƒ½ä¸å¥½æ„æ€è¯´æˆ‘åšçš„é¡¹ç›®æ˜¯ç”µå•†æ•°æ®åˆ†æï¼Œå› ä¸ºæˆ‘å•†ä¸šæ–¹é¢çš„ä¹Ÿä¸æ‡‚ï¼Œåˆ†ææ–¹é¢çš„æ›´ä¸æ‡‚ã€‚è€æ¿è¦æˆ‘ä»¬ç»„å‡ºä¸¤ä¸ªPPTï¼Œé’±å¤§ç¥è´Ÿè´£å¼€æ”¾æ•°æ®å¹³å°çš„æŠ¥å‘Šï¼Œç”±äºå†¯æ€»å¤ªå¿™ï¼Œé¡¹ç›®é¢å‘å•†ä¸šçš„æŠ¥å‘Šå°±è®©æˆ‘æ¥åšã€‚æˆ‘è¿™äººæœ€æ€•åœ¨äººå¤šçš„åœ°æ–¹å‘è¨€æˆ–æŠ¥å‘Šäº†ï¼Œåªè¦æœ‰ç”Ÿäººï¼Œæˆ‘å°±ä¼šç´§å¼ ã€‚èŠ±äº†ä¸€å¤©åŠæ—¶é—´æ‰æ†‹å‡ºäº†ä¸€ä»½é«˜ç«¯å¤§æ°”çš„å•†åŠ¡é£PPTï¼Œæ­£æ–‡æ‰9é¡µï¼Œä¼°è®¡æˆ‘çš„æ•ˆç‡åˆè¦è¢«é„™è§†äº†ã€‚ã€‚ã€‚æœ¬æ¥åˆæƒ³æ¨ç»™å†¯æ€»å»æŠ¥å‘Šäº†ï¼Œæƒ³æƒ³æˆ‘éƒ½èŠ±äº†é‚£ä¹ˆå¤šå¿ƒæ€å»åšPPTäº†ï¼Œä¸è®²æˆ‘ä¸æ˜¯äºäº†ä¹ˆã€‚ æ€•ï¼Œä½ å°±ä¼šè¾“ä¸€è¾ˆå­ã€‚ è¿™æ˜¯ç”µå½±ã€Šæ¿€æˆ˜ã€‹çš„å®£ä¼ è¯­ï¼Œæˆ‘å¾ˆå–œæ¬¢ã€‚åˆšå¼€å§‹è®²çš„æ—¶å€™çœŸçš„ç´§å¼ äº†ï¼Œç”µè„‘è“å±=_= è¿˜æŠŠé¡¹ç›®è¯´æˆäº†ç½‘ç«™é¡¹ç›®ï¼ˆå°±å› ä¸ºæˆ‘æ˜¯åšç½‘ç«™çš„ä¹ˆ= =ï¼‰ï¼Œè¢«é—®åˆ°æŠ€æœ¯æ–¹é¢çš„é—®é¢˜éƒ½è®©é˜Ÿå‹å¸®æˆ‘å›ç­”ã€‚ã€‚ã€‚ ä¸ä¸Šå°æºœæºœï¼Œä½ æ°¸è¿œä¸ä¼šçŸ¥é“è‡ªå·±æœ‰å¤šå¼ºï¼ˆæœ‰å¤šå¼±ï¼‰ æœ€æ—©æ˜¯åœ¨ä¸€æ¡å¥èº«å¾®åšä¸Šçœ‹åˆ°è¿™æ ·çš„è¯ï¼Œè¯´ä½ ä¸€ç›´èº²åœ¨å¥èº«æˆ¿ç»ƒè€Œä¸å»å‚åŠ æ¯”èµ›çš„è¯ï¼Œä½ æ°¸è¿œä¸ä¼šçŸ¥é“è‡ªå·±å’Œåˆ«äººçš„å·®è·ã€‚å¥èº«æ–¹é¢æˆ‘è¿˜çœŸæ“è›‹çš„æ˜¯è¿™æ ·ã€‚ã€‚ã€‚æŠ€æœ¯æ–¹é¢è¿œä¸å¦‚é’±å¤§ç¥ï¼Œå•†ä¸šæ–¹é¢ä¸å¦‚å†¯æ€»ã€‚æˆ‘å°±æ˜¯ä¸ªåšç½‘ç«™çš„ï¼Œæœ€å¤šç«™åœ¨ç”¨æˆ·è§’åº¦å»æ€è€ƒäº›ã€‚ åˆä¸€æ³¢å¤§å§¨å¤«ä¸€åŒå­¦æ¥æ‰¾æˆ‘ï¼Œæƒ³è®©æˆ‘å¸®ä»–å’Œä»–å¥³æœ‹å‹æå®šæ¯•è®¾ï¼Œè¯´ç»™æŠ¥é…¬ï¼Œè¿˜è¯´é™¤äº†æˆ‘æ²¡äººå¸®å¾—äº†ä»–äº†ã€‚æˆ‘ä»¬åˆä¸­é«˜ä¸­éƒ½ä¸€èµ·çš„ï¼Œæƒ³æƒ³ä»–å½“å¹´æ“è›‹çš„å»å¤è¯»ç»“æœè¿˜æ˜¯ä¸ªä¸‰æœ¬ï¼Œä¸ç„¶ä¹Ÿä¸ä¼šè¿™ä¸ªæ—¶å€™å†æ¥æ‰¾æˆ‘ã€‚å¹¸äºä¸æ˜¯ä¸€å±Šï¼Œè€Œä¸”ä¸‰æœ¬åº”è¯¥ä¼šæ¯”è¾ƒæ¾ï¼Œå—åˆ°é‡‘é’±è¯±æƒ‘ï¼Œæˆ‘å¸®ä»–åšèµ·äº†æ¯•è®¾çš„ç”Ÿæ„ã€‚å¦åŠ ä¸¤ä¸ªä»–å…³ç³»å¥½çš„åŒå­¦ï¼Œæ€»å…±4ä»½ï¼Œæˆ‘å±…ç„¶æ“è›‹çš„ç­”åº”äº†ã€‚æˆ‘åˆå¾—é‡æ‹¾å¤§äºŒå¤§ä¸‰æ—¶åšçš„Java Swingï¼ŒSocketï¼ŒHibernateç­‰ä¸œè¥¿äº†ï¼Œå·²ç»ä¸¤ä¸‰å¹´ä¸ç¢°é‚£äº›ä¸œè¥¿äº†ã€‚è€Œä¸”ä»–ä»¬æœ‰æ—¶é—´è¦æ±‚çš„ï¼Œå…¶å®è¿˜æ˜¯æœ‰ç‚¹å‹åŠ›çš„ã€‚ æŸ³æš—èŠ±æ˜ä¸‹é¢æ˜¯ä»Šæ—©å»é©¾æ ¡è€ƒç§‘ç›®ä¸€åçœ‹åˆ°çš„ï¼Œæ‰å‘ç°åŸæ¥æ²¡çœ‹åˆ°çš„æ™¯è‰²ï¼Œå¯ä»¥å¿ƒç†å®‰æ…°æ²¡ç™½æ—©èµ·äº†ã€‚ è¿™å¯èƒ½æ˜¯æ¢…èŠ±å§ï¼Œæˆ‘ä¹Ÿä¸å¤ªæ‡‚ï¼Œåªæœ‰è¿™ä¹ˆä¸¤é¢—ã€‚ ä¸€ä¸ªäººå®‰é™çš„ä»é‚£æ¡è·¯èµ°å‡ºæ¥ï¼Œçœ‹ç€è¿™æ ·çš„æ™¯ï¼Œå¬ç€Easonçš„æ­Œï¼Œè„‘ä¸­æ”¾ç©ºä»»å®ƒèƒ¡æ€ä¹±æƒ³ï¼Œå±…ç„¶åœ¨é©¾æ ¡ä¹Ÿèƒ½äº§ç”Ÿè¿™æ ·çš„æ”¾æ¾å¢ƒç•Œã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„æ”¾æ¾çŠ¶æ€ å…³äºè¿½æ±‚ä¸Šå¤§å­¦å‰çš„è¿½æ±‚æ˜¯è€ƒä¸ªå¥½å¤§å­¦ï¼ŒçœŸçš„è€ƒä¸Šå¥½å¤§å­¦åï¼Œå´å˜å¾—æ²¡å•¥è¿½æ±‚äº†ã€‚æƒ³æƒ³è‡ªå·±æœ¬ç§‘é˜¶æ®µåŸºæœ¬éƒ½åœ¨ç…§æœ¬å®£ç§‘ï¼Œä¹Ÿä¸ä¼šä¸šä½™æ—¶é—´è‡ªå·±å»ç¢ç£¨æŸç§æŠ€æœ¯ï¼Œæœ€å¤šç…§ç€exampleè‡ªå·±æ•²ä¸€éä»£ç ï¼Œä»æ¥ä¸ä¼šå»åšäº›è‡ªå·±è§‰å¾—å¥½ç©çš„ä¸œè¥¿ã€‚å¥½å¤„æ˜¯è½»æ¾çš„ä¿ç ”äº†ï¼Œæ“è›‹çš„æ˜¯åˆ°äº†ç ”ç©¶ç”Ÿé˜¶æ®µæ‰æœ‰äº†è§‰æ‚Ÿï¼Œæ‰å†³å®šäº†ä»¥åå¹²javascriptï¼Œæ‰å¼€å§‹æåšå®¢ã€‚ æŠ€æœ¯ä¸Šæˆ‘æ²¡å•¥è¿½æ±‚ï¼Œåšä¸ªæ™®é€šçš„åˆæ ¼çš„ç¨‹åºå‘˜å³å¯ï¼Œæˆ‘è§‰å¾—è‡ªå·±çœŸçš„ä¸å–œæ¬¢å†™ä»£ç ï¼Œè¿è®¾è®¡åšå®¢é¦–é¡µçš„å¸ƒå±€ä»£ç éƒ½ä¸æƒ³å†™ã€‚æˆ‘ä»¥å‰å°±è¯´ï¼Œç›¸æ¯”å†™ä»£ç ï¼Œæˆ‘æ›´å–œæ¬¢å†™æ–‡å­—ï¼ˆåŒ…æ‹¬æ–‡æ¡£ï¼‰ã€‚ ç”Ÿæ´»ä¸Šçš„è¿½æ±‚ä¹Ÿå¾ˆç®€å•ï¼Œæœ‰ä»½ç¨³ç¨³çš„å¹¸ç¦ã€‚]]></content>
      <categories>
        <category>life</category>
      </categories>
      <tags>
        <tag>èƒ¡æ€ä¹±æƒ³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹äº”-ä»£ç å¤ç”¨æ¨¡å¼]]></title>
    <url>%2Fblog%2F2014%2F03%2Fjs-pattern-part5-code-reuse-pattern.html</url>
    <content type="text"><![CDATA[ç±»å¼ç»§æ‰¿ç¤ºä¾‹ 123456789function Parent(name)&#123; this.name = name || 'Adam';&#125;Parent.prototype.say = function()&#123; return this.name;&#125;function Child(name)&#123;&#125;inherit(Child, Parent); é˜¶æ®µ1 - é»˜è®¤æ¨¡å¼123function inherit(C, P)&#123; C.prototype = new P();&#125; ç¼ºç‚¹ï¼šæ— æ³•ç»§æ‰¿çˆ¶å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼ˆå¦‚ä¸Šä¾‹ä¸­çš„nameï¼‰ã€‚ é˜¶æ®µ2 - å€Ÿç”¨æ„é€ å‡½æ•°123function Child(name)&#123; Parent.apply(this, arguments);&#125; ç¼ºç‚¹ï¼šåªèƒ½ç»§æ‰¿åœ¨çˆ¶æ„é€ å‡½æ•°ä¸­æ·»åŠ åˆ°thisçš„å±æ€§ã€‚åŒæ—¶å¹¶ä¸èƒ½ç»§æ‰¿é‚£äº›å·²æ·»åŠ åˆ°åŸå‹ä¸­çš„æˆå‘˜ã€‚ä¼˜ç‚¹ï¼šä¸ä¼šå­˜åœ¨å­å¯¹è±¡æ„å¤–è¦†ç›–çˆ¶å¯¹è±¡å±æ€§çš„é£é™©ã€‚ é˜¶æ®µ3 - å€Ÿç”¨å’Œè®¾ç½®åŸå‹1234function Child(name)&#123; Parent.apply(this, arguments);&#125;Child.prototype = new Parent(); ç¼ºç‚¹ï¼šçˆ¶æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼›è‡ªèº«çš„å±æ€§ä¼šè¢«ç»§æ‰¿ä¸¤æ¬¡ã€‚ é˜¶æ®µ4 - å…±äº«åŸå‹123function inherit(C, P)&#123; C.prototype = P.prototype;&#125; æœ¬æ¨¡å¼çš„ç»éªŒæ³•åˆ™åœ¨äºï¼šå¯å¤ç”¨æˆå‘˜åº”è¯¥è½¬ç§»åˆ°åŸå‹ä¸­è€Œä¸æ˜¯æ”¾ç½®åœ¨thisä¸­ã€‚å› æ­¤ï¼Œå‡ºäºç»§æ‰¿çš„ç›®çš„ï¼Œä»»ä½•å€¼å¾—ç»§æ‰¿çš„ä¸œè¥¿éƒ½åº”è¯¥æ”¾ç½®åœ¨åŸå‹ä¸­å®ç°ã€‚ é˜¶æ®µ5 - ä¸´æ—¶æ„é€ å‡½æ•°12345function inherit(C, P)&#123; var F = function()&#123;&#125;; F.prototype = P.prototype; C.prototype = new F();&#125; è¿™ç§æ¨¡å¼ä¸é˜¶æ®µ1ç•¥æœ‰ä¸åŒï¼Œè¿™æ˜¯ç”±äºè¿™é‡Œçš„å­å¯¹è±¡ä»…ç»§æ‰¿äº†åŸå‹çš„å±æ€§ã€‚è¿™ç§æƒ…å†µé€šå¸¸æ¥è¯´æ˜¯å¾ˆå¥½çš„ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯æ›´åŠ å¯å–çš„ï¼Œå› ä¸ºåŸå‹ä¹Ÿæ­£æ˜¯æ”¾ç½®å¯å¤ç”¨åŠŸèƒ½çš„ä½ç½®ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œçˆ¶æ„é€ å‡½æ•°æ·»åŠ åˆ°thisä¸­çš„ä»»ä½•æˆå‘˜éƒ½ä¸ä¼šè¢«ç»§æ‰¿ã€‚ é˜¶æ®µ6 - åœ£æ¯1234567function inherit(C, P)&#123; var F = function()&#123;&#125;; F.prototype = P.prototype; C.prototype = new F(); C.parent = P.prototype; C.prototype.constructor = C;&#125; è¿™ç§æ¨¡å¼ä¹Ÿè¢«ç§°ä¸ºä½¿ç”¨ä»£ç†å‡½æ•°æˆ–ä»£ç†æ„é€ å‡½æ•°çš„æ¨¡å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸´æ—¶æ„é€ å‡½æ•°çš„æ¨¡å¼ï¼Œè¿™æ˜¯å› ä¸ºä¸´æ—¶æ„é€ å‡½æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªç”¨äºè·å¾—çˆ¶å¯¹è±¡åŸå‹çš„ä»£ç†ã€‚ å¯¹è¯¥åœ£æ¯æ¨¡å¼çš„ä¸€ä¸ªå¸¸è§ä¼˜åŒ–æ˜¯é¿å…åœ¨æ¯æ¬¡éœ€è¦ç»§æ‰¿æ—¶éƒ½åˆ›å»ºä¸´æ—¶ï¼ˆä»£ç†ï¼‰æ„é€ å‡½æ•°ã€‚ä»…åˆ›å»ºä¸€æ¬¡ä¸´æ—¶æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”ä¿®æ”¹å®ƒçš„åŸå‹ï¼Œè¿™å·²ç»æ˜¯éå¸¸å……åˆ†çš„ã€‚ 123456789var inherit = (function()&#123; var F = function()&#123;&#125;; return function(C, P)&#123; F.prototype = P.prototype; C.prototype = new F(); C.parent = P.prototype; C.prototype.constructor = C; &#125;&#125;()); é˜¶æ®µ7 - Klassç‰¹ç‚¹ï¼š æœ‰ä¸€å¥—æœ‰å…³å¦‚ä½•å‘½åç±»æ–¹æ³•çš„å…¬çº¦ï¼Œè¿™ä¹Ÿè¢«è®¤ä¸ºæ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œæ¯”å¦‚initializeã€_initä»¥åŠä¸€äº›å…¶ä»–ç±»ä¼¼çš„æ„é€ å‡½æ•°åï¼Œå¹¶ä¸”åœ¨åˆ›å»ºå¯¹è±¡æ—¶è¿™äº›æ–¹æ³•å°†ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ å­˜åœ¨ä»å…¶ä»–ç±»æ‰€ç»§æ‰¿çš„ç±» åœ¨å­ç±»ä¸­å¯ä»¥è®¿é—®çˆ¶ç±»æˆ–è¶…ç±» ä½¿ç”¨ç¤ºä¾‹ 12345678910111213141516171819202122var Man = Klass(null, &#123; __construct: function(what)&#123; console.log('constructor of Man'); this.name = what; &#125;, getName: function()&#123; return this.name; &#125;&#125;);var Batman = Klass(Man, &#123; __construct: function(what)&#123; console.log('constructor of Batman'); &#125;, getName: function()&#123; var name = Batman.parent.getName.call(this); return 'I am ' + name; &#125;&#125;);var bruce= new Batman('Bruce Wayne'); //æ§åˆ¶å°ç¬¬ä¸€è¡Œè¾“å‡º'constructor of Man'ï¼Œç„¶åè¾“å‡º'constructor of Batman'bruce.getName(); //output: I am Bruce Wayne æ¯æ¬¡åœ¨è°ƒç”¨å­ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œçˆ¶ç±»çš„æ„é€ å‡½æ•°ä¹Ÿå°†ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ 12bruce instanceof Man; //truebruce instanceof Batman; //true å…·ä½“å®ç° 1234567891011121314151617181920212223242526272829var Klass = function(Parent, props)&#123; //1. æ–°æ„é€ å‡½æ•° var Child = function()&#123; if(Child.parent &amp;&amp; Child.parent.hasOwnProperty('__construct'))&#123; Child.parent.__construct.apply(this, arguments); &#125; if(Child.prototype.hasOwnProperty('__construct'))&#123; Child.prototype.__construct.apply(this, arguments); &#125; &#125;; //2. ç»§æ‰¿ Parent = Parent || Object; var F = function()&#123;&#125;; F.prototype = Parent.prototype; Child.prototype = new F(); Child.parent = Parent.prototype; Child.prototype.constructor = Child; //3. æ·»åŠ å®ç°æ–¹æ³• for(var i in props)&#123; if(props.hasOwnProperty(i))&#123; Child.prototype[i] = props[i]; &#125; &#125; //è¿”å›è¯¥class return Child;&#125;; è¯´æ˜ï¼šåˆ›å»ºäº†Child()æ„é€ å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ˜¯æœ€åè¿”å›çš„ï¼Œå¹¶ä¸”è¯¥å‡½æ•°ä¹Ÿç”¨ä½œç±»ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå¦‚æœå­˜åœ¨__constructæ–¹æ³•ï¼Œé‚£ä¹ˆå°†ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚å¦å¤–ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œé€šè¿‡ä½¿ç”¨é™æ€parentå±æ€§ï¼Œå…¶çˆ¶ç±»çš„__constructæ–¹æ³•å¦‚æœå­˜åœ¨çš„è¯ä¹Ÿä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚å¯èƒ½åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå½“æ²¡æœ‰å®šä¹‰parentå±æ€§æ—¶ï¼Œæ¯”å¦‚ç›´æ¥ä»Objectç±»ä¸­ç»§æ‰¿æ—¶ï¼Œè¿™ä¸ä»Manç±»çš„å®šä¹‰ä¸­ç»§æ‰¿æ˜¯ç›¸ä¼¼çš„æƒ…å†µã€‚ åŸå‹ç»§æ‰¿åŸå‹ç»§æ‰¿æ˜¯ä¸€ç§â€œç°ä»£â€æ— ç±»ç»§æ‰¿æ¨¡å¼ï¼Œä¸æ¶‰åŠç±»ï¼Œè¿™ä¸ªçš„å¯¹è±¡éƒ½æ˜¯ç»§æ‰¿è‡ªå…¶ä»–å¯¹è±¡ã€‚ä»¥è¿™ç§æ–¹å¼è€ƒè™‘ï¼šæœ‰ä¸€ä¸ªæƒ³è¦å¤ç”¨çš„å¯¹è±¡ï¼Œå¹¶ä¸”æƒ³åˆ›å»ºçš„ç¬¬äºŒä¸ªå¯¹è±¡éœ€è¦ä»ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸­è·å–å…¶åŠŸèƒ½ã€‚ ä½¿ç”¨ç¤ºä¾‹ 12345var parent = &#123; name: 'papa'&#125;;var child = object(parent);alert(child.name); //output: papa å…·ä½“å®ç° 12345function object(o)&#123; function F() &#123;&#125; F.prototype = o; return new F();&#125; è®¨è®º åœ¨åŸå‹ç»§æ‰¿æ¨¡å¼ä¸­ï¼Œå¹¶ä¸éœ€è¦ä½¿ç”¨å­—é¢é‡æ¥åˆ›å»ºçˆ¶å¯¹è±¡ï¼ˆå°½ç®¡è¿™æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„æ–¹å¼ï¼‰ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°æ¥åˆ›å»ºçˆ¶å¯¹è±¡ï¼Œä½†è¯·æ³¨æ„ï¼Œå¦‚æœè¿™æ ·åšçš„è¯ï¼Œè‡ªèº«ï¼ˆthisï¼‰å±æ€§å’ŒåŸå‹å±æ€§éƒ½å°†è¢«ç»§æ‰¿ã€‚ åœ¨æœ¬æ¨¡å¼çš„å¦å¤–ä¸€ä¸ªå˜åŒ–ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä»…ç»§æ‰¿ç°æœ‰æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚è¯·è®°ä½ï¼Œå¯¹è±¡ç»§æ‰¿è‡ªå¯¹è±¡ï¼Œè€Œä¸è®ºçˆ¶å¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚ 1var kid = object(Person.prototype); åœ¨ES5ä¸­ï¼ŒåŸå‹ç»§æ‰¿æ¨¡å¼å·²ç»æ­£å¼æˆä¸ºè¯¥è¯­è¨€çš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§æ¨¡å¼æ˜¯é€šè¿‡æ–¹æ³•Object.create()æ¥å®ç°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦æ¨å‡ºä¸object()ç›¸ç±»ä¼¼çš„å‡½æ•°ï¼Œå®ƒå·²ç»å†…åµŒåœ¨è¯¥è¯­è¨€ä¸­ã€‚ 1var child = Object.create(parent); Object.create()æ¥å—ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œå³ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªé¢å¤–å¯¹è±¡çš„å±æ€§å°†ä¼šè¢«æ·»åŠ åˆ°æ–°å¯¹è±¡ä¸­ï¼Œä»¥æ­¤ä½œä¸ºæ–°å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œç„¶åObject.create()è¿”å›è¯¥æ–°å¯¹è±¡ã€‚è¿™æä¾›äº†å¾ˆå¤§çš„æ–¹ä¾¿ï¼Œä½¿ä½ å¯ä»¥ä»…é‡‡ç”¨ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å³å¯å®ç°ç»§æ‰¿å¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºå­å¯¹è±¡ã€‚ 123var child = Object.create(parent, &#123; age: &#123; value: 22 &#125; //ECMA5æè¿°ç¬¦å·&#125;); é€šè¿‡å¤åˆ¶å±æ€§å®ç°ç»§æ‰¿æµ…å¤åˆ¶ 123456789function extend(parent, child)&#123; child = child || &#123;&#125;; for(var i in parent)&#123; if(parent.hasOwnProperty(i))&#123; child[i] = parent[i]; &#125; &#125; return child;&#125; æ·±å¤åˆ¶ 123456789101112131415161718function extendDeep(parent, child)&#123; var toString = Object.prototype.toString; var astr = '[object Array]'; child = child || &#123;&#125;; for(var i in parent)&#123; if(parent.hasOwnProperty(i))&#123; if(typeof parent[i] === 'object')&#123; child[i] = (toString.call(parent[i]) === astr) ? [] : &#123;&#125;; extendDeep(parent[i], child[i]); &#125; else&#123; child[i] = parent[i]; &#125; &#125; &#125; return child;&#125; è¿™ç§å±æ€§å¤åˆ¶æ¨¡å¼æ¯”è¾ƒç®€å•ä¸”å¾—åˆ°äº†å¹¿æ³›è¿ç”¨ã€‚ä¾‹å¦‚ï¼ŒFirebugï¼ˆä½¿ç”¨Javascriptç¼–å†™çš„Firefoxæ‰©å±•æ’ä»¶ï¼‰ä¸­å…·æœ‰ä¸€ä¸ªåä¸ºextend()çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°±å¯ä»¥å®ç°æµ…å¤åˆ¶ï¼Œè€Œjqueryåº“ä¸­çš„extend()åˆ™å¯åˆ›å»ºæ·±åº¦å¤åˆ¶çš„å‰¯æœ¬ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æœ¬æ¨¡å¼ä¸­æ ¹æœ¬æ²¡æœ‰æ¶‰åŠä»»ä½•åŸå‹ï¼Œæœ¬æ¨¡å¼ä»…ä¸å¯¹è±¡ä»¥åŠå®ƒä»¬è‡ªèº«çš„å±æ€§ç›¸å…³ã€‚ æ··å…¥å¯ä»¥é’ˆå¯¹è¿™ç§é€šè¿‡å±æ€§å¤åˆ¶å®ç°ç»§æ‰¿çš„æ€æƒ³åšè¿›ä¸€æ­¥çš„æ‰©å±•ï¼Œå°±æœ‰äº†mix-inï¼ˆæ··å…¥ï¼‰æ¨¡å¼ã€‚mix-inæ¨¡å¼å¹¶ä¸æ˜¯å¤åˆ¶ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä»å¤šä¸ªå¯¹è±¡ä¸­å¤åˆ¶å‡ºä»»æ„çš„æˆå‘˜å¹¶å°†è¿™äº›æˆå‘˜ç»„åˆæˆä¸€ä¸ªæ–°å¯¹è±¡ã€‚ mix-inå®ç°æ¯”è¾ƒç®€å•ï¼Œåªéœ€éå†æ¯ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å¤åˆ¶å‡ºä¼ é€’ç»™è¯¥å‡½æ•°çš„æ¯ä¸ªå¯¹è±¡ä¸­çš„æ¯ä¸ªå±æ€§ã€‚å¯ä»¥å‘å®ƒä¼ é€’ä»»æ„æ•°é‡çš„å¯¹è±¡ï¼Œå…¶ç»“æœå°†è·å¾—ä¸€ä¸ªå…·æœ‰æ‰€æœ‰æºå¯¹è±¡å±æ€§çš„æ–°å¯¹è±¡ã€‚ 1234567891011function mixin()&#123; var child = &#123;&#125;; for(var arg=0; arg&lt;arguments.length; arg++)&#123; for(var prop in arguments[arg])&#123; if(arguments[arg].hasOwnProperty(prop))&#123; child[prop] = arguments[arg][prop]; &#125; &#125; &#125; return child;&#125; å€Ÿç”¨å’Œç»‘å®š12345function bind(o, m)&#123; return function()&#123; return m.apply(o, [].slice.call(arguments)); &#125;;&#125; ES5ä¸­å°†bind()æ–¹æ³•æ·»åŠ åˆ°Function.prototypeï¼Œä½¿å¾—bind()å°±åƒapply()å’Œcall()ä¸€æ ·ç®€å•æ˜“ç”¨ã€‚ 1234567891011if(typeof Function.prototype.bind === 'undefined')&#123; Function.prototype.bind = function(thisArg)&#123; var fn = this; var slice = Array.prototype.slice; var args = slice.call(arguments, 1); return function()&#123; return fn.apply(thisArg, args.concat(slice.call(arguments))); &#125;; &#125;;&#125; è¿™ä¸ªå®ç°å¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œå®ƒä½¿ç”¨äº†éƒ¨åˆ†åº”ç”¨å¹¶æ‹¼æ¥äº†å‚æ•°åˆ—è¡¨ï¼Œå³é‚£äº›ä¼ é€’ç»™bind()çš„å‚æ•°ï¼ˆé™¤äº†ç¬¬ä¸€ä¸ªä»¥å¤–ï¼‰ï¼Œä»¥åŠé‚£äº›ä¼ é€’ç»™ç”±bind()æ‰€è¿”å›çš„æ–°å‡½æ•°çš„å‚æ•°ï¼Œå…¶ä¸­è¯¥æ–°å‡½æ•°å°†åœ¨ä»¥åè¢«è°ƒç”¨ã€‚ å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹å››-å¯¹è±¡åˆ›å»ºæ¨¡å¼]]></title>
    <url>%2Fblog%2F2014%2F03%2Fjs-pattern-part4-object-creation-pattern.html</url>
    <content type="text"><![CDATA[å‘½åç©ºé—´æ¨¡å¼1234567891011121314151617181920212223var MYAPP = MYAPP || &#123;&#125;;MYAPP.namespace = function(ns_string)&#123; var parts = ns_string.split('.'); var parent = MYAPP; //å‰¥ç¦»æœ€å‰é¢çš„å†—ä½™å…¨å±€å˜é‡ if(parts[0] === 'MYAPP')&#123; parts = parts.slice(1); &#125; for(var i=0; i&lt;parts.length; i++)&#123; //å¦‚æœå®ƒä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºä¸€ä¸ªå±æ€§ if(typeof parent[parts[i]] === 'undefined')&#123; parent[parts[i]] = &#123;&#125;; &#125; parent = parent[parts[i]]; &#125; return parent;&#125;;//ä½¿ç”¨var module2 = MYAPP.namespace('MYAPP.modules.module2');module2 === MYAPP.modules.module2; //true æ¨¡å—æ¨¡å¼123456789101112131415161718192021222324MYAPP.namespace('MYAPP.utilities.array');MYAPP.utilities.array = (function()&#123; //ä¾èµ– var uobj = MYAPP.utilities.object; var ulang = MYAPP.utilities.lang; //ç§æœ‰å±æ€§ var array_string = '[object Array]'; var ops = Object.prototype.toString; //ç§æœ‰æ–¹æ³• //... //å¯é€‰çš„ä¸€æ¬¡æ€§åˆå§‹åŒ–è¿‡ç¨‹ //... //å…¬æœ‰API return &#123; isArray: function(a)&#123; return ops.call(a) === array_string; &#125;, //æ›´å¤šæ–¹æ³•å’Œå±æ€§... &#125;;&#125;()); æ¨¡å—æ¨¡å¼çš„å˜ä½“æ­ç¤ºæ¨¡å—æ¨¡å¼ï¼šæ‰€æœ‰çš„æ–¹æ³•éƒ½éœ€è¦ä¿æŒç§æœ‰æ€§ï¼Œå¹¶ä¸”åªèƒ½æš´éœ²é‚£äº›æœ€åå†³å®šè®¾ç«‹APIçš„é‚£äº›æ–¹æ³•ã€‚åˆ›å»ºæ„é€ å‡½æ•°çš„æ¨¡å—ï¼šåŒ…è£…äº†æ¨¡å—çš„å³æ—¶å‡½æ•°æœ€ç»ˆå°†ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚å°†å…¨å±€å˜é‡å¯¼å…¥åˆ°æ¨¡å—ä¸­ï¼šå°†å…¨å±€å˜é‡ä»¥å‚æ•°çš„å½¢å¼ä¼ é€’åˆ°åŒ…è£…äº†æ¨¡å—çš„å³æ—¶å‡½æ•°ä¸­ã€‚ æ²™ç®±æ¨¡å¼æ²™ç®±æ¨¡å¼æä¾›äº†ä¸€ä¸ªå¯ç”¨äºæ¨¡å—è¿è¡Œçš„ç¯å¢ƒï¼Œä¸”ä¸ä¼šå¯¹å…¶ä»–æ¨¡å—å’Œä¸ªäººæ²™ç®±é€ æˆä»»ä½•å½±å“ã€‚åœ¨å‘½åç©ºé—´æ¨¡å¼ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡ã€‚åœ¨æ²™ç®±æ¨¡å¼ä¸­ï¼Œåˆ™æ˜¯ä¸€ä¸ªå…¨å±€æ„é€ å‡½æ•°ï¼Œè®©æˆ‘ä»¬ç§°ä¹‹ä¸ºSandbox()ã€‚å¯ä»¥ä½¿ç”¨è¯¥æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡å¹¶ä¸”è¿˜å¯ä»¥ä¼ é€’å›è°ƒå‡½æ•°ï¼Œå®ƒå˜æˆäº†ä»£ç çš„éš”ç¦»æ²™ç®±è¿è¡Œç¯å¢ƒã€‚ ä½¿ç”¨ç¤ºä¾‹ 12345678910Sandbox(['dom', 'event'], function(box)&#123; //ä½¿ç”¨DOMå’Œäº‹ä»¶æ¥è¿è¡Œ... Sandbox('ajax', function(box)&#123; //å¦ä¸€ä¸ªæ²™ç®± //ä½¿ç”¨Ajaxæ¥å¤„ç†... &#125;); //è¿™é‡Œæ²¡æœ‰Ajaxæ¨¡å—&#125;); ä½¿ç”¨æœ¬æ²™ç®±æ¨¡å¼æ—¶ï¼Œå¯ä»¥é€šè¿‡å°†ä»£ç åŒ…è£…åˆ°å›è°ƒå‡½æ•°ä¸­ä»è€Œä¿æŠ¤å…¨å±€å‘½åç©ºé—´ã€‚å¯ä»¥æ ¹æ®æ‰€éœ€è¦çš„æ¨¡å—ç±»å‹åˆ›å»ºä¸åŒçš„æ²™ç®±å®ä¾‹ï¼Œå¹¶ä¸”è¿™äº›å®ä¾‹äº’ç›¸ç‹¬ç«‹è¿è¡Œã€‚ å…·ä½“å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869function Sandbox()&#123; //å°†å‚æ•°è½¬æ¢æˆä¸€ä¸ªæ•°ç»„ var args = Array.prototype.slice.call(arguments); //æœ€åä¸€ä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•° var callback = args.pop(); //æ¨¡å—å¯ä»¥ä½œä¸ºä¸€ä¸ªæ•°ç»„ä¼ é€’ï¼Œæˆ–ä½œä¸ºå•ç‹¬çš„å‚æ•°ä¼ é€’ var modules = (args[0] &amp;&amp; typeof args[0] === 'string') ? args : args[0]; //ç¡®ä¿è¯¥å‡½æ•°ä½œä¸ºå¤Ÿå’±å‡½æ•°è¢«è°ƒç”¨ //å‚è§"Javascriptæ¨¡å¼ä¹‹äºŒ"ä¸­çš„"å¼ºåˆ¶ä½¿ç”¨newæ¨¡å¼" if(!(this instanceof Sandbox))&#123; return new Sandbox(modules, callback); &#125; //éœ€è¦å‘thisæ·»åŠ çš„å±æ€§ //example this.a = 1; this.b = 2; //ç°åœ¨å‘è¯¥æ ¸å¿ƒthiså¯¹è±¡æ·»åŠ æ¨¡å— //ä¸æŒ‡å®šæ¨¡å—åç§°æˆ–åˆ¶å®š'*'ï¼Œéƒ½è¡¨ç¤ºä½¿ç”¨æ‰€æœ‰æ¨¡å— if(!modules || modules === '*')&#123; modules = []; for(i in Sandbox.modules)&#123; if(Sandbox.modules.hasOwnProperty(i))&#123; modules.push(i); &#125; &#125; &#125; //åˆå§‹åŒ–æ‰€éœ€çš„æ¨¡å— for(var i=0; i&lt;modules.length; i++)&#123; Sandbox.modules[modules[i]](this); &#125; //å›è°ƒ //æ³¨ï¼šæ”¹å˜çš„æ˜¯thiså³å›è°ƒå‡½æ•°çš„å‚æ•°boxæ‰€æ‹¥æœ‰çš„å±æ€§å’Œæ–¹æ³• callback(this);&#125;//éœ€è¦çš„ä»»ä½•åŸå‹å±æ€§Sandbox.prototype = &#123; name: 'My Application', version: '1.0', getName: function()&#123; return this.name; &#125;&#125;;//æ·»åŠ æ¨¡å—Sandbox.modules = &#123;&#125;;Sandbox.modules.dom = function(box)&#123; box.getElement = function()&#123;&#125;; box.getStyle = function()&#123;&#125;; box.foo = 'bar';&#125;;Sandbox.modules.event = function(box)&#123; //å¦‚æœéœ€è¦ï¼Œå°±è®¿é—®SandboxåŸå‹ï¼Œå¦‚ä¸‹è¯­å¥ //box.constructor.prototype.m = 'mmm'; box.attachEvent = function()&#123;&#125;; box.dettachEvent = function()&#123;&#125;;&#125;;Sandbox.modules.ajax = function(box)&#123; box.makeRequest = function()&#123;&#125;; box.getResponse = function()&#123;&#125;;&#125;; åœ¨è¿™ä¸ªç¤ºä¾‹å®ç°ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒä»å…¶ä»–æ–‡ä»¶ä¸­åŠ è½½æ‰€éœ€çš„åŠŸèƒ½ï¼Œä½†è¿™ç»å¯¹ä¹Ÿæ˜¯ä¸€ä¸ªå¯é€‰çš„å®ç°åŠŸèƒ½ã€‚æ¯”å¦‚YUI3åº“ä¸­å°±æ”¯æŒè¿™ç§åŠŸèƒ½ã€‚å½“æˆ‘ä»¬çŸ¥é“æ‰€éœ€çš„æ¨¡å—æ—¶ï¼Œä¾¿å¯ä»¥æ®æ­¤è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™è¡¨ç¤ºå¯ä»¥è°ƒç”¨å®ç°æ¯ä¸ªæ¨¡å—çš„å‡½æ•°ã€‚è¯¥æ„é€ å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚è¯¥å›è°ƒå‡½æ•°å°†ä¼šåœ¨ä½¿ç”¨æ–°åˆ›å»ºçš„å®ä¾‹æ—¶æœ€åè¢«è°ƒç”¨ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å®é™…ä¸Šæ˜¯ç”¨æˆ·çš„æ²™ç®±ï¼Œå®ƒå¯ä»¥è·å¾—ä¸€ä¸ªå¡«å……äº†æ‰€éœ€åŠŸèƒ½çš„boxå¯¹è±¡ã€‚ æˆ‘è§‰å¾—æ²™ç®±æ¨¡å¼çš„ç¼ºç‚¹æ˜¯Sandbox.modulesæš´éœ²åœ¨å¤–ï¼Œåº”è¯¥ä½¿ç”¨æ›´å¥½çš„AMD(Asynchronous Module Definition)æ¨¡å¼ é“¾æ¨¡å¼é“¾æ¨¡å¼çš„ä¼˜ç‚¹åœ¨äºå®ƒå¯ä»¥å¸®åŠ©ä½ è€ƒè™‘åˆ†å‰²å‡½æ•°ï¼Œä»¥åˆ›å»ºæ›´åŠ ç®€çŸ­ã€å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯åˆ›å»ºå°è¯•å®ç°å¤ªå¤šåŠŸèƒ½çš„å‡½æ•°ã€‚ä»é•¿è¿œçœ‹æ¥ï¼Œè¿™æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚é“¾æ¨¡å¼çš„ç¼ºç‚¹åœ¨äºä»¥è¿™ç§æ–¹å¼ç¼–å†™çš„ä»£ç æ›´åŠ éš¾ä»¥è°ƒè¯•ã€‚æˆ–è®¸çŸ¥é“åœ¨æŸä¸ªç‰¹å®šçš„ä»£ç è¡Œä¸­å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯åœ¨æ­¤è¡Œä¸­å®é™…æ‰§è¡Œäº†å¤ªå¤šçš„æ­¥éª¤ã€‚å½“é“¾ä¸­å¤šä¸ªæ–¹æ³•çš„å…¶ä¸­ä¸€ä¸ªé™é»˜å¤±æ•ˆæ—¶ï¼Œæ— æ³•çŸ¥é“æ˜¯å“ªä¸€ä¸ªæ–¹æ³•å‘ç”Ÿå¤±æ•ˆã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œè¯†åˆ«å‡ºè¿™ç§æ¨¡å¼éƒ½å¾ˆæœ‰å¥½å¤„ã€‚å½“ç¼–å†™çš„æ–¹æ³•å¹¶æ²¡æœ‰æ˜æ˜¾å’Œæœ‰æ„ä¹‰çš„è¿”å›å€¼æ—¶ï¼Œå¯ä»¥æ€»æ˜¯è¿”å›thisã€‚ method()æ–¹æ³•æ€æƒ³ï¼ˆå¹¶ä¸æ˜¯å¾ˆæ¨èï¼‰ example. 12345678910111213var Person = function(name)&#123; this.name = name;&#125;. method('getName', function()&#123; return this.name; &#125;). method('setName', function(name)&#123; this.name = name; return this; &#125;);var a = new Person('Adam');a.setName('Eve').getName(); method()æ–¹æ³•å®ç° 123456if(typeof Function.prototype.method !== 'function')&#123; Function.prototype.method = function(name, implementation)&#123; this.prototype[name] = implementation; return this. &#125;&#125; å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹ä¸‰-å‡½æ•°]]></title>
    <url>%2Fblog%2F2014%2F02%2Fjs-pattern-part3-function.html</url>
    <content type="text"><![CDATA[èƒŒæ™¯Javascriptä¸­å‡½æ•°æœ‰ä¸¤ä¸ªé‡è¦ç‰¹å¾ã€‚ç¬¬ä¸€ï¼Œå‡½æ•°æ˜¯ç¬¬ä¸€ç±»å¯¹è±¡ï¼ˆfirst-class objectï¼‰ï¼Œå¯ä»¥ä½œä¸ºå¸¦æœ‰å±æ€§å’Œæ–¹æ³•çš„å€¼ä»¥åŠå‚æ•°è¿›è¡Œä¼ é€’ã€‚ç¬¬äºŒï¼Œå‡½æ•°æä¾›äº†å±€éƒ¨ä½œç”¨åŸŸã€‚Javascriptä¸­ä»…å­˜åœ¨å‡½æ•°ä½œç”¨åŸŸï¼ŒèŠ±æ‹¬å·{}å¹¶ä¸æä¾›å±€éƒ¨ä½œç”¨åŸŸï¼Œå› æ­¤å¦‚æœåœ¨ifæ¡ä»¶è¯­å¥æˆ–åœ¨forä»¥åŠwhileå¾ªç¯ä¸­ï¼Œä½¿ç”¨varå…³é”®å­—å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œè¿™å¹¶ä¸æ„å‘³ç€è¯¥å˜é‡å¯¹äºifæˆ–foræ¥è¯´æ˜¯å±€éƒ¨å˜é‡ã€‚å®ƒä»…å¯¹äºåŒ…è£…å‡½æ•°æ¥è¯´æ˜¯å±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”å¦‚æœæ²¡æœ‰åŒ…è£…å‡½æ•°ï¼Œå®ƒå°†ç§°ä¸ºä¸€ä¸ªå…¨å±€å˜é‡ã€‚æ­¤å¤–ï¼Œå‡½æ•°ä¸­å£°æ˜çš„å±€éƒ¨å˜é‡å¯è¢«æå‡åˆ°å±€éƒ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨ã€‚ å‡½æ•°åˆ›å»ºæ–¹å¼1ã€å‘½åå‡½æ•°è¡¨è¾¾å¼ã€‚ 1var add = function add(a, b)&#123;...&#125;; æ³¨ï¼šä¸è¦å°†å‘½åå‡½æ•°è¡¨è¾¾å¼åˆ†é…ç»™ä¸€ä¸ªå…·æœ‰ä¸åŒåç§°çš„å˜é‡ï¼Œå› ä¸ºå¯èƒ½åœ¨æŸäº›æµè§ˆå™¨ä¸‹ä¸æ”¯æŒã€‚å¦‚var foo = function bar(){}; 2ã€å‡½æ•°è¡¨è¾¾å¼ã€‚ä¸ä¸Šé¢çš„ç›¸åŒï¼Œä½†ç¼ºå°‘ä¸€ä¸ªåå­—ï¼Œé€šå¸¸ä¹Ÿç§°ä¸ºåŒ¿åå‡½æ•°ã€‚ 1var add = function(a, b)&#123;...&#125;; å”¯ä¸€çš„åŒºåˆ«åœ¨äºè¯¥å‡½æ•°å¯¹è±¡çš„nameå±æ€§å°†ä¼šæˆä¸ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²æˆ–undefinedã€‚nameå±æ€§æ˜¯Javascriptè¯­è¨€çš„ä¸€ä¸ªæ‰©å±•ï¼ˆå®ƒå¹¶ä¸æ˜¯ECMAæ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œå¯ç”¨äºdebugæ—¶é”™è¯¯å®šä½ï¼Œä¹Ÿå¯ç”¨äºåœ¨è‡ªèº«å†…éƒ¨é€’å½’è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°ã€‚ 3ã€å‡½æ•°å£°æ˜ã€‚ 1function foo()&#123;...&#125; å°±è¯­æ³•è€Œè¨€ï¼Œå‘½åå‡½æ•°è¡¨è¾¾å¼ä¸å‡½æ•°å£°æ˜çœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œå°¤å…¶æ˜¯å¦‚æœä¸å°†å‡½æ•°è¡¨è¾¾å¼çš„ç»“æœåˆ†é…ç»™å˜é‡ã€‚åœ¨å°¾éšçš„åˆ†å·ä¸­ï¼Œè¿™ä¸¤è€…ä¹‹é—´å­˜åœ¨è¯­æ³•å·®å¼‚ã€‚å‡½æ•°å£°æ˜ä¸­å¹¶ä¸éœ€è¦åˆ†å·ç»“å°¾ï¼Œä½†åœ¨å‡½æ•°è¡¨è¾¾å¼ä¸­éœ€è¦åˆ†å·ï¼Œå¹¶ä¸”åº”è¯¥æ€»æ˜¯ä½¿ç”¨åˆ†å·ï¼ˆåœ¨å‹ç¼©jsæ–‡ä»¶æ—¶ä¼šå‡ºé—®é¢˜ï¼‰ã€‚ å‡½æ•°çš„æå‡å¯¹äºæ‰€æœ‰å˜é‡ï¼Œæ— è®ºåœ¨å‡½æ•°ä½“çš„ä½•å¤„è¿›è¡Œå£°æ˜ï¼Œéƒ½ä¼šåœ¨åå°è¢«æå‡åˆ°å‡½æ•°é¡¶éƒ¨ã€‚è€Œè¿™å¯¹äºå‡½æ•°åŒæ ·é€‚ç”¨ï¼Œå…¶åŸå› åœ¨äºå‡½æ•°åªæ˜¯åˆ†é…ç»™å˜é‡çš„å¯¹è±¡ã€‚å½“ä½¿ç”¨å‡½æ•°å£°æ˜æ—¶ï¼Œå‡½æ•°å®šä¹‰ä¹Ÿè¢«æå‡ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°å£°æ˜è¢«æå‡ã€‚ example. 123456789101112131415161718function hoistMe()&#123; console.log(typeof foo); //output: function console.log(typeof bar); //output: undefined foo(); //output: local foo bar(); //output: TypeError: bar is not a function //å‡½æ•°å£°æ˜ï¼Œå˜é‡'foo'åŠå…¶å®ç°éƒ½è¢«æå‡ function foo()&#123; alert('local foo'); &#125; //å‡½æ•°è¡¨è¾¾å¼ï¼Œä»…å˜é‡'bar'è¢«æå‡ï¼Œå‡½æ•°å®ç°å¹¶æœªè¢«æå‡ var bar = function()&#123; alert('local bar'); &#125;;&#125;hoistMe(); APIæ¨¡å¼-å›è°ƒæ¨¡å¼example.æ™®é€šå†™æ³• 12345678910111213141516171819var findNodes = function()&#123; var i = 100000; var nodes = []; var found; while(i--)&#123; //å¤æ‚é€»è¾‘... nodes.push(found); &#125; return nodes;&#125;;var hide = function(nodes)&#123; for(var i=0, max=nodes.length; i&lt;max; i++)&#123; nodes[i].style.display = 'none'; &#125;&#125;;//æ‰§è¡Œå‡½æ•°hide(findNodes()); å®ç°ä½æ•ˆï¼Œå› ä¸ºhide()å¿…é¡»å†æ¬¡éå†ç”±findNodes()æ‰€è¿”å›çš„æ•°ç»„èŠ‚ç‚¹ã€‚å¦‚æœåœ¨findNodes()ä¸­å®ç°hideé€»è¾‘ï¼Œç”±äºæ£€ç´¢å’Œä¿®æ”¹é€»è¾‘è€¦åˆï¼Œé‚£ä¹ˆå®ƒä¸å†æ˜¯ä¸€ä¸ªé€šç”¨å‡½æ•°ã€‚å¯¹è¿™ç§é—®é¢˜çš„è§£å†³åŠæ³•æ˜¯é‡‡ç”¨å›è°ƒæ¨¡å¼ã€‚ example.å›è°ƒæ¨¡å¼ 123456789101112131415161718192021222324var findNodes = function(callback)&#123; var i = 100000; var nodes = []; var found; //æ£€æŸ¥å›è°ƒå‡½æ•°æ˜¯å¦ä¸ºå¯è°ƒç”¨çš„ if(typeof callback !== 'function')&#123; callback = false; &#125; while(i--)&#123; //å¤æ‚é€»è¾‘... if(callback)&#123; callback(found); &#125; nodes.push(found); &#125; return nodes;&#125;;//æ‰§è¡Œå‡½æ•°findNodes(function(node)&#123; node.style.display = 'none';&#125;); æ³¨ï¼šå›è°ƒå‡½æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå·²æœ‰çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¯ä»¥åœ¨è°ƒç”¨ä¸»å‡½æ•°æ—¶åˆ›å»ºå®ƒã€‚ è™½ç„¶åœ¨è®¸å¤šæƒ…å†µä¸‹è¿™ç§æ–¹æ³•éƒ½æ˜¯ç®€å•è€Œä¸”æœ‰æ•ˆçš„ï¼Œä½†ç»å¸¸å­˜åœ¨ä¸€äº›åœºæ™¯ï¼Œå…¶å›è°ƒå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§çš„åŒ¿åå‡½æ•°æˆ–å…¨å±€å‡½æ•°ï¼Œè€Œæ˜¯å¯¹è±¡çš„æ–¹æ³•ã€‚å¦‚æœè¯¥å›è°ƒæ–¹æ³•ä½¿ç”¨thisæ¥å¼•ç”¨å®ƒæ‰€å±çš„å¯¹è±¡ï¼Œå°±ä¼šå¯¼è‡´é—®é¢˜ã€‚è§£å†³åŠæ³•æ˜¯ä¼ é€’å›è°ƒå‡½æ•°ï¼Œå¹¶ä¸”å¦å¤–è¿˜ä¼ é€’è¯¥å›è°ƒå‡½æ•°æ‰€å±çš„å¯¹è±¡ã€‚ example. 12345678910var findNodes = function(callback, callback_obj)&#123; //... if(typeof callback === 'string')&#123; callback = callback_obj[callback]; &#125; if(typeof callback === 'function')&#123; callback.call(callback_obj, found); &#125; //...&#125;; APIæ¨¡å¼-é…ç½®å¯¹è±¡å°†å‡½æ•°å‚æ•°åŒ…è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚addPerson(param)é…ç½®å¯¹è±¡çš„ä¼˜ç‚¹åœ¨äºï¼šä¸éœ€è¦è®°ä½ä¼—å¤šçš„å‚æ•°ä»¥åŠå…¶é¡ºåºï¼›å¯ä»¥å®‰å…¨å¿½ç•¥å¯é€‰å‚æ•°ï¼›æ˜“äºé˜…è¯»å’Œç»´æŠ¤ï¼›æ˜“äºæ·»åŠ å’Œåˆ é™¤å‚æ•°ã€‚é…ç½®å¯¹è±¡çš„ä¸åˆ©ä¹‹å¤„åœ¨äºï¼šéœ€è¦è®°ä½å‚æ•°åç§°ï¼›å±æ€§åç§°æ— æ³•è¢«å‹ç¼©ã€‚ APIæ¨¡å¼-è¿”å›å‡½æ•°123456789var setup = function()&#123; var count = 0; return function()&#123; return (count += 1); &#125;;&#125;;var next = setup();next(); //returns: 1next(); //returns: 2 ç”±äºsetup()åŒ…è£…äº†è¿”å›å‡½æ•°ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªé—­åŒ…ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé—­åŒ…å­˜å‚¨ä¸€äº›ç§æœ‰æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®ä»…å¯è¢«è¯¥è¿”å›å‡½æ•°è®¿é—®ï¼Œä½†å¤–éƒ¨ä»£ç å´æ— æ³•è®¿é—®ã€‚ APIæ¨¡å¼-CurryåŒ–ä¾‹å­ï¼Œæœ‰function add(a, b){...} å‡½æ•°åº”ç”¨ï¼šadd.apply(null, [1, 2]); éƒ¨åˆ†åº”ç”¨ï¼š(add.apply(null, [1]))(2); æ³¨ï¼šéƒ¨åˆ†åº”ç”¨ä¸­ï¼Œadd.apply(null, [1])ä»…åº”ç”¨äº†ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå½“æ‰§è¡Œéƒ¨åˆ†åº”ç”¨æ—¶ï¼Œå¹¶ä¸ä¼šè·å¾—å…·ä½“ç»“æœï¼Œè€Œæ˜¯ä¼šè·å¾—å¦ä¸€ä¸ªå‡½æ•°ï¼Œéšåå†ä»¥å…¶ä»–å‚æ•°è°ƒç”¨è¯¥è¿”å›å‡½æ•°ã€‚è¿™ç§è¿è¡Œæ–¹å¼å®é™…ä¸Šä¸add(1)(2)æœ‰äº›ç›¸ä¼¼ï¼Œè¿™æ˜¯ç”±äºadd(1)è¿”å›äº†ä¸€ä¸ªå¯åœ¨åæ¥ç”¨(2)æ¥è°ƒç”¨çš„å‡½æ•°ã€‚ example. 12345678910function add(x, y)&#123; if(typeof y === 'undefined')&#123; //éƒ¨åˆ†åº”ç”¨ return function(y)&#123; return x + y; &#125;; &#125; //å®Œå…¨åº”ç”¨ return x + y;&#125; ä½¿å‡½æ•°ç†è§£å¹¶å¤„ç†éƒ¨åˆ†åº”ç”¨çš„è¿‡ç¨‹å°±ç§°ä¸ºCurryè¿‡ç¨‹ã€‚ example.é€šç”¨CurryåŒ–å‡½æ•° 123456789function schonfinkelize(fn)&#123; var slice = Array.prototype.slice; var stored_args = slice.call(arguments, 1); return function()&#123; var new_args = slice.call(arguments); var args = stored_args.concat(new_args); return fn.apply(null, args); &#125;;&#125; æ³¨ï¼šJavascriptä¸­argumentså¹¶ä¸æ˜¯ä¸€ä¸ªçœŸå®çš„æ•°ç»„ï¼Œä»Array.prototypeä¸­å€Ÿç”¨slice()æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†argumentså˜æˆä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ä¸”ä½¿ç”¨è¯¥æ•°ç»„å·¥ä½œæ›´åŠ æ–¹ä¾¿ã€‚ 123456789//æ™®é€šå‡½æ•°function add(x, y)&#123; return x + y;&#125;//å°†ä¸€ä¸ªå‡½æ•°CurryåŒ–ä»¥è·å¾—ä¸€ä¸ªæ–°çš„å‡½æ•°var newadd = schonfinkelize(add, 1);newadd(2); //returns: 3//ç­‰ä»·äº schonfinkelize(add, 1)(2); è½¬æ¢å‡½æ•°schonfinkelize()å¹¶ä¸å±€é™äºå•ä¸ªå‚æ•°æˆ–è€…å•æ­¥CurryåŒ–ã€‚å½“å‘ç°æ­£åœ¨è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä¼ é€’çš„å‚æ•°ç»å¤§å¤šæ•°éƒ½æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°å¯èƒ½æ˜¯ç”¨äºCurryåŒ–çš„ä¸€ä¸ªå¾ˆå¥½çš„å€™é€‰å‚æ•°ã€‚å¯ä»¥é€šè¿‡å°†ä¸€ä¸ªå‡½æ•°é›†åˆéƒ¨åˆ†åº”ç”¨åˆ°å‡½æ•°ä¸­ï¼Œä»è€ŒåŠ¨æ€åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ã€‚è¿™ä¸ªæ–°å‡½æ•°å°†ä¼šä¿å­˜é‡å¤çš„å‚æ•°ï¼ˆå› æ­¤ä¸å¿…æ¯æ¬¡éƒ½ä¼ é€’è¿™äº›å‚æ•°ï¼‰ï¼Œå¹¶ä¸”è¿˜ä¼šä½¿ç”¨é¢„å¡«å……åŸå§‹å‡½æ•°æ‰€æœŸæœ›çš„å®Œæ•´å‚æ•°åˆ—è¡¨ã€‚ åˆå§‹åŒ–æ¨¡å¼-å³æ—¶å‡½æ•°å³æ—¶å‡½æ•°æ¨¡å¼æ˜¯ä¸€ç§å¯ä»¥æ”¯æŒåœ¨å®šä¹‰å‡½æ•°åç«‹å³æ‰§è¡Œè¯¥å‡½æ•°çš„è¯­æ³•ã€‚(function(){...}()); æˆ– (function(){...})();è¿™ç§æ¨¡å¼éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¸ºåˆå§‹åŒ–ä»£ç æä¾›äº†ä¸€ä¸ªä½œç”¨åŸŸæ²™ç®±ï¼Œä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…¨å±€å¯¹è±¡æ˜¯ä»¥å‚æ•°æ–¹å¼ä¼ é€’ç»™å³æ—¶å‡½æ•°çš„ï¼Œè¿™æ ·å°†ä½¿å¾—ä»£ç åœ¨æµè§ˆå™¨ç¯å¢ƒä¹‹å¤–æ—¶å…·æœ‰æ›´å¥½çš„äº’æ“ä½œæ€§ã€‚ 123(function(global)&#123; //é€šè¿‡'global'è®¿é—®å…¨å±€å˜é‡&#125;(this)); ä¸€èˆ¬æ¥è¯´ï¼Œä¸åº”è¯¥ä¼ é€’è¿‡å¤šçš„å‚æ•°åˆ°å³æ—¶å‡½æ•°ä¸­ã€‚ æ­£å¦‚ä»»ä½•å…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œå³æ—¶å‡½æ•°å¯ä»¥è¿”å›å€¼ï¼Œå¹¶ä¸”è¿™äº›è¿”å›å€¼ä¹Ÿå¯ä»¥åˆ†é…ç»™å˜é‡ã€‚å³æ—¶å‡½æ•°æ¨¡å¼å¾—åˆ°äº†å¹¿æ³›çš„ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©åŒ…è£…è®¸å¤šæƒ³è¦æ‰§è¡Œçš„å·¥ä½œï¼Œä¸”ä¸ä¼šåœ¨åå°ç•™ä¸‹ä»»ä½•å…¨å±€å˜é‡ã€‚è¯¥æ¨¡å¼è¿˜æ”¯æŒå°†ä¸ªåˆ«åŠŸèƒ½åŒ…è£…åœ¨è‡ªåŒ…å«æ¨¡å—ä¸­ã€‚ åˆå§‹åŒ–æ¨¡å¼-å³æ—¶å¯¹è±¡åˆå§‹åŒ–example. 12345678(&#123; width: 600, height: 400, getXXX: function()&#123;...&#125;, init: function()&#123; //æ›´å¤šåˆå§‹åŒ–ä»»åŠ¡... &#125;&#125;).init(); æ³¨ï¼šå¦‚æœæƒ³åœ¨init()å®Œæ¯•ä¹‹åä¿å­˜å¯¹è¯¥å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œå¯ä»¥é€šè¿‡åœ¨init()å°¾éƒ¨æ·»åŠ return this;è¯­å¥æ¥å®ç°è¯¥åŠŸèƒ½ã€‚ å°±è¯­æ³•è€Œè¨€ï¼Œè¿™ç§æ¨¡å¼å°±åƒåœ¨ä½¿ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ã€‚å°†å­—é¢é‡åŒ…è£…åˆ°æ‹¬å·ä¸­ï¼ˆåˆ†ç»„æ“ä½œç¬¦ï¼‰ï¼Œå®ƒæŒ‡ç¤ºJavascriptå¼•æ“å°†å¤§æ‹¬å·ä½œä¸ºå¯¹è±¡å­—é¢é‡ï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ªä»£ç å—ã€‚åœ¨ç»“æŸè¯¥æ‹¬å·ä¹‹åï¼Œå¯ä»¥ç«‹å³è°ƒç”¨init()æ–¹æ³•ã€‚({...}).init(); æˆ– ({...}.init());è¿™ç§æ¨¡å¼çš„ä¼˜ç‚¹ä¸å³æ—¶å‡½æ•°æ¨¡å¼çš„ä¼˜ç‚¹æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥åœ¨æ‰§è¡Œä¸€æ¬¡æ€§çš„åˆå§‹åŒ–ä»»åŠ¡æ—¶ä¿æŠ¤å…¨å±€å‘½åç©ºé—´ã€‚ åˆå§‹åŒ–æ¨¡å¼-åˆå§‹åŒ–æ—¶åˆ†æ”¯åˆå§‹åŒ–æ—¶åˆ†æ”¯ï¼Œä¹Ÿç§°ä¸ºåŠ è½½æ—¶åˆ†æ”¯ï¼Œæ˜¯ä¸€ç§ä¼˜åŒ–æ¨¡å¼ã€‚å½“çŸ¥é“æŸä¸ªæ¡ä»¶åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸå†…éƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä»…å¯¹è¯¥æ¡ä»¶æµ‹è¯•ä¸€æ¬¡æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ã€‚æµè§ˆå™¨å—…æ¢ï¼ˆæˆ–åŠŸèƒ½æ£€æµ‹ï¼‰å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ã€‚ æ€§èƒ½æ¨¡å¼-å¤‡å¿˜æ¨¡å¼å‡½æ•°æ˜¯å¯¹è±¡ï¼Œå› æ­¤å®ƒä»¬å…·æœ‰å±æ€§ã€‚äº‹å®ä¸Šï¼Œå®ƒä»¬ç¡®å®è¿˜æœ‰å±æ€§å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ¯ä¸€ä¸ªå‡½æ•°ï¼Œæ— è®ºä½¿ç”¨ä»€ä¹ˆæ ·çš„è¯­æ³•æ¥åˆ›å»ºå®ƒï¼Œå®ƒéƒ½ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ªlengthå±æ€§ï¼Œå…¶ä¸­åŒ…å«äº†è¯¥å‡½æ•°æœŸæœ›çš„å‚æ•°æ•°é‡ã€‚å¯ä»¥åœ¨ä»»ä½•æ—¶å€™å°†è‡ªå®šä¹‰å±æ€§æ·»åŠ åˆ°ä½ çš„å‡½æ•°ä¸­ã€‚è‡ªå®šä¹‰å±æ€§çš„å…¶ä¸­ä¸€ä¸ªç”¨ä¾‹æ˜¯ç¼“å­˜å‡½æ•°è¿”å›å€¼ï¼Œä¹Ÿè¢«ç§°ä¸ºå¤‡å¿˜ã€‚ example. 123456789var myFunc = function(param)&#123; if(!myFunc.cache[param])&#123; var result = &#123;&#125;; //å¼€é”€å¾ˆå¤§çš„æ“ä½œ... myFunc.cache[param] = result; &#125; return myFunc.cache[param];&#125;;myFunc.cache = &#123;&#125;; ä¸Šè¿°ä»£ç å‡å®šè¯¥å‡½æ•°åªéœ€è¦ä¸€ä¸ªå‚æ•°paramï¼Œå¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹ã€‚å¦‚æœæœ‰æ›´å¤šæ›´å¤æ‚çš„å‚æ•°ï¼Œå¯¹æ­¤çš„é€šç”¨è§£å†³æ–¹æ¡ˆæ˜¯å°†å®ƒä»¬åºåˆ—åŒ–ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†å‚æ•°å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€ä¸ªJSONå­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨è¯¥å­—ç¬¦ä¸²ä½œä¸ºcacheå¯¹è±¡çš„é”®ã€‚ 1var cachekey = JSON.stringify(Array.prototype.slice.call(arguments)); æ³¨æ„ï¼šåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡çš„â€œæ ‡è¯†â€å°†ä¼šä¸¢å¤±ã€‚å¦‚æœæœ‰ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡å¹¶ä¸”æ°å¥½éƒ½å…·æœ‰ç›¸åŒçš„å±æ€§ï¼Œåˆ™å®ƒä»¬åºåˆ—åŒ–åçš„ç»“æœç›¸åŒã€‚ æ€§èƒ½æ¨¡å¼-è‡ªå®šä¹‰å‡½æ•°example. 12345678var scareMe = function()&#123; alert('Boo!'); scareMe = function()&#123; alert('Double boo!')ï¼› &#125;;&#125;;scareMe(); //output: Boo!scareMe(); //output: Double boo! å½“ä½ çš„å‡½æ•°æœ‰ä¸€äº›åˆå§‹åŒ–å‡†å¤‡å·¥ä½œè¦åšï¼Œå¹¶ä¸”ä»…éœ€è¦æ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆè¿™ç§æ¨¡å¼å°±éå¸¸æœ‰ç”¨ã€‚å› ä¸ºå¹¶æ²¡æœ‰ä»»ä½•ç†ç”±å»æ‰§è¡Œæœ¬å¯ä»¥é¿å…çš„é‡å¤å·¥ä½œï¼Œå³å‡½æ•°çš„ä¸€äº›éƒ¨åˆ†å¯èƒ½å¹¶ä¸å†éœ€è¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªå®šä¹‰å‡½æ•°å¯ä»¥æ›´æ–°è‡ªèº«çš„å®ç°ã€‚è¿™ç§æ¨¡å¼çš„å¦ä¸€ä¸ªåç§°æ˜¯â€œæƒ°æ€§å‡½æ•°å®šä¹‰â€ï¼ˆlazy function definitionï¼‰ï¼Œå› ä¸ºè¯¥å‡½æ•°ç›´åˆ°ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰è¢«æ­£ç¡®åœ°å®šä¹‰ï¼Œå¹¶ä¸”å…·æœ‰åå‘æƒ°æ€§ï¼Œæ‰§è¡Œäº†æ›´å°‘çš„å·¥ä½œã€‚è¯¥æ¨¡å¼çš„å…¶ä¸­ä¸€ä¸ªç¼ºç‚¹åœ¨äºï¼Œå½“å®ƒé‡å®šä¹‰è‡ªèº«æ—¶ï¼Œå·²ç»æ·»åŠ åˆ°åŸå§‹å‡½æ•°çš„ä»»ä½•å±æ€§éƒ½ä¼šä¸¢å¤±ã€‚æ­¤å¤–ï¼Œå¦‚æœè¯¥å‡½æ•°ä½¿ç”¨äº†ä¸åŒçš„åç§°ï¼Œæ¯”å¦‚åˆ†é…ç»™ä¸åŒçš„å˜é‡æˆ–è€…ä»¥å¯¹è±¡çš„æ–¹æ³•æ¥ä½¿ç”¨ï¼Œé‚£ä¹ˆé‡å®šä¹‰éƒ¨åˆ†å°†æ°¸è¿œä¸ä¼šå‘ç”Ÿï¼Œå¹¶ä¸”å°†ä¼šæ‰§è¡ŒåŸå§‹å‡½æ•°ä½“ã€‚ example.æ¥ä¸Š 1234567891011121314151617181920212223//1ã€æ·»åŠ ä¸€ä¸ªæ–°çš„å±æ€§scareMe.property = 'properly';//2ã€èµ‹å€¼ç»™å¦ä¸€ä¸ªä¸åŒåç§°çš„å˜é‡var prank = scareMe;//3ã€ä½œä¸ºä¸€ä¸ªæ–¹æ³•ä½¿ç”¨var spooky = &#123; boo: scareMe&#125;;//calling with a new nameprank(); //output: Boo!prank(); //output: Boo!console.log(prank.property); //output: properly//ä½œä¸ºä¸€ä¸ªæ–¹æ³•æ¥è°ƒç”¨spooky.boo(); //output: Boo!spooky.boo(); //output: Boo!console.log(spooky.boo.property); //output: properly//ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°scareMe(); //output: Double boo!scareMe(); //output: Double boo!console.log(scareMe.property); //output: undefined æ­£å¦‚çœ‹åˆ°çš„ï¼Œå½“å°†è¯¥å‡½æ•°åˆ†é…ç»™ä¸€ä¸ªæ–°çš„å˜é‡æ—¶ï¼Œå‡½æ•°çš„è‡ªå®šä¹‰å¹¶æ²¡æœ‰å‘ç”Ÿã€‚æ¯æ¬¡å½“è°ƒç”¨prank()æ—¶ï¼Œå®ƒéƒ½é€šçŸ¥â€™Boo!â€™æ¶ˆæ¯ï¼ŒåŒæ—¶å®ƒè¿˜è¦†ç›–äº†å…¨å±€scareMe()å‡½æ•°ï¼Œä½†æ˜¯prank()è‡ªèº«ä¿æŒäº†å¯è§æ—§å‡½æ•°ï¼Œå…¶ä¸­è¿˜åŒ…æ‹¬å±æ€§ã€‚å½“è¯¥å‡½æ•°ä»¥spookyå¯¹è±¡çš„boo()æ–¹æ³•ä½¿ç”¨æ—¶ï¼Œä¹Ÿå‘ç”Ÿäº†åŒæ ·çš„æƒ…å†µã€‚æ‰€æœ‰è¿™äº›è°ƒç”¨ä¸æ–­åœ°é‡å†™å…¨å±€scareMe()æŒ‡é’ˆï¼Œä»¥è‡³äºå½“å®ƒæœ€ç»ˆè¢«è°ƒç”¨æ—¶ï¼Œå®ƒæ‰ç¬¬ä¸€æ¬¡å…·æœ‰æ›´æ–°å‡½æ•°ä¸»ä½“å¹¶é€šçŸ¥â€™Double boo!â€™æ¶ˆæ¯çš„æƒåˆ©ã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿä¸èƒ½è®¿é—®scareMe.propertyå±æ€§ã€‚ å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹äºŒ-å­—é¢é‡å’Œæ„é€ å‡½æ•°]]></title>
    <url>%2Fblog%2F2014%2F02%2Fjs-pattern-part2-literal-and-constructor.html</url>
    <content type="text"><![CDATA[å¯¹è±¡åˆ›å»ºæ–¹å¼å¯¹è±¡å­—é¢é‡ï¼šè¿™æ˜¯ä¸€ç§ä¼˜ç¾çš„å¯¹è±¡åˆ›å»ºæ–¹å¼ï¼Œå®ƒä»¥åŒ…è£…åœ¨å¤§æ‹¬å·ä¸­çš„é€—å·åˆ†å‰²çš„é”®-å€¼ï¼ˆkey-valueï¼‰å¯¹çš„æ–¹å¼åˆ›å»ºå¯¹è±¡ã€‚æ„é€ å‡½æ•°ï¼šä¸»è¦åŒ…æ‹¬å†…ç½®æ„é€ å‡½æ•°ï¼ˆå‡ ä¹æ€»æ˜¯æœ‰ä¸€ä¸ªæ›´å¥½ä¸”æ›´çŸ­çš„å­—é¢é‡è¡¨ç¤ºæ³•ï¼‰å’Œè‡ªå®šä¹‰æ„é€ å‡½æ•°ã€‚ example. 12345//ä½¿ç”¨å­—é¢é‡var car = &#123;goes: 'far'&#125;;//ä½¿ç”¨å†…ç½®æ„é€ å‡½æ•°ï¼ˆåæ¨¡å¼ï¼‰var car = new Object();car.goes = 'far'; ä¼˜å…ˆé€‰æ‹©å­—é¢é‡æ¨¡å¼åˆ›å»ºå¯¹è±¡çš„å¦ä¸€ä¸ªåŸå› åœ¨äºå®ƒå¼ºè°ƒäº†è¯¥å¯¹è±¡ä»…æ˜¯ä¸€ä¸ªå¯å˜å“ˆå¸Œæ˜ å°„ï¼Œè€Œä¸æ˜¯ä»å¯¹è±¡ä¸­æå–çš„å±æ€§æˆ–æ–¹æ³•ã€‚ä¸ä½¿ç”¨Objectæ„é€ å‡½æ•°ç›¸å¯¹ï¼Œä½¿ç”¨å­—é¢é‡çš„å¦ä¸€ä¸ªåŸå› åœ¨äºå®ƒå¹¶æ²¡æœ‰ä½œç”¨åŸŸè§£æã€‚å› ä¸ºå¯èƒ½ä»¥åŒæ ·çš„åå­—åˆ›å»ºäº†ä¸€ä¸ªå±€éƒ¨æ„é€ å‡½æ•°ï¼Œè§£é‡Šå™¨éœ€è¦ä»è°ƒç”¨Object()çš„ä½ç½®å¼€å§‹ä¸€ç›´å‘ä¸ŠæŸ¥è¯¢ä½œç”¨åŸŸé“¾ï¼Œç›´åˆ°å‘ç°å…¨å±€Objectæ„é€ å‡½æ•°ã€‚ Object()æ„é€ å‡½æ•°ä»…æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿˜ä¾èµ–ä¼ é€’çš„å€¼ï¼Œè¯¥Object()å¯èƒ½ä¼šå§”æ´¾å¦ä¸€ä¸ªå†…ç½®æ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›äº†ä¸€ä¸ªå¹¶éæœŸæœ›çš„ä¸åŒå¯¹è±¡ã€‚å½“ä¼ é€’ç»™Object()æ„é€ å‡½æ•°çš„å€¼æ˜¯åŠ¨æ€çš„ï¼Œå¹¶ä¸”ç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šå…¶ç±»å‹æ—¶ï¼ŒObject()æ„é€ å‡½æ•°çš„è¿™ç§è¡Œä¸ºå¯èƒ½ä¼šå¯¼è‡´æ„æ–™ä¸åˆ°çš„ç»“æœã€‚å› æ­¤ï¼Œä¸è¦ä½¿ç”¨new Object()æ„é€ å‡½æ•°ï¼Œç›¸ååº”è¯¥ä½¿ç”¨æ›´ä¸ºç®€å•ã€å¯é çš„å¯¹è±¡å­—é¢é‡æ¨¡å¼ã€‚ è‡ªå®šä¹‰æ„é€ å‡½æ•°123456var Person = function(name)&#123; this.name = name; this.say = function()&#123; return 'I am ' + this.name; &#125;;&#125;; å½“ä»¥newæ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œå‡½æ•°å†…éƒ¨å°†ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡å¹¶ä¸”thiså˜é‡å¼•ç”¨äº†è¯¥å¯¹è±¡ï¼ŒåŒæ—¶è¿˜ç»§æ‰¿äº†è¯¥å‡½æ•°çš„åŸå‹ã€‚ å±æ€§å’Œæ–¹æ³•è¢«åŠ å…¥åˆ°thiså¼•ç”¨çš„å¯¹è±¡ä¸­ã€‚ æ–°åˆ›å»ºçš„å¯¹è±¡ç”±thisæ‰€å¼•ç”¨ï¼Œå¹¶ä¸”æœ€åéšå¼åœ°è¿”å›thisï¼ˆå¦‚æœæ²¡æœ‰æ˜¾å¼åœ°è¿”å›å…¶å®ƒå¯¹è±¡ï¼‰ã€‚ ä»¥ä¸Šæƒ…å†µçœ‹èµ·æ¥å°±åƒæ˜¯åœ¨åå°å‘ç”Ÿäº†å¦‚ä¸‹äº‹æƒ…ï¼š 12345678910var Person = function(name)&#123; //ä½¿ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ //var this = &#123;&#125;; //å‘thisæ·»åŠ å±æ€§å’Œæ–¹æ³• this.name = name; this.say = function()&#123; return 'I am ' + this.name; &#125;; //return this;&#125;; åœ¨æœ¬ä¾‹ä¸­ï¼Œå°†say()æ–¹æ³•æ·»åŠ åˆ°thisä¸­ï¼Œå…¶é€ æˆçš„ç»“æœæ˜¯åœ¨ä»»ä½•æ—¶å€™è°ƒç”¨new Person()æ—¶éƒ½ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚è¿™ç§æ–¹æ³•æ˜¾ç„¶æ˜¯ä½æ•ˆçš„ï¼Œå› ä¸ºå¤šä¸ªå®ä¾‹ä¹‹é—´çš„say()æ–¹æ³•å®é™…ä¸Šå¹¶æ²¡æœ‰æ”¹å˜ã€‚æ›´å¥½çš„é€‰æ‹©åº”è¯¥æ˜¯å°†æ–¹æ³•æ·»åŠ åˆ°Personç±»çš„åŸå‹ä¸­ã€‚å¯é‡ç”¨çš„æˆå‘˜ï¼Œæ¯”å¦‚å¯é‡ç”¨çš„æ–¹æ³•ï¼Œéƒ½åº”è¯¥æ”¾ç½®åˆ°å¯¹è±¡çš„åŸå‹ä¸­ã€‚ æœ¬ä¾‹ä¸­ï¼Œvar this = {};å¹¶ä¸æ˜¯çœŸç›¸çš„å…¨éƒ¨ï¼Œå› ä¸ºâ€œç©ºâ€å¯¹è±¡å®é™…ä¸Šå¹¶ä¸ç©ºï¼Œå®ƒå·²ç»ä»Personçš„åŸå‹ä¸­ç»§æ‰¿äº†è®¸å¤šæˆå‘˜ã€‚å› æ­¤ï¼Œå®ƒæ›´åƒæ˜¯ä¸‹é¢çš„è¯­å¥ï¼š 1var this = Object.create(Person.prototype); æ³¨æ„ï¼Œæ„é€ å‡½æ•°å°†éšå¼åœ°è¿”å›thisï¼Œç”šè‡³äºåœ¨å‡½æ•°ä¸­æ²¡æœ‰æ˜¾å¼åœ°åŠ å…¥returnè¯­å¥ã€‚ä½†æ˜¯ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è¿”å›ä»»æ„å…¶ä»–å¯¹è±¡ã€‚ å¼ºåˆ¶ä½¿ç”¨newçš„æ¨¡å¼åœ¨è°ƒç”¨æ„é€ å‡½æ•°æ—¶å¦‚æœå¿˜è®°ä½¿ç”¨newæ“ä½œç¬¦ï¼Œå°†å¯¼è‡´æ„é€ å‡½æ•°ä¸­çš„thisæŒ‡å‘äº†å…¨å±€å¯¹è±¡ï¼ˆåœ¨æµè§ˆå™¨ä¸­ï¼Œthiså°†ä¼šæŒ‡å‘windowï¼‰ã€‚ example. 1234567function Waffle()&#123; this.tastes = 'yummy';&#125;//åæ¨¡å¼ï¼šå¿˜è®°ä½¿ç”¨newæ“ä½œç¬¦var mm = Waffle();console.log(typeof mm); //output: undefinedconsole.log(window.tastes); //output: yummy ä¸Šé¢çš„è¿™ç§æ„å¤–è¡Œä¸ºåœ¨ECMAScript 5ä¸­å¾—åˆ°äº†è§£å†³ï¼Œå¹¶ä¸”åœ¨strictæ¨¡å¼ä¸­ï¼Œthisä¸ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡ã€‚ æ–¹æ¡ˆ1ï¼šä½¿ç”¨that 12345function Waffle()&#123; var that = &#123;&#125;; that.tastes = 'yummy'; return that;&#125; è¿™ç§æ¨¡å¼çš„é—®é¢˜åœ¨äºå®ƒä¼šä¸¢å¤±åˆ°åŸå‹çš„é“¾æ¥ï¼Œå› æ­¤ä»»ä½•æ·»åŠ åˆ°Waffle()åŸå‹çš„æˆå‘˜ï¼Œå¯¹äºå¯¹è±¡æ¥è¯´éƒ½æ˜¯ä¸å¯ç”¨çš„ã€‚ æ–¹æ¡ˆ2ï¼šè‡ªè°ƒç”¨æ„é€ å‡½æ•° å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­æ£€æŸ¥thisæ˜¯å¦ä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¦‚æœä¸ºå¦ï¼Œæ„é€ å‡½æ•°å¯ä»¥å†æ¬¡è°ƒç”¨è‡ªèº«ï¼Œå¹¶ä¸”åœ¨è¿™æ¬¡è°ƒç”¨ä¸­æ­£ç¡®åœ°ä½¿ç”¨newæ“ä½œç¬¦ã€‚ example. 1234567891011121314function Waffle()&#123; if(!(this instanceof Waffle))&#123; return new Waffle(); &#125; this.tastes = 'yummy';&#125;Waffle.prototype.wantAnother = true;var first = new Waffle();var second = Waffle();console.log(first.tastes); //output: yummyconsole.log(second.tastes); //output: yummyconsole.log(first.wantAnother); //output: trueconsole.log(second.wantAnother); //output: true å¦ä¸€ç§ç”¨äºæ£€æµ‹å®ä¾‹å¯¹è±¡çš„é€šç”¨æ–¹æ³•æ˜¯å°†å…¶ä¸arguments.calleeè¿›è¡Œæ¯”è¾ƒï¼Œè€Œä¸æ˜¯åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ„é€ å‡½æ•°åç§°ã€‚ 123if(!(this instanceof arguments.callee))&#123; return new arguments.callee();&#125; æ³¨ï¼šåœ¨ES5çš„strictæ¨¡å¼ä¸­å¹¶ä¸æ”¯æŒarguments.calleeå±æ€§ã€‚ å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javascriptæ¨¡å¼ä¹‹ä¸€-åŸºæœ¬æŠ€å·§]]></title>
    <url>%2Fblog%2F2014%2F02%2Fjs-pattern-part1-basic-tricks.html</url>
    <content type="text"><![CDATA[åŸºæœ¬æ¦‚å¿µ-é¢å‘å¯¹è±¡Javascriptæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ã€‚åªæœ‰äº”ç§åŸºæœ¬ç±»å‹ä¸æ˜¯å¯¹è±¡ï¼šæ•°å€¼ç±»å‹ã€å­—ç¬¦ä¸²ç±»å‹ã€å¸ƒå°”ç±»å‹ã€ç©ºç±»å‹å’Œæœªå®šä¹‰ç±»å‹ã€‚å…¶ä¸­å‰ä¸‰ä¸ªç±»å‹æœ‰å¯¹åº”çš„ä»¥åŸºæœ¬ç±»å‹å°è£…å½¢å¼ä½“ç°çš„å¯¹è±¡è¡¨ç¤ºã€‚ åœ¨JavaScriptä¸­ï¼Œä¸€æ—¦å®šä¹‰å¥½äº†å˜é‡ï¼ŒåŒæ—¶ä¹Ÿå°±å·²ç»æ­£åœ¨å¤„ç†å¯¹è±¡äº†ã€‚é¦–å…ˆï¼Œè¯¥å˜é‡ä¼šè‡ªåŠ¨æˆä¸ºå†…ç½®å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œæˆä¸ºæ¿€æ´»å¯¹è±¡ï¼ˆå¦‚æœè¯¥å˜é‡æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé‚£ä¹ˆè¯¥å˜é‡ä¼šæˆä¸ºå…¨å±€å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼‰ã€‚ç¬¬äºŒï¼Œè¯¥å˜é‡å®é™…ä¸Šä¹Ÿæ˜¯ä¼ªç±»ï¼Œå› ä¸ºå®ƒæ‹¥æœ‰å…¶è‡ªèº«çš„å±æ€§ï¼ˆç§°ä¸ºattributesï¼‰ï¼Œè¯¥å±æ€§å†³å®šäº†è¯¥å˜é‡æ˜¯å¦å¯ä»¥è¢«ä¿®æ”¹ã€è¢«åˆ é™¤å’Œåœ¨ä¸€ä¸ªfor-inå¾ªç¯ä¸­è¿›è¡Œæšä¸¾ã€‚è¿™äº›å±æ€§åœ¨ECMAScript3ä¸­æ²¡æœ‰ç›´æ¥å¯¹å¤–æä¾›ï¼Œä½†åœ¨ç¬¬5ç‰ˆæœ¬çš„ECMAScriptä¸­ï¼Œæä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„æè¿°ç¬¦æ–¹æ³•æ¥æ“çºµè¿™äº›å±æ€§ã€‚ å‡½æ•°å®é™…ä¸Šä¹Ÿæ˜¯å¯¹è±¡ï¼Œå‡½æ•°æœ‰å±æ€§å’Œæ–¹æ³•ã€‚ä¸€ä¸ªå¯¹è±¡ä»…ä»…æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè¯¥å®¹å™¨åŒ…å«äº†å‘½åçš„å±æ€§ã€é”®å€¼å¯¹çš„åˆ—è¡¨ã€‚è¿™é‡Œé¢çš„å±æ€§å¯ä»¥æ˜¯å‡½æ•°ï¼ˆå‡½æ•°å¯¹è±¡ï¼‰ï¼Œè¿™ç§æƒ…å½¢ä¸‹æˆ‘ä»¬ç§°å…¶ä¸ºæ–¹æ³•ã€‚ä¸€ä¸ªâ€œç©ºå¯¹è±¡â€å®é™…ä¸Šå¹¶ä¸æ˜¯å®Œå…¨ç©ºç™½çš„ï¼Œå®ƒåŒ…å«æœ‰ä¸€äº›å†…ç½®å±æ€§ï¼Œä½†æ˜¯æ²¡æœ‰å…¶è‡ªèº«çš„å±æ€§ã€‚ å…³äºåˆ›å»ºçš„å¯¹è±¡çš„å¦å¤–ä¸€ä»¶äº‹æƒ…æ˜¯å¯ä»¥åœ¨ä»»æ„æ—¶é—´ä¿®æ”¹è¯¥å¯¹è±¡ï¼ˆå°½ç®¡ECMAScript5å¼•å…¥äº†APIæ¥é˜²æ­¢çªå˜ï¼‰ã€‚å¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡æ‰§è¡Œæ·»åŠ ã€åˆ é™¤å’Œæ›´æ–°å®ƒçš„æˆå‘˜å˜é‡ã€‚ æœ€åéœ€è¦è®°ä½çš„æ˜¯å¯¹è±¡ä¸»è¦æœ‰ä¸¤ç§ï¼šåŸç”Ÿçš„ï¼ˆNativeï¼‰ï¼Œåœ¨ECMAScriptæ ‡å‡†ä¸­æœ‰è¯¦ç»†æè¿°ã€‚ä¸»æœºçš„ï¼ˆHostï¼‰ï¼Œåœ¨ä¸»æœºç¯å¢ƒä¸­å®šä¹‰çš„ï¼ˆä¾‹å¦‚æµè§ˆå™¨ç¯å¢ƒï¼‰ã€‚åŸç”Ÿçš„å¯¹è±¡å¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºå†…ç½®å¯¹è±¡ï¼ˆä¾‹å¦‚æ•°ç»„ã€æ—¥æœŸå¯¹è±¡ç­‰ï¼‰å’Œç”¨æˆ·è‡ªå®šä¹‰å¯¹è±¡ï¼ˆä¾‹å¦‚var o={};ï¼‰ç­‰ã€‚ä¸»æœºå¯¹è±¡åŒ…å«windowså¯¹è±¡å’Œæ‰€æœ‰çš„DOMå¯¹è±¡ã€‚ JavaScriptä¸­æ²¡æœ‰ç±»ã€‚Javascriptåªå¤„ç†å¯¹è±¡ã€‚JavaScriptæ²¡æœ‰ç»§æ‰¿ï¼Œé€šå¸¸ä½¿ç”¨åŸå‹æ¥å®ç°ç»§æ‰¿ã€‚åŸå‹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”åˆ›å»ºçš„æ¯ä¸€ä¸ªå‡½æ•°éƒ½ä¼šè‡ªåŠ¨è·å–ä¸€ä¸ªprototypeå±æ€§ï¼Œè¯¥å±æ€§æŒ‡å‘ä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡ã€‚è¯¥é»˜è®¤çš„åŸå‹å¯¹è±¡å‡ ä¹ç­‰åŒäºé‡‡ç”¨å¯¹è±¡å­—é¢é‡æˆ–Object()åˆ›å»ºçš„å¯¹è±¡ï¼ŒåŒºåˆ«åœ¨äºå®ƒçš„constructorå±æ€§æŒ‡å‘äº†æ‰€åˆ›å»ºçš„å‡½æ•°ï¼Œè€Œä¸æ˜¯æŒ‡å‘å†…ç½®çš„Object()å‡½æ•°ã€‚ example. 1234567var func = function()&#123;&#125;;console.log(func.constructor); //output: function Function() &#123; [native code] &#125;console.log(func.prototype); //output: Object &#123;&#125;console.log(func.prototype.constructor); //output: function ()&#123;&#125;var obj = &#123;&#125;;console.log(obj.constructor); //output: function Object() &#123; [native code] &#125; å…¨å±€å˜é‡çš„é—®é¢˜å…¨å±€å˜é‡çš„é—®é¢˜åœ¨äºå®ƒä»¬åœ¨æ•´ä¸ªJavascriptåº”ç”¨æˆ–Webé¡µé¢å†…å…±äº«ï¼Œå®ƒä»¬ç”Ÿå­˜äºåŒä¸€ä¸ªå…¨å±€å‘½åç©ºé—´å†…ï¼Œæ€»æœ‰å¯èƒ½å‘ç”Ÿå‘½åå†²çªã€‚è¦å°½å¯èƒ½å°‘åœ°ä½¿ç”¨å…¨å±€å˜é‡ï¼Œå¦‚ä½¿ç”¨å‘½åç©ºé—´æ¨¡å¼æˆ–è‡ªæ‰§è¡Œç«‹å³ç”Ÿæ•ˆå‡½æ•°ï¼ˆthe self-executing immediate functionsï¼‰ï¼Œä½†æœ€é‡è¦çš„æ–¹æ³•è¿˜æ˜¯ä½¿ç”¨varå£°æ˜å˜é‡ã€‚ Javascriptæ€»æ˜¯åœ¨ä¸çŸ¥ä¸è§‰ä¸­å°±å‡ºäººæ„æ–™åœ°åˆ›å»ºäº†å…¨å±€å˜é‡ï¼Œå…¶åŸå› åœ¨äºJavascriptçš„ä¸¤ä¸ªç‰¹æ€§ã€‚ç¬¬ä¸€ä¸ªç‰¹æ€§æ˜¯Javascriptå¯ç›´æ¥ä½¿ç”¨å˜é‡ï¼Œç”šè‡³æ— éœ€å£°æ˜ã€‚ç¬¬äºŒä¸ªç‰¹æ€§æ˜¯Javascriptæœ‰ä¸ªæš—ç¤ºå…¨å±€å˜é‡ï¼ˆimplied globalsï¼‰çš„æ¦‚å¿µï¼Œå³ä»»ä½•å˜é‡ï¼Œå¦‚æœæœªç»å£°æ˜ï¼Œå°±ä¸ºå…¨å±€å¯¹è±¡æ‰€æœ‰ï¼ˆä¹Ÿå°±åƒæ­£ç¡®å£°æ˜è¿‡çš„å…¨å±€å˜é‡ä¸€æ ·å¯ä»¥è®¿é—®ï¼‰ã€‚ æ³¨ï¼šåœ¨ECMAScript5 strictæ¨¡å¼ä¸­ï¼Œä¸ºæ²¡æœ‰å£°æ˜çš„å˜é‡èµ‹å€¼ä¼šæŠ›å‡ºé”™è¯¯ã€‚ å¦ä¸€ç§åˆ›å»ºéšå¼å…¨å±€å˜é‡çš„åæ¨¡å¼æ˜¯å¸¦æœ‰varå£°æ˜çš„é“¾å¼èµ‹å€¼ã€‚ example. 1234function foo()&#123; var a = b = 0; //...&#125; åœ¨è¿™ä»£ç ç‰‡æ®µä¸­ï¼Œaæ˜¯å±€éƒ¨å˜é‡ï¼Œbæ˜¯å…¨å±€å˜é‡ï¼Œè¿™ä¹Ÿè®¸å¹¶ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚è¿™æºäºä»å³è‡³å·¦çš„æ“ä½œç¬¦ä¼˜å…ˆçº§ã€‚é¦–å…ˆï¼Œä¼˜å…ˆçº§è¾ƒé«˜çš„æ˜¯è¡¨è¾¾å¼b=0ï¼Œæ­¤æ—¶bæœªç»å£°æ˜ã€‚è¡¨è¾¾å¼çš„è¿”å›å€¼ä¸º0ï¼Œå®ƒè¢«èµ‹ç»™varå£°æ˜çš„å±€éƒ¨å˜é‡aï¼Œå¦‚ä»¥ä¸‹ä»£ç è¡¨ç¤ºï¼š 1var a = (b = 0); å˜é‡é‡Šæ”¾æ—¶çš„å‰¯ä½œç”¨éšå¼å…¨å±€å˜é‡ä¸æ˜ç¡®å®šä¹‰çš„å…¨å±€å˜é‡æœ‰ç»†å¾®çš„ä¸åŒï¼Œä¸åŒä¹‹å¤„åœ¨äºèƒ½å¦ä½¿ç”¨deleteæ“ä½œç¬¦æ’¤é”€å˜é‡ã€‚ä½¿ç”¨varåˆ›å»ºçš„å…¨å±€å˜é‡ï¼ˆè¿™ç±»å˜é‡åœ¨å‡½æ•°å¤–éƒ¨åˆ›å»ºï¼‰ä¸èƒ½åˆ é™¤ã€‚ä¸ä½¿ç”¨varåˆ›å»ºçš„éšå¼å…¨å±€å˜é‡ï¼ˆå°½ç®¡å®ƒæ˜¯åœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºï¼‰å¯ä»¥åˆ é™¤ã€‚è¿™è¡¨æ˜éšå¼å…¨å±€å˜é‡ä¸¥æ ¼æ¥è®²ä¸æ˜¯çœŸæ­£çš„å˜é‡ï¼Œè€Œæ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§ã€‚å±æ€§å¯ä»¥é€šè¿‡deleteæ“ä½œç¬¦åˆ é™¤ï¼Œä½†å˜é‡ä¸å¯ä»¥ã€‚ æå‡-å‡Œæ•£å˜é‡çš„é—®é¢˜Javascriptå…è®¸åœ¨å‡½æ•°çš„ä»»æ„åœ°æ–¹å£°æ˜å¤šä¸ªå˜é‡ï¼Œæ— è®ºåœ¨å“ªé‡Œå£°æ˜ï¼Œæ•ˆæœéƒ½ç­‰åŒäºåœ¨å‡½æ•°é¡¶éƒ¨è¿›è¡Œå£°æ˜ã€‚è¿™å°±æ˜¯æ‰€è°“çš„â€œæå‡â€ã€‚åªè¦å˜é‡æ˜¯åœ¨åŒä¸€ä¸ªèŒƒå›´ï¼ˆåŒä¸€å‡½æ•°ï¼‰é‡Œï¼Œå°±è§†ä¸ºå·²ç»å£°æ˜ï¼Œå“ªæ€•æ˜¯åœ¨å˜é‡å£°æ˜å‰å°±ä½¿ç”¨ã€‚ example. 1234567myname = 'global';function func()&#123; alert(myname); //output: undefined var myname = 'local'; alert(myname); //output: local&#125;func(); ç­‰åŒäº 12345678myname = 'global';function func()&#123; var myname; //ç­‰åŒäº var myname = undefined; alert(myname); //output: undefined myname = 'local'; alert(myname); //output: local&#125;func(); æ³¨ï¼šä»…ä»…æ˜¯å˜é‡å£°æ˜æå‡äº†ï¼Œèµ‹å€¼ä»åœ¨åŸæ¥çš„ä½ç½®ã€‚ forå¾ªç¯forå¾ªç¯æ€§èƒ½æå‡å»ºè®®ï¼š ç¼“å­˜éå†å¯¹è±¡çš„é•¿åº¦ï¼Œå°¤å…¶æ˜¯DOMå…ƒç´ ã€‚æ¯æ¬¡è®¿é—®ä»»ä½•å®¹å™¨çš„é•¿åº¦æ—¶ï¼Œä¹Ÿå°±æ˜¯åœ¨æŸ¥è¯¢æ´»åŠ¨çš„DOMã€‚ é€æ­¥å‡è‡³0ï¼Œè¿™æ ·é€šå¸¸æ›´å¿«ï¼Œå› ä¸ºåŒ0æ¯”è¾ƒæ›´æœ‰æ•ˆç‡ã€‚ example. 123for(var i=elements.length-1; i&gt;=0; i--)&#123;...&#125;//æˆ–for(var i=elements.length; i--; )&#123;...&#125; for-inå¾ªç¯ç”¨æ¥éå†éæ•°ç»„å¯¹è±¡ï¼Œä¹Ÿè¢«ç§°ä¸ºæšä¸¾ã€‚å½“éå†å¯¹è±¡å±æ€§æ—¶ï¼Œä½¿ç”¨hasOwnProperty()æ¥è¿‡æ»¤åŸå‹é“¾çš„å±æ€§ã€‚ example. 12345for(var i in obj)&#123; if(obj.hasOwnProperty(i))&#123;...&#125; //æˆ– if(Object.prototype.hasOwnProperty(obj, i))&#123;...&#125;&#125; é¿å…ä½¿ç”¨eval()â€œeval()æ˜¯ä¸€ä¸ªé­”é¬¼â€ã€‚è¯¥å‡½æ•°å¯ä»¥å°†ä»»æ„å­—ç¬¦ä¸²å½“åšä¸€ä¸ªJavascriptä»£ç æ¥æ‰§è¡Œã€‚å½“éœ€è¦è®¨è®ºçš„ä»£ç æ˜¯é¢„å…ˆå°±ç¼–å†™å¥½äº†ï¼ˆä¸æ˜¯åœ¨åŠ¨æ€è¿è¡Œæ—¶å†³å®šï¼‰ï¼Œæ˜¯æ²¡æœ‰ç†ç”±ä½¿ç”¨eval()çš„ã€‚ä½¿ç”¨eval()å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œå› ä¸ºè¿™æ ·åšæœ‰å¯èƒ½æ‰§è¡Œè¢«ç¯¡æ”¹è¿‡çš„ä»£ç ï¼ˆä¾‹å¦‚æ¥è‡ªç½‘ç»œçš„ä»£ç ï¼‰ã€‚è¿™æ˜¯åœ¨å¤„ç†æ¥è‡ªä¸€ä¸ªAjaxè¯·æ±‚çš„JSONå“åº”æ—¶å¸¸è§çš„åæ¨¡å¼ï¼Œæœ€å¥½æ˜¯ä½¿ç”¨æµè§ˆå™¨å†…ç½®çš„æ–¹æ³•æ¥è§£æJSONæ•°æ®ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§å’Œæœ‰æ•ˆæ€§ã€‚å¯¹äºåŸç”Ÿä¸æ”¯æŒJSON.parse()çš„æµè§ˆå™¨æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨æ¥è‡ªJSON.orgç½‘ç«™çš„ç±»åº“ã€‚ è¿˜æœ‰ä¸€ç‚¹ï¼Œé€šè¿‡setInterval()ã€setTimeout()å’Œfunction()ç­‰æ„é€ å‡½æ•°æ¥ä¼ é€’å‚æ•°ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å½¢ä¸‹ï¼Œä¼šå¯¼è‡´ç±»ä¼¼eval()çš„éšæ‚£ã€‚ example. 123456789//åæ¨¡å¼ setTimeout('myFunc()', 1000);setTimeout('myFunc(1, 2, 3)', 1000);//æ¨èçš„æ¨¡å¼ setTimeout(myFunc, 1000);setTimeout(function()&#123; myFunc(1, 2, 3);&#125;, 1000); å¦‚æœä¸€å®šè¦ä½¿ç”¨eval()ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨new Function()æ¥æ›¿ä»£eval()ã€‚è¿™æ ·åšçš„ä¸€ä¸ªæ½œåœ¨å¥½å¤„æ˜¯ç”±äºåœ¨new Function()ä¸­çš„ä»£ç å°†åœ¨å±€éƒ¨å‡½æ•°ç©ºé—´ä¸­è¿è¡Œï¼Œå› æ­¤ä»£ç ä¸­ä»»ä½•é‡‡ç”¨varå®šä¹‰çš„å˜é‡ä¸ä¼šè‡ªåŠ¨æˆä¸ºå…¨å±€å˜é‡ã€‚å¦ä¸€ä¸ªé¿å…è‡ªåŠ¨æˆä¸ºå…¨å±€å˜é‡çš„æ–¹æ³•æ˜¯å°†eval()è°ƒç”¨å°è£…åˆ°ä¸€ä¸ªå³æ—¶å‡½æ•°ä¸­ã€‚ example. 12345678910var jsstring = 'var one = 1; console.log(one);';eval(jsstring); //output: 1jsstring = 'var two = 2; console.log(two);';(function()&#123; eval(jsstring);&#125;()); //output: 2console.log(typeof one); //output: numberconsole.log(typeof two); //output: undefined å¦ä¸€ä¸ªnew Function()å’Œeval()çš„åŒºåˆ«åœ¨äºeval()ä¼šå½±å“åˆ°ä½œç”¨åŸŸé“¾ï¼Œè€ŒFunction()æ›´å¤šåœ°ç±»ä¼¼äºä¸€ä¸ªæ²™ç›’ã€‚æ— è®ºåœ¨å“ªé‡Œæ‰§è¡ŒFunctionï¼Œå®ƒéƒ½ä»…ä»…èƒ½çœ‹åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œå› æ­¤å¯¹å±€éƒ¨å˜é‡çš„å½±å“è¾ƒå°ã€‚åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ï¼Œeval()å¯ä»¥è®¿é—®å’Œä¿®æ”¹å®ƒå¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ï¼Œç„¶è€ŒFunctionä¸è¡Œï¼ˆè¯·æ³¨æ„ä½¿ç”¨Functionå’Œä½¿ç”¨new Functionæ˜¯ä¸€æ ·çš„ï¼‰ã€‚ example. 12345678910(function()&#123; var local = 1; eval('local = 3; console.log(local);'); //output: 3 console.log(local); //output: 3&#125;());(function()&#123; var local = 1; Function('console.log(typeof local);')(); //output: undefined&#125;()); å‚è€ƒJavaScriptæ¨¡å¼]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
</search>
